    @Override
    public boolean isServiceDetected(InetAddress address) {
        String hostName = address.getCanonicalHostName();
        if (InetAddressUtils.str(address).equals(hostName)) {
            try {
                hostName = Address.getHostName(address);
                //Check again.
                if (!InetAddressUtils.str(address).equals(hostName)) {
                    return true;
                }
            } catch (UnknownHostException e) {
                LOG.warn("Failed to retrieve domain/hostname for {}.", address);
            } catch (Exception e) {
                LOG.warn("Unknown exception while retrieving domain/hostname for {}.", address);
            }
        } else {
            return true;
        }
        return false;
    }

