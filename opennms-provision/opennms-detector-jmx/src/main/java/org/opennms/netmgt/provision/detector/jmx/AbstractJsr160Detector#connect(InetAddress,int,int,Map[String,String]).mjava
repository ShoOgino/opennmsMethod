    /** 
     * @throws IOException 
     */
    @Override
    protected JmxServerConnectionWrapper connect(final InetAddress address, final int port, final int timeout, final Map<String, String> runtimeAttributes) throws IOException {

        Map<String, String> props = Maps.newHashMap();
        props.put("port", String.valueOf(port));
        props.put("timeout", String.valueOf(timeout));
        props.put("factory", getFactory());
        props.put("friendlyname", getFriendlyName());
        props.put("username", getUsername());
        props.put("password", getPassword());
        props.put("urlPath", getUrlPath());
        props.put("type", getType());
        props.put("protocol", getProtocol());
        props.put("url", getUrl());
        // The runtime attributes contain the agent details pull from the JmxConfigDao
        props.putAll(runtimeAttributes);

        return Jsr160ConnectionFactory.getMBeanServerConnection(props, address);
    }

