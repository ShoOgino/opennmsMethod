    @Override
    public void connect(InetAddress address, int port, int timeout) throws IOException, Exception {
        // Validate Protocol
        if (!isTcp() && !isUdp()) {
            throw new  IllegalArgumentException("Unsupported protocol, only TCP and UDP currently supported");
        } else if (isUdp()) {
            log().warn("UDP support is largely untested");
        }
        // Initialize Socket
        if (isTcp()) {
            tcpSocket = new Socket();
            tcpSocket.connect(new InetSocketAddress(address, port), timeout);
            tcpSocket.setSoTimeout(timeout);
        } else {
            udpSocket = new DatagramSocket();
            udpSocket.setSoTimeout(timeout);
            udpPacket = new DatagramPacket(new byte[]{}, 0, address, port); // Empty datagram per RFC868
        }
        log().debug("Connected to host: " + address + " on " + protocol.toUpperCase() + " port: " + port);
    }

