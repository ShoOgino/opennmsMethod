    private String connectAndGetResponse(InetAddress address, Integer port, int timeout) {
        if(port != null){
            Socket socket = new Socket();
            try{
                
                socket.connect(new InetSocketAddress(address, port.intValue()), timeout);
                socket.setSoTimeout(timeout);
                
    
                // Allocate a line reader
                //
                BufferedReader lineRdr = new BufferedReader(new InputStreamReader(socket.getInputStream()));
    
                // Read the banner line and see if it contains the
                // substring "Microsoft Exchange"
                //
                String banner = lineRdr.readLine();
                
                socket.close();
                return banner;
                
            }catch(Exception e){
                e.printStackTrace();
                if(socket != null){
                    try {
                        socket.close();
                    } catch (IOException e1) {
                        // TODO Auto-generated catch block
                        e1.printStackTrace();
                    }
                }
            }
        }
        return null;
    }

