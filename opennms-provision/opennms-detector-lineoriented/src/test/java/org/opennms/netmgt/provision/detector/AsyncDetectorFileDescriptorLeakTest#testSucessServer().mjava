    @Test
    public void testSucessServer() throws Throwable {
        setUpServer();
        int port = m_server.getLocalPort();
        InetAddress address = m_server.getInetAddress();
        for (int i = 0; i < 10000; i++) {
            setUp();
            System.err.println("current loop: " + i);
            assertNotNull(m_detector);
            
            final TcpDetector detector = m_detector.get();
            
            detector.setPort(port);
            
            DefaultDetectFuture future = (DefaultDetectFuture)detector.isServiceDetected(address, new NullDetectorMonitor());
            future.addListener(new IoFutureListener<DetectFuture>() {
    
                public void operationComplete(DetectFuture future) {
                    detector.dispose();
                }
                
            });
            
            future.awaitUninterruptibly();
            assertNotNull(future);
            if (future.getException() != null) {
                System.err.println("got future exception: " + future.getException());
                throw future.getException();
            }
            System.err.println("got value: " + future.getObjectValue());
            assertTrue(future.isServiceDetected());

            m_detector.set(null);
        }
        tearDownServer();
    }

