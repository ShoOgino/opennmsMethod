    private static AsyncAbstractDetector getNewDetector(int port, String bannerRegex) {
        TcpDetector detector = new TcpDetector();
        detector.setServiceName("TCP");
        detector.setPort(port);
        // Three seconds
        detector.setTimeout(3000);
        // Three seconds
        detector.setIdleTime(3000);
        detector.setBanner(bannerRegex);
        detector.setRetries(3);
        detector.init();
        return detector;
    }

