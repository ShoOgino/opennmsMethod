    @Test
    public void testServerSuccess() throws Exception{
        m_server  = new SimpleServer() {
            
            public void onInit() {
                setBanner("* OK THIS IS A BANNER FOR IMAP");
                addResponseHandler(contains("LOGOUT"), shutdownServer("* BYE\r\nONMSCAPSD OK"));
            }
        };
        
        m_server.init();
        m_server.startServer();
        
        Thread.sleep(100); // make sure the server is really started
        
        try {
            m_detector.setPort(m_server.getLocalPort());
            m_detector.setIdleTime(100);
            
            //assertTrue(m_detector.isServiceDetected(m_server.getInetAddress(), new NullDetectorMonitor()));
            DetectFuture future = m_detector.isServiceDetected(m_server.getInetAddress(), new NullDetectorMonitor());
            assertNotNull(future);
            
            future.awaitUninterruptibly();
            
            
            assertTrue(future.isServiceDetected());
        } finally {
            m_server.stopServer();
        }
    }

