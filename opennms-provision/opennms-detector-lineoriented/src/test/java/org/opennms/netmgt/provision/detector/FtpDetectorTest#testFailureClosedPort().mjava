    @Test(timeout=20000)
    public void testFailureClosedPort() throws Exception {

        m_server.setBanner("WRONG BANNER");
        m_detector.setPort(65535);
        m_detector.setIdleTime(10000);

        DetectFuture df = m_detector.isServiceDetected(m_server.getInetAddress());
        assertFalse("Test should fail because the server closes before detection takes place", doCheck(df));

    }

