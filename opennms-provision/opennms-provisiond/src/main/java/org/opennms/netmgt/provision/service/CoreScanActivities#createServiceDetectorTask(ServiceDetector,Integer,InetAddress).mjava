    private Task createServiceDetectorTask(ServiceDetector detector, Integer nodeId, InetAddress ipAddress) {
        if (detector instanceof SyncServiceDetector) {
            return createSyncServiceDetectorTask((SyncServiceDetector)detector, nodeId, ipAddress);
        } else {
            return createAsyncServiceDetectorTask((AsyncServiceDetector)detector, nodeId, ipAddress);
        }
    }

