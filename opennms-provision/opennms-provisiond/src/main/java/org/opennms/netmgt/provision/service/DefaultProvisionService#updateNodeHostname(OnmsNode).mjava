    private void updateNodeHostname(final OnmsNode node) {
        if (NodeLabelSource.HOSTNAME.equals(node.getLabelSource()) || NodeLabelSource.ADDRESS.equals(node.getLabelSource())) {
            OnmsIpInterface primary = node.getPrimaryInterface();
            if (primary == null && node.getIpInterfaces() != null) {
                primary = node.getIpInterfaces().iterator().next();
            }

            if (primary != null) {
                LOG.debug("Node Label was set by hostname or address.  Re-resolving.");
                final InetAddress addr = primary.getIpAddress();
                final String ipAddress = str(addr);
                final String hostname = m_hostnameResolver.getHostname(addr, node.getLocation().getLocationName());

                if (hostname == null || ipAddress.equals(hostname)) {
                    node.setLabel(ipAddress);
                    node.setLabelSource(NodeLabelSource.ADDRESS);
                } else {
                    node.setLabel(hostname);
                    node.setLabelSource(NodeLabelSource.HOSTNAME);
                }
            }
        }
    }

