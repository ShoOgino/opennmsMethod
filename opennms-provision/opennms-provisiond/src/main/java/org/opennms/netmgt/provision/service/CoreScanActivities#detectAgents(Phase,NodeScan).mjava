    @Activity( lifecycle = "nodeScan", phase = "detectAgents" )
    public void detectAgents(Phase currentPhase, NodeScan nodeScan) {
        
        boolean foundAgent = false;

        if (!nodeScan.isAborted()) {
            OnmsIpInterface primaryIface = nodeScan.getNode().getPrimaryInterface();
            if (primaryIface.getMonitoredServiceByServiceType("SNMP") != null) {
                nodeScan.doAgentScan(currentPhase, primaryIface.getInetAddress(), "SNMP");
                foundAgent = true;
            }
            
            if (!foundAgent) {
                nodeScan.doNoAgentScan(currentPhase);
            }
        }
    }

