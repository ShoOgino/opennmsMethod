    public OnmsIpInterface updateIpInterfaceAttributes(Integer nodeId, OnmsIpInterface scannedIface) {
        if (scannedIface.getSnmpInterface() != null) {
            scannedIface.setSnmpInterface(updateSnmpInterfaceAttributes(nodeId, scannedIface.getSnmpInterface()));
        }
        
        OnmsIpInterface dbIface = m_ipInterfaceDao.findByNodeIdAndIpAddress(nodeId, scannedIface.getIpAddress());
        if (dbIface != null) {
            dbIface.mergeInterfaceAttributes(scannedIface);
            m_ipInterfaceDao.save(dbIface);
            return dbIface;
        } else {
            OnmsNode dbNode = m_nodeDao.load(nodeId);
            assertNotNull(dbNode, "no node found with nodeId %d", nodeId);
            // for performance reasons we don't add the ip interface to the node so we avoid loading all the interfaces
            // setNode only sets the node in the interface
            scannedIface.setNode(dbNode);
            m_ipInterfaceDao.save(scannedIface);
            AddEventVisitor visitor = new AddEventVisitor(m_eventForwarder);
            scannedIface.visit(visitor);
            return scannedIface;
        }

    }

