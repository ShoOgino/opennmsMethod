    @Activity( lifecycle = "import", phase = "scan")
    public BaseTask scanNodes(LifeCycleInstance lifeCycle) {
        ImportOperationsManager opsMgr = lifeCycle.getAttribute("opsMgr", ImportOperationsManager.class);
        
        System.out.println("Scheduling Nodes");
        final Collection<ImportOperation> operations = opsMgr.getOperations();
        
        BatchTask batch = new BatchTask(lifeCycle.getCoordinator());
        
        for(final ImportOperation op : operations) {
            LifeCycleInstance nodeScan = lifeCycle.createNestedLifeCycle("nodeScan");
            System.out.printf("Created  LifeCycle %s for op %s\n", nodeScan, op);
            nodeScan.setAttribute("operation", op);
            batch.add((BaseTask)nodeScan);
        }



        return batch;
    }

