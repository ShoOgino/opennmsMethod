    private Runnable ipUpdater(final Phase currentPhase,
            final BaseAgentScan agentScan, final OnmsIpInterface iface) {
        Runnable r = new Runnable() {
            public void run() {
                agentScan.doUpdateIPInterface(currentPhase, iface);
                if (iface.isManaged()) {
                    agentScan.triggerIPInterfaceScan(currentPhase, iface.getInetAddress());
                }
            }
        };
        return r;
    }

