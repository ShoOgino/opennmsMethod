    /** {@inheritDoc} */
    @Override
    public void run(final BatchTask parent) {
        LOG.info("Scanning node {}/{}/{}", m_nodeId, m_foreignSource, m_foreignId);

        parent.getBuilder().addSequence(
                                        new RunInBatch() {
                                            @Override
                                            public void run(final BatchTask phase) {
                                                loadNode(phase);
                                            }
                                        },
                                        new RunInBatch() {
                                            @Override
                                            public void run(final BatchTask phase) {
                                                detectAgents(phase);
                                            }
                                        },
                                        new RunInBatch() {
                                            @Override
                                            public void run(final BatchTask phase) {
                                                handleAgentUndetected(phase);
                                            }
                                        },
                                        new RunInBatch() {
                                            @Override
                                            public void run(final BatchTask phase) {
                                                applyNodePolicies(phase);
                                            }
                                        },
                                        new RunInBatch() {
                                            @Override
                                            public void run(final BatchTask phase) {
                                                scanCompleted(phase);
                                            }
                                        }
                );


    }

