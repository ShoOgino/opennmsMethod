    private OnmsMonitoredService addMonitoredService(OnmsIpInterface iface, String svcName) {
        OnmsServiceType svcType = m_serviceTypeDao.findByName(svcName);
        
        if (svcType == null) {
            svcType = new OnmsServiceType(svcName);
            m_serviceTypeDao.save(svcType);
        }
        

        OnmsMonitoredService svc = iface.getMonitoredServiceByServiceType(svcName);

        if (svc != null) {
            svc.setSource(OnmsMonitoredService.SOURCE_DETECTOR);
            if (getPollerConfig().isPolled(iface.getIpAddress(), svcName)) svc.setStatus(OnmsMonitoredService.STATUS_ACTIVE);
            else svc.setStatus(OnmsMonitoredService.STATUS_NOT_POLLED);
            m_monitoredServiceDao.saveOrUpdate(svc);
        } else {

            // this adds the service to the interface as a side effect
            svc = new OnmsMonitoredService(iface, svcType);
            svc.setSource(OnmsMonitoredService.SOURCE_DETECTOR);
            if (getPollerConfig().isPolled(iface.getIpAddress(), svcName)) svc.setStatus(OnmsMonitoredService.STATUS_ACTIVE);
            else svc.setStatus(OnmsMonitoredService.STATUS_NOT_POLLED);
            m_ipInterfaceDao.saveOrUpdate(iface);
            AddEventVisitor visitor = new AddEventVisitor(m_eventForwarder);
            svc.visit(visitor);
        }
        
        return svc;
        
    }

