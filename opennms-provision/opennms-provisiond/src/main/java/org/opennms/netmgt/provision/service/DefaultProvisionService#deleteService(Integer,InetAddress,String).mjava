    /** {@inheritDoc} */
    @Transactional
    @Override
    public void deleteService(final Integer nodeId, final InetAddress addr, final String svcName) {
        LOG.debug("deleteService: nodeId={}, addr={}, service={}", nodeId, addr, svcName);

        final OnmsMonitoredService service = m_monitoredServiceDao.get(nodeId, addr, svcName);
        if (service != null) {

            final OnmsIpInterface iface = service.getIpInterface();
            final OnmsNode node = iface.getNode();

            final boolean lastService = (iface.getMonitoredServices().size() == 1);
            final boolean lastInterface = (node.getIpInterfaces().size() == 1);

            final DeleteEventVisitor visitor = new DeleteEventVisitor(m_eventForwarder);

            iface.removeMonitoredService(service);
            m_nodeDao.saveOrUpdate(node);
            m_nodeDao.flush();
            service.visit(visitor);

            if (lastService) {
                LOG.debug("Deleting interface {} from node {}", InetAddressUtils.str(iface.getIpAddress()), nodeId);

                node.removeIpInterface(iface);
                m_nodeDao.saveOrUpdate(node);
                m_nodeDao.flush();
                iface.visit(visitor);

                if (lastInterface) {
                    LOG.debug("Deleting node {}", nodeId);

                    m_nodeDao.delete(node);
                    m_nodeDao.flush();
                    node.visit(visitor);
                }
            }
        }
    }

