        private void applyNodePolicies(final BatchTask phase) {
            final List<NodePolicy> nodePolicies = getProvisionService().getNodePoliciesForForeignSource(getForeignSource() == null ? "default" : getForeignSource());
            LOG.debug("NodeScan.applyNodePolicies: {}", nodePolicies);

            OnmsNode node = getNode();
            for(final NodePolicy policy : nodePolicies) {
                if (node != null) {
                    node = policy.apply(node, Collections.emptyMap());
                }
            }

            if (node == null) {
                abort("Aborted scan of node due to configured policy");
            } else {
                setNode(node);
            }

        }

