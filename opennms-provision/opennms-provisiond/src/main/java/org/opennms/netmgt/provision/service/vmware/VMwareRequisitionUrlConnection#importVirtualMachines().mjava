	private void importVirtualMachines() throws RemoteException, UnknownHostException {
		ManagedEntity[] virtualMachines;

		virtualMachines = new InventoryNavigator(m_serviceInstance.getRootFolder()).searchManagedEntities("VirtualMachine");

		if (virtualMachines != null) {
			for (int i = 0; i < virtualMachines.length; i++) {
				VirtualMachine virtualMachine = (VirtualMachine) virtualMachines[i];
				if (checkForAttribute(virtualMachine)) {
					logger.debug("Adding Virtual Machine '{}'", virtualMachine.getName());

					LinkedHashSet<String> ipAddresses = new LinkedHashSet<String>();

					ipAddresses.add(virtualMachine.getGuest().getIpAddress());

					if (virtualMachine.getGuest().getNet() != null) {
						for (GuestNicInfo guestNicInfo : virtualMachine.getGuest().getNet()) {
							for (String ipAddress : guestNicInfo.getIpAddress())
								ipAddresses.add(ipAddress);
						}
					}

					RequisitionNode node = createRequisitionNode(ipAddresses, virtualMachine);
					m_requisition.insertNode(node);
				}
			}
		}
	}

