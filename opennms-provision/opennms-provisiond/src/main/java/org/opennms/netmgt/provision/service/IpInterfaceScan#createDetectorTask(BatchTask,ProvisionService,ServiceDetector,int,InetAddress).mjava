    protected static Task createDetectorTask(final BatchTask currentPhase, final ProvisionService service, final ServiceDetector detector, final int nodeId, final InetAddress address) {
        if (detector instanceof SyncServiceDetector) {
            return createSyncDetectorTask(currentPhase, service, (SyncServiceDetector) detector, nodeId, address);
        } else {
            return createAsyncDetectorTask(currentPhase, service, (AsyncServiceDetector) detector, nodeId, address);
        }
    }

