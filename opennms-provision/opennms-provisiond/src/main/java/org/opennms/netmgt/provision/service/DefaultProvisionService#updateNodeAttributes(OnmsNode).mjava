    /* (non-Javadoc)
     * @see org.opennms.netmgt.provision.service.ProvisionService#updateNodeInfo(org.opennms.netmgt.model.OnmsNode)
     */
    /** {@inheritDoc} */
    @Transactional
    public OnmsNode updateNodeAttributes(final OnmsNode node) {
    	final OnmsNode dbNode = getDbNode(node);

        if (dbNode == null) {
        	final OnmsDistPoller scannedPoller = node.getDistPoller();
            OnmsDistPoller dbPoller;
            if (scannedPoller == null) {
                dbPoller = m_distPollerDao.get("locahost");
            } else {
                dbPoller = m_distPollerDao.get(scannedPoller.getName());
                if (dbPoller == null) {
                    m_distPollerDao.save(scannedPoller);
                    m_distPollerDao.flush();
                    dbPoller = scannedPoller;
                }
            }
            
            node.setDistPoller(dbPoller);
            return saveOrUpdate(node);
        } else {
            dbNode.mergeNodeAttributes(node);            
            return saveOrUpdate(dbNode);
        }
    }

