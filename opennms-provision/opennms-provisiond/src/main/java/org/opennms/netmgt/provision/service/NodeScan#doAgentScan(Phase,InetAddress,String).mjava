    public void doAgentScan(Phase detectAgents, InetAddress agentAddress, String agentType) {
        detectAgents.createNestedLifeCycle("agentScan")
            .setAttribute("agentScan", createAgentScan(agentAddress, agentType))
            .setAttribute("agentType", agentType)
            .setAttribute("node", getNode())
            .setAttribute("foreignSource", getForeignSource())
            .setAttribute("foreignId", getForeignId())
            .setAttribute("primaryAddress", agentAddress)
            .trigger();
    }

