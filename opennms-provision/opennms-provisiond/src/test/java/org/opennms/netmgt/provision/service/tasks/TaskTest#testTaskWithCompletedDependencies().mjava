    @Test
    public void testTaskWithCompletedDependencies() throws Exception {
        
        
        final List<String> sequence = new Vector<String>();
        
        Task task1 = createTask(appender(sequence, "task1"));
        Task task2 = createTask(appender(sequence, "task2"));
        Task task3 = createTask(appender(sequence, "task3"));

        task1.schedule();
        
        task1.waitFor(10000, TimeUnit.MILLISECONDS);

        task2.addPrerequisite(task1);
        
        task2.schedule();

        task2.waitFor(10000, TimeUnit.MILLISECONDS);
        
        task3.addPrerequisite(task2);

        task3.schedule();
        
        
        task3.waitFor(3500, TimeUnit.MILLISECONDS);
        
        assertArrayEquals(new String[] { "task1", "task2", "task3" }, sequence.toArray(new String[0]));
        
    }

