    @Test(timeout=300000)
    public void testRequisitionedCategoriesWithUserCategoryThenUpdateRequisitionToRemoveRequisitionedCategory() throws Exception {
        final int nextNodeId = m_nodeDao.getNextNodeId();

        importFromResource("classpath:/provisioner-testCategories-oneCategory.xml", Boolean.TRUE.toString());
        final NodeScan scan = m_provisioner.createNodeScan(nextNodeId, "empty", "1");
        runScan(scan);

        // make sure we have the 1 category we expect
        OnmsNode n = getNodeDao().get(nextNodeId);
        assertEquals(1, n.getCategories().size());
        assertTrue(n.hasCategory("TotallyMadeUpCategoryName"));

        OnmsCategory cat = new OnmsCategory("ThisIsAlsoMadeUp");
        m_categoryDao.save(cat);
        m_categoryDao.flush();

        n.addCategory(m_categoryDao.findByName("ThisIsAlsoMadeUp"));
        getNodeDao().save(n);

        importFromResource("classpath:/provisioner-testCategories-noCategories.xml", Boolean.TRUE.toString());
        runScan(scan);

        // when the scan has completed, the requisitioned category should be removed, but the user-added one should remain
        n = getNodeDao().get(nextNodeId);

        assertEquals(1, n.getCategories().size());
        assertTrue(n.hasCategory("ThisIsAlsoMadeUp"));
    }

