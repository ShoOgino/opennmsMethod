    @Test
    public void testSequenceWithDependencies() throws Exception {
        
        
        final List<String> sequence = new Vector<String>();
        
        BaseTask task1 = testTask(m_coordinator, "task1", sequence);
        BaseTask task2 = testTask(m_coordinator, "task2", sequence);

        SequenceTask seq = new SequenceTask(m_coordinator);

        seq.add(testTask(m_coordinator, "subtask1", sequence));
        seq.add(testTask(m_coordinator, "subtask2", sequence));
        seq.add(testTask(m_coordinator, "subtask3", sequence));
        
        seq.addDependency(task1);
        task2.addDependency(seq);

        seq.schedule();

        task1.schedule();
        
        task2.schedule();
        
        task2.waitFor(3500, TimeUnit.MILLISECONDS);
        
        assertArrayEquals(new String[] { "task1", "subtask1", "subtask2", "subtask3", "task2" }, sequence.toArray(new String[0]));
    }

