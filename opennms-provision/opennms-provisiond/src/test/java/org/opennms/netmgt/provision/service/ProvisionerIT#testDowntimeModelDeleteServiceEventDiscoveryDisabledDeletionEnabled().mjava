    @Test
    public void testDowntimeModelDeleteServiceEventDiscoveryDisabledDeletionEnabled() throws Exception {
        System.setProperty("org.opennms.provisiond.enableDiscovery", "false");
        assertFalse(m_provisionService.isDiscoveryEnabled());

        System.setProperty("org.opennms.provisiond.enableDeletionOfRequisitionedEntities", "true");
        assertTrue(m_provisionService.isRequisitionedEntityDeletionEnabled());

        importFromResource("classpath:/deleteService.xml", Boolean.TRUE.toString());
        final OnmsNode node = m_nodeDao.findByForeignId("deleteService", "4243");
        m_eventAnticipator.reset();

        // only the service deletion should be fired
        m_eventAnticipator.anticipateEvent(serviceDeleted(node.getId(), "10.201.136.161", "ICMP"));
        m_mockEventIpcManager.sendEventToListeners(deleteService(node.getId(), "10.201.136.161", "ICMP"));
        m_eventAnticipator.verifyAnticipated();
    }

