    @Test
    public void testLargeBatchInProgress() throws Exception {
 
        long count = 10;
        long loops = 1000;
        long total=count*loops;
        
        AtomicLong result = new AtomicLong(0);
        
        BatchTask task = new BatchTask(m_coordinator, null);
        
        task.add(scheduler(task, result, 1, count, loops-1));
        
        task.schedule();

        task.waitFor();
        
        assertEquals(total*(total+1)/2, result.get());
        
    }

