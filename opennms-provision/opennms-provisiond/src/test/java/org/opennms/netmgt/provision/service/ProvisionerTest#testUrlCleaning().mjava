    @Test
    public void testUrlCleaning() {
        String resourceUrl;

        resourceUrl = "vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true&username=secretuser&password=secretpass&importHostOnly=true";
        assertThat(Provisioner.stripCredentials(resourceUrl), equalTo("vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true&username=***&password=***&importHostOnly=true"));
        resourceUrl = "vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true&username=secretuser&importHostOnly=true&password=secretpass";
        assertThat(Provisioner.stripCredentials(resourceUrl), equalTo("vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true&username=***&importHostOnly=true&password=***"));
        resourceUrl = "vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true;username=secretuser;password=secretpass;importHostOnly=true";
        assertThat(Provisioner.stripCredentials(resourceUrl), equalTo("vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true;username=***;password=***;importHostOnly=true"));
        resourceUrl = "vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true;username=secretuser;importHostOnly=true;password=secretpass";
        assertThat(Provisioner.stripCredentials(resourceUrl), equalTo("vmware://vcenter.yourdomain.com/VCenterImport?_OpenNMSImport=true;username=***;importHostOnly=true;password=***"));
    }

