    @Test
    public void testLargeBatch() throws Exception {
        
        long count = 500;
        
        AtomicLong result = new AtomicLong(0);
        
        BatchTask task = new BatchTask(m_coordinator, null);
        
        for(long i = 1; i <= count; i++) {
            task.add(addr(result, i));
        }
        
        task.schedule();
        
        task.waitFor();
        
        assertEquals(count*(count+1)/2, result.get());
        
    }

