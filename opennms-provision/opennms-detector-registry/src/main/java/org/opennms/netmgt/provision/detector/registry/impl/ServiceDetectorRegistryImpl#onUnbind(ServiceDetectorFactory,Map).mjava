    @SuppressWarnings({ "rawtypes", "unchecked" })
    public synchronized void onUnbind(ServiceDetectorFactory factory, Map properties) {
        LOG.debug("unbind called with {}: {}", factory, properties);
        if (factory != null) {
            final String serviceName = getServiceName(factory);
            final String className = factory.getDetectorClass().getCanonicalName();
            m_factoriesByServiceName.remove(serviceName, factory);
            m_factoriesByClassName.remove(className, factory);
            m_classNameByServiceName.remove(serviceName, className);
        }
    }

