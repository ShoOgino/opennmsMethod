    public boolean isServiceDetected(InetAddress address, DetectorMonitor detectorMonitor) {
        int port = getPort();
        int retries = getRetries();
        int timeout = getTimeout();
        
        detectorMonitor.start(this, "Checking address: %s for %s capability", address, getServiceName());
                
        for (int attempts = 0; attempts <= retries; attempts++) {
            m_socket = null;

            try {
                m_socket = createSocketConnection(address, port, timeout);
                
                detectorMonitor.attempt(this, attempts, "Attempting to connect to address: %s attempt #%s",address.getHostAddress(),attempts);

                // Allocate a line reader
                //
                OutputStream out = m_socket.getOutputStream();
                BufferedReader in = new BufferedReader(new InputStreamReader(m_socket.getInputStream()));
                
                if (attemptConversation(in, out)) {
                    return true;
                }
                
            } catch (ConnectException cE) {
                // Connection refused!! Continue to retry.
            } catch (NoRouteToHostException e) {
                // No Route to host!!!
               
                e.fillInStackTrace();
                detectorMonitor.info(this, e, "%s: No route to address %s was available", getServiceName(), address.getHostAddress());
                throw new UndeclaredThrowableException(e);
            } catch (InterruptedIOException e) {
                // Expected exception
                detectorMonitor.info(this, e, "%s: Did not connec to to address within timeout: %d attempt: %d", getServiceName(), timeout, attempts);
            } catch (IOException e) {
                detectorMonitor.info(this, e, "%s: An unexpected I/O exception occured contacting address %s",getServiceName(), address.getHostAddress());
            } catch (Throwable t) {
                detectorMonitor.failure(this, "%s: Failed to detect %s on address %s", getServiceName(), getServiceName(), address.getHostAddress());
                detectorMonitor.error(this, t, "%s: An undeclared throwable exception was caught contating address %s", getServiceName(), address.getHostAddress());
                t.fillInStackTrace();
                t.printStackTrace();
                System.out.println("error : " + t.getMessage());
            } finally {
                try {
                    if (m_socket != null)
                        m_socket.close();
                } catch (IOException e) {
                }
            }
        }
        
        return false;
    }

