    public static Map<String, String> getParameters(URL url) {
        final Map<String, String> params = new HashMap<>();
        params.put("type", url.getHost());
        params.put("port", Integer.toString(url.getPort()));
        params.put("path", url.getPath());

        // Extract the username and password
        final String userInfo = url.getUserInfo();
        if (userInfo != null && !userInfo.isEmpty()) {
            if (userInfo.contains(":")) {
                final String[] tokens = userInfo.split(":");
                params.put("username", tokens[0]);
                params.put("password", tokens[1]);
            } else {
                params.put("username", userInfo);
            }
        }

        // Parse the query string parametrs
        params.putAll(GenericURLConnection.getQueryStringParameters(url.getQuery()));
        return Collections.unmodifiableMap(params);
    }

