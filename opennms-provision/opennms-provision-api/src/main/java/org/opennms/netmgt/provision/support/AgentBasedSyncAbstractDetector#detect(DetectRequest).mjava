    @Override
    public DetectResults detect(DetectRequest request) {
        Map<String, String> runTimeAttributes = request.getRuntimeAttributes();

        if (hasMultipleAgentConfigs(runTimeAttributes)) {
            return new DetectResultsImpl(isServiceDetected(request.getAddress(), getListOfAgentConfigs(request)));
        }
        return new DetectResultsImpl(isServiceDetected(request.getAddress(), getAgentConfig(request)));
    }

