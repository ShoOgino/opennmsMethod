    /**
     * Free up the resources used by a connection and connection factory.
     * @param factory
     * @param connection
     */
    public static final void dispose(ConnectionFactory factory) {
        // If the reference count on the factory is zero...
        if (--factory.m_references <= 0) {
            // ... then remove it from the map of available connectors 
            synchronized (s_connectorPool) {
                LOG.debug("Disposing of factory {} for interval {}", factory, factory.m_timeout);
                Iterator<Entry<Integer, ConnectionFactory>> i = s_connectorPool.entrySet().iterator();
                while(i.hasNext()) {
                    if(i.next().getValue() == factory) {
                        i.remove();
                    }
                }
            }

            // Call dispose on the factory itself now that there are no references to it
            factory.dispose();
        }
    }

