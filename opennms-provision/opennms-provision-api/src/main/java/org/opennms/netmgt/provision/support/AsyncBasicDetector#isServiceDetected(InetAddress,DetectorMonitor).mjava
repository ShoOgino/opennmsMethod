    @Override
    public DetectFuture isServiceDetected(InetAddress address, DetectorMonitor monitor) {
        SocketConnector connector = new NioSocketConnector();
        
        DetectFuture future = new DefaultDetectFuture(this);

        // Set connect timeout.
        connector.setConnectTimeoutMillis( 3000 );
        connector.setHandler( createDetectorHandler(future) );
        connector.getFilterChain().addLast( "logger", getLoggingFilter() != null ? getLoggingFilter() : new LoggingFilter() );
        connector.getFilterChain().addLast( "codec", getProtocolCodecFilter());
        connector.getSessionConfig().setIdleTime( IdleStatus.READER_IDLE, getIdleTime() );

        // Start communication
        connector.connect( new InetSocketAddress( address, getPort() ));

        return future;
    }

