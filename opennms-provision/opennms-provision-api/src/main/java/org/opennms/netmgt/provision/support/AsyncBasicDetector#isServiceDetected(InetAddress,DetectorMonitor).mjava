    @SuppressWarnings("deprecation")
    @Override
    public DetectorFuture isServiceDetected(InetAddress address, DetectorMonitor monitor) {
        SocketConnector connector = new NioSocketConnector();

        // Set connect timeout.
         //connector.getDefaultConfig().setConnectTimeout(30);
        connector.setConnectTimeoutMillis( 3000 );
        connector.setHandler( getDetectorHandler() );
        connector.getFilterChain().addLast( "logger", getLoggingFilter() != null ? getLoggingFilter() : new LoggingFilter() );
        connector.getFilterChain().addLast( "codec", getProtocolCodecFilter());
        connector.getSessionConfig().setIdleTime( IdleStatus.READER_IDLE, getIdleTime() );

        // Start communication.
        //ConnectFuture cf = connector.connect( new InetSocketAddress( address, 9123 ));
        DetectorFuture df = (DetectorFuture) connector.connect( new InetSocketAddress( address, 9123 ));
        
        // Wait for the connection attempt to be finished.
        df.join();
        df.getSession();
        
        return df;
    }

