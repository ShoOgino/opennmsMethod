    @Override
    public DetectFuture isServiceDetected(InetAddress address, DetectorMonitor monitor) throws Exception {
        DetectFuture future = null;
        
        SocketConnector connector = new NioSocketConnector();
        
        future = new DefaultDetectFuture(this);
        
        // Set connect timeout.
        connector.setConnectTimeoutMillis( getTimeout() );
        connector.setHandler( createDetectorHandler(future) );
        
        if(isUseSSLFilter()) {
            SslFilter filter = new SslFilter(createClientSSLContext());
            filter.setUseClientMode(true);
            connector.getFilterChain().addFirst("SSL", filter);
        }
        
        connector.getFilterChain().addLast( "logger", getLoggingFilter() != null ? getLoggingFilter() : new LoggingFilter() );
        connector.getFilterChain().addLast( "codec", getProtocolCodecFilter());
        connector.getSessionConfig().setIdleTime( IdleStatus.READER_IDLE, getIdleTime() );

        // Start communication
        InetSocketAddress socketAddress = new InetSocketAddress(address, getPort());
        ConnectFuture cf = connector.connect( socketAddress );
        cf.addListener(retryAttemptListener( connector, future, socketAddress, getRetries() ));
        
        return future;
    }

