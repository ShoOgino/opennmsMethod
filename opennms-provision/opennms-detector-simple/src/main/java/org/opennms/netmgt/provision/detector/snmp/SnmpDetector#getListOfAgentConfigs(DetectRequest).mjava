    @Override
    public List<SnmpAgentConfig> getListOfAgentConfigs(DetectRequest request) {
        List<SnmpAgentConfig> agentConfigList = new ArrayList<>();
        Map<String, String> runTimeAttributes = request.getRuntimeAttributes();

        if (useSnmpProfiles() && hasMultipleAgentConfigs(runTimeAttributes)) {
            //Retrieve agent configs from runtime attributes.
            runTimeAttributes.forEach((label, configAsString) -> {
                if (label.contains(AGENT_CONFIG_PREFIX)) {
                    agentConfigList.add(SnmpAgentConfig.parseProtocolConfigurationString(configAsString));
                }
            });
        } else if (hasMultipleAgentConfigs(runTimeAttributes)) {
            //Retrieve agent configs from runtime attributes just for default profile.
            runTimeAttributes.forEach((label, configAsString) -> {
                if (label.contains(AGENT_CONFIG_PREFIX) && label.contains(PROFILE_LABEL_FOR_DEFAULT_CONFIG)) {
                    agentConfigList.add(SnmpAgentConfig.parseProtocolConfigurationString(configAsString));
                }
            });
        }
        return agentConfigList;
    }

