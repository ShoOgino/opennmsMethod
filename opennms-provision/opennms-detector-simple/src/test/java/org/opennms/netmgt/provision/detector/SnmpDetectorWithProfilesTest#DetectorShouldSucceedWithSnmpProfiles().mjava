    @Test(timeout = 30000)
    public void DetectorShouldSucceedWithSnmpProfiles() throws IOException {

        URL url = getClass().getResource("/org/opennms/netmgt/provision/detector/snmp-config-with-profiles.xml");
        try (InputStream configStream = url.openStream()) {
            SnmpPeerFactory snmpPeerFactory = new ProxySnmpAgentConfigFactoryExtension(configStream);
            // This is to not override snmp-config from etc
            SnmpPeerFactory.setFile(new File(url.getFile()));
            m_detectorFactory.setAgentConfigFactory(snmpPeerFactory);
            m_request = m_detectorFactory.buildRequest(null, InetAddressUtils.addr(TEST_IP_ADDRESS), null, Collections.emptyMap());
            assertTrue(m_detector.detect(m_request).isServiceDetected());
        }

    }

