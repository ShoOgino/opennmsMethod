    @Override
    public List<OnmsIpInterface> findObsoleteIpInterfaces(final Integer nodeId, final Date scanStamp) {
        final List<OnmsIpInterface> ifaces = new ArrayList<OnmsIpInterface>();
        final OnmsNode node = get(nodeId);
        if (node == null) return ifaces;
        
        for (final OnmsIpInterface iface : node.getIpInterfaces()) {
            if (iface.isPrimary()) continue;
            if (iface.getIpLastCapsdPoll() == null
                    || iface.getIpLastCapsdPoll().before(scanStamp)) ifaces.add(iface);
        }

        return ifaces;
    }

