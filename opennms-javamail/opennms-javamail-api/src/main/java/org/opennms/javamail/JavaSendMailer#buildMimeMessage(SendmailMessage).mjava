    /**
     * Builds the mime message.
     *
     * @param msg the sendmail message
     * @return the mime message
     */
    public MimeMessage buildMimeMessage(SendmailMessage msg) {
        //no need to set the same object again
        if (m_config.getSendmailMessage() != msg) {
            m_config.setSendmailMessage(msg);
        }
        MimeMessage mimeMsg = new MimeMessage(m_session);
        try {
            MimeMessageHelper helper = new MimeMessageHelper(mimeMsg, false, m_config.getSendmailProtocol().getCharSet());
            helper.setFrom(m_config.getSendmailMessage().getFrom());
            helper.setTo(m_config.getSendmailMessage().getTo());
            helper.setSubject(m_config.getSendmailMessage().getSubject());
        } catch (MessagingException e) {
            LOG.warn("found a problem building message: {}", e.getMessage());
        }
        return mimeMsg;
    }

