    /**
     * Attempts to reteive the string portion of a message... tries to handle
     * multipart messages as well.  This seems to be working so far with my tests
     * but could use some tweaking later as more types of mail servers are used
     * with this feature.
     * 
     * @param msg
     * @return The text portion of an email with each line being an element of the list.
     * @throws MessagingException
     * @throws IOException
     */
    public static List<String> getText(Message msg) throws MessagingException, IOException {
        List<String> lines = new ArrayList<String>();
        
        String content = null;
        if (msg.isMimeType("text/*")) {
            try {
                content = (String)msg.getContent();
            } catch (ClassCastException cce) {
                Object c = msg.getContent();
                if (c instanceof MimeMultipart) {
                    for (int cnt = 0; cnt < ((MimeMultipart)c).getCount(); cnt++) {
                        BodyPart bp = ((MimeMultipart)c).getBodyPart(cnt);
                        if (bp.isMimeType("text/*")) {
                            content = (String)bp.getContent();
                            break;
                        }
                    }
                }
            }
            return string2Lines(content);
        }
        
        return lines;
    }

