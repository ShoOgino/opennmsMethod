    /**
     * Recommended usage is from the OpenNMSJavaMessageBuilder class.
     * 
     * Create a JavaMail message using all the properties from the @param config object.  An authenticator,
     * content type, from address, reply-to address, subject, and date is set based on the SendmailConfig settings.
     * You probably want to set the subject to something more meaningful.  Javamail properties are created
     * in the message's session object based on the configuration.
     * 
     * @param content
     * @param config
     * @return a JavaMail Message object
     * @throws JavaMailerException
     */
    public static OpenNMSJavaMailMessage createMessage(String content, SendmailConfig config) throws JavaMailerException {
        Session sess = Session.getInstance(OpenNMSJavaMailMessage.configureProps(config), OpenNMSJavaMailMessage.configureAuthenticator(config));
        OpenNMSJavaMailMessage msg = new OpenNMSJavaMailMessage(sess);
        try {
            msg.setContent(content, config.getSendmailProtocol().getMessageContentType());
            msg.setFrom(new InternetAddress(config.getSendmailMessage().getFrom()));
            Address[] addrs = {new InternetAddress(config.getSendmailMessage().getFrom())};
            msg.setReplyTo(addrs);
            msg.setSentDate(new Date());
            msg.setSubject(config.getSendmailMessage().getSubject());
        } catch (MessagingException e) {
            throw new JavaMailerException("An exception occurred creating a Java Mail message from config: "+config.getName(), e);
        }
        return msg;
    }

