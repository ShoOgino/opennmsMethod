    /**
     * Helper method to that creates a MIME message.
     * @param session
     * @return
     * @throws MessagingException
     * @throws AddressException
     */
    private MimeMessage initializeMessage() throws MessagingException, AddressException {
        MimeMessage message;
        message = new MimeMessage(getSession());
        message.setFrom(new InternetAddress(getFrom()));
        if (!Strings.isNullOrEmpty(getReplyTo())) {
            message.setReplyTo(new Address[]{new InternetAddress(getReplyTo())});
        }
        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(getTo(), false));
        message.setSubject(getSubject(), m_charSet);
        for (final String key : getExtraHeaders().keySet()) {
        	message.setHeader(key, m_extraHeaders.get(key));
        }
        return message;
    }

