    /**
     * This tests the ability of a configureSNMP event to configure v3 settings.
     */
    @Test
    public final void testConfiguringV3ThroughEventInDef() throws Exception {

        String snmpConfigXml = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" +
                "<snmp-config timeout=\"800\" read-community=\"public\" write-community=\"private\" xmlns=\"http://xmlns.opennms.org/xsd/config/snmp\">\n" +
                "   <definition version=\"v2c\">\n" +
                "      <specific>192.168.0.5</specific>\n" +
                "   </definition>\n" +
                "</snmp-config>\n" +
                "";

        String expectedConfig = "" +
                "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" +
                "<snmp-config timeout=\"800\" read-community=\"public\" write-community=\"private\" xmlns=\"http://xmlns.opennms.org/xsd/config/snmp\">\n" +
                "   <definition auth-passphrase=\"nant\" auth-protocol=\"SHA-256\" version=\"v3\">\n" +
                "      <specific>192.168.0.5</specific>\n" +
                "   </definition>\n" +
                "</snmp-config>\n" +
                "";

        SnmpPeerFactory.setInstance(new SnmpPeerFactory(new StringResource(snmpConfigXml)));

        assertXmlEquals(snmpConfigXml, SnmpPeerFactory.getInstance().getSnmpConfigAsString());

        SnmpEventInfo info = new SnmpEventInfo();
        info.setFirstIPAddress("192.168.0.5");
        info.setVersion("v3");
        info.setAuthProtocol("SHA-256");
        info.setAuthPassPhrase("nant");

        SnmpPeerFactory.getInstance().define(info);

        String actualConfig = SnmpPeerFactory.getInstance().getSnmpConfigAsString();
        assertXmlEquals(expectedConfig, actualConfig);

        SnmpAgentConfig agentConfig = SnmpPeerFactory.getInstance().getAgentConfig(InetAddress.getByName("192.168.0.5"));
        assertEquals(agentConfig.getVersion(), SnmpConfiguration.VERSION3);
        assertEquals(agentConfig.getAuthProtocol(), "SHA-256");
        assertEquals(agentConfig.getAuthPassPhrase(), "nant");

    }

