    /**
     * Tests removal of IP address from definition.
     * @throws IOException
     */
    @Test
    public void testRemovalOfIpAddressFromRangeFromDefinition() throws IOException {

        String snmpConfigXml = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" +
                "<snmp-config port=\"161\" retry=\"3\" timeout=\"800\" read-community=\"public\" version=\"v1\" xmlns=\"http://xmlns.opennms.org/xsd/config/snmp\">\n" +
                "    <definition version=\"v2c\" location=\"MINION\" port=\"1161\">\n" +
                "        <range begin=\"192.168.1.15\" end=\"192.168.1.35\"/>\n" +
                "    </definition>\n" +
                "</snmp-config>\n" +
                "";

        String expectedConfig = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" +
                "<snmp-config port=\"161\" retry=\"3\" timeout=\"800\" read-community=\"public\" version=\"v1\" xmlns=\"http://xmlns.opennms.org/xsd/config/snmp\">\n" +
                "    <definition version=\"v2c\" location=\"MINION\" port=\"1161\">\n" +
                "        <range begin=\"192.168.1.15\" end=\"192.168.1.34\"/>\n" +
                "    </definition>\n" +
                "</snmp-config>\n" +
                "";
        SnmpPeerFactory.setInstance(new SnmpPeerFactory(new StringResource(snmpConfigXml)));
        assertXmlEquals(snmpConfigXml, SnmpPeerFactory.getInstance().getSnmpConfigAsString());

        boolean success = SnmpPeerFactory.getInstance().removeFromDefinition(InetAddress.getByName("192.168.1.35"), "MINION","test" );
        assertTrue("Remove from definition should be successful", success);
        String actualConfig = SnmpPeerFactory.getInstance().getSnmpConfigAsString();
        System.out.println(actualConfig);
        assertXmlEquals(expectedConfig, actualConfig);
    }

