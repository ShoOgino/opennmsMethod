    @Test
    public void testMultipleExcludes() throws Exception {

        final DiscoveryConfiguration conf = new DiscoveryConfiguration();

        IncludeRange ir = new IncludeRange();
        ir.setBegin("192.168.0.1");
        ir.setEnd("192.168.0.254");
        conf.addIncludeRange(ir);

        ir = new IncludeRange();
        ir.setBegin("192.168.2.1");
        ir.setEnd("192.168.2.255");
        conf.addIncludeRange(ir);

        Specific s = new Specific();
        s.setAddress("192.168.1.1");
        conf.addSpecific(s);

        s = new Specific();
        s.setAddress("192.168.4.1");
        conf.addSpecific(s);

        ExcludeRange er = new ExcludeRange();
        er.setBegin("192.168.0.100");
        er.setEnd("192.168.0.150");
        conf.addExcludeRange(er);

        er = new ExcludeRange();
        er.setBegin("192.168.2.200");
        er.setEnd("192.168.4.254");
        conf.addExcludeRange(er);

        final DiscoveryConfigFactory factory = new DiscoveryConfigFactory(conf);
        factory.initializeExcludeRanges();

        assertFalse(factory.isExcluded(InetAddressUtils.addr("192.168.0.1"), null));
        assertFalse(factory.isExcluded(InetAddressUtils.addr("192.168.0.2"), null));
        assertFalse(factory.isExcluded(InetAddressUtils.addr("192.168.0.99"), null));
        assertTrue(factory.isExcluded(InetAddressUtils.addr("192.168.0.100"), null));
        assertTrue(factory.isExcluded(InetAddressUtils.addr("192.168.0.140"), null));
        assertTrue(factory.isExcluded(InetAddressUtils.addr("192.168.0.150"), null));
        assertFalse(factory.isExcluded(InetAddressUtils.addr("192.168.0.151"), null));
        assertFalse(factory.isExcluded(InetAddressUtils.addr("192.168.1.1"), null));
        assertFalse(factory.isExcluded(InetAddressUtils.addr("192.168.2.1"), null));
        assertFalse(factory.isExcluded(InetAddressUtils.addr("192.168.2.100"), null));
        assertTrue(factory.isExcluded(InetAddressUtils.addr("192.168.2.200"), null));
        assertTrue(factory.isExcluded(InetAddressUtils.addr("192.168.2.220"), null));
        assertTrue(factory.isExcluded(InetAddressUtils.addr("192.168.2.255"), null));
        assertTrue(factory.isExcluded(InetAddressUtils.addr("192.168.4.1"), null));

    }

