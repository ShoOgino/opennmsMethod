    /**
     * This method is used to establish package against IP list mapping, with
     * which, the IP list is selected per package via the configured filter rules
     * from the database.
     */
    protected void updatePackageIpListMap() {
        m_pkgIpMap.clear();
        try {
            getWriteLock().lock();
            for (final org.opennms.netmgt.config.linkd.Package pkg : m_config.getPackageCollection()) {
                //
                // Get a list of IP addresses per package against the filter rules from
                // database and populate the package, IP list map.
                //
                try {
                    final List<InetAddress> ipList = getIpList(pkg);
                    LOG.trace("createPackageIpMap: package {}: ipList size = {}", pkg.getName(), ipList.size());
    
                    if (ipList != null && ipList.size() > 0) {
                        m_pkgIpMap.put(pkg, ipList);
                    }
                } catch (final Throwable t) {
                    LOG.error("createPackageIpMap: failed to map package: {} to an IP list", pkg.getName(), t);
                }
            }
        } finally {
            getWriteLock().unlock();
        }
    }

