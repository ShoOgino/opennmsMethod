    /**
     * Sets the password for this user, assuming that the value passed in is
     * already encrypted properly
     *
     * @param userID
     *            the user ID to change the password for
     * @param aPassword
     *            the encrypted password
     * @throws java.lang.Exception if any.
     */
    public void setEncryptedPassword(final String userID, final String aPassword, final boolean salted) throws Exception {
        update();

        m_writeLock.lock();
        
        try {
            final User user = m_users.get(userID);
            if (user != null) {
                final Password pass = new Password();
                pass.setEncryptedPassword(aPassword);
                pass.setSalt(salted);
                user.setPassword(pass);
            }
        
            _saveCurrent();
        } finally {
            m_writeLock.unlock();
        }
    }

