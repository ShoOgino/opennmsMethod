    /** {@inheritDoc} */
    @Override
    public List<InetAddress> getIpList(final Package pkg) {
        getReadLock().lock();
        
        try {
            if (pkg == null) return null;
    
            final Filter filter = pkg.getFilter();
            if (filter == null) return null;
    
            final StringBuffer filterRules = new StringBuffer(filter.getContent());
    
            LogUtils.debugf(this, "getIpList: package is %s. filter rules are: %s", pkg.getName(), filterRules.toString());
            return FilterDaoFactory.getInstance().getActiveIPAddressList(filterRules.toString());
        } finally {
            getReadLock().unlock();
        }
    }

