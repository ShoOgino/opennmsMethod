        protected void setValue(Event targetEvent, String value) {
            if (value == null) {
                log().debug("Value of parameter is null setting to blank");
                value="";
            }

            for (final Parm parm : targetEvent.getParmCollection()) {
                if (parm.getParmName().equals(getAttributeName())) {
                    org.opennms.netmgt.xml.event.Value val = parm.getValue();
                    if (val == null) {
                        val = new org.opennms.netmgt.xml.event.Value();
                        parm.setValue(val);
                    }
                    if (log().isDebugEnabled()) {
                        log().debug("Overriding value of parameter "+getAttributeName()+". Setting it to "+value);
                    }
                    val.setContent(value);
                    return;
                }
            }

            // if we got here then we didn't find the existing parameter
            Parm newParm = new Parm();
            newParm.setParmName(getAttributeName());
            org.opennms.netmgt.xml.event.Value val = new org.opennms.netmgt.xml.event.Value();
            newParm.setValue(val);
            if (log().isDebugEnabled()) {
                log().debug("Setting value of parameter "+getAttributeName()+" to "+value);
            }
            val.setContent(value);
            targetEvent.addParm(newParm);
        }

