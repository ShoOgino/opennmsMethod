    @Override
    public boolean removeFromDefinition(InetAddress inetAddress, String location, String module) {
        boolean succeeded = false;
        getWriteLock().lock();
        try {
            // Check if there is a matching definition from the config itself instead of doing getAgentConfig.
            Definition matchingDefinition = findMatchingDefinition(inetAddress, location);
            if(matchingDefinition !=  null) {
                // Form a definition just with this IP Address.
                Definition definition = createDefinition(matchingDefinition);
                List<String> specifics = new ArrayList<>();
                specifics.add(InetAddressUtils.toIpAddrString(inetAddress));
                definition.setSpecifics(specifics);
                final SnmpConfigManager mgr = new SnmpConfigManager(getSnmpConfig());
                succeeded = mgr.removeDefinition(definition);
            }
        } finally {
            getWriteLock().unlock();
        }
        if(succeeded) {
            try {
                saveCurrent();
                LOG.info("Removed {} at location {} from definitions by module {}", inetAddress.getHostAddress(), location, module);
            } catch (IOException e) {
                // This never should happen, we currently don't support rollback of configuration.
                LOG.error("Exception while saving current config", e);
            }
        }
        return succeeded;
    }

