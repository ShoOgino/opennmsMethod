    /**
     * <p>isExcluded</p>
     *
     * @param address a {@link InetAddress} object.
     * @param location
     * @return a boolean.
     */
    @Override
    public boolean isExcluded(final InetAddress address, String location) {

        String defaultLocation = LocationUtils.DEFAULT_LOCATION_NAME;

        if (!m_excludeRanges.isEmpty()) {

            final byte[] laddr = address.getAddress();
            for (final ExcludeRange range : m_excludeRanges) {

                if (!isLocationMatched(range.getLocation().orElse(defaultLocation), location)) {
                    continue;
                }

                if (InetAddressUtils.isInetAddressInRange(laddr, range.getBegin(), range.getEnd())) {
                    return true;
                }
            }
        }
        return false;
    }

