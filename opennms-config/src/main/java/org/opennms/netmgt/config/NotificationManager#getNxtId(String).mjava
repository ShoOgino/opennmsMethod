    /**
     * This method returns the next ID for a given sql.
     *
     * @param sql a java.lang.String.
     * @return a int.
     * @throws java.io.IOException if any.
     */
    private int getNxtId(final String sql) throws SQLException {
        int id = 0;
        Connection connection = null;
        try {
            connection = getConnection();
            Statement stmt = connection.createStatement();
            ResultSet results = stmt.executeQuery(sql);

            results.next();

            id = results.getInt(1);

            stmt.close();
            results.close();
        } finally {
            if (connection != null) {
                try {
                    connection.close();
                } catch (SQLException e) {
                }
            }
        }
        return id;
    }

