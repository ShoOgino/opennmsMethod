    private void handleLegacyConfiguration() {
        String generatedSubscriptionName = null;

        /* Be backwards-compatible with old configurations.
         * 
         * The old style configuration did not have a <serverSubscription> field
         * inside the <external-servers> tag, so create a default one.
         */
        Enumeration<ExternalServers> e = getExternalServerEnumeration();
        while (e.hasMoreElements()) {
            ExternalServers es = e.nextElement();
            if (es.getServerSubscriptionCollection().size() == 0) {
                if (generatedSubscriptionName == null) {
                    generatedSubscriptionName = "legacyServerSubscription-" + java.util.UUID.randomUUID().toString();
                }
                es.addServerSubscription(generatedSubscriptionName);
            }
        }

        if (generatedSubscriptionName != null) {
            boolean foundUnnamedSubscription = false;
            for (Subscription s : getConfiguration().getSubscriptionCollection()) {
                if (s.getName() == null) {
                    s.setName(generatedSubscriptionName);
                    foundUnnamedSubscription = true;
                    break;
                }
            }
            if (! foundUnnamedSubscription) {
                String[] ueis = {
                        EventConstants.NODE_LOST_SERVICE_EVENT_UEI,
                        EventConstants.NODE_REGAINED_SERVICE_EVENT_UEI,
                        EventConstants.NODE_UP_EVENT_UEI,
                        EventConstants.NODE_DOWN_EVENT_UEI,
                        EventConstants.INTERFACE_UP_EVENT_UEI,
                        EventConstants.INTERFACE_DOWN_EVENT_UEI,
                        EventConstants.UPDATE_SERVER_EVENT_UEI,
                        EventConstants.UPDATE_SERVICE_EVENT_UEI,
                        EventConstants.XMLRPC_NOTIFICATION_EVENT_UEI
                };
                Subscription subscription = new Subscription();
                subscription.setName(generatedSubscriptionName);
                SubscribedEvent subscribedEvent = null;
                for (String uei : ueis) {
                    subscribedEvent = new SubscribedEvent();
                    subscribedEvent.setUei(uei);
                    subscription.addSubscribedEvent(subscribedEvent);
                }
                getConfiguration().addSubscription(subscription);
            }
        }
    }

