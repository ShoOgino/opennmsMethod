    /**
     * Helper method to search the wmi-config for the appropriate domain/workgroup.
     * @param def
     * @return a string containing the domain. will return the default if none is set.
     */
    private String determineDomain(Definition def) {
        return (def.getDomain() == null ? (getConfig().getDomain() == null ? WmiAgentConfig.DEFAULT_DOMAIN :getConfig().getDomain()) : def.getDomain());
    }

