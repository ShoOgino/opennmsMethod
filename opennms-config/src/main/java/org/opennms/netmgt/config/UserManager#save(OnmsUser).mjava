    public void save(final OnmsUser user) throws Exception {
        m_writeLock.lock();
        
        try {
            User castorUser = _getUser(user.getUsername());
            if (castorUser == null) {
                castorUser = new User();
                castorUser.setUserId(user.getUsername());
            }
            castorUser.setFullName(user.getFullName());
            castorUser.setUserComments(user.getComments());
            
            final Password pass = new Password();
            pass.setContent(user.getPassword());
            pass.setSalt(user.getPasswordSalted());
            castorUser.setPassword(pass);
    
            if (user.getDutySchedule() != null) {
                castorUser.setDutySchedule(user.getDutySchedule());
            }
            
            _writeUser(user.getUsername(), castorUser);
        } finally {
            m_writeLock.unlock();
        }
    }

