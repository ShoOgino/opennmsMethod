    public String getForeignSource(InetAddress address) {
    	getReadLock().lock();
    	
        final byte[] laddr = address.getAddress();

    	List<Specific> specificCollection = getConfiguration().getSpecificCollection();
    	for (Specific specific : specificCollection) {
			String ipAddr = specific.getContent();
			if (ipAddr.equals(InetAddressUtils.str(address))) {
				return specific.getForeignSource();
			}
		}
    	
    	List<IncludeRange> includeRangeCollection = getConfiguration().getIncludeRangeCollection();
    	for (IncludeRange range : includeRangeCollection) {
            if (InetAddressUtils.isInetAddressInRange(laddr, range.getBegin(), range.getEnd())) {
    			range.getForeignSource();
            }
		}
    	
    	List<IncludeUrl> includeUrlCollection = getConfiguration().getIncludeUrlCollection();
    	for (IncludeUrl includeUrl : includeUrlCollection) {
    		String ipAddr = includeUrl.getContent();
			if (ipAddr.equals(InetAddressUtils.str(address))) {
				return includeUrl.getForeignSource();
			}
		}
    	
    	return getConfiguration().getForeignSource();
    }

