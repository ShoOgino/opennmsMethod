    /**
     * This function recursively calls the {@link WaterfallCallable} tasks with the given chain of ExecutorServices.
     */
    public static void waterfall(Executor executor, Callable<Callable<?>> callable) throws InterruptedException, ExecutionException {
        if (executor == null) {
            throw new IllegalStateException("Executor is null");
        } else if (callable == null) {
            throw new IllegalStateException("Callable is null");
        }

        // Submit the task to the current ExecutorService
        executor.execute(new WaterfallCallable(executor, callable));
    }

