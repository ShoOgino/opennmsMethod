    public static Locale parseLocale(String string) {
        String[] segments = string.split("[-_]");
        if (segments.length == 1) {
            // Language only
            if ("".equals(segments[0].trim())) {
                throw new IllegalArgumentException("Invalid locale string: " + string);
            } else {
                return new Locale(segments[0].trim());
            }
        } else if (segments.length == 2) {
            // Language and country
            if ("".equals(segments[0].trim()) || "".equals(segments[1].trim())) {
                throw new IllegalArgumentException("Invalid locale string: " + string);
            } else {
                return new Locale(segments[0].trim(), segments[1].trim());
            }
        } else if (segments.length == 3) {
            // Language, country, and variant
            if ("".equals(segments[0].trim()) || "".equals(segments[1].trim()) || "".equals(segments[2].trim())) {
                throw new IllegalArgumentException("Invalid locale string: " + string);
            } else {
                return new Locale(segments[0].trim(), segments[1].trim(), segments[2].trim());
            }
        } else {
            throw new IllegalArgumentException("Invalid locale string: " + string);
        }
    }

