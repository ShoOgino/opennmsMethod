    /**
     * Helper method to set the security level in v3 operations.  The default is
     * noAuthNoPriv if there is no authentication passphrase.  From there, if
     * there is a privacy passphrase supplied, then the security level is set to
     * authPriv else it falls out to authNoPriv.  There are only these 3 possible
     * security levels.
     * default 
     * @param defaultConfig 
     * @return
     */
    public int getSecurityLevel(final SnmpConfig defaultConfig) {
        // use the def security level first
        if (hasSecurityLevel()) return getSecurityLevel();
    
        // use a configured default security level next
        if (defaultConfig.hasSecurityLevel()) {
            return defaultConfig.getSecurityLevel();
        }
    
        final String authPassPhrase = (isBlank(getAuthPassphrase()) ? defaultConfig.getAuthPassphrase() : getAuthPassphrase());
        final String privPassPhrase = (isBlank(getPrivacyPassphrase()) ? defaultConfig.getPrivacyPassphrase() : getPrivacyPassphrase());
    
        if (authPassPhrase == null) {
            return SnmpAgentConfig.NOAUTH_NOPRIV;
        } else {
            if (privPassPhrase == null) {
                return SnmpAgentConfig.AUTH_NOPRIV;
            } else {
                return SnmpAgentConfig.AUTH_PRIV;
            }
        }
    }

