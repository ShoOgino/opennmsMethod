    /**
     * This method determines the configured SNMP version.
     * the order of operations is:
     * 1st: return a valid requested version
     * 2nd: return a valid version defined in a definition within the snmp-config
     * 3rd: return a valid version in the snmp-config
     * 4th: return the default version
     * @param m_config 
     * 
     * @param requestedSnmpVersion
     * @return
     */
    public int getVersionCode(final SnmpConfig m_config, final int requestedSnmpVersion) {
    
        int version = SnmpAgentConfig.VERSION1;
    
        String cfgVersion = "v1";
        if (requestedSnmpVersion == SnmpAgentConfig.VERSION_UNSPECIFIED) {
            if (getVersion() == null) {
                if (m_config.getVersion() == null) {
                    return version;
                } else {
                    cfgVersion = m_config.getVersion();
                }
            } else {
                cfgVersion = getVersion();
            }
        } else {
            return requestedSnmpVersion;
        }
    
        if (cfgVersion.equals("v1")) {
            version = SnmpAgentConfig.VERSION1;
        } else if (cfgVersion.equals("v2c")) {
            version = SnmpAgentConfig.VERSION2C;
        } else if (cfgVersion.equals("v3")) {
            version = SnmpAgentConfig.VERSION3;
        }
    
        return version;
    }

