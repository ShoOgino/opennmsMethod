    /**
     * Helper method to find a privacy protocol to use from the snmp-config.  If v3 has
     * been specified and one can't be found, then a default is used for this
     * is a required option for v3 operations.
     * @param snmpPeerFactory TODO
     * @return
     */
    public String getPrivacyProtocol(final SnmpConfig defaultConfig) {
        if (getPrivacyProtocol() != null) return getPrivacyProtocol();
        if (defaultConfig.getPrivacyProtocol() != null) return defaultConfig.getPrivacyProtocol();
        if (getPrivPassphrase(defaultConfig) != null) {
            return SnmpAgentConfig.DEFAULT_PRIV_PROTOCOL;
        }
        return null;
    }

