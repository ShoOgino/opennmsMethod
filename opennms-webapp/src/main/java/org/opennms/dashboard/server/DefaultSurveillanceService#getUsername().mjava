    protected String getUsername() {
        Object obj = SecurityContextHolder.getContext().getAuthentication().getPrincipal(); 
        if (obj instanceof UserDetails) { 
            return ((UserDetails)obj).getUsername(); 
        } else { 
            return obj.toString(); 
        }
    }

