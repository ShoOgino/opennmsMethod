    private List<String> splitfields(String string, String sep, int maxsplit) {
        List<String> list = new ArrayList<String>();

        int length = string.length();
        if (maxsplit < 0) {
            maxsplit = length;
        }

        int lastbreak = 0;
        int splits = 0;
        int sepLength = sep.length();
        while (splits < maxsplit) {
            int index = string.indexOf(sep, lastbreak);
            if (index == -1) {
                break;
            }
            splits += 1;
            list.add(string.substring(lastbreak, index));
            lastbreak = index + sepLength;
        }
        if (lastbreak <= length) {
            list.add(string.substring(lastbreak, length));
        }
        return list;
    }

