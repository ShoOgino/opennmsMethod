        protected String determineTargetUrl(HttpServletRequest request) {
            // Don't attempt to obtain the url from the saved request if alwaysUsedefaultTargetUrl is set
            String targetUrl = alwaysUseDefaultTargetUrl ? null : AbstractProcessingFilter.obtainFullRequestUrl(request);

            if (targetUrl == null) {
                targetUrl = getDefaultTargetUrl();
            }

            return targetUrl;
        }

