    public void attributeRemoved(HttpSessionBindingEvent event) {
        if (event.getName().equals(HttpSessionContextIntegrationFilter.ACEGI_SECURITY_CONTEXT_KEY)) {
            SecurityContext securityContext = (SecurityContext) event.getValue();
            
            WebApplicationContext appContext = WebApplicationContextUtils.getRequiredWebApplicationContext(event.getSession().getServletContext());
            EventProxy eventProxy = (EventProxy) appContext.getBean("eventProxy", EventProxy.class);

            String user = securityContext.getAuthentication().getName();
            if (m_sessionIdsLoggedOut.contains(event.getSession().getId())) {
                m_sessionIdsLoggedOut.remove(event.getSession().getId());
                createEvent(user, eventProxy, LOGGED_OUT_EVENT);
            } else {
                createEvent(user, eventProxy, SESSION_REMOVED_EVENT);
            }
        }
    }

