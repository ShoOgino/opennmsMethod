    public String getCommandNonAdhoc(PrefabGraphType type,
                                     GraphResourceType resourceType,
                                     HttpServletRequest request,
                                     HttpServletResponse response) {
        String report = request.getParameter("report");
        String[] rrds = request.getParameterValues("rrd");
        String propertiesFile = request.getParameter("props");
        String start = request.getParameter("start");
        String end = request.getParameter("end");
        
        String[] requiredParameters = {
                "report",
                "rrd",
                "props",
                "start",
                "end",
        };
        
        if (report == null) {
            throw new MissingParameterException("report",
                                                requiredParameters);
        }
        if (rrds == null) {
            throw new MissingParameterException("rrd",
                                                requiredParameters);
        }
        if (start == null) {
            throw new MissingParameterException("start",
                                                requiredParameters);
        }
        if (end == null) {
            throw new MissingParameterException("end",
                                                requiredParameters);
        }
        
        for (int i = 0; i < rrds.length; i++) {
            if (!RrdFileConstants.isValidRRDName(rrds[i])) {
                log("Illegal RRD filename: " + rrds[i]);
                throw new IllegalArgumentException("Illegal RRD filename: "
                        + rrds[i]);
            }
        }
        
        return createPrefabCommand(request,
                                   resourceType,
                                   type.getReportMap(),
                                   type.getCommandPrefix(),
                                   type.getRrdDirectory(), report, rrds,
                                   propertiesFile,
                                   start, end);
    }

