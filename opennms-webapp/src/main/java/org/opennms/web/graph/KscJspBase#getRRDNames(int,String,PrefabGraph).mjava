    /** intf can be null */
    public String[] getRRDNames(int nodeId, String intf, PrefabGraph graph) {
        if (graph == null) {
            throw new IllegalArgumentException("Cannot take null parameters.");
        }

        String[] columns = graph.getColumns();
        String[] rrds = new String[columns.length];

        for (int i = 0; i < columns.length; i++) {
            StringBuffer buffer = new StringBuffer();

            if (nodeId >= 0) {
                buffer.append(nodeId);
                buffer.append(File.separator);
            }

            boolean addInterface = false;
            if (intf != null) {
                if (nodeId < 0) {
                    // Response time graph, it's always interface specific
                    addInterface = true;
                } else if (PerformanceModel.INTERFACE_GRAPH_TYPE.equals(graph
                        .getType())) {
                    // Performance graph where type == interface
                    addInterface = true;
                }

                if (addInterface) {
                    buffer.append(intf);
                    buffer.append(File.separator);
                }
            }

            buffer.append(columns[i]);
            buffer.append(org.opennms.netmgt.utils.RrdFileConstants
                    .getRrdSuffix());

            rrds[i] = buffer.toString();
        }

        return rrds;
    }

