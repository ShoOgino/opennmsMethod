    private static PrefabGraph makePrefabGraph(String key, Properties props, int order) {
        if (key == null) {
            throw new IllegalArgumentException("key cannot be null");
        }
        if (props == null) {
            throw new IllegalArgumentException("props cannot be null");
        }

        String title = getReportProperty(props, key, "name", true);

        String command = getReportProperty(props, key, "command", true);

        String columnString = getReportProperty(props, key, "columns", true);
        String[] columns = BundleLists.parseBundleList(columnString);

        String externalValuesString = getReportProperty(props, key,
                                                        "externalValues",
                                                        false);
        String[] externalValues;
        if (externalValuesString == null) {
            externalValues = new String[0];
        } else {
            externalValues = BundleLists.parseBundleList(externalValuesString);
        }

        String[] propertiesValues;
        String propertiesValuesString = getReportProperty(props, key,
                                                          "propertiesValues",
                
                                                          false);
        if( propertiesValuesString == null ) {
                propertiesValues = new String[0];
        } else {
                propertiesValues = BundleLists.parseBundleList(propertiesValuesString);
        }

        // can be null
        String type = getReportProperty(props, key, "type", false);

        // can be null
        String description = getReportProperty(props, key, "description", false);
        
        return new PrefabGraph(key, title, columns,
                command, externalValues,
                propertiesValues, order, type,
                description);

    }

