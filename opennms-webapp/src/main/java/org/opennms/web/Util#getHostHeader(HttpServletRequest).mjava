    /** Obtains the host and port used by the end user. */
    public static String getHostHeader(HttpServletRequest request) {
        for (int i = 0; i < hostHeaders.length; ++i) {
            String ret = request.getHeader(hostHeaders[i]);
            if (ret != null) {
                return ret;
            }
        }
        return request.getServerName() + ":"
                + Integer.toString(request.getServerPort());
    }

