        public Alarm mapRow(ResultSet rs, int rowNum) throws SQLException {
            Integer stateCode = (Integer)rs.getObject("TTicketState");
            TroubleTicketState ttstate = null;
            for (TroubleTicketState state : TroubleTicketState.values()) {
                if (stateCode != null && state.ordinal() == stateCode.intValue()) {
                    ttstate = state;
                }
            }

            Alarm alarm = new Alarm(
                rs.getInt("alarmID"), 
                rs.getString("eventUei"), 
                rs.getString("dpName"), 
                // node id can be null, in which case nodeID will be 0
                Integer.valueOf(rs.getInt("nodeID")), 
                rs.getString("ipAddr"), 
                // This causes serviceID to be null if the column in the database is null
                (Integer) rs.getObject("serviceID"), 
                rs.getString("reductionKey"), 
                rs.getInt("counter"), 
                rs.getInt("severity"), 
                rs.getInt("lastEventID"), 
                getTimestamp("firsteventtime", rs), 
                getTimestamp("lasteventtime", rs), 
                rs.getString("description"), 
                rs.getString("logmsg"), 
                rs.getString("OperInstruct"), 
                rs.getString("TTicketID"), 
                ttstate, 
                rs.getString("MouseOverText"), 
                getTimestamp("suppressedUntil", rs), 
                rs.getString("suppressedUser"), 
                getTimestamp("suppressedTime", rs), 
                rs.getString("alarmAckUser"), 
                getTimestamp("alarmAckTime", rs)
            );

            return alarm;

        }

