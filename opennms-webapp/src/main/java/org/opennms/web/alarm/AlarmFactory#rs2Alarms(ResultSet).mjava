    /**
     * Convenience method for translating a <code>java.sql.ResultSet</code>
     * containing event information into an array of <code>Alarm</code>
     * objects.
     */
    // FIXME: Don't reuse the same "element" variable for different objects
    protected static Alarm[] rs2Alarms(ResultSet rs) throws SQLException {
        Alarm[] alarms = null;
        Vector<Alarm> vector = new Vector<Alarm>();

        while (rs.next()) {
            Alarm alarm = new Alarm();

            Object element = new Integer(rs.getInt("alarmID"));
            alarm.id = ((Integer) element).intValue();

            element = rs.getString("eventUei");
            alarm.uei = (String) element;

            element = rs.getString("dpName");
            alarm.dpName = (String) element;

            // node id can be null
            element = rs.getObject("nodeID");
            if (element == null) {
                alarm.nodeID = new Integer(0);
            } else {
                alarm.nodeID = (Integer) element;
            }

            element = rs.getString("ipAddr");
            alarm.ipAddr = (String) element;

            element = rs.getObject("serviceID");
            alarm.serviceID = (Integer) element;

            element = rs.getString("reductionKey");
            alarm.reductionKey = (String) element;

            element = rs.getObject("counter");
            alarm.count = ((Integer) element).intValue();

            element = new Integer(rs.getInt("severity"));
            alarm.severity = ((Integer) element).intValue();

            element = new Integer(rs.getInt("lastEventID"));
            alarm.lastEventID = ((Integer) element).intValue();

            element = rs.getTimestamp("firsteventtime");
            alarm.firsteventtime = new Date(((Timestamp) element).getTime());

            element = rs.getTimestamp("lasteventtime");
            alarm.lasteventtime = new Date(((Timestamp) element).getTime());

            element = rs.getString("description");
            alarm.description = (String) element;

            element = rs.getString("logmsg");
            alarm.logMessage = (String) element;

            element = rs.getString("OperInstruct");
            alarm.operatorInstruction = (String) element;

            element = rs.getString("TTicketID");
            alarm.troubleTicket = (String) element;

            Integer stateCode = (Integer)rs.getObject("TTicketState");
            for (TroubleTicketState state : TroubleTicketState.values()) {
                if (stateCode != null && state.ordinal() == stateCode.intValue()) {
                    alarm.troubleTicketState = state;
                }
            }

            element = rs.getString("MouseOverText");
            alarm.mouseOverText = (String) element;

            element = rs.getTimestamp("suppressedUntil");
            alarm.suppressedUntil = new Date(((Timestamp) element).getTime());

            element = rs.getString("suppressedUser");
            alarm.suppressedUser = (String) element;

            element = rs.getTimestamp("suppressedTime");
            alarm.suppressedTime = new Date(((Timestamp) element).getTime());

            element = rs.getString("alarmAckUser");
            alarm.acknowledgeUser = (String) element;

            element = rs.getTimestamp("alarmAckTime");
            if (element != null) {
                alarm.acknowledgeTime = new Date(((Timestamp) element).getTime());
            }

            element = rs.getString("nodeLabel");
            alarm.nodeLabel = (String) element;

            element = rs.getString("serviceName");
            alarm.serviceName = (String) element;

            vector.addElement(alarm);
        }

        alarms = new Alarm[vector.size()];

        for (int i = 0; i < alarms.length; i++) {
            alarms[i] = vector.elementAt(i);
        }

        return alarms;
    }

