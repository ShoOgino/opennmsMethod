    public InputStream getPrefabGraph(
            String parentResourceType, String parentResource,
            String resourceType, String resource, String report, long start,
            long end) {
        assertPropertiesSet();

        if (parentResourceType == null) {
            throw new IllegalArgumentException("parentResourceType argument cannot be null");
        }
        if (parentResource == null) {
            throw new IllegalArgumentException("parentResource argument cannot be null");
        }
        if (resourceType == null) {
            throw new IllegalArgumentException("resourceType argument cannot be null");
        }
        if (resource == null) {
            throw new IllegalArgumentException("resource argument cannot be null");
        }
        if (report == null) {
            throw new IllegalArgumentException("report argument cannot be null");
        }
        if (end < start) {
            throw new IllegalArgumentException("end time cannot be before start time");
        }

        PrefabGraphType t = m_prefabGraphDao.findByName("performance");
        if (t == null) {
            throw new IllegalArgumentException("graph type \"" + "performance"
                                               + "\" is not valid");
        }
        
        GraphModel model = findGraphModelByName(t.getName());

        GraphResourceType rt =
            model.getResourceTypeByName(resourceType);
        
        GraphResource r = findResource(model,
                                       parentResourceType, parentResource,
                                       resourceType, resource);
        
        PrefabGraph prefabGraph = rt.getPrefabGraph(report);
        if (prefabGraph == null) {
            throw new ObjectRetrievalFailureException(PrefabGraph.class, report,
                                                      "Unknown report name '" + report + "'",
                                                      null);
        }
        
        if (!"node".equals(parentResourceType) && !"domain".equals(parentResourceType)) {
            throw new IllegalArgumentException("parentResourceType '"
                                               + parentResourceType
                                               + "' is not supported");
            
        }
        
        // XXX should we verify that the parentResource is an integer if parentResourceType == "node"??
        Graph graph = new Graph(prefabGraph, parentResourceType, parentResource, resourceType, resource, new Date(start), new Date(end));

        String attributePath = rt.getRelativePathForAttribute(parentResource, resource, "bogusAttribute");
        int lastSeparator = attributePath.lastIndexOf(File.separatorChar);
        String relativePropertiesPath = attributePath.substring(0, lastSeparator)
            + File.separator + "strings.properties";
        String command = getCommandNonAdhoc(t, rt, report, graph, 
                                            relativePropertiesPath);
        
        return getInputStreamForCommand(rt, command);
    }

