    public Collection<AggregateStatus> createAggregateStatusUsingBuilding(
            String building, Collection<AggregateStatusDefinition> categoryGrouping) {
        
        /*
         * We'll return this collection populated with all the aggregated statuss for the
         * devices in the building (site) by for each group of categories.
         */
        Collection<AggregateStatus> stati = new ArrayList<AggregateStatus>();
        
        /*
         * Iterate over the status definitions and create aggregated statuss
         */
        for (AggregateStatusDefinition statusDef : categoryGrouping) {
            AggregateStatus status = new AggregateStatus();
            status.setLabel(statusDef.getAggrStatusLabel());
            
            Collection<OnmsNode> nodes = m_nodeDao.findAllByVarCharAssetColumnCategoryList("building", building, statusDef.getCategories());
            
            status.setDownEntityCount(computeDownCount(nodes));
            status.setTotalEntityCount(nodes.size());
            status.setColor(computeColor(nodes, status));
            stati.add(status);
        }
        
        return stati;
    }

