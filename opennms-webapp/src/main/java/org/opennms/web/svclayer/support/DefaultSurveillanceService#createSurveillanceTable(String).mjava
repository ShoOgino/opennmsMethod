    /**
     * Creates a custom table object containing intersected rows and
     * columns and categories.
     */
    public SurveillanceTable createSurveillanceTable(String surveillanceViewName) {

        View view = m_surveillanceConfigDao.getView(surveillanceViewName);
        
        final Rows rows = view.getRows();
        final Columns columns = view.getColumns();
        
        /*
         * Initialize a status table 
         */
        final SurveillanceTable statusTable = new SurveillanceTable(rows.getRowDefCount(), columns.getColumnDefCount());
        statusTable.setLabel(view.getName());
        
        List<Category> viewRowCats = new ArrayList<Category>();
        List<Category> viewColCats = new ArrayList<Category>();
        List rowDefs = rows.getRowDefCollection();
        List columnDefs = columns.getColumnDefCollection();

        /*
         * Iterate of the requested view's configuration (row's and columns) and set an aggreated status into each table
         * cell.
         */
        for (Iterator rowDefIter = rowDefs.iterator(); rowDefIter.hasNext();) {
            RowDef rowDef = (RowDef) rowDefIter.next();
            final int row = rowDef.getRow()-1;
            statusTable.setRowHeader(row, rowDef.getLabel());
            viewRowCats.addAll(rowDef.getCategoryCollection());

            for (Iterator colDefIter = columnDefs.iterator(); colDefIter.hasNext();) {
                ColumnDef colDef = (ColumnDef) colDefIter.next();
                viewColCats.addAll(colDef.getCategoryCollection());

                final int col = colDef.getCol()-1;
                statusTable.setColumnHeader(col, colDef.getLabel());
                statusTable.setStatus(row, col, createAggregateStatus(createCategories(viewRowCats), createCategories(viewColCats)));

                if (statusTable.getStatus(row, col).getDownEntityCount() > 0) {
                    statusTable.setRowHeader(row, createNodePageUrl(rowDef.getLabel()));
                }

                viewColCats.removeAll(colDef.getCategoryCollection());
            }
            
            viewRowCats.removeAll(rowDef.getCategoryCollection());
        }
        
        return statusTable;
    }

