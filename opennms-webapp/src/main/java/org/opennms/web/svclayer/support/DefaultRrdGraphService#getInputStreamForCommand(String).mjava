    private InputStream getInputStreamForCommand(String command) {
        boolean debug = true;
        File workDir = m_resourceDao.getRrdDirectory(true);

        InputStream tempIn = null;
        try {
            log().debug("Executing RRD command in directory '" + workDir
                        + "': " + command);

            tempIn = m_rrdStrategy.createGraph(command, workDir);
        } catch (RrdException e) {
            String message = "RrdException received while creating graph: "
                + e.getMessage(); 
            log().warn(message, e);
            if (debug) {
                throw new DataRetrievalFailureException(message, e);
            } else {
                return returnErrorImage(s_rrdError);
            }
        } catch (IOException e) {
            String message = "IOException received while creating graph: "
                + e.getMessage(); 
            log().warn(message, e);
            if (debug) {
                throw new DataRetrievalFailureException(message, e);
            } else {
                return returnErrorImage(s_rrdError);
            }
        }

        return tempIn;
    }

