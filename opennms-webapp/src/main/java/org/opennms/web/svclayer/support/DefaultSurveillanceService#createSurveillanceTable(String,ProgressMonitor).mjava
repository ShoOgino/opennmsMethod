    /**
     * Creates a custom table object containing intersected rows and
     * columns and categories.
     */
    public SimpleWebTable createSurveillanceTable(String surveillanceViewName, ProgressMonitor progressMonitor) {

        View view = m_surveillanceConfigDao.getView(surveillanceViewName);
        
        SurveillanceView sView = new SurveillanceView(surveillanceViewName, m_surveillanceConfigDao, m_categoryDao);
        
        final Rows rows = view.getRows();
        final Columns columns = view.getColumns();
        
        progressMonitor.setPhaseCount(rows.getRowDefCount()+columns.getColumnDefCount()+2);
        
        /*
         * Initialize a status table 
         */
        SimpleWebTable webTable = new SimpleWebTable();
        webTable.setTitle(view.getName());
        
        webTable.addColumn("Nodes Down", "simpleWebTableHeader");
        
        // set up the column headings
        for(int colIndex = 0; colIndex < sView.getColumnCount(); colIndex++) {
            webTable.addColumn(sView.getColumnLabel(colIndex), "simpleWebTableHeader");
        }
        

        // build the set of nodes for each cell
        
        CellStatusStrategy strategy = new CellStatusStrategy();
        
        AggregateStatus[][] cellStatus = calculateCellStatus(sView, progressMonitor, strategy);
        
        progressMonitor.beginNextPhase("Calculating Status Values");
        
        for(int rowIndex = 0; rowIndex < sView.getRowCount(); rowIndex++) {
            
            webTable.newRow();
            webTable.addCell(sView.getRowLabel(rowIndex), "simpleWebTableRowLabel");
            

            for(int colIndex = 0; colIndex < sView.getColumnCount(); colIndex++) {

				AggregateStatus aggStatus = cellStatus[rowIndex][colIndex];
				
				SimpleWebTable.Cell cell = webTable.addCell(aggStatus.getDownEntityCount()+" of "+aggStatus.getTotalEntityCount(), aggStatus.getStatus());

                if (aggStatus.getDownEntityCount() > 0) {
					cell.setLink(createNodePageUrl(aggStatus));
                    m_foundDownNode = null; //what a hack
                }
            }
                
        }
        progressMonitor.finished(webTable);
        
        return webTable;
    }

