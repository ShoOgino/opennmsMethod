    public Collection<AggregateStatus> createAggregateStatusUsingAssetColumn(String assetColumn,
            String columnValue, Collection<AggregateStatusDefinition> categoryGrouping) {
        
        /*
         * We'll return this collection populated with all the aggregated statuss for the
         * devices in the building (site) by for each group of categories.
         */
        Collection<AggregateStatus> stati = new ArrayList<AggregateStatus>();
        
        /*
         * Iterate over the status definitions and create aggregated statuss
         */
        for (AggregateStatusDefinition statusDef : categoryGrouping) {
            AggregateStatus status = new AggregateStatus();
            status.setLabel(statusDef.getAggrStatusLabel());
            
            Collection<OnmsNode> nodes = m_nodeDao.findAllByVarCharAssetColumnCategoryList(assetColumn, columnValue, statusDef.getCategories());
            
//            for (OnmsNode node : nodes) {
//                m_nodeDao.getHierarchy(node.getId());
//            }
            
            status.setDownEntityCount(computeDownCount(nodes));
            status.setTotalEntityCount(nodes.size());
            status.setStatus(computeStatus(nodes, status));
            stati.add(status);
        }
        
        return stati;
    }

