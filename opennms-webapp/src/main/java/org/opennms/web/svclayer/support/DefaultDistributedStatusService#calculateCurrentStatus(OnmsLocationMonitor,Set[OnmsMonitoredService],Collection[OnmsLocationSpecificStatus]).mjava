    public String calculateCurrentStatus(OnmsLocationMonitor monitor,
            Set<OnmsMonitoredService> applicationServices,
            Collection<OnmsLocationSpecificStatus> statuses) {
        Set<PollStatus> pollStatuses = new HashSet<PollStatus>();
        
        for (OnmsMonitoredService service : applicationServices) {
            for (OnmsLocationSpecificStatus status : statuses) {
                if (status.getMonitoredService().equals(service)
                        && status.getLocationMonitor().equals(monitor)) {
                    pollStatuses.add(status.getPollResult());
                } else {
                    pollStatuses.add(PollStatus.unknown());
                }
            }
        }
        
        /*
         * XXX We aren't doing anything for warning, because we don't
         * have a warning state available, right now.
         */
        if (monitor == null || monitor.getLastCheckInTime() == null
                || monitor.getLastCheckInTime().before(new Date(System.currentTimeMillis() - 300000))) {
            // XXX spec says "Red", which would be Critical
            return "Indeterminate";
        }
        
        for (PollStatus pollStatus : pollStatuses) {
            if (!pollStatus.isAvailable()) {
                return "Critical";
            }
        }
        
        return "Normal";
    }

