    private void sanitizeFavorite(OnmsFilterFavorite favorite) {
        // Input string is URL-Encoded and some html-entities are already escaped.
        // Revert this process, to allow WebSecurityUtils to work properly.
        try {
            favorite.setName(StringEscapeUtils.unescapeHtml(URLDecoder.decode(favorite.getName(), "UTF-8")));
            favorite.setFilter(StringEscapeUtils.unescapeHtml(URLDecoder.decode(favorite.getFilter(), "UTF-8")));
        } catch (UnsupportedEncodingException e) {
            throw new RuntimeException(e);
        }

        // Sanitize input
        favorite.setName(WebSecurityUtils.sanitizeString(favorite.getName()));
        favorite.setFilter(WebSecurityUtils.sanitizeString(favorite.getFilter()));
    }

