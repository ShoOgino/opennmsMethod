        URL createSnapshot() throws MalformedURLException {
            flush();

            Requisition pending = getPendingForeignSourceRepository().getRequisition(getForeignSource());
            Requisition deployed = getDeployedForeignSourceRepository().getRequisition(getForeignSource());

            URL activeUrl = pending == null || (deployed != null && deployed.getDateStamp().compare(pending.getDateStamp()) > -1)
                ? getDeployedForeignSourceRepository().getRequisitionURL(getForeignSource())
                : RequisitionFileUtils.createSnapshot(getPendingForeignSourceRepository(), getForeignSource(), pending.getDate()).toURI().toURL();

            return activeUrl;
        }

