    protected OnmsCriteria getCriteria(final OnmsSeverity severity) {
        final OnmsCriteria criteria = new OnmsCriteria(OnmsAlarm.class);
        if (severity != null) {
            criteria.add(Restrictions.eq("severity", severity));
        }

        criteria.setFetchMode("firstEvent", FetchMode.JOIN);
        criteria.setFetchMode("lastEvent", FetchMode.JOIN);
        
        criteria.createAlias("node", "node", CriteriaSpecification.LEFT_JOIN);
        criteria.createAlias("node.snmpInterfaces", "snmpInterface", CriteriaSpecification.LEFT_JOIN);
        criteria.createAlias("node.ipInterfaces", "ipInterface", CriteriaSpecification.LEFT_JOIN);

        return criteria;
    }

