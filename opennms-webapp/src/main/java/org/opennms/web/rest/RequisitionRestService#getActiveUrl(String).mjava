    private URL getActiveUrl(String foreignSourceName) throws MalformedURLException {
        Requisition pending = m_pendingForeignSourceRepository.getRequisition(foreignSourceName);
        Requisition deployed = m_deployedForeignSourceRepository.getRequisition(foreignSourceName);

        if (pending == null || (deployed != null && deployed.getDateStamp().compare(pending.getDateStamp()) > -1)) {
            // all we have is deployed, or deployed is newer than pending
            return m_deployedForeignSourceRepository.getRequisitionURL(foreignSourceName);
        }
        
        return RequisitionFileUtils.createSnapshot(m_pendingForeignSourceRepository, foreignSourceName).toURI().toURL();
    }

