	private void updateAlarm(final OnmsAlarm saveMe) {
		new UpsertTemplate<OnmsAlarm, AlarmDao>(m_transactionManager, m_alarmDao) {
			@Override
			protected OnmsAlarm query() {
				return m_alarmDao.get(saveMe.getId());
			}

			@Override
			protected OnmsAlarm doUpdate(final OnmsAlarm updateMe) {
				if (updateMe.getId() == null && saveMe.getId() != null) {
					updateMe.setId(saveMe.getId());
				}
				updateMe.setAlarmAckTime(saveMe.getAckTime());
				updateMe.setAlarmAckUser(saveMe.getAlarmAckUser());
				updateMe.setAlarmType(saveMe.getAlarmType());
				updateMe.setApplicationDN(saveMe.getApplicationDN());
				updateMe.setClearKey(saveMe.getClearKey());
				updateMe.setCounter(saveMe.getCounter());
				updateMe.setDescription(saveMe.getDescription());
				updateMe.setDetails(saveMe.getDetails());
				updateMe.setDistPoller(saveMe.getDistPoller());
				updateMe.setEventParms(saveMe.getEventParms());
				updateMe.setFirstAutomationTime(saveMe.getFirstAutomationTime());
				updateMe.setFirstEventTime(saveMe.getFirstEventTime());
				updateMe.setIfIndex(saveMe.getIfIndex());
				updateMe.setIpAddr(saveMe.getIpAddr());
				updateMe.setLastAutomationTime(saveMe.getLastAutomationTime());
				updateMe.setLastEvent(saveMe.getLastEvent());
				updateMe.setLastEventTime(saveMe.getLastEventTime());
				updateMe.setLogMsg(saveMe.getLogMsg());
				updateMe.setManagedObjectInstance(saveMe.getManagedObjectInstance());
				updateMe.setManagedObjectType(saveMe.getManagedObjectType());
				updateMe.setMouseOverText(saveMe.getMouseOverText());
				updateMe.setNode(saveMe.getNode());
				updateMe.setOperInstruct(saveMe.getOperInstruct());
				updateMe.setOssPrimaryKey(saveMe.getOssPrimaryKey());
				updateMe.setQosAlarmState(saveMe.getQosAlarmState());
				updateMe.setReductionKey(saveMe.getReductionKey());
				updateMe.setServiceType(saveMe.getServiceType());
				updateMe.setSeverity(saveMe.getSeverity());
				updateMe.setSuppressedTime(saveMe.getSuppressedTime());
				updateMe.setSuppressedUntil(saveMe.getSuppressedUntil());
				updateMe.setSuppressedUser(saveMe.getSuppressedUser());
				updateMe.setTTicketId(saveMe.getTTicketId());
				updateMe.setTTicketState(saveMe.getTTicketState());
				updateMe.setUei(saveMe.getUei());
				updateMe.setX733AlarmType(saveMe.getX733AlarmType());
				updateMe.setX733ProbableCause(saveMe.getX733ProbableCause());
				m_alarmDao.update(updateMe);
				m_alarmDao.flush();
				return updateMe;
			}

			@Override
			protected OnmsAlarm doInsert() {
				m_alarmDao.save(saveMe);
				m_alarmDao.flush();
				return saveMe;
			}
			
		}.execute();
	}

