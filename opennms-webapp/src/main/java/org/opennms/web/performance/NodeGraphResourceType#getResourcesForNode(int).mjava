    public List<GraphResource> getResourcesForNode(int nodeId) {
        ArrayList<GraphResource> graphResources =
            new ArrayList<GraphResource>();

        /*
         * Verify that the node directory exists so we can throw a good
         * error message if not.
         */
        try {
            m_performanceModel.getNodeDirectory(nodeId, true);
        } catch (DataAccessException e) {
            throw new ObjectRetrievalFailureException("The '" + getName() + "' resource type does not exist on this node.  Nested exception is: " + e.getClass().getName() + ": " + e.getMessage(), e);
        }
        
        List<String> dataSources =
            m_performanceModel.getDataSourceList(Integer.toString(nodeId));
        Set<GraphAttribute> attributes =
            new HashSet<GraphAttribute>(dataSources.size());
        
        for (String dataSource : dataSources) {
            attributes.add(new RrdGraphAttribute(dataSource));
        }
        
        GraphResource resource =
            new DefaultGraphResource("", "Node-level Performance Data",
                                     attributes);
        graphResources.add(resource);
        return graphResources;
    }

