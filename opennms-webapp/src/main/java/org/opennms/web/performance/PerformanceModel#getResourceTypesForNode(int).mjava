    public Collection<GraphResourceType> getResourceTypesForNode(int nodeId) {
        Collection<GraphResourceType> in = m_resourceTypes.values();
        Collection<GraphResourceType> out = new LinkedList<GraphResourceType>();
        for (GraphResourceType a : in) {
            boolean onNode = a.isResourceTypeOnNode(nodeId);
            if (log().isDebugEnabled()) {
                log().debug("Resource " + a.getName() + " is on node "
                            + nodeId + ": " + onNode);
            }
            if (onNode) {
                out.add(a);
            }
        }
        return out;
    }

