    /**
     * @throws SQLException
     * @throws ClassNotFoundException
     */

    Connection createConnection() throws MapsException {

        if (m_factory != null) {
            try {
                return m_factory.getConnection();
            } catch (SQLException e) {
                LOG.error("Exception while creating connection");
                throw new MapsException(e);
            }
        } else {
            try {
                return DataSourceFactory.getInstance().getConnection();
            } catch (SQLException e) {
                LOG.error("Exception while creating connection");
                throw new MapsException(e);
            }
        }
    }

