    /** {@inheritDoc} */
    @Override
    public VMap refreshMap(VMap map) throws MapsException {
        
        if (map == null) {
            throw new MapNotFoundException("map is null");
        }

        Collection<VElement> velems = map.getElements().values();
        velems = localRefreshElements(velems);
        for (VElement mapElement : velems) {
            map.addElement(mapElement);
        }
        
        map.removeAllLinks();
        map.addLinks(getLinks(map.getElements().values()));

        return map;
    }

