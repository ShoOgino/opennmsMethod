    /**
     * <p>getMapsStructure</p>
     *
     * @return a java$util$Map object.
     * @throws org.opennms.web.map.MapsException if any.
     */
    public java.util.Map<Integer, Set<Integer>> getMapsStructure()
            throws MapsException {
        Connection conn = createConnection();
        PreparedStatement statement = null;
        ResultSet rs = null;
        try {
            java.util.Map<Integer, Set<Integer>> maps = new HashMap<Integer, Set<Integer>>();
            String sqlQuery = "select elementid,mapid from " + elementTable
                    + " where elementtype=?";
            statement = conn.prepareStatement(sqlQuery);
            statement.setString(1, MapsConstants.MAP_TYPE);
            rs = statement.executeQuery();
            while (rs.next()) {
                Integer parentId = new Integer(rs.getInt("mapid"));
                Integer childId = new Integer(rs.getInt("elementid"));

                Set<Integer> childs = maps.get(parentId);

                if (childs == null) {
                    childs = new HashSet<Integer>();
                }

                if (!childs.contains(childId)) {
                    childs.add(childId);
                }
                maps.put(parentId, childs);
            }
            return maps;
        } catch (Throwable e) {
            log.error("Exception while getting maps parent-child structure");
            throw new MapsException(e);
        } finally {
            closeResultSet(rs);
            closeStatement(statement);
            releaseConnection(conn);
        }
    }

