    private Set getNodeidsOnElement(Element elem) throws SQLException, MapsException {
   		Set elementNodeIds = new TreeSet();
		if (elem.isNode()) {
			elementNodeIds.add(new Integer(elem.getId()));
		} else if (elem.isMap()) {
			int curMapId = elem.getId();
			Element[] elemNodeElems = Factory.getNodeElementsOfMap(curMapId);
			if (elemNodeElems != null && elemNodeElems.length >0 ) {
				for (int i=0; i<elemNodeElems.length;i++ ) {
					elementNodeIds.add(new Integer(elemNodeElems[i].getId()));
				}
			}
			Element[] elemMapElems = Factory.getMapElementsOfMap(curMapId);
			if (elemMapElems != null && elemMapElems.length >0 ) {
				for (int i=0; i<elemMapElems.length;i++ ) {
					elementNodeIds.addAll(getNodeidsOnElement(elemMapElems[i]));
				}
			}
		}
		return elementNodeIds;
   	
    }

