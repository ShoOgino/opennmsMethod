    public Set<Integer> getNodeIdsBySource(String query) throws MapsException {
        if (query == null) {
            return getAllNodes();
        }
        Set<Integer> nodes = new HashSet<Integer>();
        Connection conn = createConnection();
        try {
            String sqlQuery = query;
            log.debug("Applying filters for source " + " '" + sqlQuery + "'");

            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sqlQuery);
            // add all matching nodes (id) with the source to the Set.
            while (rs.next()) {
                nodes.add(new Integer(rs.getInt(1)));
            }
            rs.close();
            stmt.close();
        } catch (Exception e) {
            throw new MapsException(
                                    "Exception while getting nodes by source label "
                                            + e);
        } finally {
            releaseConnection(conn);
        }
        return nodes;
    }

