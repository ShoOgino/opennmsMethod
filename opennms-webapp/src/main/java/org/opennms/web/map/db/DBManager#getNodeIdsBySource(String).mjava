	public Set<Integer> getNodeIdsBySource(String query) throws MapsException {
		if (query == null) {
			return getAllNodes();
		}
		Statement stmt = null;
		ResultSet rs = null;
		Set<Integer> nodes = new HashSet<Integer>();
		try {
			createConnection();
			String sqlQuery = query;
			log.debug("Applying filters for source " + " '" + sqlQuery + "'");

			stmt = m_dbConnection.createStatement();
			rs = stmt.executeQuery(sqlQuery);
			// add all matching nodes (id) with the source to the Set.
			while (rs.next()) {
				nodes.add(new Integer(rs.getInt(1)));
			}
			rs.close();
			stmt.close();
		} catch (Exception e) {
			throw new MapsException(
					"Exception while getting nodes by source label " + e);
		} finally {
			releaseConnection();
		}
		return nodes;
	}

