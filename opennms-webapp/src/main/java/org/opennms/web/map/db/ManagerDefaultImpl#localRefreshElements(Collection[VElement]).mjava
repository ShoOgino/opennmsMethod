    private List<VElement> localRefreshElements(
            Collection<VElement> mapElements) throws MapsException {
        List<VElement> elems = new ArrayList<VElement>();
        Vector<Integer> deletedNodeids = dbManager.getDeletedNodes();
        java.util.Map<Integer, AlarmInfo> outagedNodes = getAlarmedNodes();
        java.util.Map<Integer, Double> avails = dbManager.getAvails(mapElements.toArray(new VElement[0]));
        Set<Integer> nodesBySource = new HashSet<Integer>();
        if (dataSource != null) {
            nodesBySource = dbManager.getNodeIdsBySource(filter);
        }

        for (VElement mapElement : mapElements) {
            elems.add(refresh(mapElement, nodesBySource, deletedNodeids,
                         outagedNodes, avails));
        }

        return elems;
    }

