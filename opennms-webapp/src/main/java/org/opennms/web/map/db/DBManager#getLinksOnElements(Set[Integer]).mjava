    public Set<LinkInfo> getLinksOnElements(Set<Integer> allnodes) throws SQLException, ClassNotFoundException {
	       Set<LinkInfo> nodes = new HashSet<LinkInfo>();
	        createConnection();
	        String nodelist="";
	        Iterator<Integer> ite = allnodes.iterator();
	        while (ite.hasNext()) {
	        	nodelist+=ite.next();
	        	if (ite.hasNext()) nodelist+=",";
	        }

	        String sql = "SELECT " +
		"datalinkinterface.nodeid, ifindex,nodeparentid, parentifindex, snmpiftype,snmpifspeed,snmpifoperstatus " +
		"FROM datalinkinterface " +
		"left join snmpinterface on nodeparentid = snmpinterface.nodeid " +
		"WHERE" +
		" (datalinkinterface.nodeid IN ("+nodelist+")" +
		" OR nodeparentid in ("+nodelist+")) " +
		"AND status != 'D' and datalinkinterface.parentifindex = snmpinterface.snmpifindex";
	        Statement stmt = m_dbConnection
            .createStatement();
	        ResultSet rs = stmt.executeQuery(sql);
		    while (rs.next()) {
	            Object element = new Integer(rs.getInt("nodeid"));
	            int nodeid = -1;
	            if (element != null) {
	                nodeid = ((Integer) element);
	            }

	            element = new Integer(rs.getInt("ifindex"));
	            int ifindex = -1;
	            if (element != null) {
	            	ifindex = ((Integer) element);
	            }

	            element = new Integer(rs.getInt("nodeparentid"));
	            int nodeparentid = -1;
	            if (element != null) {
	            	nodeparentid = ((Integer) element);
	            }

	            element = new Integer(rs.getInt("parentifindex"));
	            int parentifindex = -1;
	            if (element != null) {
	            	parentifindex = ((Integer) element);
	            }

	            element = new Integer(rs.getInt("snmpiftype"));
	            int snmpiftype = -1;
	            if (element != null) {
	            	snmpiftype = ((Integer) element);
	            }

	            element = new Long(rs.getLong("snmpifspeed"));
	            long snmpifspeed = -1;
	            if (element != null) {
	            	snmpifspeed = ((Long) element);
	            }

	            element = new Integer(rs.getInt("snmpifoperstatus"));
	            int snmpifoperstatus = -1;
	            if (element != null) {
	            	snmpifoperstatus = ((Integer) element);
	            }
	            
	            LinkInfo link = new LinkInfo(nodeid,ifindex,nodeparentid,parentifindex,snmpiftype,snmpifspeed,snmpifoperstatus);

	            nodes.add(link);
	        }
	        rs.close();
	        stmt.close();
	        
	        
	        return nodes;
	         		
	}

