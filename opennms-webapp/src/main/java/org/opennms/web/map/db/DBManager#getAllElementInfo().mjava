    public Vector<VElementInfo> getAllElementInfo() throws MapsException {
        Connection conn = createConnection();
        try {
            final String sqlQuery = "SELECT  n.nodeid,n.nodelabel,i.ipaddr FROM node n left join ipinterface i on n.nodeid=i.nodeid" +
            		" WHERE n.nodetype!='D' and (i.issnmpprimary='P' or i.issnmpprimary='N') order by nodeid,issnmpprimary desc";
            PreparedStatement statement = conn.prepareStatement(sqlQuery);
            ResultSet rs = statement.executeQuery();
            Vector<VElementInfo> elements = new Vector<VElementInfo>();
            int previousNodeid = -1;
            while (rs.next()) {
                int curnodeid = rs.getInt("nodeid");
                if (curnodeid != previousNodeid) {
                    VElementInfo ei = new VElementInfo(curnodeid,rs.getString("ipaddr"),rs.getString("nodelabel"));
                    elements.add(ei);
                }
                previousNodeid=curnodeid;
            }
            rs.close();
            statement.close();
            return elements;
        } catch (Exception e) {
            log.error("Exception while getting all element infos", e);
            throw new MapsException(e);
        } finally {
            releaseConnection(conn);
        }
    }

