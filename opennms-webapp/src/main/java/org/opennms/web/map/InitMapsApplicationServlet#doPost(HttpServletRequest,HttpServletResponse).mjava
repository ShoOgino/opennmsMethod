	public void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		
		BufferedWriter bw = new BufferedWriter(
				new OutputStreamWriter(response.getOutputStream()));
		String strToSend=null;
		try {
			ThreadCategory.setPrefix(MapsConstants.LOG4J_CATEGORY);
			log = ThreadCategory.getInstance(this.getClass());
			log.info("Init maps application");
			
			String action = request.getParameter("action");

			strToSend = action + "OK";

			if (action.equals(MapsConstants.INIT_ACTION)) {
				HttpSession userSession = request.getSession();
				Manager m = new Manager();
				VMap sessionMap = m.newMap();

				Integer mapToOpen = (Integer) userSession.getAttribute("mapToOpen");

				String refreshTime = (String) userSession.getAttribute("refreshTime");
				if(refreshTime!=null){
					strToSend += refreshTime;
				}
				if (mapToOpen != null) {
					strToSend += "&" + mapToOpen.intValue();
				} 
			} else {
				strToSend = MapsConstants.INIT_ACTION + "Failed";
			}
		} catch (Exception e) {
			log.error("Init maps application: " + e);
			strToSend = MapsConstants.INIT_ACTION + "Failed";
		}finally{
			bw.write(strToSend);
			bw.close();
			log.info("Sending response to the client '" + strToSend + "'");
		}
		
	}

