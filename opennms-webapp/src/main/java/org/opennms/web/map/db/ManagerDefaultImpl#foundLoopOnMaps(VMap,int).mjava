    public boolean foundLoopOnMaps(VMap parentMap, int mapId)
            throws MapsException {

        ThreadCategory.setPrefix(MapsConstants.LOG4J_CATEGORY);
        ThreadCategory log = ThreadCategory.getInstance(this.getClass());

        java.util.Map<Integer, Set<Integer>> maps = dbManager.getMapsStructure();
        Set<Integer> childSet = new TreeSet<Integer>();
        for (VElement elem : parentMap.getElements().values()) {
            if (elem.getType().equals(MapsConstants.MAP_TYPE)) {
                childSet.add(new Integer(elem.getId()));
            }
        }

        log.debug("List of sub-maps before preorder visit "
                + childSet.toString());

        maps.put(new Integer(parentMap.getId()), childSet);

        while (childSet.size() > 0) {
            childSet = preorderVisit(childSet, maps);

            log.debug("List of sub-maps  " + childSet.toString());

            if (childSet.contains(new Integer(mapId))) {
                return true;
            }
        }
        return false;

    }

