    public synchronized int deleteMap(int id) throws MapsException {
        log.debug("deleting map...");
        Connection conn = startSession();
        final String sqlDeleteMap = "DELETE FROM " + mapTable
                + " WHERE mapid = ? AND maptype != ? ";
        int countDelete = 0;
        try {
            PreparedStatement statement = conn.prepareStatement(sqlDeleteMap);
            statement.setInt(1, id);
            statement.setString(2, Map.AUTOMATICALLY_GENERATED_MAP);
            countDelete = statement.executeUpdate();
            statement.close();
            return countDelete;
        } catch (SQLException e) {
            log.error("error while deleting map " + id);
            rollback(conn);
            throw new MapsException(e);
        } finally {
            endSession(conn);
        }
    }

