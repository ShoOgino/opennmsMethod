    /** {@inheritDoc} */
    public synchronized int deleteMap(int id) throws MapsException {
        log.debug("deleting map...");
        Connection conn = startSession();
        final String sqlDeleteMap = "DELETE FROM " + mapTable
                + " WHERE mapid = ? AND maptype != ? ";
        int countDelete = 0;
        PreparedStatement statement = null;
        try {
            statement = conn.prepareStatement(sqlDeleteMap);
            statement.setInt(1, id);
            statement.setString(2, MapsConstants.AUTOMATICALLY_GENERATED_MAP);
            countDelete = statement.executeUpdate();
        } catch (SQLException e) {
            log.error("error while deleting map " + id);
            rollback(conn);
            throw new MapsException(e);
        } finally {
            closeStatement(statement);
            endSession(conn);
        }
        return countDelete;
    }

