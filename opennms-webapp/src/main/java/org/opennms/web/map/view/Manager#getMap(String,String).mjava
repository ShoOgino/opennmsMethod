    /**
     * Take the map label and type in input and return it in VMap form.
     * 
     * @param mapname
     * @param maptype
     * @return the VMap[] with corresponding mapname and maptype
     * @throws MapsException
     */

    public VMap[] getMap(String mapname, String maptype) throws MapsManagementException,
            MapNotFoundException, MapsException {
    	
        VMap retVMap = null;
        if (!maptype.equals(VMap.AUTOMATICALLY_GENERATED_MAP) && !maptype.equals(VMap.USER_GENERATED_MAP)) {
            throw new MapNotFoundException("Map with uncorrect maptype " + maptype);
        }
        Vector ve = new Vector();

        try {
            Map[] maps = Factory.getMaps(mapname,maptype);
            if (maps == null) {
                throw new MapNotFoundException("Map with mapname " + mapname
                        + "and maptype " + maptype + " doesn't exist.");
            }
            for (int i = 0; i<maps.length;i++) {
            	Map m = maps[i];
            	retVMap = new VMap(m.getId(), m.getName(), m.getBackground(),
                    m.getOwner(), m.getAccessMode(), m.getUserLastModifies(), m
                            .getScale(), m.getOffsetX(), m.getOffsetY(), m
                            .getType(),m.getWidth(),m.getHeight());
            	retVMap.setCreateTime(m.getCreateTime());
            	retVMap.setLastModifiedTime(m.getLastModifiedTime());
            	Element[] mapElems = Factory.getElementsOfMap(m.getId());
            	VElement elem =null;
            	if(mapElems!=null){
            		for (int j = 0; j < mapElems.length; j++) {
            			elem = new VElement(mapElems[j]);
            			// here we must add all the stuff required
            			retVMap.addElement(elem);
            		}
            	}
            	retVMap.addElements((VElement[]) refreshElements(retVMap.getAllElements(),false).toArray(new VElement[0]));
            	retVMap.addLinks((VLink[]) getLinks(retVMap.getAllElements()).toArray(new VLink[0]));
            	ve.add(retVMap);
            }
        } catch (SQLException se) {
            throw new MapsManagementException(
                    "Factory: unable to get map with mapname and maptype " + mapname + maptype + "." + se);
        }
        VMap[] vmaps = new VMap[ve.size()];
        vmaps=(VMap[])ve.toArray(vmaps);
        return vmaps;
     }

