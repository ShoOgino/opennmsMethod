	public Set getNodeIdsBySource(String sourceLabel)throws MapsException{
		DataSource dataSource = (DataSource) sourcesMap.get(sourceLabel);
		Filter[] filters = dataSource.getFilters();
		if(filters==null || filters.length==0){
			return getAllNodes();
		}
		Connection conn=null;
		Statement stmt = null;
		ResultSet rs = null;
		HashSet nodes = new HashSet();
		try {
			conn = Vault.getDbConnection();
			String sqlQuery = null;
			// contructs and execute the query
			
			sqlQuery = "select distinct " + filters[0].table + ".nodeid from ";
			for (int i = 0; i < filters.length; i++) {
				sqlQuery += filters[i].table;
				if (i < filters.length - 1) {
					sqlQuery += ",";
				}
			}
			sqlQuery += " where ";
			for (int i = 0; i < filters.length; i++) {
				sqlQuery += filters[i].condition;
				if (i < filters.length - 1) {
					sqlQuery += " AND ";
				}
			}
			log.debug("Applying filters for source "+sourceLabel+" '"+sqlQuery+"'");
			
			stmt = conn.createStatement();
			rs = stmt.executeQuery(sqlQuery);
			// add all matching nodes (id) with the source to the Set.
			while (rs.next()) {
				nodes.add(new Integer(rs.getInt(1)));
			}
			rs.close();
			stmt.close();
			conn.close();
		}catch(Exception e){
			throw new MapsException("Exception while getting nodes by source label "+e);
		}	
		return nodes;
	}

