    private Set<Integer> getAllNodes() throws MapsException {
        Connection conn = createConnection();
        Set<Integer> nodes = new HashSet<Integer>();
        Statement statement = null;
        ResultSet rs = null;
        try {
            String sqlQuery = "select distinct nodeid from ipinterface";
            statement = conn.createStatement();
            rs = statement.executeQuery(sqlQuery);
            // add all matching nodes (id) with the source to the Set.
            while (rs.next()) {
                nodes.add(new Integer(rs.getInt(1)));
            }
            rs.close();
            statement.close();
        } catch (Throwable e) {
            throw new MapsException("Exception while getting all nodes " + e);
        } finally {
            closeResultSet(rs);
            closeStatement(statement);
            releaseConnection(conn);
        }
        return nodes;
    }

