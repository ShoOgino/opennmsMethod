    @Override
    protected ModelAndView handleRequestInternal(HttpServletRequest req, HttpServletResponse resp) throws Exception {
    	
    	final String progressMonitorKey = "serveillanceViewProgressMonitor";

    	HttpSession session = req.getSession();
		ProgressMonitor progressMonitor = (ProgressMonitor) session.getAttribute(progressMonitorKey);
		if (progressMonitor == null) {
			progressMonitor = createProgressMonitor(req.getParameter("viewName"));
			session.setAttribute(progressMonitorKey, progressMonitor);
		}
		
		if (progressMonitor.isError()) {
			session.removeAttribute(progressMonitorKey);
			throw progressMonitor.getException();
		}
    	
    	if (progressMonitor.isFinished()) {
			session.removeAttribute(progressMonitorKey);
    		SurveillanceTable table = (SurveillanceTable)progressMonitor.getResult();
    		return new ModelAndView("surveillanceView", "webTable", table.getWebTable());
    	}
    	
    	return new ModelAndView("progressBar", "progress", progressMonitor);
    		
    }

