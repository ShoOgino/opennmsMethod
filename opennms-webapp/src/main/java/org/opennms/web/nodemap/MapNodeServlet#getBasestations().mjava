   private HashMap<Integer, NodeResult> getBasestations() throws SQLException {
        final DBUtils d = new DBUtils();
        Connection connection = null;
	HashMap<Integer, NodeResult> base_stations = 
	    new HashMap<Integer, NodeResult>();

        try {
	    PreparedStatement stmt;
	    ResultSet results;

            connection = DataSourceFactory.getInstance().getConnection();
            d.watch(connection);

	    stmt = connection.prepareStatement(GET_BS_QUERY);
	    stmt.setTimestamp(1, getNow());
	    stmt.setTimestamp(2, getYesterday());
            d.watch(stmt);

	    results = stmt.executeQuery();
            d.watch(results);

            if (results != null) {
                while (results.next()) {
		    BaseStationResult bs = new BaseStationResult(); 

		    bs.setNodeId(results.getInt(1));
                    bs.setNodeLabel(results.getString(2));
                    bs.setAvail(results.getDouble(3));
                    bs.setGeolocationLat(results.getDouble(4));
                    bs.setGeolocationLon(results.getDouble(5));
                    bs.setForeignId(results.getString(6));
                    bs.setType(NodeResult.NODE_TYPE_BASESTATION);
		    
		    base_stations.put(bs.getNodeId(), bs);
                }
            }
        } finally {
            d.cleanUp();
        }

       
        return base_stations;
    }

