    private HashMap<Integer, NodeResult> getCpes() throws  SQLException { 
        final DBUtils d = new DBUtils();
        Connection connection = null;
	HashMap<Integer, NodeResult> cpes = 
	    new HashMap<Integer, NodeResult>();

        try {
            PreparedStatement stmt;
	    ResultSet results;

            connection = DataSourceFactory.getInstance().getConnection();
            d.watch(connection);

	    stmt = connection.prepareStatement(GET_CPE_QUERY);
	    stmt.setTimestamp(1, getNow());
	    stmt.setTimestamp(2, getYesterday());
            d.watch(stmt);

	    results = stmt.executeQuery();
            d.watch(results);

            if (results != null) {
                while (results.next()) {
		    NodeResult cpe = new NodeResult(); 		   

		    cpe.setNodeId(results.getInt(1));
                    cpe.setNodeLabel(results.getString(2));
                    cpe.setAvail(results.getDouble(3));
                    cpe.setGeolocationLat(results.getDouble(4));
                    cpe.setGeolocationLon(results.getDouble(5));
                    cpe.setParentNodeId(results.getInt(6));
                    cpe.setForeignId(results.getString(7));
                    cpe.setType(NodeResult.NODE_TYPE_CPE);
		    
		    cpes.put(cpe.getNodeId(), cpe);
                }
            }
        } finally {
            d.cleanUp();
        }

        return cpes;
    }

