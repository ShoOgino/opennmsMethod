    private HashMap<Integer, NodeResult> getCategory(int category_id) throws  SQLException { 
        final DBUtils d = new DBUtils();
        Connection connection = null;
	HashMap<Integer, NodeResult> nodes = 
	    new HashMap<Integer, NodeResult>();

        try {
            PreparedStatement stmt;
	    ResultSet results;

            connection = DataSourceFactory.getInstance().getConnection();
            d.watch(connection);

	    if (category_id >= 0) {
		stmt = connection.prepareStatement(GET_CAT_QUERY);
	    } else {
		stmt = connection.prepareStatement(GET_UCAT_QUERY);
	    }
	    stmt.setTimestamp(1, getNow());
	    stmt.setTimestamp(2, getYesterday());

	    if (category_id >= 0) {
		stmt.setInt(3, category_id);
	    }
            d.watch(stmt);

	    results = stmt.executeQuery();
            d.watch(results);

            if (results != null) {
                while (results.next()) {
		    NodeResult node = new NodeResult(); 		   

		    node.setNodeId(results.getInt(1));
                    node.setNodeLabel(results.getString(2));
                    node.setAvail(results.getDouble(3));
                    node.setGeolocationLat(results.getDouble(4));
                    node.setGeolocationLon(results.getDouble(5));
                    node.setParentNodeId(results.getInt(6));
                    node.setForeignId(results.getString(7));
                    node.setType(NodeResult.NODE_TYPE_GENERAL);
		    
		    nodes.put(node.getNodeId(), node);
                }
            }
        } finally {
            d.cleanUp();
        }

        return nodes;
    }

