    /**
     * Acknowledge the events specified in the POST and then redirect the client
     * to an appropriate URL for display.
     */
    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    	if(request.isUserInRole( Authentication.READONLY_ROLE)) {
    		//ERROR: unauthorised user trying to access this servlet by surreptitious means
    		throw new ServletException("Unauthorized access to this servlet");
    	}
    	// required parameter
        String[] eventIdStrings = request.getParameterValues("event");
        String action = request.getParameter("action");

        if (eventIdStrings == null) {
            throw new MissingParameterException("event", new String[] { "event", "action" });
        }

        if (action == null) {
            throw new MissingParameterException("action", new String[] { "event", "action" });
        }

        // convert the event id strings to ints
        int[] eventIds = new int[eventIdStrings.length];
        for (int i = 0; i < eventIds.length; i++) {
            eventIds[i] = WebSecurityUtils.safeParseInt(eventIdStrings[i]);
        }

        try {
            if (action.equals(ACKNOWLEDGE_ACTION)) {
                EventFactory.acknowledge(eventIds, request.getRemoteUser());
            } else if (action.equals(UNACKNOWLEDGE_ACTION)) {
                EventFactory.unacknowledge(eventIds);
            } else {
                throw new ServletException("Unknown acknowledge action: " + action);
            }

            response.sendRedirect(this.getRedirectString(request));
        } catch (SQLException e) {
            throw new ServletException("Database exception", e);
        }
    }

