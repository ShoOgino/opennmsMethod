    @Override
    public Map<OnmsMonitoredService, Map<String, Double>> getApplicationServiceStatus(final OnmsApplication onmsApplication, final long start, final long end) {
        final Map<OnmsMonitoredService, Map<String, Double>> status = new TreeMap<>();
        final Collection<OnmsOutage> outages = m_outageDao.getStatusChangesForApplicationIdBetween(new Date(start), new Date(end), onmsApplication.getId());

        for(final OnmsMonitoredService onmsMonitoredService : onmsApplication.getMonitoredServices()) {
            final Map<String, Double> serviceStatus = new TreeMap<>();

            final ApplicationServiceStatus applicationServiceStatus = ApplicationStatusUtil.buildApplicationServiceStatus(
                    m_monSvcDao,
                    onmsApplication,
                    onmsMonitoredService.getId(),
                    outages,
                    start,
                    end
            );

            for(final Location location : applicationServiceStatus.getLocations()) {
                serviceStatus.put(location.getName(), location.getAggregatedStatus());
            }

            status.put(onmsMonitoredService, serviceStatus);
        }

        return status;
    }

