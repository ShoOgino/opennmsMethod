    /**
     * Returns all non-deleted nodes with a MAC address like the rule given from AtInterface.
     */

    public static Node[] getNodesWithPhysAddrAtInterface(String macAddr)
			throws SQLException {
		if (macAddr == null) {
			throw new IllegalArgumentException("Cannot take null parameters.");
		}

		Node[] nodes = null;
		Connection conn = Vault.getDbConnection();

		try {
            StringBuffer buffer = new StringBuffer("%");
            buffer.append(macAddr);
            buffer.append("%");

            PreparedStatement stmt = conn
					.prepareStatement("SELECT DISTINCT * FROM node WHERE nodetype != 'D' " +
							"AND nodeid IN (SELECT nodeid FROM atinterface WHERE atphysaddr LIKE '% ? %') ORDER BY nodelabel");

			stmt.setString(1, buffer.toString());
			ResultSet rs = stmt.executeQuery();

			nodes = rs2Nodes(rs);

			rs.close();
			stmt.close();
		} finally {
			Vault.releaseDbConnection(conn);
		}

		return nodes;
	}

