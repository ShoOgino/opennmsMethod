    private String processValidate(final HttpServletRequest request, final HttpSession user) {
        final String userAction = request.getParameter("userAction");

        if ("rebuild".equals(userAction)) {
            final Map<String, Object> params = new HashMap<String, Object>();
            params.put("newRule", request.getParameter("newRule"));
            final String[] services = request.getParameterValues("services");
            if (services != null) {
                params.put("services", services);
            }
            params.put("mode", "rebuild");

            return SOURCE_PAGE_RULE + makeQueryString(params);
        } else {
            final Notification newNotice = (Notification) user.getAttribute("newNotice");
            Rule rule = new Rule();
            rule.setContent(request.getParameter("newRule"));
            newNotice.setRule(rule);
            return SOURCE_PAGE_PATH;
        }
    }

