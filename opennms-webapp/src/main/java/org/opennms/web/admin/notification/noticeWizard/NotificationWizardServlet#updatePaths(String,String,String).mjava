    private void updatePaths(String rule, String criticalIp, String criticalSvc)
                                 throws FilterParseException, SQLException {
        Connection conn = Vault.getDbConnection();
        SortedMap<Integer, String> nodes = getFilterDao().getNodeMap(rule);
        try {
            Iterator<Integer> i = nodes.keySet().iterator();
            while (i.hasNext()) {
                Integer key = i.next();
                deleteCriticalPath(key.intValue(), conn);
                if (criticalIp != null && !criticalIp.equals("")) {
                    setCriticalPath(key.intValue(), criticalIp, criticalSvc, conn);
                }
            }
        } finally {
            Vault.releaseDbConnection(conn);
        }
    }

