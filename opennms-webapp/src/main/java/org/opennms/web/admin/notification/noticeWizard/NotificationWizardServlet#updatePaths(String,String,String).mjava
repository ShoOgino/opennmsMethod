    private void updatePaths(final String rule, final String criticalIp, final String criticalSvc) throws FilterParseException, SQLException {
        final Connection conn = DataSourceFactory.getInstance().getConnection();
        final DBUtils d = new DBUtils(getClass(), conn);
        try {
            final SortedMap<Integer, String> nodes = getFilterDao().getNodeMap(rule);
            for (final Map.Entry<Integer, String> entry : nodes.entrySet()) {
                final int key = entry.getKey().intValue();
                deleteCriticalPath(key, conn);
                if (criticalIp != null && !"".equals(criticalIp)) {
                    setCriticalPath(key, criticalIp, criticalSvc, conn);
                }
            }
        } finally {
            d.cleanUp();
        }
    }

