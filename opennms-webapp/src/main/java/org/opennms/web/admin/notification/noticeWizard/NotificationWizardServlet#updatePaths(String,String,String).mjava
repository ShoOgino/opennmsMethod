    private void updatePaths(String rule, String criticalIp, String criticalSvc)
                                 throws FilterParseException, SQLException {
        Connection conn = Vault.getDbConnection();
        StringBuffer buffer = new StringBuffer();
        Filter filter = new Filter();
	SortedMap nodes = filter.getNodeMap(rule);
        try {
            Iterator i = nodes.keySet().iterator();
            while(i.hasNext()) {
                Integer key = (Integer)i.next();
                deleteCriticalPath(key.intValue(), conn);
                if(criticalIp != null && !criticalIp.equals("")) {
                    setCriticalPath(key.intValue(), criticalIp, criticalSvc, conn);
                }
            }
        } finally {
            Vault.releaseDbConnection(conn);
        }
    }

