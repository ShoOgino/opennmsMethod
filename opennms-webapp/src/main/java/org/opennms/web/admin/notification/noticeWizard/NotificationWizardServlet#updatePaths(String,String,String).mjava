    private void updatePaths(String rule, String criticalIp, String criticalSvc)
            throws FilterParseException, SQLException {
        final Connection conn = Vault.getDbConnection();
        final DBUtils d = new DBUtils(getClass(), conn);
        try {
            SortedMap<Integer, String> nodes = getFilterDao().getNodeMap(rule);
            Iterator<Integer> i = nodes.keySet().iterator();
            while (i.hasNext()) {
                Integer key = i.next();
                deleteCriticalPath(key.intValue(), conn);
                if (criticalIp != null && !criticalIp.equals("")) {
                    setCriticalPath(key.intValue(), criticalIp, criticalSvc, conn);
                }
            }
        } finally {
            d.cleanUp();
        }
    }

