    /**
     * Convenience method for getting the SQL WHERE clause related to a given
     * resolution type.
     *
     * @param resType
     *            the resolution type to map to a clause
     * @return a {@link java.lang.String} object.
     */
    protected static String getResolutionTypeClause(ResolutionType resType) {
        if (resType == null) {
            throw new IllegalArgumentException("Cannot take null parameters.");
        }

        String clause = null;

        switch (resType.getId()) {
        case ResolutionType._RESOLVED:
            clause = " RESOLVEDTIME IS NOT NULL";
            break;

        case ResolutionType._OPEN:
            clause = " RESOLVEDTIME IS NULL";
            break;

        case ResolutionType._BOTH:
            clause = " TRUE"; // gets both
            break;

        default:
            throw new IllegalArgumentException("Unknown VulnerabilityFactory.ResolutionType: " + resType.getName());
        }

        return clause;
    }

