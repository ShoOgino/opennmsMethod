	@Transactional
	private LldpLinkNode convertFromModel(int nodeid, LldpLink link) {

                LldpLinkNode linknode = new LldpLinkNode();
                linknode.setLldpPortString(getPortString(link.getLldpPortId(), link.getLldpPortIdSubType()));
                linknode.setLldpPortDescr(link.getLldpPortDescr());
                linknode.setLldpPortUrl(getSnmpInterfaceUrl(Integer.valueOf(nodeid), link.getLldpPortIfindex()));

                linknode.setLldpRemSysName(link.getLldpRemSysname());
                linknode.setLldpRemPortString(getPortString(link.getLldpRemPortId(), link.getLldpRemPortIdSubType()));
                linknode.setLldpRemPortDescr(link.getLldpRemPortDescr());

                linknode.setLldpCreateTime(Util.formatDateToUIString(link.getLldpLinkCreateTime()));
                linknode.setLldpLastPollTime(Util.formatDateToUIString(link.getLldpLinkLastPollTime()));
		
                OnmsNode remNode = null; 
                
                List<LldpElement> lldpremelements= m_lldpElementDao.findByChassisId(link.getLldpRemChassisId(),link.getLldpRemChassisIdSubType());
                
                if (lldpremelements.size() == 1) {
                    remNode = lldpremelements.get(0).getNode();
                } else if (lldpremelements.size() > 1) {
                    linknode.setLldpRemChassisIdString(getChassisIdString("Found " + lldpremelements.size() + " nodes for", link.getLldpRemChassisId(), link.getLldpRemChassisIdSubType()));
                    return linknode;
                } else {
                    final Criteria criteria = new Criteria(OnmsNode.class).addRestriction(new EqRestriction("sysName", link.getLldpRemSysname()));
                    List<OnmsNode> nodes = m_nodeDao.findMatching(criteria);
                    if (nodes.size() == 1) 
                        remNode=nodes.get(0);
                }
                
                if (remNode != null) {
                    linknode.setLldpRemChassisIdString(getChassisIdString(remNode.getLabel(), link.getLldpRemChassisId(), link.getLldpRemChassisIdSubType()));
                    linknode.setLldpRemChassisIdUrl(getNodeUrl(remNode.getId()));
                    if (link.getLldpRemPortIdSubType() == LldpPortIdSubType.LLDP_PORTID_SUBTYPE_LOCAL) {
                        try {
                            Integer remIfIndex = Integer.getInteger(link.getLldpRemPortId());
                            linknode.setLldpRemPortUrl(getSnmpInterfaceUrl(Integer.valueOf(remNode.getId()), remIfIndex));
                        } catch (Exception e) {
                        }
                    }
                } else {
                    linknode.setLldpRemChassisIdString(getChassisIdString(link.getLldpRemChassisId(), link.getLldpRemChassisIdSubType()));
                }
		return linknode;
	}

