    private void addDataSource(GraphDefinition graphDef, DataSource ds) {
        if (graphDef != null ) {
            
            int i = 0;
            boolean alreadyExists = false;
//            GraphDataElement gde;
            for (Iterator iter = graphDef.getGraphDataElements().iterator(); iter.hasNext();) {
				GraphDataElement gde = (GraphDataElement) iter.next();
				
                org.opennms.secret.model.DataSource dataSource = (org.opennms.secret.model.DataSource) gde.getDataSource();
                
                if (ds.equals(dataSource)) {
                    alreadyExists = true;
                    break;
                }
                i++;
            }
            
            if (!alreadyExists) {	
                GraphDataLine gdl = new GraphDataLine(null);
                gdl.setDataSource(ds);
                graphDef.addGraphDataElement(gdl);
            }
        }
    }

