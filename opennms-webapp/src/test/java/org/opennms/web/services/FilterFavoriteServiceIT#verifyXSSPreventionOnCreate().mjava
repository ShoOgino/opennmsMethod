    @Test
    public void verifyXSSPreventionOnCreate() throws FilterFavoriteService.FilterFavoriteException {
        final String maliciousName = "test<script>alert(123);</script>";
        final String maliciousFilter = "filter=severity=6<script>alert(123);</script>";

        for (Page page : Page.values()) {
            // try to create malicious favorites
            OnmsFilterFavorite favorite = service.createFavorite("ulf", maliciousName, maliciousFilter, page);

            // verify that filter name and criteria are not vulnerable to xss
            Assert.assertEquals(WebSecurityUtils.sanitizeString(maliciousName), favorite.getName());
            Assert.assertEquals(WebSecurityUtils.sanitizeString(maliciousFilter), favorite.getFilter());
        }
    }

