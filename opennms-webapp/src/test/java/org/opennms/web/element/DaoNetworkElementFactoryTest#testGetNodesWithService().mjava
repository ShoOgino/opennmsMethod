    @Test
    public void testGetNodesWithService() {
        assertEquals(6, getNetworkElementFactory().getNodesWithService(1).length);
        
        OnmsServiceType svcType = new OnmsServiceType("Service1");
        ServiceTypeDao svcDao = m_dbPopulator.getServiceTypeDao();
        svcDao.save(svcType);
        
        OnmsNode node1 = m_dbPopulator.getNode1();
        
        OnmsIpInterface iface = new OnmsIpInterface("172.20.1.1", node1);
        IpInterfaceDao ifaceDao = m_dbPopulator.getIpInterfaceDao();
        ifaceDao.save(iface);
        
        OnmsMonitoredService monSvc = new OnmsMonitoredService(iface, svcType);
        MonitoredServiceDao monSvcDao = m_dbPopulator.getMonitoredServiceDao();
        monSvcDao.save(monSvc);
        
        assertEquals(1, getNetworkElementFactory().getNodesWithService(4).length);
        
    }

