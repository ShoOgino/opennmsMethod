    public void doSingleAuthority(String in, String out) {
        UserAttributeLdapAuthoritiesPopulator populator = init();
        
        LdapUserDetails userDetails = createMock(LdapUserDetails.class);
        Attributes attributes = new BasicAttributes(s_userAttribute, in, true);
        expect(userDetails.getDn()).andReturn(s_dn).anyTimes();
        expect(userDetails.getAttributes()).andReturn(attributes);
        
        replay(userDetails);
        GrantedAuthority[] authorities =
            populator.getGrantedAuthorities(userDetails);
        verify(userDetails);
        
        assertNotNull("GrantedAuthority[] list returned from "
                      + "getGrantedAuthorities cannot be null", authorities);
        assertEquals("Incorrect number of entries in the GrantedAuthority list",
                     1, authorities.length); 
        assertEquals("User that we were expecting", out, authorities[0].getAuthority());
    }

