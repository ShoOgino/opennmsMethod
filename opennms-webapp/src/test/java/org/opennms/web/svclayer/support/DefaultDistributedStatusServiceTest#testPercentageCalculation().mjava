    public void testPercentageCalculation() {
        OnmsMonitoredService httpService = findMonitoredService(m_services, m_ip, "HTTP");
        OnmsMonitoredService httpsService = findMonitoredService(m_services, m_ip, "HTTPS");

        Collection<OnmsLocationSpecificStatus> statuses = new HashSet<OnmsLocationSpecificStatus>();
        statuses.add(createStatus(m_locationMonitor1, httpService, PollStatus.available(), "20061011-00:00:00"));
        statuses.add(createStatus(m_locationMonitor1, httpService, PollStatus.available(), "20061012-00:00:00"));
        statuses.add(createStatus(m_locationMonitor1, httpsService, PollStatus.available(), "20061012-06:00:00"));
        statuses.add(createStatus(m_locationMonitor1, httpService, PollStatus.available(), "20061013-00:00:00"));

        Date startDate = new Date(2006 - 1900, 10 - 1, 12, 0, 0, 0);
        Date endDate = new Date(2006 - 1900, 10 - 1, 13, 0, 0, 0);

        expect(m_locationMonitorDao.getStatusChangesBetween(startDate, endDate)).andReturn(statuses);


        replayEverything();
        String percentage =
            m_service.calculatePercentageUptime(m_locationMonitor1,
                                                m_application1.getMemberServices(),
                                                startDate,
                                                endDate);
        verifyEverything();
        
        assertEquals("percentage", "75.000%", percentage);
    }

