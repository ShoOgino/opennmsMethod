    public void testDetails() {
        List<OnmsMonitoringLocation> locationDefinitions = new LinkedList<>();
        locationDefinitions.add(m_locationDefinition1);
        locationDefinitions.add(m_locationDefinition2);
        locationDefinitions.add(m_locationDefinition3);
        expect(m_monitoringLocationDao.findAll()).andReturn(locationDefinitions);
        
        List<OnmsApplication> applications = new ArrayList<>();
        applications.add(m_application1);
        applications.add(m_application2);
        expect(m_applicationDao.findAll()).andReturn(applications);
        
        expect(m_monitoringLocationDao.get("Durham")).andReturn(m_locationDefinition2);
        expect(m_applicationDao.findByName("Application 2")).andReturn(m_application2);
        
        List<OnmsMonitoringLocation> monitors = new ArrayList<>();
        monitors.add(m_locationDefinition2);

        for (OnmsMonitoredService service : m_applicationServices2) {
            m_locationSpecificStatusDao.initialize(service.getIpInterface());
            m_locationSpecificStatusDao.initialize(service.getIpInterface().getNode());
        }
        
        String locationName = m_locationDefinition2.getLocationName();
        String applicationName = m_application2.getName();
        String monitorId = "";
        String timeSpan = "Last Day";
        String previousLocation = "";
        
        expect(m_monitoredServiceDao.findByApplication(m_application2)).andReturn(m_applicationServices2).times(2);
        
        expectResourceDaoCall(m_locationDefinition2, m_applicationServices2);
        
        m_easyMockUtils.replayAll();
        DistributedStatusHistoryModel summary =  m_service.createHistoryModel(locationName, monitorId, applicationName, timeSpan, previousLocation);
        m_easyMockUtils.verifyAll();
        
        assertNotNull("summary should not be null", summary);
        assertNotNull("summary locations list should not be null", summary.getLocations());
        assertNotNull("summary applications list should not be null", summary.getApplications());
        assertNotNull("summary chosen location should not be null", summary.getChosenLocation());
        assertNotNull("summary chosen application should not be null", summary.getChosenApplication());
        assertNotNull("summary error list should not be null", summary.getErrors());
        
        assertEquals("summary locations list size", locationDefinitions.size(), summary.getLocations().size());
        assertEquals("summary applications list size", applications.size(), summary.getApplications().size());
        assertEquals("summary error list size: " + summary.getErrors(), 0, summary.getErrors().size());
        
        // Verify sorting of applications
        assertEquals("summary applications 1", m_application1, summary.getApplications().get(0));
        assertEquals("summary applications 2", m_application2, summary.getApplications().get(1));
        
        // Verify chosen ones
        assertEquals("summary chosen location", m_locationDefinition2, summary.getChosenLocation());
        assertEquals("summary chosen application", m_application2, summary.getChosenApplication());
        
        // And verify that they are in the lists in the right place
        assertEquals("summary chosen location matches list", summary.getLocations().get(1), summary.getChosenLocation());
        assertEquals("summary chosen application matches list", summary.getApplications().get(1), summary.getChosenApplication());
        
        assertEquals("graph URL map size", 1, summary.getServiceGraphs().size());
        assertNotNull("graph 0 URL should not be null", summary.getServiceGraphs().iterator().next().getUrl());
    }

