    protected void createUser(final String username) throws Exception {
        final String previousUser = getUser();
        final Collection<String> previousRoles = getUserRoles();

        clearUserInfo();
        setUser("admin");
        addUserRole("ROLE_ADMIN");

        String user = "<user>" +
                "<user-id>" + username + "</user-id>" +
                "<full-name>" + username + " Full Name</full-name>" +
                "<user-comments>Autogenerated by a unit test...</user-comments>" +
                "<password>" + PASSWORD + "</password>" +
                "</user>";
        sendPost("/users", user, 303, "/users/" + username);

        clearUserInfo();
        setUser(previousUser);
        for (final String role : previousRoles) {
            addUserRole(role);
        }
    }

