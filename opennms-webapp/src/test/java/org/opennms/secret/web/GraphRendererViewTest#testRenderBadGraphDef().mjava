    @Test
    public void testRenderBadGraphDef() throws Exception {
        boolean gotException = false;
        
        m_session.setAttribute("graphDef", "not a graphDef");
        
        try {
            m_view.render(new HashMap(), m_request, m_response);
        } catch (IllegalStateException e) {
            assertEquals("Received IllegalStateException as expected; getMessage() on exception does not match",
                    "\"graphDef\" session attribute is not an instance of " +
                    GraphDefinition.class.getName(),
                    e.getMessage());
            gotException = true;
        }
        
        if (!gotException) {
            fail("Expected IllegalStateException, but did not receive it");
        }
    }

