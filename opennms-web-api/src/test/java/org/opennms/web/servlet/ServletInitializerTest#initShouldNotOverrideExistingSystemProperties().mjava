    /**
     * Verifies that {@link ServletInitializer#init} does not override existing
     * system properties.
     *
     * @throws ServletException
     */
    @Test
    public void initShouldNotOverrideExistingSystemProperties() throws ServletException {
        // Set a system property to a known value
        System.setProperty("x", "x");

        // Now mock the context and mock the version.properties file to contain
        // two system properties
        String properties = "x = !x\n" + "y = y";
        ServletContext context = mock(ServletContext.class);
        when(context.getResourceAsStream("/WEB-INF/version.properties"))
                .thenReturn(new ByteArrayInputStream(properties.getBytes()));
        when(context.getInitParameterNames()).thenReturn(Collections.emptyEnumeration());

        // Init
        ServletInitializer.init(context);

        // "x" should retain it's original value
        assertEquals("x", System.getProperty("x"));
        // "y" should be set
        assertEquals("y", System.getProperty("y"));
    }

