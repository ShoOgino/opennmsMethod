	@Test
	public void testBeanSanitizerWithHtmlAllowList() {
		CommandBeanMockup bean = new CommandBeanMockup();
		HashSet<String> set = new HashSet<String>();
		set.add("htmltable");
		bean = (CommandBeanMockup) WebSecurityUtils
				.sanitizeBeanStringProperties(bean, set);

		assertTrue("Script property is sanitized no Html allowed",
				WebSecurityUtils.sanitizeString("<script>foo</script>", false)
						.equals(bean.getScript()));
		assertTrue("Not, Script property is sanitized with Html allowed",
				!WebSecurityUtils.sanitizeString("<script>foo</script>", true)
						.equals(bean.getScript()));

		assertTrue(
				"HtmlTable is sanitzied with Html allowed so, no changes",
				WebSecurityUtils.sanitizeString("<table>", true).equals(
						bean.getHtmlTable()));
		assertTrue(
				"Not, HtmlTable is sanitized and html removed",
				!WebSecurityUtils.sanitizeString("<table>", false).equals(
						bean.getHtmlTable()));
	}

