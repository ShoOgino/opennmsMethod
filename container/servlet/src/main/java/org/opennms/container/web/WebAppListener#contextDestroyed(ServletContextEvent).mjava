    @Override
    public void contextDestroyed(ServletContextEvent sce) {
        try {
            this.log("removing Karaf bundle context from OpenNMS OSGi bridge");
            m_bridge.stop(m_framework);
            // TODO unregister services form both registries when the osgi container stops

            this.log("stopping Karaf");
            if (main != null) {
                main.destroy();
            }
            this.log("Karaf stopped");
        } catch (final Throwable e) {
            this.log("unexpected exception while stopping Karaf", e);
            e.printStackTrace();
        }
    }

