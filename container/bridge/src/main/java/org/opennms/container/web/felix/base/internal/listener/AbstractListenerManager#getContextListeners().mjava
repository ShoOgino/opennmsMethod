    protected final Iterator<T> getContextListeners()
    {
        List<T> result = allContextListeners;
        if (result == null)
        {
            synchronized (lock)
            {
                if (allContextListeners == null)
                {
                    @SuppressWarnings("unchecked") // Because of OSGi API
                    T[] services = (T[])getServices();
                    if (services != null && services.length > 0)
                    {
                        result = new ArrayList<T>(services.length);
                        for (T service : services)
                        {
                            result.add(service);
                        }
                    }
                    else
                    {
                        result = new ArrayList<T>(0);
                    }
                    this.allContextListeners = result;
                }
                else
                {
                    result = this.allContextListeners;
                }
            }
        }
        return result.iterator();
    }

