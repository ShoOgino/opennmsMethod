    @Override
    protected void doFilter(HttpServletRequest req, HttpServletResponse res)
        throws IOException, ServletException
    {
        this.index++;

        if (this.index < this.handlers.length) {
            this.handlers[this.index].handle(req, res, this);
        } else {
            if (!this.servletPipeline.handle(req, res)) {
                this.proceedingChain.doFilter(req, res);
            }
        }
    }

