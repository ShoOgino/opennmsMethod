    @Test
    public void testCount() {
        final OnmsCriteria criteria = new OnmsCriteria(OnmsAlarm.class);

        criteria.setFetchMode("firstEvent", FetchMode.JOIN);
        criteria.setFetchMode("lastEvent", FetchMode.JOIN);
        
        criteria.createAlias("node", "node", CriteriaSpecification.LEFT_JOIN);
        criteria.createAlias("node.snmpInterfaces", "snmpInterface", CriteriaSpecification.LEFT_JOIN);
        criteria.createAlias("node.ipInterfaces", "ipInterface", CriteriaSpecification.LEFT_JOIN);

        criteria.setProjection(
                               Projections.distinct(
                                   Projections.projectionList().add(
                                       Projections.alias( Projections.property("id"), "id" )
                                   )
                               )
                           );

        OnmsCriteria rootCriteria = new OnmsCriteria(OnmsAlarm.class);
        rootCriteria.add(Subqueries.propertyIn("id", criteria.getDetachedCriteria()));
        // rootCriteria.addOrder(Order.desc("lastEventTime"));
        // rootCriteria.setMaxResults(1);
        // rootCriteria.setFirstResult(0);

        final int count = m_statisticsService.getTotalCount(rootCriteria);
        assertEquals(1, count);
    }

