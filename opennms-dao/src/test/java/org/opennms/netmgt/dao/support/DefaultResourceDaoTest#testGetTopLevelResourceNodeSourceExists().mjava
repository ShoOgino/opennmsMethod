    @Test
    public void testGetTopLevelResourceNodeSourceExists() throws Exception {
        OnmsNode node = createNode();
        expect(m_nodeDao.findByForeignId("source1", "123")).andReturn(node).times(1);

        File responseDir = m_fileAnticipator.tempDir("snmp");
        File forSrcDir = m_fileAnticipator.tempDir(responseDir, "fs");
        File sourceDir = m_fileAnticipator.tempDir(forSrcDir, "source1");
        File idDir = m_fileAnticipator.tempDir(sourceDir, "123");
        m_fileAnticipator.tempFile(idDir, "foo" + RrdUtils.getExtension());

        m_easyMockUtils.replayAll();
        OnmsResource resource = m_resourceDao.getResourceById(String.format("nodeSource[source1:123]", node.getId()));
        m_easyMockUtils.verifyAll();

        assertNotNull("Resource should not be null", resource);
    }

