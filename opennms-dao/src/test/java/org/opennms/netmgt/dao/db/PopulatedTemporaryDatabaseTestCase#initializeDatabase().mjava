    protected void initializeDatabase() throws Exception {
        if (!isEnabled()) {
            return;
        }
        
        installerDb = new InstallerDb();

        // Create a ByteArrayOutputSteam to effectively throw away output.
        resetOutputStream();
        installerDb.setDatabaseName(getTestDatabase());
        installerDb.setDataSource(getDataSource());
        
        installerDb.setCreateSqlLocation(
            "../opennms-daemon/src/main/filtered/etc/create.sql");

        installerDb.setStoredProcedureDirectory(
            "../opennms-daemon/src/main/filtered/etc");

        //installerDb.setDebug(true);

        installerDb.readTables();
        
        installerDb.createSequences();
        installerDb.updatePlPgsql();
        installerDb.addStoredProcedures();
        
        installerDb.createTables();

        installerDb.closeConnection();
    }

