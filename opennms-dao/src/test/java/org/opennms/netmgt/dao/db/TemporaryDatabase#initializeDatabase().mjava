    private void initializeDatabase() throws Exception {
        m_installerDb = new InstallerDb();

        // Create a ByteArrayOutputSteam to effectively throw away output.
        resetOutputStream();
        m_installerDb.setDatabaseName(getTestDatabase());
        m_installerDb.setDataSource(getDataSource());

        m_installerDb.setCreateSqlLocation(ConfigurationTestUtils.getFileForConfigFile("create.sql").getAbsolutePath());

        m_installerDb.setStoredProcedureDirectory(ConfigurationTestUtils.getFileForConfigFile("create.sql").getParentFile().getAbsolutePath());

        // installerDb.setDebug(true);

        m_installerDb.readTables();

        m_installerDb.createSequences();
        m_installerDb.updatePlPgsql();
        m_installerDb.addStoredProcedures();

        /*
        * Here's an example of an iplike function that always returns true.
        * CREATE OR REPLACE FUNCTION iplike(text, text) RETURNS bool AS ' BEGIN
        * RETURN true; END; ' LANGUAGE 'plpgsql';
        *
        * Found this in BaseIntegrationTestCase.
        */

        if (isSetupIpLike()) {
            if (!m_installerDb.isIpLikeUsable()) {
                m_installerDb.setupPlPgsqlIplike();
            }
        }

        m_installerDb.createTables();
        m_installerDb.insertData();
        m_installerDb.closeConnection();

    }

