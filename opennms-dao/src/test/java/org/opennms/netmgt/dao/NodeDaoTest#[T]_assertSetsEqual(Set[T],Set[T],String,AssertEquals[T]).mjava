    private <T> void assertSetsEqual(Set<T> expectedSet, Set<T> actualSet, String orderProperty, AssertEquals<T> comparer) throws Exception {
    	SortedSet<T> expectedSorted = new TreeSet<T>(new PropertyComparator(orderProperty));
    	expectedSorted.addAll(expectedSet);
    	SortedSet<T> actualSorted = new TreeSet<T>(new PropertyComparator(orderProperty));
    	actualSorted.addAll(actualSet);

    	Iterator<T> expected = expectedSorted.iterator();
    	Iterator<T> actual = actualSorted.iterator();

    	while(expected.hasNext() && actual.hasNext()) {
    		comparer.assertEqual(expected.next(), actual.next());
    	}

    	if (expected.hasNext())
    		fail("Missing item "+expected.next()+" in the actual list");

    	if (actual.hasNext())
    		fail("Unexpected item "+actual.next()+" in the actual list");
    }

