    public void testGetMatchingOutages() {
        insertEntitiesAndOutage("172.16.1.1", "ICMP");
        
        /*
         * We need to flush and finish the transaction because JdbcFilterDao
         * gets its own connection from the DataSource and won't see our data
         * otherwise.
         */
        flushOutageDaoAndStartNewTransaction();
        
        String[] svcs = new String[] { "ICMP" };
        ServiceSelector selector = new ServiceSelector("ipAddr IPLIKE 172.16.1.1", Arrays.asList(svcs));
    	Collection<OnmsOutage> outages = getOutageDao().matchingCurrentOutages(selector);
    	assertEquals("outage count", 1, outages.size());
    }

