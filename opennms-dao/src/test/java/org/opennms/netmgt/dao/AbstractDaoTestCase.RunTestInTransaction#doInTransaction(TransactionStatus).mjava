        public Object doInTransaction(TransactionStatus ts) {
            try {
                AbstractDaoTestCase.super.runTest();
            } catch (RuntimeException e) {
                ts.setRollbackOnly();
                throw e;
            } catch (AssertionFailedError e) {
                ts.setRollbackOnly();
                throw e;
            } catch (Throwable e) {
                ts.setRollbackOnly();
                e.printStackTrace();
                fail("Unexpected throwable! "+e);
            }
            return null;
        }

