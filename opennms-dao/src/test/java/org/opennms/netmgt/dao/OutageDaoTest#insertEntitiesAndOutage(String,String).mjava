    private OnmsOutage insertEntitiesAndOutage(final String ipAddr, final String serviceName) {
        OnmsNode node = new OnmsNode(getLocalHostDistPoller());
        getNodeDao().save(node);

        OnmsIpInterface ipInterface = getIpInterface(ipAddr, node);
        OnmsServiceType serviceType = getServiceType(serviceName);
        OnmsMonitoredService monitoredService = getMonitoredService(ipInterface, serviceType);
        
        OnmsEvent event = getEvent();

        OnmsOutage outage = getOutage(monitoredService, event);
        
        return outage;
    }

