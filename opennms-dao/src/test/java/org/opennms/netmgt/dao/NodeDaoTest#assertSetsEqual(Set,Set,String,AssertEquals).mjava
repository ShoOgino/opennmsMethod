    @SuppressWarnings("unchecked")
	private void assertSetsEqual(Set expectedSet, Set actualSet, String orderProperty, AssertEquals comparer) throws Exception {
    	SortedSet expectedSorted = new TreeSet(new PropertyComparator(orderProperty));
    	expectedSorted.addAll(expectedSet);
    	SortedSet actualSorted = new TreeSet<OnmsIpInterface>(new PropertyComparator(orderProperty));
    	actualSorted.addAll(actualSet);

    	Iterator expected = expectedSorted.iterator();
    	Iterator actual = actualSorted.iterator();

    	while(expected.hasNext() && actual.hasNext()) {
    		comparer.assertEqual(expected.next(), actual.next());
    	}

    	if (expected.hasNext())
    		fail("Missing item "+expected.next()+" in the actual list");

    	if (actual.hasNext())
    		fail("Unexpected item "+actual.next()+" in the actual list");
    }

