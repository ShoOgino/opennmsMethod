    /**
     * <p>isExcluded</p>
     *
     * @param address a {@link java.net.InetAddress} object.
     * @return a boolean.
     */
    public boolean isExcluded(final InetAddress address) {
        getReadLock().lock();
        
        try {
            final List<ExcludeRange> excludeRange = getConfiguration().getExcludeRangeCollection();
            if (excludeRange != null) {
                final byte[] laddr = address.getAddress();
        
                for (final ExcludeRange range : excludeRange) {
                    try {
                        byte[] begin = InetAddress.getByName(range.getBegin()).getAddress();
                        byte[] end = InetAddress.getByName(range.getEnd()).getAddress();
                        ByteArrayComparator comparator = new ByteArrayComparator();
                        int beginComp = comparator.compare(begin, laddr);
                        int endComp = comparator.compare(laddr, end);
                        if (beginComp <= 0 && endComp <= 0) {
                            return true;
                        }
                    } catch (final UnknownHostException ex) {
                        LogUtils.debugf(this, ex, "isExcluded: failed to convert exclusion address to InetAddress");
                    }
                }
            }
            return false;
        } finally {
            getReadLock().unlock();
        }
    }

