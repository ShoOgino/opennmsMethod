    /**
     * Saves the current in-memory configuration to disk and reloads
     */
    public synchronized void saveCurrent() throws MarshalException, IOException, ValidationException {
        File cfgFile = ConfigFileConstants.getFile(ConfigFileConstants.COLLECTD_CONFIG_FILE_NAME);

        /*
         * marshall to a string first, then write the string to the file. This
         * way the original config
         * isn't lost if the xml from the marshall is hosed.
         */
        StringWriter stringWriter = new StringWriter();
        Marshaller.marshal(m_collectdConfig.getConfig(), stringWriter);
        if (stringWriter.toString() != null) {
            FileWriter fileWriter = new FileWriter(cfgFile);
            fileWriter.write(stringWriter.toString());
            fileWriter.flush();
            fileWriter.close();
        }

        reload();
    }

