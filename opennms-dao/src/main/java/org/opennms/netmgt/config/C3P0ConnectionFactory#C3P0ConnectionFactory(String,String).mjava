    protected C3P0ConnectionFactory(String configFile, String dsName) throws IOException, MarshalException, ValidationException, PropertyVetoException, SQLException {
        /*
         * Set the system identifier for the source of the input stream.
         * This is necessary so that any location information can
         * positively identify the source of the error.
         */
        FileInputStream fileInputStream = new FileInputStream(configFile);
        log().info("C3P0ConnectionFactory: setting up data sources from:"+configFile);
        try {
            JdbcDataSource ds = marshalDataSourceFromConfig(fileInputStream, dsName);
            initializePool(ds);
        } finally {
            IOUtils.closeQuietly(fileInputStream);
        }
    }

