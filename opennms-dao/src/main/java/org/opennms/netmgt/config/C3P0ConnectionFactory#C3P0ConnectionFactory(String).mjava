    public C3P0ConnectionFactory(String configFile) throws IOException, MarshalException, ValidationException, PropertyVetoException, SQLException {
        Class dsc = Database.class;

        // Set the system identifier for the source of the input stream.
        // This is necessary so that any location information can
        // positively identify the source of the error.
        //
        FileInputStream fileInputStream = new FileInputStream(configFile);
		try {
			InputSource dbIn = new InputSource(fileInputStream);
			dbIn.setSystemId(configFile);

			m_database = (Database) Unmarshaller.unmarshal(dsc, dbIn);
			Param[] params = m_database.getDatabaseChoice().getDriver().getParam();
			for (Iterator it = Arrays.asList(params).iterator(); it.hasNext();) {
			    Param param = (Param) it.next();
			    if (param.getName().equals("user")) {
			        m_user = param.getValue();
			    } else if (param.getName().equals("password")) {
			        m_password = param.getValue();
			    }
			}

			initializePool();
		} finally {
			fileInputStream.close();
		}
        
    }

