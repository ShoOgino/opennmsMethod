    private Set<Integer> findRelatedAlarms(int[] alarmIds) {
        final Set<Integer> allAlarmIds = new HashSet<>();
        Set<Integer> toBeChecked = Sets.newHashSet(ArrayUtils.toObject(alarmIds));

        do {
            allAlarmIds.addAll(toBeChecked);

            final Set<Integer> relatedAlarms = toBeChecked.stream()
                    .map(i -> getAlarm(i))
                    .filter(o -> o.isSituation())
                    .flatMap(o -> o.getRelatedAlarmIds().stream())
                    .collect(Collectors.toSet());

            toBeChecked = relatedAlarms;
        } while (!toBeChecked.isEmpty());

        return allAlarmIds;
    }

