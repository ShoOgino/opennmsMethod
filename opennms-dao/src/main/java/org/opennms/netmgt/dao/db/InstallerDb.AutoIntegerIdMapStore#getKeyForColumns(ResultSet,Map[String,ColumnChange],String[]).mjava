        private MultiColumnKey getKeyForColumns(ResultSet rs, Map<String, ColumnChange> columnChanges, String[] columns) throws SQLException {
            Object[] objects = new Object[columns.length];
            for (int i = 0; i < columns.length; i++) { 
                String indexColumn = columns[i];
                
                ColumnChange columnChange = columnChanges.get(indexColumn);
                if (columnChange == null) {
                    throw new IllegalArgumentException("No ColumnChange entry for '" + indexColumn + "'");
                }
                
                int index = columnChange.getSelectIndex();
                if (index == 0) {
                    throw new IllegalArgumentException("ColumnChange entry for '" + indexColumn + "' has no select index");
                }
                
                objects[i] = rs.getObject(index);
            }

            return new MultiColumnKey(objects);
        }

