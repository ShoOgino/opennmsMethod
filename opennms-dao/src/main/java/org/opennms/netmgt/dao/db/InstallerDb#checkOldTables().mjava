    /**
     * <p>checkOldTables</p>
     *
     * @throws java.sql.SQLException if any.
     * @throws org.opennms.netmgt.dao.db.BackupTablesFoundException if any.
     */
    public void checkOldTables() throws SQLException,
            BackupTablesFoundException {
        Statement st = getConnection().createStatement();
        ResultSet rs = st.executeQuery("SELECT relname FROM pg_class "
                + "WHERE relkind = 'r' AND " + "relname LIKE '%_old_%'");
        LinkedList<String> oldTables = new LinkedList<String>();

        m_out.print("- checking database for old backup tables... ");

        while (rs.next()) {
            oldTables.add(rs.getString(1));
        }

        rs.close();
        st.close();

        if (oldTables.size() == 0) {
            // No problems, so just print "NONE" and return.
            m_out.println("NONE");
            return;
        }

        throw new BackupTablesFoundException(oldTables);
    }

