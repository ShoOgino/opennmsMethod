    /**
     * This method is used to parse and valiate a rule into its graph tree. If
     * the parser cannot validate the rule then an exception is generated.
     *
     * @param rule
     *            The rule to parse.
     *
     * @throws FilterParseException
     *             Thrown if the rule cannot be parsed.
     */
    private Start parseRule(String rule) throws FilterParseException {
        if (rule != null && rule.length() > 0) {
            try {
                // Create a Parser instance.
                Parser p = new Parser(new Lexer(new PushbackReader(new StringReader(rule))));

                // Parse the input.
                return p.parse();
            } catch (Exception e) {
                log().error("Failed to parse the filter rule '" + rule + "': " + e, e);
                throw new FilterParseException("Parse error in rule '" + rule + "': " + e, e);
            }
        } else {
            throw new FilterParseException("Parse error: rule is null or empty");
        }
    }

