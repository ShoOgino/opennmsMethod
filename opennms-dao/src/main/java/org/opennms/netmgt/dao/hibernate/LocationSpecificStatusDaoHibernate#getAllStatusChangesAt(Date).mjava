    @Override
    public Collection<OnmsLocationSpecificStatus> getAllStatusChangesAt(final Date timestamp) {
        return findObjects(OnmsLocationSpecificStatus.class,
                "from OnmsLocationSpecificStatus as status " +
                        "left join fetch status.location as l " +
                        "left join fetch status.monitoredService as m " +
                        "left join fetch m.serviceType " +
                        "left join fetch m.ipInterface " +
                        "where status.id in (" +
                        "select max(s.id) from OnmsLocationSpecificStatus as s " +
                        "where s.pollResult.timestamp <? " +
                        "group by s.location, s.monitoredService " +
                        ")",
                timestamp);
    }

