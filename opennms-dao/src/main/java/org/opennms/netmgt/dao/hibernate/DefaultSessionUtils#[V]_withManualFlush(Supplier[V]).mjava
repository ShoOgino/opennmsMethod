    @Override
    public <V> V withManualFlush(Supplier<V> supplier) {
        final FlushMode flushMode = sessionFactory.getCurrentSession().getFlushMode();
        try {
            sessionFactory.getCurrentSession().setFlushMode(FlushMode.MANUAL);
            return supplier.get();
        } finally {
            sessionFactory.getCurrentSession().setFlushMode(flushMode);
        }
    }

