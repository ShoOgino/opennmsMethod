    private void garbageCollectSessions() {
        List<FilterSession> sessionsToRemove = sessionByRule.values().stream()
                .filter(s -> s.callbacks.isEmpty())
                .collect(Collectors.toList());
        for (FilterSession session : sessionsToRemove) {
            sessionByRule.remove(session.rule);
        }
    }

