    @Override
    public List<CdpTopologyLink> findLinksForTopology() {
        return getHibernateTemplate().execute(new HibernateCallback<List<CdpTopologyLink>>() {
            @Override
            public List<CdpTopologyLink> doInHibernate(Session session) throws HibernateException, SQLException {
                List<Object[]> list = session.createSQLQuery("select l.id as sourceid, " +
                        "l.nodeid as sourcenodeid, " +
                        "l.cdpcacheifindex as sourceifindex, " +
                        "l.cdpinterfacename as sourceifname, " +
                        "e.id as targetid, " +
                        "e.nodeid as targetnodeid, " +
                        "l.cdpcachedeviceport as targetifname " +
                        "from cdplink l " +
                        "right join ipinterface e " +
                        "on l.cdpcacheaddress = e.ipaddr " +
                        "where l.cdpcacheaddresstype=1;").list();

                List<CdpTopologyLink> topoLinks = new ArrayList<CdpTopologyLink>();
                for (Object[] objs : list) {
                    Integer targetId = (Integer)objs[4];
                    Integer targetNodeId =(Integer)objs[5];
                    if(targetId != null && targetNodeId != null) {
                        topoLinks.add(new CdpTopologyLink((Integer) objs[0], (Integer) objs[1], (Integer) objs[2], (String) objs[3], (Integer) objs[4], (Integer) objs[5], (String) objs[6]));
                    }
                }

                return topoLinks;
            }

        });
    }

