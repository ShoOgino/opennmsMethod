    @Override
    public synchronized void update(int nodeid) {
 
        List<BridgeMacLink> bft = m_notYetParsedBFTMap.remove(nodeid);
        Set<String>incomingSet = new HashSet<String>();
        for (BridgeMacLink link: bft)
            incomingSet.add(link.getMacAddress());
        BroadcastDomain bftdomain = null;
        for (BroadcastDomain domain: m_domains) {
            Set<String>retainedSet = new HashSet<String>(domain.getMacsOnDomain());
            retainedSet.retainAll(incomingSet);
            // should contain at list 10 or 10% of the all size
            if (retainedSet.size() < 10 && retainedSet.size() <= incomingSet.size()*0.1 ) {
                domain.removeBridge(nodeid);
                continue;          
            }
            bftdomain = domain;
            break;
        }
        if (bftdomain == null) {
            bftdomain = new BroadcastDomain();
            m_domains.add(bftdomain);
        }
        bftdomain.loadBFT(nodeid,bft,m_notYetParsedSTPMap.remove(nodeid),m_notYetParsedEleMap.remove(nodeid));
        
        List<BroadcastDomain> domains = new ArrayList<BroadcastDomain>();
        for (BroadcastDomain domain: m_domains) {
            if (domain.isEmpty())
                continue;
            domains.add(domain);
        }
        m_domains = domains;

    }

