    /**
     * Get the status defintions for a view by view ID
     * @param viewId
     * @return
     */
    private Collection<AggregateStatusDefinition> loadStatusDefs(final Integer viewId) {

        final RowMapper statusDefMapper = new RowMapper() {

            public Object mapRow(ResultSet rs, int index) throws SQLException {
                AggregateStatusDefinition statusDef = new AggregateStatusDefinition();
                statusDef.setId(rs.getInt("id"));
                statusDef.setAggrStatusLabel(rs.getString("name"));
                statusDef.setCategories(loadStatusDefCategories(statusDef.getId()));
                return statusDef;
            }

        };
        
        return getJdbcTemplate().query("select * from "+AGGREGATE_STATUS_DEFINITIONS_TABLE+" asd " +
                "join "+STATUS_VIEW_DEF_MAPPING_TABLE+" svsd on (svsd.statusDefId = asd.id) "  +
                " where svsd.statusViewId = "+viewId, statusDefMapper);
    }

