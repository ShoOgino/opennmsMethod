    @Override
    public List<OnmsNode> findByIpAddressAndService(InetAddress ipAddress, String serviceName) {
        final org.opennms.core.criteria.Criteria criteria = new org.opennms.core.criteria.Criteria(OnmsNode.class)
        .setAliases(Arrays.asList(new Alias[] {
                new Alias("ipInterfaces","ipInterfaces", JoinType.LEFT_JOIN),
                new Alias("ipInterfaces.monitoredServices","monitoredServices", JoinType.LEFT_JOIN),
                new Alias("monitoredServices.serviceType","serviceType", JoinType.LEFT_JOIN)
        }))
        .addRestriction(new EqRestriction("ipInterfaces.ipAddress", ipAddress))
        //TODO: Replace D with a constant
        .addRestriction(new NeRestriction("ipInterfaces.isManaged", "D"))
        .addRestriction(new EqRestriction("serviceType.name", serviceName))
        .setOrders(Arrays.asList(new Order[] {
                Order.desc("id")
        }));

        return findMatching(criteria);
    }

