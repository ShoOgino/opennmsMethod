    public boolean functionExists(String function, int[] columnTypes,
            int retType) throws Exception {
        Statement st = getConnection().createStatement();
        ResultSet rs;

        StringBuffer ct = new StringBuffer();
        for (int columnType : columnTypes) {
            ct.append(" " + columnType);
        }

        String query = "SELECT oid FROM pg_proc WHERE proname='"
                + function.toLowerCase() + "' AND " + "prorettype=" + retType
                + " AND " + "proargtypes='" + ct.toString().trim() + "'";

        rs = st.executeQuery(query);
        return rs.next();
    }

