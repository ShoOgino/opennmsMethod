    @Override
    @Transactional
    public Optional<OnmsAcknowledgment> findLatestAckForRefId(Integer refId) {
        CriteriaBuilder builder = new CriteriaBuilder(OnmsAcknowledgment.class)
                .eq("refId", refId)
                .limit(1)
                .orderBy("ackTime").desc()
                .orderBy("id").desc();
        List<OnmsAcknowledgment> acks = findMatching(builder.toCriteria());

        return acks.size() == 1 ? Optional.of(acks.get(0)) : Optional.empty();
    }

