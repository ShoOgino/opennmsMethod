    @Override
    public void afterPropertiesSet() {
        long timerIntevalMs = Math.min(refreshRateLimitMs, TimeUnit.SECONDS.toMillis(5));
        timer.schedule(new TimerTask() {
            @Override
            public void run() {
                try {
                    sessionByRule.values().forEach(s -> {
                        try {
                            s.refreshIfNeeded();
                        } catch (Exception e) {
                            LOG.warn("Error refreshing filter for rule: {}. Will retry again in {}ms.", s.rule, timerIntevalMs, e);
                        }
                    });
                } catch (Exception e) {
                    LOG.warn("Error refreshing filter results. Will retry again in {}ms.", timerIntevalMs, e);
                }
            }
        }, timerIntevalMs, timerIntevalMs);
    }

