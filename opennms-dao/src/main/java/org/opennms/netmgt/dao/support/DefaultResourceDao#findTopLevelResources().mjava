    /** {@inheritDoc} */
    @Override
    public List<OnmsResource> findTopLevelResources() {
        // Retrieve all top-level resources by passing null as the parent
        final List<OnmsResource> resources = m_resourceTypes.values().stream()
                .map(type -> type.getResourcesForParent(null))
                .flatMap(rs -> rs.stream())
                .collect(Collectors.toList());

        // Handle node resources separately since their effective
        // type (node vs nodeSource) depends on various factors.
        // See getResourceForNode() for details.
        resources.addAll(findNodeResources());

        return resources;
    }

