    /**
     * Test forward traps and informs.
     *
     * @throws Exception the exception
     */
    @Test
    public void testForwarding() throws Exception {
        // Create a sample trap configuration
        SnmpTrapConfig config = new SnmpTrapConfig();
        config.setDestinationAddress(TRAP_DESTINATION);
        config.setDestinationPort(TRAP_PORT);
        config.setEnterpriseId(".1.3.6.1.4.1.5813");
        config.setSpecific(2);
        config.setHostAddress(InetAddressUtils.addr("10.0.0.1"));
        config.addParameter(".1.3.6.1.2.1.2.2.1.1.3", "3", VarbindType.TYPE_SNMP_INT32.value());

        // Send a V1 Trap
        config.setVersion(SnmpVersion.V1);
        forwardTrap(config);

        // Send a V2c Trap
        config.setVersion(SnmpVersion.V2c);
        forwardTrap(config);

        // Send a V3 Trap
        config.setVersion(SnmpVersion.V3);
        forwardTrap(config);

        // Send a V2 Inform
        config.setVersion(SnmpVersion.V2_INFORM);
        forwardTrap(config);

        // Send a V3 Inform
        config.setVersion(SnmpVersion.V3_INFORM);
        forwardTrap(config);
    }

