    /**
     * Create a new variable binding and add it to the specified SNMP V1 trap.
     *
     * @param trap The trap to which the variable binding should be added.
     * @param name The name (a.k.a. "id") of the variable binding to be created
     * @param type The type of variable binding to be created
     * @param encoding Describes the way in which the value content has been encoded
     * @param value The variable binding value
     * @throws SnmpTrapException if the variable binding cannot be added to the trap for any reason.
     */
    private void addVarBinding(SnmpTrapBuilder trap, String name, String type, String encoding, String value) throws SnmpTrapException {
        if (name == null) {
            throw new SnmpTrapException("Name is null");
        }
        VarBindFactory factory = (VarBindFactory) m_factoryMap.get(type);
        if (factory == null) {
            throw new SnmpTrapException("Type " + type + " is invalid or not implemented");
        }
        factory.addVarBind(trap, name, encoding, value);
    }

