    /**
     * Populates a trap builder for v2 or v3.
     *
     * @param builder the trap builder object
     * @param trapConfig the trap configuration object
     * @throws SnmpTrapException the SNMP trap exception
     */
    private void populateTrapBuilder(SnmpTrapBuilder builder, SnmpTrapConfig trapConfig) throws SnmpTrapException {
        addVarBinding(builder, SNMP_SYSUPTIME_OID, EventConstants.TYPE_SNMP_TIMETICKS, Long.toString(System.currentTimeMillis()/1000));
        String oid;
        if (trapConfig.getGeneric() == ENTERPRISE_SPECIFIC) {
            oid = trapConfig.getEnterpriseId() + "." + trapConfig.getSpecific();
        } else {
            oid = SNMP_TRAPS + '.' + (trapConfig.getGeneric() + 1);
        }
        addVarBinding(builder, SNMP_TRAP_OID, EventConstants.TYPE_SNMP_OBJECT_IDENTIFIER, oid);
        addParameters(builder, trapConfig);
    }

