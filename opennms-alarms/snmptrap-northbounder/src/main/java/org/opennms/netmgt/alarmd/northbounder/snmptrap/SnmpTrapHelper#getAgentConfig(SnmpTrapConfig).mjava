    /**
     * Gets the SNMP agent configuration.
     *
     * @param trapConfig The trap configuration mapping object
     * @return the SNMP agent configuration
     * @throws SnmpTrapException if any.
     */
    // TODO Compare the estimated size with a maximum value:
    //      If the estimated is lower than the maximum in X percentage, log a warning.
    //      Otherwise, log an error and throw an exception
    private SnmpAgentConfig getAgentConfig(SnmpTrapConfig trapConfig) throws SnmpTrapException {
        SnmpAgentConfig agentConfig = trapConfig.getAgentConfig();
        if (trapConfig.getVersion().intValue() != agentConfig.getVersion()) {
            throw new SnmpTrapException("SNMP Version mismatch for " + trapConfig);
        }
        int estimatedSize = getEstimatedPacketSize(trapConfig, agentConfig);
        LOG.info("Sending SNMP{} using {}. The estimated packet size is {} bytes", trapConfig.getVersion().stringValue(), trapConfig, estimatedSize);
        return agentConfig;
    }

