    /**
     * Create an SNMP V1 trap based on the content of the specified trap configuration, and send it to the appropriate destination.
     * 
     * @param trapConfig The trap configuration mapping object
     * @throws SnmpTrapException if any.
     */
    private void forwardV1Trap(SnmpTrapConfig trapConfig) throws SnmpTrapException {
        SnmpV1TrapBuilder trap = SnmpUtils.getV1TrapBuilder();
        trap.setEnterprise(SnmpObjId.get(trapConfig.getEnterpriseId()));
        trap.setAgentAddress(trapConfig.getHostAddress());
        if (trapConfig.hasGeneric()) {
            trap.setGeneric(trapConfig.getGeneric());
        }
        if (trapConfig.hasSpecific()) {
            trap.setSpecific(trapConfig.getSpecific());
        }
        trap.setTimeStamp(System.currentTimeMillis() / 1000);
        int i = 0;
        for (Parm parm : trapConfig.getParameters()) {
            try {
                Value value = parm.getValue();
                addVarBinding(trap, parm.getParmName(), value.getType(), value.getEncoding(), value.getContent());
            } catch (SnmpTrapException e) {
                throw new SnmpTrapException(e.getMessage() + " in event parm[" + i + "]");
            } finally {
                i++;
            }
        }
        sendTrap(trapConfig, trap);
    }

