    /**
     * Create an SNMP V1 trap based on the content of the specified trap configuration, and send it to the appropriate destination.
     * 
     * @param trapConfig The trap configuration mapping object
     * @throws SnmpTrapException if any.
     */
    private void forwardV1Trap(SnmpTrapConfig trapConfig) throws SnmpTrapException {
        SnmpV1TrapBuilder trap = SnmpUtils.getV1TrapBuilder();
        trap.setEnterprise(SnmpObjId.get(trapConfig.getEnterpriseId()));
        trap.setAgentAddress(trapConfig.getHostAddress());
        if (trapConfig.hasGeneric()) {
            trap.setGeneric(trapConfig.getGeneric());
        }
        if (trapConfig.hasSpecific()) {
            trap.setSpecific(trapConfig.getSpecific());
        }
        trap.setTimeStamp(System.currentTimeMillis() / 1000);
        addParameters(trap, trapConfig);
        try {
            SnmpAgentConfig config = getAgentConfig(trapConfig);
            trap.send(config.getAddress().getHostAddress(), config.getPort(), config.getReadCommunity());
        } catch (Throwable e) {
            throw new SnmpTrapException("Failed to send trap "+e.getMessage(), e);
        }
    }

