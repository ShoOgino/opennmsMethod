    /**
     * Test bean wrapper.
     *
     * @throws Exception the exception
     */
    @Test
    public void testBeanWrapper() throws Exception {
        SnmpTrapSink sink = configDao.getConfig().getSnmpTrapSink("localTest2");
        final BeanWrapper wrapper = PropertyAccessorFactory.forBeanPropertyAccess(sink);
        Map<String,String> params = new HashMap<String,String>();
        params.put("ipAddress", "192.168.0.1");
        Assert.assertEquals("127.0.0.2", sink.getIpAddress());
        boolean modified = false;
        for (final String key : params.keySet()) {
            if (wrapper.isWritableProperty(key)) {
                final String stringValue = params.get(key);
                final Object value = wrapper.convertIfNecessary(stringValue, (Class<?>)wrapper.getPropertyType(key));
                wrapper.setPropertyValue(key, value);
                modified = true;
            }
        }
        Assert.assertTrue(modified);
        Assert.assertEquals("192.168.0.1", sink.getIpAddress());
        configDao.save();
        configDao.reload();
        Assert.assertEquals("192.168.0.1", configDao.getConfig().getSnmpTrapSink("localTest2").getIpAddress());
    }

