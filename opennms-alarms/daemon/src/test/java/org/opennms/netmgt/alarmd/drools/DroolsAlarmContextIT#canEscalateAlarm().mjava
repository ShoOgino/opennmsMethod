    @Test
    public void canEscalateAlarm() {
        OnmsAlarm trigger = new OnmsAlarm();
        trigger.setId(1);
        trigger.setAlarmType(1);
        trigger.setSeverity(OnmsSeverity.WARNING);
        trigger.setReductionKey("n1:oops");
        trigger.setLastEventTime(new Date(100));

        OnmsServiceType serviceType = new OnmsServiceType();
        serviceType.setName("ICMP");
        trigger.setServiceType(serviceType);

        when(alarmDao.get(trigger.getId())).thenReturn(trigger);
        dac.getClock().advanceTime( 100, TimeUnit.MILLISECONDS );
        dac.handleNewOrUpdatedAlarm(trigger);
        dac.tick();

        // Advance > 1 hours
        dac.getClock().advanceTime( 120, TimeUnit.MINUTES );
        dac.tick();

        // The severity should be updated
        assertThat(trigger, hasSeverity(OnmsSeverity.MINOR));
    }

