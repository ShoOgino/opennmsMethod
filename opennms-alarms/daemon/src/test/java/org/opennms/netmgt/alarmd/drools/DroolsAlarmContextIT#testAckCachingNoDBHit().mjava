    /**
     * Tests that the ack cache is updated with default acks when it can't find an ack in the db.
     */
    @Test
    public void testAckCachingNoDBHit() {
        OnmsAlarm alarm1 = generateAlarm(1);
        OnmsAlarm alarm2 = generateAlarm(2);
        dac.handleAlarmSnapshot(Arrays.asList(alarm1, alarm2));
        verify(acknowledgmentDao, times(1)).findLatestAcks(any(Date.class));
        dac.tick();
        assertThat(dac.getAckByAlarmId(alarm1.getId()).getAckAction(), equalTo(AckAction.UNACKNOWLEDGE));
        assertThat(dac.getAckByAlarmId(alarm2.getId()).getAckAction(), equalTo(AckAction.UNACKNOWLEDGE));

        dac.handleNewOrUpdatedAlarm(alarm1);
        verify(acknowledgmentDao, times(1)).findLatestAckForRefId(alarm1.getId());
        dac.tick();
        assertThat(dac.getAckByAlarmId(alarm1.getId()).getAckAction(), equalTo(AckAction.UNACKNOWLEDGE));
    }

