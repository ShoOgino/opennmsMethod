    @Before
    public void setUp() throws Exception {
        m_anticipator = new EventAnticipator();
        m_eventMgr.setEventAnticipator(m_anticipator);

        // Events need database IDs to make alarmd happy
        m_eventMgr.setEventWriter(m_database);

        // Events need to real nodes too
        final OnmsNode node = new OnmsNode(m_locationDao.getDefaultLocation(), "node1");
        node.setId(1);
        m_nodeDao.save(node);

        Vacuumd.destroySingleton();
        Vacuumd vacuumd = Vacuumd.getSingleton();
        vacuumd.setEventManager(m_eventMgr);
        vacuumd.init();
        vacuumd.start();
    }

