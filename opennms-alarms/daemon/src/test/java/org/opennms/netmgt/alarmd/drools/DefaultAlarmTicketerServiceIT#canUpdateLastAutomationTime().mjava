    @Test
    public void canUpdateLastAutomationTime() {
        // Create some alarm
        OnmsAlarm a1 = transactionTemplate.execute(status -> {
            OnmsAlarm alarm = new OnmsAlarm();
            alarm.setDistPoller(distPollerDao.whoami());
            alarm.setCounter(1);
            alarm.setUei("linkDown");
            alarm.setLastAutomationTime(new Date(0));
            alarmDao.saveOrUpdate(alarm);
            return alarm;
        });

        // Use the ticketer service to trigger a create ticket event for the alarm, which should
        // also update the last automation time
        Date now = new Date();
        alarmTicketerService.createTicket(a1, now);

        // Use a separate transaction to verify that the last automation time wa updated
        transactionTemplate.execute(status -> {
            final OnmsAlarm alarmInTrans = alarmDao.get(a1.getId());
            assertThat(alarmInTrans.getLastAutomationTime().getTime(), equalTo(now.getTime()));
            return null;
        });
    }

