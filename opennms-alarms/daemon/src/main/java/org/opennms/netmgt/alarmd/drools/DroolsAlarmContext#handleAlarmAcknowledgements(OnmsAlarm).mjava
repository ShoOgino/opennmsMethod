    private void handleAlarmAcknowledgements(OnmsAlarm alarm) {
        final AlarmAcknowledgementAndFact acknowledgmentFact = acknowledgementsByAlarmId.get(alarm.getId());
        if (acknowledgmentFact == null) {
            OnmsAcknowledgment ack = getLatestAcknowledgement(alarm);
            LOG.debug("Inserting first alarm acknowledgement into session: {}", ack);
            final FactHandle fact = getKieSession().insert(ack);
            acknowledgementsByAlarmId.put(alarm.getId(), new AlarmAcknowledgementAndFact(ack, fact));
        } else {
            FactHandle fact = acknowledgmentFact.getFact();
            OnmsAcknowledgment ack = getLatestAcknowledgement(alarm);
            LOG.trace("Updating acknowledgment in session: {}", ack);
            getKieSession().update(fact, ack);
            acknowledgementsByAlarmId.put(alarm.getId(), new AlarmAcknowledgementAndFact(ack, fact));
        }
    }

