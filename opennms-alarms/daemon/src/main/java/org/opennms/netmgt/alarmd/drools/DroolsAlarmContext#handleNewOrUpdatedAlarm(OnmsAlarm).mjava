    @Override
    public void handleNewOrUpdatedAlarm(OnmsAlarm alarm) {
        if (kieSession == null) {
            LOG.debug("Ignoring new/updated alarm. Drools session is stopped.");
            return;
        }
        lockIfNotFiring();
        try {
            handleNewOrUpdatedAlarmNoLock(alarm);
        } finally {
            unlockIfNotFiring();
        }
    }

