    private OnmsEntity getEntity(Integer nodeId, String ipAddr, Integer ifIndex, Integer serviceId) {
        
        if (ipAddr == null && serviceId == null) {
            return (OnmsNode)Cache.obtain(OnmsNode.class, nodeId);
        } else if (serviceId == null)
        {
            IpInterfaceId ifaceId = new IpInterfaceId(nodeId, ipAddr, ifIndex);
            return (OnmsIpInterface)Cache.obtain(OnmsIpInterface.class, ifaceId);
        } else {
            MonitoredServiceId monSvcId = new MonitoredServiceId(nodeId, ipAddr, ifIndex, serviceId);
            return (OnmsMonitoredService)Cache.obtain(OnmsMonitoredService.class, monSvcId);
        }
    }

