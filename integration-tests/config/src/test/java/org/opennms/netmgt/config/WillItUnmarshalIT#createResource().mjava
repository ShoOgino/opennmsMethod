    /**
     * Create a resource for the config file to unmarshall using the configured
     * source.
     *
     * @return the Resource
     */
    public final Resource createResource() {
        // Create a resource for the config file to unmarshall using the
        // configured source
        switch (this.source) {
        case CONFIG:
            return new FileSystemResource(ConfigurationTestUtils.getFileForConfigFile(file));

        case EXAMPLE:
            return new FileSystemResource(ConfigurationTestUtils.getFileForConfigFile("examples/" + file));

        case SPRING:
            return ConfigurationTestUtils.getSpringResourceForResource(this, this.file);

        case ABSOLUTE:
            return new FileSystemResource(this.file);

        case CLASSPATH:
            return new ClassPathResource(file, clazz);

        default:
            throw new RuntimeException("Source unknown: " + this.source);
        }
    }

