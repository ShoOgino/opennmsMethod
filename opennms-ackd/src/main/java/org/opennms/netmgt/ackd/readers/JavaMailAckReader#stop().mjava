    public void stop() throws IllegalStateException {
        log().debug("stop: acquiring lock...");
        synchronized (m_lock) {
            if (!AckReaderState.STOPPED.equals(getState())) {
                setState(AckReaderState.STOP_PENDING);
                log().info("stop: lock acquired; stopping reader...");
                
                if (m_future != null) {
                    m_future.cancel(false);
                    m_future = null;
                }
                
                setState(AckReaderState.STOPPED);
                log().info("stop: Reader stopped.");
            } else {
                IllegalStateException e = new IllegalStateException("Reader is already stopped.");
                log().error("stop: "+e, e);
                throw e;
            }
        }
    }

