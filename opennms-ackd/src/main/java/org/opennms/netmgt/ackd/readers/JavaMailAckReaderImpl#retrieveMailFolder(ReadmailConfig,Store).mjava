    /**
     * Establish connection with mail store and return the configured mail folder.
     * 
     * @param mailParms
     * @param mailStore
     * @return the folder specified in configuration
     * @throws MessagingException
     */
    private Folder retrieveMailFolder(final ReadmailConfig config, final Store mailStore) throws MessagingException {
        mailStore.connect(config.getReadmailHost().getHost(), (int)config.getReadmailHost().getPort(), config.getUserAuth().getUserName(), config.getUserAuth().getPassword());
        
        //TODO: figure out the difference between getting a named folder from the store and getting a named folder from a folder (perhaps a heiarchy thing?)
        Folder mailFolder = mailStore.getDefaultFolder();
        mailFolder = mailFolder.getFolder(config.getMailFolder());
        if (!mailFolder.exists()) {
            throw new IllegalArgumentException("The specified mail folder doesn't exist in the store: "+config.getMailFolder());
        }
        return mailFolder;
    }

