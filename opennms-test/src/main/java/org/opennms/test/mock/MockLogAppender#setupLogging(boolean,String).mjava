    public static void setupLogging(boolean toConsole, String level) {
        resetLogLevel();
        
        Properties logConfig = new Properties();

        String consoleAppender = (toConsole ? ", CONSOLE" : "");

        logConfig.put("log4j.appender.CONSOLE",
                      "org.apache.log4j.ConsoleAppender");
        logConfig.put("log4j.appender.CONSOLE.layout",
                      "org.apache.log4j.PatternLayout");
        logConfig.put("log4j.appender.CONSOLE.layout.ConversionPattern",
                      "%d %-5p [%t] %c: %m%n");
        logConfig.put("log4j.appender.MOCK", MockLogAppender.class.getName());
        logConfig.put("log4j.appender.MOCK.layout",
                      "org.apache.log4j.PatternLayout");
        logConfig.put("log4j.appender.MOCK.layout.ConversionPattern",
                      "%-5p [%t] %c: %m%n");

        logConfig.put("log4j.rootCategory", level + consoleAppender
                + ", MOCK");
        logConfig.put("log4j.logger.org.apache.commons.httpclient.HttpMethodBase", "ERROR");
        logConfig.put("log4j.logger.org.snmp4j", "ERROR");
        logConfig.put("log4j.logger.org.snmp4j.agent", "ERROR");
        logConfig.put("log4j.logger.org.hibernate.cfg.AnnotationBinder",
                      "ERROR" + consoleAppender + ", MOCK");

        PropertyConfigurator.configure(logConfig);
    }

