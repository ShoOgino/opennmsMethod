    @Test
    public void canApproveDoubleSlash() throws URISyntaxException, IOException {
        ApproveAbsolutePathAliases aliasCheck = new ApproveAbsolutePathAliases();

        // If the alias and file only differ by a double slash, it should be approved
        String path = "/WEB-INF/jsp//support/index.jsp";
        String uri = "file:///opt/opennms/jetty-webapps/opennms/WEB-INF/jsp//support/index.jsp";
        assertThat(aliasCheck.check(path, new PathResource(new URI(uri)) {
            @Override
            public URI getAlias() {
                try {
                    return new URI("file:///opt/opennms/jetty-webapps/opennms/WEB-INF/jsp/support/index.jsp");
                } catch (URISyntaxException e) {
                    throw new RuntimeException(e);
                }
            }
        }), equalTo(true));

        // Other differences should not be approved
        uri = "file:///opt/opennms/jetty-webapps/opennms/WEB-INF/jsp/support/index.jsp";
        assertThat(aliasCheck.check(path, new PathResource(new URI(uri)) {
            @Override
            public URI getAlias() {
                try {
                    return new URI("file:///opt/opennms/jetty-webapps/opennms/WEB-INF/jsp/.support/index.jsp");
                } catch (URISyntaxException e) {
                    throw new RuntimeException(e);
                }
            }
        }), equalTo(false));
    }

