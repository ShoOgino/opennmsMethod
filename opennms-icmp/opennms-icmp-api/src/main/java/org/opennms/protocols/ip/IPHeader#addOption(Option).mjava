    /**
     * Adds an option to the IP header.
     * 
     * @param opt
     *            The option to add to the header.
     * 
     */
    public void addOption(Option opt) {
        int origLen = 0;
        if (m_options == null) {
            int len = opt.bytesRequired();
            if ((len % 4) != 0)
                len = 4 - (len % 4);

            m_options = new byte[opt.bytesRequired()];
            int off = opt.writeBytes(m_options, 0);
            while (off < len)
                m_options[off++] = (byte) 0;
        } else {
            origLen = m_options.length;
            if (origLen + opt.bytesRequired() > 40)
                throw new IndexOutOfBoundsException("Option List is too long, must be less than 40 bytes");

            int len = origLen + opt.bytesRequired();
            if ((len % 4) != 0)
                len += 4 - (len % 4);

            byte[] ndata = new byte[len];
            System.arraycopy(m_options, 0, ndata, 0, origLen);

            int off = opt.writeBytes(ndata, origLen);
            while (off < len)
                ndata[off++] = (byte) 0;
        }

        m_hdrlen = (byte) ((20 + m_options.length) / 4);
    }

