    /**
     * Builds a datagram compatible with the ping ReplyReceiver class.
     */
    private synchronized static DatagramPacket getDatagram(InetAddress addr, long tid, short sid) {
        ICMPEchoPacket iPkt = new ICMPEchoPacket(tid);
        iPkt.setIdentity(FILTER_ID);
        iPkt.setSequenceId(sid);
        iPkt.computeChecksum();

        byte[] data = iPkt.toBytes();
        return new DatagramPacket(data, data.length, addr, 0);
    }

