    long getNextExpirationTime() {
        ArrayList<PingRequest> pr = null;
        synchronized(getTrackerLock()) {
    	    if (getPendingRequestMap().size() == 0) {
    	        return DEFAULT_WAIT_TIME;
    	    }
    	    
            pr = new ArrayList<PingRequest>(getPendingRequestMap().values());
    	}
        Collections.sort(pr, new Comparator<PingRequest>() {
            public int compare(PingRequest arg0, PingRequest arg1) {
                if (arg0 == null) {
                    return -1;
                } else if (arg1 == null) {
                    return 1;
                } else if (arg0.getExpiration() == arg0.getExpiration()) {
                    return 0;
                } else {
                    return (arg1.getExpiration() > arg0.getExpiration()? 1 : -1);
                }
            }
        });
        log().info(System.currentTimeMillis() + ": " + pr.size() + " pending requests, lowest is " + pr.get(0));
        long waitTime = pr.get(0).getExpiration() - System.currentTimeMillis();
        if (waitTime < 0) {
            return 0;
        } else {
            return waitTime;
        }
    }

