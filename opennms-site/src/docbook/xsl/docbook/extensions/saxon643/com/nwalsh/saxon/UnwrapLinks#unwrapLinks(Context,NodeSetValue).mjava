  /**
   * <p>Unwrap links</p>
   *
   * @param rtf The result tree fragment of the verbatim environment.
   *
   * @return The modified result tree fragment.
   */
  public static NodeSetValue unwrapLinks (Context context,
					  NodeSetValue rtf_ns) {

    FragmentValue rtf = (FragmentValue) rtf_ns;
    boolean tryAgain = true;

    setupUnwrapLinks(context);

    try {
      Controller controller = context.getController();
      NamePool namePool = controller.getNamePool();

      while (tryAgain) {
	UnwrapLinksEmitter ulEmitter = new UnwrapLinksEmitter(controller,
							      namePool,
							      foStylesheet);
	rtf.replay(ulEmitter);
	tryAgain = ulEmitter.tryAgain();
	rtf = (FragmentValue) ulEmitter.getResultTreeFragment();
      }

      return rtf;

    } catch (TransformerException e) {
      // This "can't" happen.
      System.out.println("Transformer Exception in unwrapLinks");
      return rtf;
    }
  }

