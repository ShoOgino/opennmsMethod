    public byte[] render(AvailabilityReportLocator locator, String format) {
        
        Resource xsltResource;
        ReportRenderer renderer;
        byte[] result = null;
            
        try {
                
                if (format.equalsIgnoreCase(HTML_FORMAT)) {
                    renderer = new HTMLReportRenderer();
                    xsltResource =  new UrlResource(m_configDao.getHtmlStylesheetLocation(locator.getFormat()));
                } else {
                    renderer = new PDFReportRenderer();
                    if (format.equalsIgnoreCase(SVG_FORMAT)) {
                        xsltResource =  new UrlResource(m_configDao.getSvgStylesheetLocation(locator.getFormat()));
                    } else {
                        xsltResource =  new UrlResource(m_configDao.getPdfStylesheetLocation(locator.getFormat()));
                    }
                }
                String baseDir = System.getProperty("opennms.report.dir");
                renderer.setBaseDir(baseDir);
                result = renderer.render(locator.getLocation(),xsltResource);
            } catch (MalformedURLException e) {
                log.fatal("Malformed URL for xslt template");
            } catch (ReportRenderException e) {
                log.fatal("unable to render report");
            }
            
            return result;
            
        }

