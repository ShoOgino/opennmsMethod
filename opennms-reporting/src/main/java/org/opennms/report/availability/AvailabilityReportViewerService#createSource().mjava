    public Source createSource() throws AvailabilityReportException {

        AvailabilityReportLocator locator = m_reportLocatorService.locateReport(m_reportId);

        if (locator == null) {
            throw new AvailabilityReportException(
                                                  "Unable to find a report with that Id");
        } else {
            File xmlFile = new File(locator.getLocation());
            if (xmlFile.canRead() == true) {
                return new StreamSource(xmlFile);
            } else {
                throw new AvailabilityReportException(
                                                      "Found a report with id:  "
                                                              + m_reportId
                                                              + " but xml (plus basedir): "
                                                              + m_baseDir
                                                              + locator.getLocation()
                                                              + " was not readable");
            }
        }

    }

