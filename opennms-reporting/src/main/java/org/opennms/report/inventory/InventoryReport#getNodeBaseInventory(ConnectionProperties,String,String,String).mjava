    public static NodeBaseInventory getNodeBaseInventory(ConnectionProperties cp, String node, String group, String version) throws RancidApiException{
        
        // get the latest version from the given date
        
        log().debug("getNodeBaseInventory " + node +" "+group + " "+version);
                
        RancidNode rn = RWSClientApi.getRWSRancidNodeInventory(cp, group, node);
        
        InventoryNode in = (InventoryNode)rn.getNodeVersions().get(version);
        
        NodeBaseInventory nbi = new NodeBaseInventory();
        
        nbi.setDevicename(node);
        nbi.setGroupname(group);
        nbi.setVersion(version);
        nbi.setStatus(in.getParent().getState());
        nbi.setCreationdate(in.getCreationDate());
        nbi.setSwconfigurationurl(in.getSoftwareImageUrl());
        nbi.setConfigurationurl(in.getConfigurationUrl());
        
        nbi.setIe( RWSClientApi.getRWSRancidNodeInventoryElement2(cp, rn, version));
        
        return nbi;
    }

