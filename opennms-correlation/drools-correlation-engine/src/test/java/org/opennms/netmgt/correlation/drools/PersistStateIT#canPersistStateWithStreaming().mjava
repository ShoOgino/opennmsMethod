    @Test(timeout=30000)
    public void canPersistStateWithStreaming() throws Exception {
        DroolsCorrelationEngine engine = findEngineByName("persistStateStreamingTest");
        assertThat(engine, notNullValue());

        engine.correlate(createNodeLostServiceEvent(1, "SSH"));
        await().atMost(1, TimeUnit.MINUTES).until(engine::getKieSessionObjects, hasSize(3));
        engine.tearDown();

        // Re-initialize and verify
        engine.initialize();
        assertThat(engine.getKieSessionObjects(), hasSize(3));
        engine.tearDown();
    }

