        Object constructValue(final ApplicationContext context) {
            
        	final String type = getType();
        	Class<?> typeClass = Object.class;
            if (type != null) {
            	final PropertyEditor classEditor = getDefaultEditor(Class.class);
                classEditor.setAsText(type);
                typeClass = (Class<?>)classEditor.getValue();
            }
        
            final String value = getValue();
            if (value != null) {
            	final PropertyEditor valueEditor = getDefaultEditor(typeClass);
                valueEditor.setAsText(value);
                return valueEditor.getValue();
            }
            
            final String ref = getRef();
            if (ref != null) {
            	return context.getBean(ref, typeClass);
            }
            
            throw new IllegalArgumentException("One of either the value or the ref must be specified");
            
        }

