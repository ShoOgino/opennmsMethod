    private void unmarshalAndInsert(byte[] factBytes, Class<?> clazz) {

        try {
            String packageName = clazz.getPackage().getName();
            String className = clazz.getSimpleName();
            // Check if this is a declared fact in drl.
            FactType factType = getDeclaredFactType(packageName, className);
            if (factType != null) {
                m_kieSession.insert(DroolsStreamUtils.streamIn(factBytes, factType.getFactClass().getClassLoader()));
            } else {
                m_kieSession.insert(DroolsStreamUtils.streamIn(factBytes, clazz.getClassLoader()));
            }
        } catch (IOException | ClassNotFoundException e) {
            LOG.error("Exception while unmarshalling fact of size {} with Class {}", factBytes.length, clazz.getCanonicalName());
        }
    }

