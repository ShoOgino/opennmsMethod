    public void initialize() throws Exception {
        KieServices kieServices = KieServices.Factory.get();
        KieFileSystem kieFileSystem = kieServices.newKieFileSystem();

        for (Resource ruleFile : m_rulesResouces) {
            LOG.info("Loading ruleFile: " + ruleFile.getFilename());
            kieFileSystem.write(ResourceFactory.newFileResource(ruleFile.getFile()));
        }

        KieBuilder kieBuilder = kieServices.newKieBuilder(kieFileSystem).buildAll();

        if (kieBuilder.getResults().hasMessages(Level.ERROR)) {
            List<Message> errors = kieBuilder.getResults().getMessages(Level.ERROR);
            StringBuilder sb = new StringBuilder("Errors:");
            for (Message msg : errors) {
                sb.append("\n");
                sb.append(prettyBuildMessage(msg));
            }
            throw new Exception(sb.toString());
        }
        LOG.info("KieServices built: " + toString());

        KieContainer kieContainer = kieServices.newKieContainer(kieServices.getRepository().getDefaultReleaseId());
        kieSession = kieContainer.newKieSession();

        kieSession.setGlobal("engine", this);
        for (final Map.Entry<String, Object> entry : m_globals.entrySet()) {
            kieSession.setGlobal(entry.getKey(), entry.getValue());
        }
    }

