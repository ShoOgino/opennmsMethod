    @Test
    public void testCombine() throws Exception {
        final File newFile = m_converter.createTempRrd(m_sineFull);
        try {
            m_converter.consolidateRrdFile(m_sineFull, newFile);
            RrdDb newRrd = new RrdDb(newFile.getPath(), true);
            TimeSeriesDataSource rrdDatabase = new RrdDatabase(newRrd);

            assertEquals(m_baseTime, newRrd.getLastArchiveUpdateTime());
            Archive archive = newRrd.getArchive(0);
            Robin robin = archive.getRobin(newRrd.getDsIndex("a"));
            assertEquals(4032, robin.getSize());
            assertEquals(Double.NaN, rrdDatabase.getDataAt(1293195600).getValue("a"), ACCEPTABLE_DOUBLE_DELTA);
            assertEquals(0.049532528339D, rrdDatabase.getDataAt(1293210000).getValue("a"), ACCEPTABLE_DOUBLE_DELTA);
            assertEquals(0.023333333333D, rrdDatabase.getDataAt(1298046000).getValue("a"), ACCEPTABLE_DOUBLE_DELTA);
        } finally {
            newFile.delete();
        }
    }

