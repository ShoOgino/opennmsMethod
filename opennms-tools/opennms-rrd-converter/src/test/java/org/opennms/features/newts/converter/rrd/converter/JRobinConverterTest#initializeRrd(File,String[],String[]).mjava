    private void initializeRrd(final File fileName, final String[] dsNames, final String[] archives) throws RrdException, IOException {
        final RrdDef rrdDef = new RrdDef(fileName.getAbsolutePath());
        rrdDef.setStartTime(0);
        final DsDef[] dsDefs = new DsDef[dsNames.length];
        for (int i = 0; i < dsNames.length; i++) {
            dsDefs[i] = new DsDef(dsNames[i], "COUNTER", 600, 0, Double.NaN);
        }
        rrdDef.addDatasource(dsDefs);
        final ArcDef[] arcDefs = new ArcDef[archives.length];
        for (int i = 0; i < archives.length; i++) {
            String[] entry = archives[i].split(":");
            Integer steps = Integer.valueOf(entry[0]);
            Integer rows = Integer.valueOf(entry[1]);
            arcDefs[i] = new ArcDef("AVERAGE", 0.5D, steps, rows);
        }
        rrdDef.addArchive(arcDefs);
        final RrdDb db = new RrdDb(rrdDef);
        db.close();
    }

