	private Event getXMLEvent(final OnmsEvent ev) {
		final Integer id = ev.getId();

		LogUtils.infof(this, "Working on XML Event for id: %s", id); 
		LogUtils.debugf(this, "Setting Event id: %s", id); 
		final Event e = new Event();
        e.setDbid(id);

        //UEI
        final String uei = ev.getEventUei();
		if (uei != null) {
            LogUtils.debugf(this, "Setting Event uei: %s", uei); 
            e.setUei(uei);
        } else {
        	LogUtils.warnf(this, "No Event uei found: skipping event....");
            return null;
        }

        // Source
        final String source = ev.getEventSource();
		if (source != null) {
        	LogUtils.debugf(this, "Setting Event source: %s", source); 
            e.setSource(source);
        } else {
        	LogUtils.infof(this, "No Event source found."); 
        }

        //nodeid
        final Integer nodeid = ev.getNode().getId();
		if (ev.getNode() != null && nodeid != null) {
            LogUtils.debugf(this, "Setting Event nodeid: %s", nodeid); 
            e.setNodeid(nodeid.longValue());
        } else {
            LogUtils.infof(this, "No Event node found."); 
        }

        // timestamp
        final Date time = ev.getEventTime();
		if (time != null) {
            LogUtils.debugf(this, "Setting event date timestamp to (GMT): %s", time);
            e.setTime(EventConstants.formatToString(time));
        } else {
        	LogUtils.infof(this, "No Event time found."); 
        }
        
        // host
        final String host = ev.getEventHost();
		if (host != null) {
            LogUtils.debugf(this, "Setting Event Host: %s", host);
            e.setHost(host);
        } else {
        	LogUtils.infof(this, "No Event host found.");
        }
        
        // interface
        final InetAddress ipAddr = ev.getIpAddr();
		if (ipAddr != null) {
            LogUtils.debugf(this, "Setting Event Interface/ipaddress: %s", ipAddr);
            e.setInterfaceAddress(ipAddr);
        } else {
            LogUtils.infof(this, "No Event ip address found.");
        }
        
        // Service Name
        if (ev.getServiceType() != null) {
            final String serviceName = ev.getServiceType().getName();
			LogUtils.debugf(this, "Setting Event Service Name: %s", serviceName);
            e.setService(serviceName);
        } else {
        	LogUtils.infof(this, "No Event service name found.");
        }

        // Description
        final String descr = ev.getEventDescr();
		if (descr != null ) {
            LogUtils.debugf(this, "Setting Event Description: %s", descr);
            e.setDescr(descr);
        } else {
            LogUtils.infof(this, "No Event ip address found.");
        }
        
        // Log message
        final String logmsg = ev.getEventLogMsg();
		if (logmsg != null) {
        	final Logmsg msg = new Logmsg();
            LogUtils.debugf(this, "Setting Event Log Message: %s", logmsg);
            msg.setContent(logmsg);
            e.setLogmsg(msg);
        } else {
            LogUtils.infof(this, "No Event log Message found.");
        }

        // severity
        final Integer severity = ev.getEventSeverity();
		if (severity != null) {
            LogUtils.debugf(this, "Setting Event Severity: %s", severity);
            e.setSeverity(OnmsSeverity.get(severity).getLabel());
        } else {
            LogUtils.infof(this, "No Event severity found.");
        }

          final Integer ifIndex = ev.getIfIndex();
		if (ifIndex != null && ifIndex > 0 ) {
              e.setIfIndex(ifIndex);
              e.setIfAlias(getIfAlias(nodeid,ifIndex));
          } else {
              e.setIfIndex(-1);
              e.setIfAlias("-1");
          }

        
        // operator Instruction
        final String operInstruct = ev.getEventOperInstruct();
		if (operInstruct != null) {
            LogUtils.debugf(this, "Setting Event Operator Instruction: %s", operInstruct);
            e.setOperinstruct(operInstruct);
        } else {
            LogUtils.infof(this, "No Event operator Instruction found.");
        }

        // parms
        final String eventParms = ev.getEventParms();
		if (eventParms != null) {
        	LogUtils.debugf(this, "Setting Event Parms: %s", eventParms);
        	final Parms parms = Parameter.decode(eventParms);
            if (parms != null) e.setParms(parms);
        } else {
            LogUtils.infof(this, "No Event parms found.");
        }

		final AlarmData ad = new AlarmData();
		final OnmsAlarm onmsAlarm = ev.getAlarm();
        try {
            if (onmsAlarm != null) {
                ad.setReductionKey(onmsAlarm.getReductionKey());
                ad.setAlarmType(onmsAlarm.getAlarmType());
                ad.setClearKey(onmsAlarm.getClearKey());
                e.setAlarmData(ad);
            }
        } catch (final ObjectNotFoundException e1) {
            LogUtils.warnf(this, e1, "Correlated alarm data not found.");
        }
        LogUtils.infof(this, "Returning event with id: %s", id);
        return e;
    }

