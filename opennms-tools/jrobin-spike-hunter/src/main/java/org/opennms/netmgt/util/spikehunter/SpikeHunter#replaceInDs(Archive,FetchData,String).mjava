	private static void replaceInDs(Archive arc, FetchData data, String dsName) {
		printToUser(" Operating on DS " + dsName);
		double[] origValues = null;
		try {
			origValues = data.getValues(dsName);
		} catch (RrdException e) {
			System.out.println("RRD Exception trying to get values from RRD file: " + e.getMessage());
			System.exit(-1);
		}
		DataAnalyzer analyzer = getDataAnalyzer();
		analyzer.setVerbose(m_verbose);
		List<Integer> violatorIndices = analyzer.findSamplesInViolation(origValues);
		if (m_verbose) {
			printToUser(" Number of values: " + origValues.length);
			printToUser(" Data analyzer: " + analyzer);
			printToUser(" Samples found in violation: " + violatorIndices.size());
		}
		DataReplacer replacer = getDataReplacer();
		double[] newValues = replacer.replaceValues(origValues, violatorIndices);
		printReplacementsToUser(data, dsName, newValues, violatorIndices);
		if (!m_dryRun) {
			replaceInFile(arc, data, dsName, newValues, violatorIndices);
		}
	}

