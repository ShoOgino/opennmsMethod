	/**
	 * Test an attempt to close the client before the client has been
	 * initialized. This should throw a new exception stating that WmiClient
	 * hasn't been properly initialized.
	 * 
	 * Test method for {@link org.opennms.protocols.wmi.WmiManager#close()}.
     *
     * @throws WmiException if there is a problem with the mock object.
	 */
	public final void testCloseWithInvalidSession() throws WmiException {
		// Set up WMI mock client.
		replay(m_WmiMock);

		try {
			// Create a manager.
			WmiManager wmiManager = new WmiManager("127.0.0.1",
					"Administrator", "password");
			// Disconnect without initializing/connecting.
			wmiManager.close();

		} catch (WmiException e) {
			assertTrue(
					"Exception missing message: WmiClient was not initialized: "
							+ e, e.getMessage().contains(
							"WmiClient was not initialized"));
		}

		verify(m_WmiMock);

		reset(m_WmiMock);
	}

