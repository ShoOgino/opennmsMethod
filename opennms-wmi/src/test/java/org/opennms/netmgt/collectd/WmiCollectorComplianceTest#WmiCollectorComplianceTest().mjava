    public WmiCollectorComplianceTest() {
        super(WmiCollector.class, true);

        WmiAgentConfig agentConfig = new WmiAgentConfig();
        peerFactory = mock(WmiPeerFactory.class);
        when(peerFactory.getAgentConfig(InetAddrUtils.getLocalHostAddress())).thenReturn(agentConfig);
        WmiPeerFactory.setInstance(peerFactory);

        WmiCollection collection = new WmiCollection();
        collection.setName("default");
        collection.setRrd(new Rrd(1, "RRA:AVERAGE:0.5:1:2016"));
        dataCollectionConfigFactory = mock(WmiDataCollectionConfigFactory.class);
        when(dataCollectionConfigFactory.getWmiCollection(COLLECTION)).thenReturn(collection);
        when(dataCollectionConfigFactory.getRrdRepository(COLLECTION)).thenReturn(new RrdRepository());
        WmiDataCollectionConfigFactory.setInstance(dataCollectionConfigFactory);
        dataCollectionConfigDao = mock(DataCollectionConfigDao.class);
        when(dataCollectionConfigDao.getConfiguredResourceTypes()).thenReturn(Maps.newHashMap());
        DataCollectionConfigFactory.setInstance(dataCollectionConfigDao);
    }

