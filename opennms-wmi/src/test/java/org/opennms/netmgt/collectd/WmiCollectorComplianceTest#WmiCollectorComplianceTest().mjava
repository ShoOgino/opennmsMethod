    public WmiCollectorComplianceTest() {
        super(WmiCollector.class, true);

        WmiAgentConfig agentConfig = new WmiAgentConfig();
        peerFactory = mock(WmiPeerFactory.class);
        when(peerFactory.getAgentConfig(InetAddrUtils.getLocalHostAddress())).thenReturn(agentConfig);
        WmiPeerFactory.setInstance(peerFactory);

        WmiCollection collection = new WmiCollection();
        collection.setWpms(new Wpms());
        dataCollectionConfigFactory = mock(WmiDataCollectionConfigFactory.class);
        when(dataCollectionConfigFactory.getWmiCollection(COLLECTION)).thenReturn(collection);
        when(dataCollectionConfigFactory.getRrdRepository(COLLECTION)).thenReturn(new RrdRepository());
        WmiDataCollectionConfigFactory.setInstance(dataCollectionConfigFactory);    
    }

