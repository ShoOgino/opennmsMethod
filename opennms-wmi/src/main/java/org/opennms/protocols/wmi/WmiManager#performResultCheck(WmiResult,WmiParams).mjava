	private void performResultCheck(WmiResult wmiResult, WmiParams params) throws WmiException {
		ArrayList<Object> wmiObjects = wmiResult.getResponse();

		int matches = 0;
		int total = wmiObjects.size();
		for (int i = 0; i < total; i++) {
			Object wmiObj = wmiObjects.get(i);

			WmiMgrOperation op = WmiMgrOperation.valueOf(params.getCompareOperation());
			
			if(op.compareString(wmiObj, (String)params.getCompareValue())) {
				matches++;
			}
		}

		/*
		 * Check that we meet the match requirements:
		 * - all: all objects must match
		 * - none: no objects must match
		 * - one: only one object must match
		 * - some: more than one object but not all objects must match.
		 */
        if (m_MatchType.equals("all") && matches == total) {
			wmiResult.setResultCode(WmiResult.RES_STATE_OK);
		} else if (m_MatchType.equals("none") && matches == 0) {
			wmiResult.setResultCode(WmiResult.RES_STATE_OK);
		} else if (m_MatchType.equals("one") && matches == 1) {
			wmiResult.setResultCode(WmiResult.RES_STATE_OK);
		} else if (m_MatchType.equals("some") && matches > 1) {
			// we want to match more than one but not all.
			if (matches != total) {
				wmiResult.setResultCode(WmiResult.RES_STATE_OK);
			} else {
				wmiResult.setResultCode(WmiResult.RES_STATE_CRIT);
			}
		} else {
			wmiResult.setResultCode(WmiResult.RES_STATE_CRIT);
		}
	}

