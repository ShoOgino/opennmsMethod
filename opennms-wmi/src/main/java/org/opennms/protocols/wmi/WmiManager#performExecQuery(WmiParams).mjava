    /**
     * <p>performExecQuery</p>
     *
     * @param params a {@link org.opennms.protocols.wmi.WmiParams} object.
     * @return a {@link org.opennms.protocols.wmi.WmiResult} object.
     * @throws org.opennms.protocols.wmi.WmiException if any.
     */
    public WmiResult performExecQuery(final WmiParams params) throws WmiException {
        final ArrayList<Object> wmiObjects = new ArrayList<Object>();
        final OnmsWbemObjectSet wos = m_WmiClient.performExecQuery(params.getWql());
        
        for(int i=0; i<wos.count(); i++) {
            wmiObjects.add(wos.get(i).getWmiProperties().getByName(params.getWmiObject()).getWmiValue());
        }

        final WmiResult result = new WmiResult(wmiObjects);

		if (params.getCompareOperation().equals("NOOP")) {
			result.setResultCode(WmiResult.RES_STATE_OK);
		} else if (params.getCompareOperation().equals("EQ")
				|| params.getCompareOperation().equals("NEQ")
				|| params.getCompareOperation().equals("GT")
				|| params.getCompareOperation().equals("LT")) {
			performResultCheck(result, params);
		} else {
			result.setResultCode(WmiResult.RES_STATE_UNKNOWN);
		}

		return result;
    }

