    /** {@inheritDoc} */
    public void connect(final String domain, final String username, final String password) throws WmiException {
        try {

            m_Session = JISession.createSession(domain, username, password);
            m_Session.useSessionSecurity(true);
            m_Session.setGlobalSocketTimeout(5000);

            m_ComStub = new JIComServer(JIProgId.valueOf(WMI_PROGID), m_Address, m_Session);

            final IJIComObject unknown = m_ComStub.createInstance();
            m_ComObject = unknown.queryInterface(WMI_CLSID);

            // This will obtain the dispatch interface
            m_Dispatch = (IJIDispatch) JIObjectFactory.narrowObject(m_ComObject.queryInterface(IJIDispatch.IID));
            final JIVariant results[] = m_Dispatch.callMethodA(
                "ConnectServer",
                new Object[]{
                    new JIString(m_Address),
                    JIVariant.OPTIONAL_PARAM(),
                    JIVariant.OPTIONAL_PARAM(),
                    JIVariant.OPTIONAL_PARAM(),
                    JIVariant.OPTIONAL_PARAM(),
                    JIVariant.OPTIONAL_PARAM(),
                    0,
                    JIVariant.OPTIONAL_PARAM()
                }
            );

            m_WbemServices = (IJIDispatch) JIObjectFactory.narrowObject((results[0]).getObjectAsComObject());

        } catch (final JIException e) {
            if (m_Session != null) {
                try {
                    JISession.destroySession(m_Session);
                } catch (JIException e1) {
                    LogUtils.errorf(this, e1, "Failed to destroy session after incomplete connect with host '%s'.", m_Address);
                }
            }
            throw new WmiException("Failed to establish COM session with host '" + m_Address + "': " + e.getMessage(), e);
        } catch (final UnknownHostException e) {
            if (m_Session != null) {
                try {
                    JISession.destroySession(m_Session);
                } catch (JIException e1) {
                    LogUtils.errorf(this, e1, "Failed to destroy session after unknown host '%s'.", m_Address);
                }
            }
            throw new WmiException("Unknown host '" + m_Address + "'. Failed to connect to WMI agent.", e);
        }
    }

