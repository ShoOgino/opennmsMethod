    @Override
    public Map<String, Object> getRuntimeAttributes(CollectionAgent agent, Map<String, Object> parameters) {
        final Map<String, Object> runtimeAttributes = new HashMap<>();
        final String collectionName = ParameterMap.getKeyedString(parameters, "collection", ParameterMap.getKeyedString(parameters, "wmi-collection", null));
        final WmiCollection collection = WmiDataCollectionConfigFactory.getInstance().getWmiCollection(collectionName);
        runtimeAttributes.put(WMI_COLLECTION_KEY, collection);
        final WmiAgentConfig agentConfig = WmiPeerFactory.getInstance().getAgentConfig(agent.getAddress());
        runtimeAttributes.put(WMI_AGENT_CONFIG_KEY, agentConfig);
        final WmiResourceTypeListWrapper wmiResourceTypeListWrapper = new WmiResourceTypeListWrapper(DataCollectionConfigFactory.getInstance().getConfiguredResourceTypes());
        runtimeAttributes.put(WMI_RESOURCE_TYPES_KEY, wmiResourceTypeListWrapper);
        return runtimeAttributes;
    }

