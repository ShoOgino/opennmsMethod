    /** {@inheritDoc} */
    public void initialize(final CollectionAgent agent, final Map<String, String> parameters) {
        LogUtils.debugf(this, "initialize: Initializing WMI collection for agent: %s", agent);
        final Integer scheduledNodeKey = new Integer(agent.getNodeId());
        WmiAgentState nodeState = m_scheduledNodes.get(scheduledNodeKey);

        if (nodeState != null) {
            LogUtils.infof(this, "initialize: Not scheduling interface for WMI collection: %s", nodeState.getAddress());
            final StringBuffer sb = new StringBuffer();
            sb.append("initialize service: ");
            sb.append(" for address: ");
            sb.append(nodeState.getAddress());
            sb.append(" already scheduled for collection on node: ");
            sb.append(agent);
            LogUtils.debugf(this, sb.toString());
            throw new IllegalStateException(sb.toString());
        } else {
            nodeState = new WmiAgentState(agent.getInetAddress(), parameters);
            LogUtils.infof(this, "initialize: Scheduling interface for collection: %s", nodeState.getAddress());
            m_scheduledNodes.put(scheduledNodeKey, nodeState);
        }
    }

