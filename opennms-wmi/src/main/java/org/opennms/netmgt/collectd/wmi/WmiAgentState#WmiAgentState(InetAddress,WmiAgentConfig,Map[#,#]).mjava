    public WmiAgentState(final InetAddress address, final WmiAgentConfig agentConfig, final Map<?,?> parameters) {
        m_address = InetAddressUtils.str(address);
        m_agentConfig = agentConfig;
        m_manager = new WmiManager(m_address, m_agentConfig.getUsername(), m_agentConfig.getPassword(), m_agentConfig.getDomain());

        try {
            m_wmiClient = new WmiClient(m_address);
        } catch(final WmiException e) {
            LOG.error("Failed to create WMI client.", e);
        }
    }

