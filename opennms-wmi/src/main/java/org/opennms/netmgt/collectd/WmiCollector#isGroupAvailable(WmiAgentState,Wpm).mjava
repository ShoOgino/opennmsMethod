    private boolean isGroupAvailable(WmiAgentState agentState, Wpm wpm) {
        log().debug("Checking availability of group " + wpm.getName());
        WmiManager manager;

        /*
         * We provide a bogus comparison value and use an operator of "NOOP"
         * to ensure that, regardless of results, we receive a result and perform
         * no logic. We're only validating that the agent is reachable and gathering
         * the result objects.
         */
        try {
            // Get and initialize the WmiManager
            manager = agentState.getManager();
            manager.init();

            WmiParams params = new WmiParams(WmiParams.WMI_OPERATION_INSTANCEOF, "not-applicable", "NOOP",
                    wpm.getWmiClass(), wpm.getKeyvalue());

            WmiResult result = manager.performOp(params);
            manager.close();
            boolean isAvailable = (result.getResultCode() == WmiResult.RES_STATE_OK);
            agentState.setGroupIsAvailable(wpm.getName(), isAvailable);
            log().debug("Group " + wpm.getName() + " is " + (isAvailable ? "" : "not") + "available ");
        } catch (WmiException e) {
            //throw new WmiCollectorException("Error checking group (" + wpm.getName() + ") availability", e);
            // Log a warning signifying that this group is unavailable.
            log().warn("Error checking group (" + wpm.getName() + ") availability", e);
            // Set the group as unavailable.
            agentState.setGroupIsAvailable(wpm.getName(), false);
            // And then continue on to check the next wpm entry.
            return false;
        }
        return true;
    }

