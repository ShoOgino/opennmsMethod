    @Override
    public boolean isServiceDetected(final InetAddress address, final DetectorMonitor detectMonitor) {
        WmiParams clientParams = null;

        if(getWmiWqlStr().equals(DEFAULT_WMI_WQL)) {
            // Create the check parameters holder.
            clientParams = new WmiParams(WmiParams.WMI_OPERATION_INSTANCEOF,
                                         getCompVal(), getCompOp(), getWmiClass(), getWmiObject());
        } else {
            // Define the WQL Query.
            clientParams = new WmiParams(WmiParams.WMI_OPERATION_WQL,
                                         getCompVal(), getCompOp(), getWmiWqlStr(), getWmiObject());
        }


        // Perform the operation specified in the parameters.
        WmiResult result = isServer(address, getUsername(), getPassword(), getDomain(), getMatchType(),
                getRetries(), getTimeout(), clientParams);

        // Only fail on critical and unknown returns.
        if (result != null && result.getResultCode() != WmiResult.RES_STATE_CRIT
                && result.getResultCode() != WmiResult.RES_STATE_UNKNOWN) {

            return true;
        } else {
            return false;
        }
    }

