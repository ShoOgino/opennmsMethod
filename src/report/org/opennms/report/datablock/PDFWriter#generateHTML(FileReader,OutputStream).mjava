	/**
	 * This converts the outage report from xml to pdf format using fop.
	 */
	public void generateHTML(FileReader xml, OutputStream fotFileName) throws MarshalException, ValidationException, IOException, Exception 
	{
		SimpleDateFormat fmt = new SimpleDateFormat("yyyyMMdd");
		ThreadCategory.setPrefix(LOG4J_CATEGORY);
		Category log = ThreadCategory.getInstance(PDFWriter.class);
		try
		{
			if(log.isInfoEnabled())
				log.info("XSL File " + m_xslSource);
			Reader xsl = new FileReader( m_xslSource );

			// create the SAX parser to supply to the FOP Driver to build the FO tree.

			TransformerFactory tfact = TransformerFactory.newInstance();
			Transformer processor = tfact.newTransformer(new StreamSource(xsl));
			processor.transform(new StreamSource(xml), new StreamResult(fotFileName));

			xml = null;
			fotFileName.close();
			fotFileName = null;
		}
                catch(IOException ioe)
                {
                        if(log.isEnabledFor(Priority.FATAL))
                                log.fatal("IOException " , ioe);
                        ioe.printStackTrace();
                        throw ioe;
                }
                catch(Exception e)
                {
                        if(log.isEnabledFor(Priority.FATAL))
                                log.fatal("Exception " , e);
                        e.printStackTrace();
                        throw e;
                }
	}

