        /**
         * Initialises the database connection.
         */
        public void initialiseConnection()  throws IOException, MarshalException, ValidationException, ClassNotFoundException, SQLException
        {
                org.apache.log4j.Category log = ThreadCategory.getInstance(this.getClass());
                //
                // Initialize the DataCollectionConfigFactory
                //
                try
                {
                        DatabaseConnectionFactory.init();
                        m_availConn = DatabaseConnectionFactory.getInstance().getConnection();
                }
                catch(MarshalException ex)
                {
                        if(log.isEnabledFor(Priority.FATAL))
                                log.fatal("initialize: Failed to load data collection configuration", ex);
                        throw new UndeclaredThrowableException(ex);
                }
                catch(ValidationException ex)
                {
                        if(log.isEnabledFor(Priority.FATAL))
                                log.fatal("initialize: Failed to load data collection configuration", ex);
                        throw new UndeclaredThrowableException(ex);
                }
                catch(IOException ex)
                {
                        if(log.isEnabledFor(Priority.FATAL))
                                log.fatal("initialize: Failed to load data collection configuration", ex);
                        throw new UndeclaredThrowableException(ex);
                }
                catch (ClassNotFoundException cnfE)
                {
                        if(log.isEnabledFor(Priority.FATAL))
                                log.fatal("initialize: Failed loading database driver.", cnfE);
                        throw new UndeclaredThrowableException(cnfE);
                }
                catch (SQLException sqlE)
                {
                        if(log.isEnabledFor(Priority.FATAL))
                                log.fatal("initialize: Failed getting connection to the database.", sqlE);
                        throw new UndeclaredThrowableException(sqlE);
                }
        }

