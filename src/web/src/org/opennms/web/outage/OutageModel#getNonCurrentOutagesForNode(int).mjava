    public Outage[] getNonCurrentOutagesForNode(int nodeId ) throws SQLException {
        Outage[] outages = new Outage[0];
        Connection conn = Vault.getDbConnection();

        try {
            PreparedStatement stmt = conn.prepareStatement(
                    "SELECT DISTINCT outages.outageid, outages.iflostservice, outages.ifregainedservice, outages.nodeID, node.nodeLabel, outages.ipaddr, ipinterface.iphostname, service.servicename, outages.serviceId " +
                    "from outages, node, ipinterface, service " +
                    "where outages.nodeid=? " +
                    "and node.nodeid=outages.nodeid and outages.serviceid=service.serviceid and ipinterface.ipaddr=outages.ipaddr " +
                    "and ifregainedservice is not null " +
                    "order by iflostservice desc"
                    );
            stmt.setInt(1, nodeId);
            ResultSet rs = stmt.executeQuery();
    
            outages = rs2Outages(rs);
            
            rs.close();
            stmt.close();
        }
        finally {
            Vault.releaseDbConnection( conn );
        }

        return outages;
    }

