    protected static Service[] rs2Services( ResultSet rs ) throws SQLException {
        Service[] services = null;
        Vector vector = new Vector();

        while(rs.next()) {
            Service service = new Service();
        
            Object element = new Integer(rs.getInt("nodeid"));
            service.m_nodeId = ((Integer)element).intValue();
        
            element = new Integer(rs.getInt("ifindex"));
            service.m_ifIndex = ((Integer)element).intValue();
        
            element = rs.getString("ipaddr");
            service.m_ipAddr = (String)element;
        
            element = rs.getTimestamp("lastgood");
            if (element != null)
                service.m_lastGood = EventConstants.formatToString(new Date(((Timestamp)element).getTime()));
        
            element = new Integer(rs.getInt("serviceid"));
            service.m_serviceId = ((Integer)element).intValue();
        
            element = rs.getString("servicename");
            service.m_serviceName = (String)element;
        
            element = rs.getTimestamp("lastfail");
            if (element != null)
                service.m_lastFail = EventConstants.formatToString(new Date(((Timestamp)element).getTime()));
            
            element = rs.getString("notify");
            service.m_notify = (String)element;
            
            element = rs.getString("status");
            if( element != null ) {
                service.m_status = ((String)element).charAt(0);
            }
    
            vector.addElement( service );
        }

        services = new Service[vector.size()];

        for( int i=0; i < services.length; i++ ) {
            services[i] = (Service)vector.elementAt(i);
        }

        return services;
    }

