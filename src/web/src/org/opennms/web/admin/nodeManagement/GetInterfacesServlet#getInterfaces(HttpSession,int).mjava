	/**
         * <p>Retrieve all the interfaces and services from the database, and keep them in
         * the user session.
         *
         * @param userSession   Current user working session
         * @param nodeId        Id of the node to manage
         */
	private List getInterfaces(HttpSession userSession, int nodeId)	throws SQLException
	{
		Connection connection = null;
		List allInterfaces = new ArrayList();
                int lineCount = 0;
                
		try
		{
			connection = DatabaseConnectionFactory.getInstance().getConnection();
			
                        PreparedStatement interfaceSelect = connection.prepareStatement(INTERFACE_QUERY);
                        interfaceSelect.setInt(1, nodeId);
                        
                        ResultSet interfaceSet = interfaceSelect.executeQuery();
                        while(interfaceSet.next())
                        {
                                lineCount++;
                                ManagedInterface newInterface = new ManagedInterface();
                                allInterfaces.add(newInterface);
                                newInterface.setNodeid(nodeId);
                                newInterface.setAddress(interfaceSet.getString(1));
                                newInterface.setStatus(interfaceSet.getString(2));
                                
                                PreparedStatement serviceSelect = connection.prepareStatement(SERVICE_QUERY);
				serviceSelect.setInt(1, nodeId);
                                serviceSelect.setString(2, newInterface.getAddress());
                                
                                ResultSet serviceSet = serviceSelect.executeQuery();
                                while(serviceSet.next())
                                {
                                        lineCount++;
                                        ManagedService newService = new ManagedService();
                                        newService.setId(serviceSet.getInt(1));
						newService.setName(serviceSet.getString(2));
                                        newService.setStatus(serviceSet.getString(3));
                                        newInterface.addService(newService);
                                }
                                serviceSelect.close();
                        }
                        interfaceSelect.close();
                        userSession.setAttribute("lineItems.nodemanagement", new Integer(lineCount));
		}
		finally
		{
			if(connection != null)
			{
				try {connection.close(); } catch(SQLException e) { }
			}
		}
		return allInterfaces;
	}

