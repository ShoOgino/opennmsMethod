        private List getAllNodes(HttpSession userSession)
                throws SQLException
        {
                Connection connection = null;
                List allNodes = new ArrayList();
                int lineCount = 0;

                try
                {
                        connection = DatabaseConnectionFactory.getInstance().getConnection();
                        int snmpServNum = 0;
                        Statement servstmt = connection.createStatement();
                        ResultSet snmpserv = servstmt.executeQuery(SNMP_SERVICE_QUERY);
                        if (snmpserv != null)
                        {
                                while (snmpserv.next ())
                                {
                                        snmpServNum = snmpserv.getInt(1);
                                }
                        }
                        this.log("DEBUG: The SNMP service number is: " + snmpServNum);


                        PreparedStatement stmt = connection.prepareStatement(NODE_QUERY);
                        stmt.setInt(1, snmpServNum);
                        ResultSet nodeSet = stmt.executeQuery();

                        if (nodeSet != null)
                        {
                                while (nodeSet.next ())
                                {
                                        SnmpManagedNode newNode = new SnmpManagedNode();
                                        newNode.setNodeID(nodeSet.getInt(1));
                                        newNode.setNodeLabel(nodeSet.getString(2));
                                        allNodes.add(newNode);

                                }
                        }
                        userSession.setAttribute("lineNodeItems.snmpmanage.jsp", new Integer(lineCount));

                        nodeSet.close();
                }
                finally
                {
                        if(connection != null)
                        {
                                try {connection.close(); } catch(SQLException e) { }
                        }
                }

                return allNodes;
        }

