    /**
     * @param session
     * @param _msg
     * @throws JavaMailerException
     */
    private void localMtaSend(Session session, Message _msg) throws JavaMailerException {
        SMTPTransport t = null;
        try {
            t = (SMTPTransport) session.getTransport(_transport);
            if (_authenticate)
                t.connect(_mailHost, _user, _password);
            else
                t.connect();
            
            t.sendMessage(_msg, _msg.getAllRecipients());
        } catch (NoSuchProviderException e) {
            throw new JavaMailerException("Couldn't get a transport: ", e);
        } catch (MessagingException e) {
            throw new JavaMailerException("Java Mailer messaging exception: ", e);
        } finally {
            System.out.println("Response: " + t.getLastServerResponse());
            try {
                t.close();
            } catch (MessagingException e1) {
                throw new JavaMailerException("Java Mailer messaging exception on transport close: ", e1);
            }
        }
    }

