	/**
	 * <P>Encodes the passed byte array using the base64 rules.
	 * The base64 encoding schema is performed by grouping 
	 * the bytes in to 6-bit quantities and then encoding
	 * them.</P>
	 *
	 * <P>For more information see RFC1341 for the format
	 * used for base64 encoding.</P>
	 *
	 * @param data  The input byte array
	 *
	 * @return The converted data in a character stream.
	 *
	 */
	public static char[] encodeBase64(byte[] data)
	{
		int destlen = ((data.length + 2) / 3) * 4;
		char[] dest = new char[destlen];
		int destndx = 0;
		
		for(int i = 0; i < data.length; i += 3)
		{
			int quantum = 0;
			int pad	 = 0;
			int bytes   = data.length - i;
			
			if(bytes >= 1)
			{
				quantum = (data[i] < 0 ? (256 + (int)data[i]) : (int)data[i]);
				pad = 2;
			}
			
			quantum <<= 8;
			if(bytes >= 2)
			{
				quantum |= (data[i+1] < 0 ? (256 + (int)data[i+1]) : (int)data[i+1]);
				pad = 1;
			}
			
			quantum <<= 8;
			if(bytes > 2)
			{
				quantum |= (data[i+2] < 0 ? (256 + (int)data[i+2]) : (int)data[i+2]);
				pad = 0;
			}
			
			for(int j = 3; j >= pad; j--)
			{
				int ndx = (quantum >> (j*6)) & 0x3f;
				dest[destndx++] = BASE64_CHARS[ndx];
			}
			
			for(int j = pad; j > 0; j--)
			{
				dest[destndx++] = BASE64_PAD;
			}
		}
		return dest;
	}

