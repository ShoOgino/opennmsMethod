    /**
     * @param text
     * @param subject
     * @param to
     * 
     */
    public void mailSend() throws JavaMailerException {
        
        Properties props = System.getProperties();
        
        if (_mailHost != null)
            props.put("mail.smtp.host", _mailHost);
        
        if (_authenticate)
            props.put("mail.smtp.auth", "true");
        
        // Get a Session object
        Session session = Session.getInstance(props, null);
        session.setDebug(DEFAULT_MAILER_DEBUG);
        
        // construct the message
        Message message = new MimeMessage(session);
        
        try {
            buildMsgHeader(log(), message);
            
            if (_fileName != null) {
                MimeBodyPart mbp1 = new MimeBodyPart(); // for message text
                // _msg.setText(_messageText);
                mbp1.setText(_messageText);
                
                MimeMultipart mp = new MimeMultipart();
                mp.addBodyPart(mbp1);
                
                log().debug("_file is not null");
                mimeAttachFile(mp);
                
                message.setContent(mp);
            } else {
                message.setText(_messageText);
            }
            
            message.setHeader("X-Mailer", _mailer);
            message.setSentDate(new Date());
            
            if (isUseJMTA()) {
                JMTA.send(message);
            } else {
                localMtaSend(session, message);
            }
            
        } catch (AddressException e) {
            throw new JavaMailerException("Java Mailer Addressing exception: ", e);
        } catch (MessagingException e) {
            throw new JavaMailerException("Java Mailer messaging exception: ", e);
        }
    }

