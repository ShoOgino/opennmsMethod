	/**
	 * <P>Constructs a new ICMP header based upon the data
	 * contained in the buffer. The buffer is decode in network
	 * byte ordering (big-endin) and must be at least a 
	 * {@link #getNetworkSize minimum} number of bytes available
	 * to be decoded.</P>
	 *
	 * <P>If there is an insufficent amount of data to decode
	 * a header then an exception is thrown.</P>
	 *
	 * @param data	The data buffer containing the header
	 * @param offset The offset of the header in the buffer
	 *
	 * @exception java.lang.IndexOutOfBoundsException Thrown
	 *	if there is not enough data to construct the header.
	 *
	 */
	public ICMPHeader(byte[] data, int offset)
	{
		if((data.length - offset) < getNetworkSize())
			throw new IndexOutOfBoundsException("Insufficient number of bytes available to construct the ICMP header");

		m_type = data[offset++];
		m_code = data[offset++];
		m_checksum = (short)(byteToShort(data[offset++]) << 8 | byteToShort(data[offset++]));
		m_sequence = (short)(byteToShort(data[offset++]) << 8 | byteToShort(data[offset++]));
		m_ident    = (short)(byteToShort(data[offset++]) << 8 | byteToShort(data[offset++]));
	}

