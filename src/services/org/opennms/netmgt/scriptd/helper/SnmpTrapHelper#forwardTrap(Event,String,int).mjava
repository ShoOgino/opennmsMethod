  /**
   * Create an SNMP trap, based on the content of the specified event, and forward
   * the trap to the specified address and port. It is assumed that the specified event
   * represents an SNMP V1 or V2 trap that was received by OpenNMS (TrapD). The type
   * of trap to be created depends on the type of the original trap (i.e. if the 
   * original trap was an SNMP V1 trap, an SNMP V1 trap will be created; if the  
   * original trap was an SNMP V2 trap, an SNMP V2 trap will be created).
   *
   * @param  event  The event upon which the trap content should be based
   * @param  destAddr  The address to which the trap should be forwarded
   * @param  destPort  The port to which the trap should be forwarded
   *
	 * @exception  Throws SnmpTrapHelperException if the variable binding cannot be
	 * added to the trap for any reason.
	 */

	public void forwardTrap(Event event, String destAddr, int destPort) throws SnmpTrapHelperException
	{

		Snmp snmpInfo = event.getSnmp();

		if (snmpInfo == null)
		{
			throw new SnmpTrapHelperException("Cannot forward an event with no SNMP info: " + event.getUei());
		}

		String version = snmpInfo.getVersion();

		if ("v1".equals(version))
		{
			forwardV1Trap(event, destAddr, destPort);
		}
		else if ("v2".equals(version))
		{
			forwardV2Trap(event, destAddr, destPort);
		}
		else
		{
			throw new SnmpTrapHelperException("Invalid SNMP version: " + version);
		}
	}

