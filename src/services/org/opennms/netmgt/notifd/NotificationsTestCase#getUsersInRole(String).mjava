    protected Collection getUsersInRole(String roleId) throws Exception {

        Map users = m_userManager.getUsers();
        Collection userNames = m_userManager.getUserNames();
        for (Iterator it = userNames.iterator(); it.hasNext();) {
            User user = (User) m_userManager.getUser((String) it.next());
            Collection roles = user.getRoleCollection();
            boolean hasRole = false;
            for(Iterator it2 = roles.iterator(); it2.hasNext();) {
                Role role = (Role) it2.next();
                if (roleId.equals(role.getRoleId())) {
                    hasRole = true;
                }
            }

            if(!hasRole) {
                it.remove();
            }
        }
        return userNames;
        
    }

