    /**
     * 
     */
    private void processTargets(Target[] targets, List targetSiblings, NoticeQueue noticeQueue, long startTime, Map params, int noticeId) throws IOException, MarshalException, ValidationException {
        Category log = ThreadCategory.getInstance(getClass());
        for (int i = 0; i < targets.length; i++) {
            String interval = (targets[i].getInterval() == null ? "0s" : targets[i].getInterval());

            String targetName = targets[i].getName();
            log.debug("Processing target " + targetName + ":" + interval);
            
            NotificationTask[] tasks = null;


            if (m_notifd.getGroupManager().hasGroup((targetName))) {
                
                tasks = makeGroupTasks(startTime, params, noticeId, targetName, targets[i].getCommand(), targetSiblings, TimeConverter.convertToMillis(interval));
                
            } else if (m_notifd.getUserManager().hasUser(targetName)) {
                
                NotificationTask[] userTasks = { makeUserTask(startTime, params, noticeId, targetName, targets[i].getCommand(), targetSiblings) };
                tasks = userTasks;
            } else if (targetName.indexOf("@") > -1) {
                
                NotificationTask[] emailTasks = { makeEmailTask(startTime, params, noticeId, targetName, targets[i].getCommand(), targetSiblings) };
                tasks = emailTasks;
            }
             
            if (tasks != null) {

                for (int index = 0; index < tasks.length; index++) {
                    NotificationTask task = tasks[index];
                    if (task != null) {
                        noticeQueue.put(task.getSendTime(), task);
                        targetSiblings.add(task);
                    }
                }
                
            } else {
                log.warn("Unrecognized target '" + targetName + "' contained in destinationPaths.xml. Please check the configuration.");
            }
            
        }
    }

