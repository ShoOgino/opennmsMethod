    private static List invokeMethods(MBeanServer server,
            InvokerService[] invokerServices,
            InvokeAtType at, boolean reverse,
            boolean failFast) {
        Category invokerLog = log();

        Integer[] serviceIndexes = new Integer[invokerServices.length];
        for (int i = 0; i < invokerServices.length; i++) {
            if (!reverse) {
                serviceIndexes[i] = new Integer(i);
            } else {
                serviceIndexes[i] = new Integer(invokerServices.length - 1 - i);
            }
        }

        List resultInfo = new ArrayList(invokerServices.length);
        for (int pass = 0, end = getEndPass(invokerServices); pass <= end; pass++) {
            if (invokerLog.isDebugEnabled()) {
                invokerLog.debug("starting pass " + pass);
            }

            for (int i = 0; i < serviceIndexes.length; i++) {
                int j = serviceIndexes[i].intValue();
                String name = invokerServices[j].getService().getName();
                if (invokerServices[j].isBadService()) {
                    if (invokerLog.isDebugEnabled()) {
                        invokerLog.debug("pass " + pass + " on service " + name
                                + " is bad: not invoking any more methods"); 
                    }
                    break;
                }
                Invoke[] todo = invokerServices[j].getService().getInvoke();
                for (int k = 0; todo != null && k < todo.length; k++) {
                    if (todo[k].getPass() != pass || !at.equals(todo[k].getAt())) {
                        continue;
                    }

                    Service service = invokerServices[j].getService();
                    ObjectInstance mbean = invokerServices[j].getMbean();

                    if (invokerLog.isDebugEnabled()) {
                        invokerLog.debug("pass " + pass + " on service " + name
                                + " will invoke method \""
                                + todo[k].getMethod() + "\""); 
                    }

                    try {
                        Object result = invoke(server, todo[k], mbean, invokerLog);
                        resultInfo.add(new InvokerResult(service, mbean, result, null));
                    } catch (Throwable t) {
                        resultInfo.add(new InvokerResult(service, mbean, null, t));
                        if (failFast) {
                            return resultInfo;
                        }
                    }
                }
            }
            if (invokerLog.isDebugEnabled()) {
                invokerLog.debug("completed pass " + pass);
            }
        }

        return resultInfo;
    }

