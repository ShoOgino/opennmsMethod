    public void runUpdate(String sql) {
        Category log = ThreadCategory.getInstance(getClass());

        log.info("Vacuumd executing statement: "+sql);
        // update the database
        Connection dbConn = null;
        boolean commit = false;
        try {
            dbConn = DatabaseConnectionFactory.getInstance().getConnection();
            dbConn.setAutoCommit(false);
            
            PreparedStatement stmt = dbConn.prepareStatement(sql);
            int count = stmt.executeUpdate();
            stmt.close();

            if (log.isDebugEnabled()) log.debug("Vacuumd: Ran update "+sql+": this affected "+count+" rows");

            commit = true;
        } catch (SQLException ex) {
            log.error("Vacuumd:  Database error execuating statement  " + sql, ex);
        } finally {

            if (dbConn != null) try {
                if (commit) {
                    dbConn.commit();
                } else {
                    dbConn.rollback();
                }
            } catch (SQLException ex) {
            } finally {
                if (dbConn != null) try { dbConn.close(); } catch (Exception e) {}                
            }
        }

    }

