    /**
     * This is a test for the passive status keeper where all the values from the config
     * should be derived using the config's value as an expression against a field in
     * the event.
     *  
     * @throws ValidationException 
     * @throws MarshalException 
     */
    public void testEventWithDerivedFieldValues() throws MarshalException, ValidationException {
        
        m_config = new PassiveStatusConfigFactory(new StringReader(getRegExFieldConfig()), m_db);
        PassiveStatusConfigFactory.setInstance(m_config);

        Event e = createPassiveStatusEvent(null, null, null, null);
        e.setHost("Router");
        e.setSource("192.168.1.1");
        e.setService("Simulated ICMP_service tester");
        e.setDescr("isDown");
        
        assertTrue(m_config.isPassiveStatusEvent(e));
        
        assertMatches(e);
    }

