    protected long getTimeStamp() {

        if (log().isDebugEnabled()) {
            log().debug("V2 trap first varbind value: " + getPdu().getVarBindAt(0).getValue().toString());
        }

        switch (getPdu().getVarBindAt(V2TrapInformation.SNMP_SYSUPTIME_OID_INDEX).getValue().typeId()) {
        case SnmpSMI.SMI_TIMETICKS:
            log().debug("V2 trap first varbind value is of type TIMETICKS (correct)");
            return ((SnmpTimeTicks) getPdu().getVarBindAt(V2TrapInformation.SNMP_SYSUPTIME_OID_INDEX).getValue()).getValue();
        case SnmpSMI.SMI_INTEGER:
            log().debug("V2 trap first varbind value is of type INTEGER, casting to TIMETICKS");
            return ((SnmpInt32) getPdu().getVarBindAt(V2TrapInformation.SNMP_SYSUPTIME_OID_INDEX).getValue()).getValue();
        default:
            throw new IllegalArgumentException("V2 trap does not have the required first varbind as TIMETICKS - cannot process trap");
        }
    }

