    protected void processTrap(TrapQueueProcessor processor) {
        
        validate();
        
        setVersion(getVersion());
        setCommunity(getCommunity());
        setAgentAddress(getAgentAddress());
        setTrapAddress(getTrapInterface());
    
        if (log().isDebugEnabled()) {
            log().debug(getVersion()+" trap - trapInterface: " + getTrapInterface());
        }
        
        // time-stamp
        setTimeStamp(getTimeStamp());
    
        setTrapIdentity(getTrapIdentity());
        
        for (int i = 0; i < getPduLength(); i++) {
            SnmpObjectId name = getVarBindAt(i).getName();
            SnmpSyntax obj = getVarBindAt(i).getValue();
            
            processVarBind(processor, name, obj);
        } // end for loop
    }

