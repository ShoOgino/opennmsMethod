	public void doTestTrap(String version, boolean newSuspectOnTrap) {
		if (newSuspectOnTrap) {
			tearDown();
			setUpTrapHandler(true);
			anticipateEvent("uei.opennms.org/internal/discovery/newSuspect");
		}

		anticipateEvent("uei.opennms.org/default/trap");
		
		if (version.equals("v1")) {
			sendV1Trap(".0.0", 6, 1);
		} else if (version.equals("v2c")) {
			sendV2Trap(".0.0", 6, 1);
		} else {
			throw new UndeclaredThrowableException(null, "unsupported SNMP version for test: " + version); 
		}
		
		finishUp();
	}

