    public long next() {
        if (m_scheduleEntries.isEmpty())
            throw new IllegalStateException("Nothing scheduled");
        
        Long nextTime = (Long)m_scheduleEntries.firstKey();
        List entries = (List)m_scheduleEntries.get(nextTime);
        Runnable runnable = (Runnable)entries.get(0);
        m_timer.setCurrentTime(nextTime.longValue());
        entries.remove(0);
        if (entries.isEmpty())
            m_scheduleEntries.remove(nextTime);
        runnable.run();
        return getCurrentTime();
    }

