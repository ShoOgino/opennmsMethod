	public synchronized void init()
	{
		// Set the category prefix
		ThreadCategory.setPrefix(LOG4J_CATEGORY);
		
		// get the category logger 
		Category log = ThreadCategory.getInstance();

		// Load up the configuration for the 
		// poller(s). Use this to start everything
		//
		try
		{
			PollerConfigFactory.reload();
		}
		catch(MarshalException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load poller configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		catch(ValidationException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load poller configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		catch(IOException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load poller configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		
		// Load up the configuration for the poll outages. 
		//
		try
		{
			PollOutagesConfigFactory.reload();
		}
		catch(MarshalException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load poll-outage configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		catch(ValidationException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load poll-outage configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		catch(IOException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load poll-outage configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		
		
		// Initialize the Capsd configuration factory 
		// Necessary for testing if an interface is managed/unmanaged
		//
		try
		{
			CapsdConfigFactory.reload();
		}
		catch(MarshalException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load Capsd configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		catch(ValidationException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load Capsd configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		catch(IOException ex)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to load Capsd configuration", ex);
			throw new UndeclaredThrowableException(ex);
		}
		
		if (log.isDebugEnabled())
			log.debug("start: Testing database connection");

		// Make sure we can connect to the database and load
		// the services table so we can easily convert from
		// service name to service id
		//
		java.sql.Connection ctest = null;
		ResultSet rs = null;
		try
		{
			DatabaseConnectionFactory.init();
			ctest = DatabaseConnectionFactory.getInstance().getConnection();
			
			PreparedStatement loadStmt= ctest.prepareStatement(SQL_RETRIEVE_SERVICE_IDS);
			
			// go ahead and load the service table 
			//
			rs = loadStmt.executeQuery();
			while(rs.next())
			{
				Integer id = new Integer(rs.getInt(1));
				String name = rs.getString(2);

				m_serviceIds.put(name, id);
			}
		}
		catch (IOException iE)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: IOException getting database connection", iE);
			throw new UndeclaredThrowableException(iE);
		}
		catch (MarshalException mE)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Marshall Exception getting database connection", mE);
			throw new UndeclaredThrowableException(mE);
		}
		catch (ValidationException vE)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Validation Exception getting database connection", vE);
			throw new UndeclaredThrowableException(vE);
		}
		catch (SQLException sqlE)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Error accessing database.", sqlE);
			throw new UndeclaredThrowableException(sqlE);
		}
		catch (ClassNotFoundException cnfE)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Error accessing database.", cnfE);
			throw new UndeclaredThrowableException(cnfE);
		}
		finally
		{
			if (rs != null)
			{
				try
				{
					rs.close();
				}
				catch(Exception e)
				{
					if(log.isInfoEnabled())
						log.info("start: an error occured closing the result set", e);
				}
			}
			if(ctest != null)
			{
				try
				{
					ctest.close();
				}
				catch(Exception e)
				{
					if(log.isInfoEnabled())
						log.info("start: an error occured closing the SQL connection", e);
				}
			}
		}

		// serviceUnresponsive behavior enabled/disabled?
		if (log.isDebugEnabled())
		{
			if (PollerConfigFactory.getInstance().serviceUnresponsiveEnabled())
			{
				log.debug("start: serviceUnresponsive behavior: enabled");
			}
			else
			{
				log.debug("start: serviceUnresponsive behavior: disabled");
			}
		}
		
		// Load up an instance of each monitor from the config
		// so that the event processor will have them for
		// new incomming events to create pollable service objects.
		//
		if (log.isDebugEnabled())
			log.debug("start: Loading monitors");
		PollerConfiguration pConfig = PollerConfigFactory.getInstance().getConfiguration();
		Enumeration eiter = pConfig.enumerateMonitor();
		while(eiter.hasMoreElements())
		{
			Monitor monitor = (Monitor)eiter.nextElement();
			try
			{
				if(log.isDebugEnabled())
				{
					log.debug("start: Loading monitor "
						  + monitor.getService()
						  + ", classname "
						  + monitor.getClassName());
				}
				Class mc = Class.forName(monitor.getClassName());
				ServiceMonitor sm = (ServiceMonitor)mc.newInstance();
				
				// Attempt to initialize the service monitor
				//
				Map properties = null; // properties not currently used
				sm.initialize(properties);
				
				m_svcMonitors.put(monitor.getService(), sm);
			}
			catch(Throwable t)
			{
				if(log.isEnabledFor(Priority.WARN))
				{
					log.warn("start: Failed to load monitor " + monitor.getClassName()
						 + " for service " + monitor.getService(), t);
				}
			}
		}

		// Create a scheduler
		//
		try
		{
			if(log.isDebugEnabled())
				log.debug("start: Creating poller scheduler");

			m_scheduler = new Scheduler("Poller", pConfig.getThreads());	
		}
		catch(RuntimeException e)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to create poller scheduler", e);
			throw e;
		}

		if(log.isDebugEnabled())
			log.debug("start: Scheduling existing interfaces");

		// Schedule the interfaces currently in the database
		//
		try
		{
			scheduleExistingInterfaces();
		}
		catch(SQLException sqlE)
		{
			if(log.isEnabledFor(Priority.ERROR))
				log.error("start: Failed to schedule existing interfaces", sqlE);
		}
		
		// Create an event receiver. The receiver will
		// receive events, process them, creates network
		// interfaces, and schedulers them.
		//
		try
		{
			if(log.isDebugEnabled())
				log.debug("start: Creating event broadcast event processor");

			m_receiver = new BroadcastEventProcessor(m_pollableServices);
		}
		catch(Throwable t)
		{
			if(log.isEnabledFor(Priority.FATAL))
				log.fatal("start: Failed to initialized the broadcast event receiver", t);

			throw new UndeclaredThrowableException(t);
		}
	}

