        public long next() {
            assertFalse("Nothing scheduled", m_scheduleEntries.isEmpty());
            
            Long nextTime = (Long)m_scheduleEntries.firstKey();
            List entries = (List)m_scheduleEntries.get(nextTime);
            ReadyRunnable readyRunnable = (ReadyRunnable)entries.get(0);
            m_currentTime = nextTime.longValue();
            if (readyRunnable.isReady()) {
                entries.remove(0);
                if (entries.isEmpty())
                    m_scheduleEntries.remove(nextTime);
                readyRunnable.run();
            }
            return m_currentTime;
        }

