    protected String getBasicAuthentication(Map parameters) {
        String credentials = ParameterMap.getKeyedString(parameters, "basic-authentication", null);
        if (credentials != null && !"".equals(credentials)) {
            return new String(Base64.encodeBase64(credentials.getBytes()));
        } else {
            String user = ParameterMap.getKeyedString(parameters, "user", null);
            if (user == null || "".equals(user))
                return null;
            
            String passwd = ParameterMap.getKeyedString(parameters, "password", "");
            
            return new String(Base64.encodeBase64((user+":"+passwd).getBytes()));
        }
    }

