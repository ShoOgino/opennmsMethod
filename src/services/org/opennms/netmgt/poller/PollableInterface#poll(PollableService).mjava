    /**
     * <P>
     * Invokes a poll of the service.
     * </P>
     * 
     * If the service changes status then node outage processing will be invoked
     * and the status of the entire interface will be evaluated.
     */
    public synchronized PollStatus poll(PollableService pSvc) {
        Category log = ThreadCategory.getInstance(getClass());

        setStatusChanged(false);

        PollStatus svcStatus = PollStatus.STATUS_UNKNOWN;

        // Get configured critical service
        String criticalSvcName = getPollerConfig().getCriticalService();
        if (log.isDebugEnabled())
            log.debug("poll: polling interface " + m_address.getHostAddress() + " status=" + getStatus() + " (criticalSvc= " + criticalSvcName + ")");

        // If no critical service defined then retrieve the
        // value of the 'pollAllIfNoCriticalServiceDefined' flag
        boolean pollAllServices = true;
        if (criticalSvcName == null) {
            pollAllServices = getPollerConfig().pollAllIfNoCriticalServiceDefined();
            if (log.isDebugEnabled())
                log.debug("poll: pollAllServices (since no critical svc defined) flag: " + pollAllServices);
        }

        // Polling logic if interface is currently DOWN
        //
        // Remember if critical service is defined and the interface is DOWN
        // we only poll the critical service (provided that the interface
        // actually supports the critical service).
        //
        if (getStatus() == PollStatus.STATUS_DOWN) {
            // Critical service defined and supported by interface
            if (criticalSvcName != null && this.supportsService(criticalSvcName)) {
                PollableService criticalSvc = null;

                // Service to be polled is critical service?
                if (pSvc.getServiceName().equals(criticalSvcName)) {
                    // Issue poll
                    svcStatus = pSvc.poll();
                    criticalSvc = pSvc;
                } else {
                    // This may be the first time this status has been
                    // polled since the interface was found to be DOWN
                    // (since it only takes the critical service being DOWN
                    // for the entire interface to be seen as DOWN) so go
                    // ahead and set the status on this service to DOWN.
                    pSvc.updateStatus(PollStatus.STATUS_DOWN);
                }

                if (svcStatus == PollStatus.STATUS_UP && criticalSvc.statusChanged()) {
                    // Mark interface as up and poll all remaining
                    // services on this interface
                    //
                    setStatus(PollStatus.STATUS_UP);
                    setStatusChanged(true);

                    pollRemainingServicesAdjustingSchedule(criticalSvc);

                    // Iterate over pollable services list, poll
                    // any remaining services which match this node/interface
                    // combination, and then reschedule them via the
                    // PollableServiceProxy.
                    synchronized (m_pollableServices) {
                        Iterator iter = m_pollableServices.iterator();
                        while (iter.hasNext()) {
                            PollableService tmp = (PollableService) iter.next();
                            InetAddress addr = (InetAddress) tmp.getAddress();
                            if (addr.equals(m_address)) {
                                if (!m_services.containsValue(tmp)) {
                                    PollStatus tmpStatus = tmp.poll();
                                    if (tmpStatus == PollStatus.STATUS_UP) {
                                        tmp.adjustSchedule();
                                    }
                                }
                            }
                        }
                    }
                }
            }
            // Critical svc not defined or not supported by interface.
            else {
                // Issue poll
                svcStatus = pSvc.poll();
                if (svcStatus == PollStatus.STATUS_UP && pSvc.statusChanged()) {
                    // Mark interface as up
                    setStatus(PollStatus.STATUS_UP);
                    setStatusChanged(true);

                    // Check flag which controls whether all services
                    // are polled if no critical service is defined
                    if (pollAllServices) {
                        // Poll all remaining services on the interface
                        pollRemainingServices(pSvc);
                    }
                }
            }
        }
        // Polling logic if interface is currently UP
        //
        else if (getStatus() == PollStatus.STATUS_UP) {
            // Issue poll
            svcStatus = pSvc.poll();
            if (svcStatus == PollStatus.STATUS_DOWN && pSvc.statusChanged()) {
                // If this is the only service supported by
                // the interface mark it as down
                if (m_services.size() == 1) {
                    setStatus(PollStatus.STATUS_DOWN);
                    setStatusChanged(true);
                }
                // else if Critical service defined and supported by interface
                // (regardless of pkg)
                else if (criticalSvcName != null && this.supportsService(criticalSvcName)) {
                    // Retrieve critical service PollableService object
                    // and poll it.
                    if (log.isDebugEnabled())
                        log.debug("poll: status changed to DOWN, now polling critical svc...");
                    PollableService criticalSvc = this.findService(criticalSvcName);

                    // If the service we just polled WAS in fact the critical
                    // service
                    // then no need to poll it again...the interface is DOWN!
                    PollStatus criticalSvcStatus = (pSvc == criticalSvc ? svcStatus : criticalSvc.poll());

                    if (criticalSvcStatus == PollStatus.STATUS_DOWN) {
                        if (log.isDebugEnabled())
                            log.debug("poll: critical svc DOWN, interface is down!");
                        setStatus(PollStatus.STATUS_DOWN);
                        setStatusChanged(true);
                    } else {
                        if (log.isDebugEnabled())
                            log.debug("poll: critical svc UP, interface still up!");
                    }
                }
                // else if no critical service or critical service not supported
                else {
                    // Check flag which controls whether all services
                    // are polled if no critical service is defined
                    if (pollAllServices) {
                        // Poll all remaining services on the interface
                        // If all services are DOWN then mark the interface DOWN
                        boolean allSvcDown = pollRemainingServicesWithStatus(pSvc);

                        if (allSvcDown) {
                            setStatus(PollStatus.STATUS_DOWN);
                            setStatusChanged(true);
                        }
                    }
                }
            }
        }

        if (log.isDebugEnabled())
            log.debug("poll: poll of interface " + m_address.getHostAddress() + " completed, status= " + getStatus());
        return getStatus();
    }

