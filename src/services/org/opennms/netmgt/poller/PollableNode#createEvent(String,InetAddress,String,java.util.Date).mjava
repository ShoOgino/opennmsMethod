    private Event createEvent(String 	uei, 
				InetAddress 	address, 
				String		svcName,
				java.util.Date  date)
	{
		Category log = ThreadCategory.getInstance(getClass());
		
		if (log.isDebugEnabled()) 
			log.debug("createEvent: uei = " + uei + " nodeid = " + m_nodeId);
		
		// create the event to be sent
		Event newEvent = new Event();
		newEvent.setUei(uei);
		newEvent.setSource(EVENT_SOURCE);
		newEvent.setNodeid((long)m_nodeId);
		if (address != null)
			newEvent.setInterface(address.getHostAddress());
		
		if (svcName != null)
			newEvent.setService(svcName);
		
		try
		{
			newEvent.setHost(InetAddress.getLocalHost().getHostName());
		}
		catch(UnknownHostException uhE)
		{
			newEvent.setHost("unresolved.host");
			log.warn("Failed to resolve local hostname", uhE);
		}
		
		// Set event time
		newEvent.setTime(EventConstants.formatToString(date));
		
		// For node level events (nodeUp/nodeDown) retrieve the
		// node's nodeLabel value and add it as a parm
		if (uei.equals(EventConstants.NODE_UP_EVENT_UEI) ||
			uei.equals(EventConstants.NODE_DOWN_EVENT_UEI))
		{
			String nodeLabel = null;
			try
			{
				nodeLabel = getPoller().getQueryMgr().getNodeLabel(m_nodeId);
			}
			catch (SQLException sqlE)
			{
				 // Log a warning
				 log.warn("Failed to retrieve node label for nodeid " + m_nodeId, sqlE);
			}
			 
			if (nodeLabel == null)
			{
				// This should never happen but if it does just
				// use nodeId for the nodeLabel so that the 
				// event description has something to display.
				nodeLabel = String.valueOf(m_nodeId);
			}
			
			// Add appropriate parms
			Parms eventParms = new Parms();
			
			// Add nodelabel parm
			Parm eventParm = new Parm();
			eventParm.setParmName(EventConstants.PARM_NODE_LABEL);
			Value parmValue = new Value();
			parmValue.setContent(nodeLabel);
			eventParm.setValue(parmValue);
			eventParms.addParm(eventParm);
			
			// Add Parms to the event
			newEvent.setParms(eventParms);
		}

		// The following code can be uncommented to add the nodelabel parm
		// to Interface Up/Down events. This is deprecated with the addition of 
		// special tags in EventUtil.
                // else if (uei.equals(EventConstants.INTERFACE_UP_EVENT_UEI) ||
                //         uei.equals(EventConstants.INTERFACE_DOWN_EVENT_UEI))
                // {
                //         String nodeLabel = null;
                //         try
                //         {
                //                 nodeLabel = getIntNodeLabel(address);
                //         }
                //         catch (SQLException sqlE)
                //         {
                //                  // Log a warning
                //                  log.warn("Failed to retrieve node label for nodeid " + address, sqlE);
                //         }

                //         if (nodeLabel == null)
                //         {
                //                 // This should never happen but if it does just
                //                 // use nodeId for the nodeLabel so that the
                //                 // event description has something to display.
                //                 nodeLabel = (String)address.getHostAddress();
                //         }

                //         // Add appropriate parms
                //         Parms eventParms = new Parms();

                //         // Add nodelabel parm
                //         Parm eventParm = new Parm();
                //         eventParm.setParmName(EventConstants.PARM_NODE_LABEL);
                //         Value parmValue = new Value();
                //         parmValue.setContent(nodeLabel);
                //         eventParm.setValue(parmValue);
                //         eventParms.addParm(eventParm);

                //         // Add Parms to the event
                //         newEvent.setParms(eventParms);
                // }

		
		return newEvent;
	}

