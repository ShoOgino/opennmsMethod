    /**
     * Validate the identifier by ensuring it is references in the schema.  Also checks 
     * for 'virtual columns' be checking the prefix.  If it is this turns into a reference
     * to the 'serviceName' column of the service table and the appropriate join.
     */
    private String validateIdent(String ident) {
        String expr = null;
        Table tableForIdent = m_schemaFactory.findTableByVisableColumn(ident);
        if (tableForIdent != null)
            expr = addColumnToStatement(tableForIdent, ident);

        if (expr == null && ident.startsWith(VIRTUAL_COLUMN_PREFIX)) {
            String serviceName = ident.substring(VIRTUAL_COLUMN_PREFIX.length());
            // should check against some form of
            // service identifier table, but for now I'm
            // removing this check since it's just used
            // internally
            //
            tableForIdent = m_schemaFactory.findTableByVisableColumn("serviceName");
            if (tableForIdent != null) 
                expr = addColumnToStatement(tableForIdent, "serviceName");
            if (expr != null)
                expr = expr+" = '"+serviceName+'\'';
        }
        
        if (expr == null) {
            throw new FilterParseException("The token " + ident
                    + " is an illegal column value.");
        }

        return expr;
    }

