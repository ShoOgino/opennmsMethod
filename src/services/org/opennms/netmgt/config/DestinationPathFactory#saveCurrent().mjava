        /**
         *
         */
        public synchronized void saveCurrent()
                throws MarshalException, ValidationException, IOException
        {
                allPaths.clearPath();
                Iterator i = m_destinationPaths.keySet().iterator();
                while(i.hasNext())
                {
                        allPaths.addPath( (Path)m_destinationPaths.get(i.next()));
                }
                
                allPaths.setHeader(rebuildHeader());
                
                //marshall to a string first, then write the string to the file. This way the original config
                //isn't lost if the xml from the marshall is hosed.
                StringWriter stringWriter = new StringWriter();
		Marshaller.marshal( allPaths, stringWriter );
                if (stringWriter.toString()!=null)
                {
                        FileWriter fileWriter = new FileWriter(m_pathsConfFile);
                        fileWriter.write(stringWriter.toString());
                        fileWriter.flush();
                        fileWriter.close();
                }
                
                reload();
        }

