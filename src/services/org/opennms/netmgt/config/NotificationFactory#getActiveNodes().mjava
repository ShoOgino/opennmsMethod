    /**
     */
    public List getActiveNodes() throws SQLException {
        String NODE_QUERY = "SELECT   n.nodeid " + "FROM     node n " + "WHERE    n.nodetype != 'D' " + "ORDER BY n.nodelabel";

        java.sql.Connection connection = null;
        List allNodes = new ArrayList();

        try {
            connection = DatabaseConnectionFactory.getInstance().getConnection();

            Statement stmt = connection.createStatement();
            ResultSet rset = stmt.executeQuery(NODE_QUERY);

            if (rset != null) {
                // Iterate through the result and build the array list
                while (rset.next()) {
                    int nodeID = rset.getInt(1);

                    allNodes.add(new Integer(nodeID));
                }
            }
            return allNodes;
        } finally {
            if (connection != null) {
                try {
                    connection.close();
                } catch (SQLException e) {
                }
            }
        }
    }

