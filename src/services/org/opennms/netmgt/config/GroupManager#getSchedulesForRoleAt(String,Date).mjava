    public List getSchedulesForRoleAt(String roleId, Date time) throws MarshalException, ValidationException, IOException {
        update();

        Role role = getRole(roleId);
        List schedules = new ArrayList();
        for (Iterator it = role.getScheduleCollection().iterator(); it.hasNext();) {
            Schedule sched = (Schedule) it.next();
            if (BasicScheduleUtils.isTimeInSchedule(time, sched)) {
                schedules.add(sched);
            }
        }
        return schedules;
    }

