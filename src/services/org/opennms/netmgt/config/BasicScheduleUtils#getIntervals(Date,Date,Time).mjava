    public static TimeIntervalSequence getIntervals(Date start, Date end, Time time) {
        TimeIntervalSequence seq = new TimeIntervalSequence();
        if (isWeekly(time)) {
            Date done = nextWeek(end);
            for(Date ref = start; done.after(ref); ref = nextWeek(ref)) {
                seq.addInterval(getInterval(ref, time));
            }
        } else if (isMonthly(time)) {
            Date done = nextMonth(end);
            for(Date ref = start; done.after(ref); ref = nextMonth(ref)) {
                seq.addInterval(getInterval(ref, time));
            }
        } else {
            seq.addInterval(getInterval(start, time));
        }
        seq.bound(start, end);
        return seq;
    }

