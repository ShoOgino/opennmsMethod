	/**
	 * Checks the configuration to determine if 
	 * the target is managed or unmanaged.
	 *
	 * @param target	The target to check against.
	 */
	public boolean isAddressUnmanaged(InetAddress target)
	{
		Category log = ThreadCategory.getInstance(CapsdConfigFactory.class);
		String temp = m_config.getManagementPolicy();
		boolean managed_by_default = (temp == null || temp.equalsIgnoreCase("managed"));

		boolean found_denial = false;
		boolean found_accept = false;
		Enumeration e = m_config.enumerateIpManagement();
		while(e.hasMoreElements() && !found_denial)
		{
			IpManagement mgt = (IpManagement)e.nextElement();
			Enumeration f = mgt.enumerateSpecific();
			while(f.hasMoreElements())
			{
				String saddr = f.nextElement().toString();
				try
				{
					InetAddress addr = InetAddress.getByName(saddr);
					if(addr.equals(target))
					{
						if(mgt.getPolicy() == null || mgt.getPolicy().equalsIgnoreCase("managed"))
							found_accept = true;
						else
							found_denial = true;

						break;
					}
				}
				catch(UnknownHostException ex)
				{
					log.info("Failed to convert management address " + saddr + " to an InetAddress", ex);
				}
			}

			// now check the ranges
			//
			f = mgt.enumerateRange();
			while(!found_denial && f.hasMoreElements())
			{
				Range rng = (Range)f.nextElement();
				try
				{
					InetAddress saddr = InetAddress.getByName(rng.getBegin());
					InetAddress eaddr = InetAddress.getByName(rng.getEnd());

					long start = toLong(saddr);
					long stop  = toLong(eaddr);
					long tgt   = toLong(target);
					if(start <= tgt && tgt <= stop)
					{
						if(mgt.getPolicy() == null || mgt.getPolicy().equalsIgnoreCase("managed"))
							found_accept = true;
						else
							found_denial = true;

						break;
					}
				}
				catch(UnknownHostException ex)
				{
					log.info("Failed to convert management addresses (" + rng.getBegin() + ", " + rng.getEnd() + ")", ex);
				}
			}
			
			// now check urls
			//
			f = mgt.enumerateIncludeUrl();
			boolean match = false;
			while(!found_denial && !match && f.hasMoreElements())
			{
				String url = f.nextElement().toString();
				
				// Retrieve address list from url map
				List addresses = (List)m_urlMap.get(url);
				
				// Iterate over addresses looking for target match
				Iterator iter = addresses.iterator();
				while(iter.hasNext())
				{
					String saddr = (String)iter.next();
					try
					{
						InetAddress addr = InetAddress.getByName(saddr);
						if(addr.equals(target))
						{
							if(mgt.getPolicy() == null || mgt.getPolicy().equalsIgnoreCase("managed"))
								found_accept = true;
							else
								found_denial = true;
							
							match = true;
							break;
						}
					}
					catch(UnknownHostException ex)
					{
						log.info("Failed to convert management address " + saddr + " to an InetAddress", ex);
					}
				}
			}
					
			
		}

		boolean result = !managed_by_default;
		if(found_denial)
			result = true;
		else if(found_accept)
			result = false;

		return result;
	}

