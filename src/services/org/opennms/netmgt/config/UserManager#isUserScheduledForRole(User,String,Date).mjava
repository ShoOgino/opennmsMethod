    public boolean isUserScheduledForRole(User user, String roleid, Date time) throws FileNotFoundException, MarshalException, ValidationException, IOException {
        update();

        Collection roles = user.getRoleCollection();
        
        for(Iterator it = roles.iterator(); it.hasNext();) {
            Role role = (Role)it.next();
            if (roleid.equals(role.getRoleId())) {
                DutySchedule dutySchedule = new DutySchedule(role.getSchedule());
                if (dutySchedule.isInSchedule(time))
                    return true;
            }
        }
        
        return false;
    }

