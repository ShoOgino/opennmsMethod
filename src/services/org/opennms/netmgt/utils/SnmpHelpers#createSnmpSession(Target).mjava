    public static Snmp createSnmpSession(Target target) throws IOException {
        TransportMapping transport;
        
        transport = new DefaultUdpTransportMapping();
        
        Snmp snmp = new Snmp(transport);

        if (target.getVersion() == SnmpConstants.version3) {
            UserTarget userTarget = (UserTarget)target;
            USM usm = new USM(SecurityProtocols.getInstance(), new OctetString(MPv3.createLocalEngineID()), 0);
            SecurityModels.getInstance().addSecurityModel(usm);
//          UsmUser user = new UsmUser(DEFAULT_SECURITY_NAME, DEFAULT_AUTH_PROTOCOL, DEFAULT_AUTH_PASSPHRASE, DEFAULT_PRIV_PROTOCOL, DEFAULT_PRIV_PASSPHRASE);
            UsmUser user = new UsmUser(userTarget.getSecurityName(), null, null, null, null);
            snmp.getUSM().addUser(userTarget.getSecurityName(), user);
        }

        return snmp;
    }

