    public static JFreeChart getBarChart(String chartName) throws MarshalException, ValidationException, IOException, SQLException {

        BarChart chart = null;
        Connection conn = null;
        CategoryDataset dataSet = null;
        chart = getBarChartConfigByName(chartName);
        conn = DatabaseConnectionFactory.getInstance().getConnection();
        dataSet = new JDBCCategoryDataset(conn, chart.getJdbcDataSet().getSql());
        
        PlotOrientation po = (chart.getPlotOrientation() == "horizontal" ? PlotOrientation.HORIZONTAL : PlotOrientation.VERTICAL);
        
        JFreeChart barChart = ChartFactory.createBarChart(chart.getTitle().getValue(),
                chart.getDomainAxisLabel(),
                chart.getRangeAxisLabel(),
                dataSet,
                po,
                chart.getShowLegend(),
                chart.getShowToolTips(),
                chart.getShowUrls());
        
        return barChart;
        
    }

