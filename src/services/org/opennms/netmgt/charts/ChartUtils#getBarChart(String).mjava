    public static JFreeChart getBarChart(String chartName) throws MarshalException, ValidationException, IOException, SQLException {

        BarChart chartConfig = null;
        Connection conn = null;
        CategoryDataset dataSet = null;
        chartConfig = getBarChartConfigByName(chartName);
        
        if (chartConfig == null) {
            throw new IllegalArgumentException("getBarChart: Invalid chart name.");
        }
        
        conn = DatabaseConnectionFactory.getInstance().getConnection();
        dataSet = new JDBCCategoryDataset(conn, chartConfig.getJdbcDataSet().getSql());
        
        PlotOrientation po = (chartConfig.getPlotOrientation() == "horizontal" ? PlotOrientation.HORIZONTAL : PlotOrientation.VERTICAL);
        
        JFreeChart barChart = ChartFactory.createBarChart(chartConfig.getTitle().getValue(),
                chartConfig.getDomainAxisLabel(),
                chartConfig.getRangeAxisLabel(),
                dataSet,
                po,
                chartConfig.getShowLegend(),
                chartConfig.getShowToolTips(),
                chartConfig.getShowUrls());
        
        for (Iterator it = chartConfig.getSubTitleCollection().iterator(); it.hasNext();) {
            SubTitle subTitle = (SubTitle) it.next();
            Title title = subTitle.getTitle();
            String value = title.getValue();
            barChart.addSubtitle(new TextTitle(value));
        }
        

        CategoryPlot plot = barChart.getCategoryPlot();
        BarRenderer renderer = (BarRenderer)plot.getRenderer();
        

        SeriesDef[] seriesDefs = chartConfig.getSeriesDef();
        for (int i = 0; i < seriesDefs.length; i++) {
            SeriesDef seriesDef = seriesDefs[i];
            Rgb rgb = seriesDef.getRgb();
            Paint paint = new Color(rgb.getRed().getRgbColor(), rgb.getBlue().getRgbColor(), rgb.getGreen().getRgbColor());
            renderer.setSeriesPaint(i, paint);
        }

        return barChart;
        
    }

