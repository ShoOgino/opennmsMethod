    public Object createDefinition(String creator, String directory, String rrdName, int step, List dataSources, List rraList) throws Exception {
        checkState("createDefinition");

        File f = new File(directory);
        f.mkdirs();

        String fileName = directory + File.separator + rrdName + RrdUtils.getExtension();

        StringBuffer createCmd = new StringBuffer("create");

        createCmd.append(' ' + fileName);

        createCmd.append(" --start=" + (System.currentTimeMillis() / 1000L - 10L));

        createCmd.append(" --step=" + step);
        
        for (Iterator iter = dataSources.iterator(); iter.hasNext();) {
            RrdDataSource dataSource = (RrdDataSource) iter.next();
            createCmd.append(" DS:");
            createCmd.append(dataSource.getName()).append(':');
            createCmd.append(dataSource.getType()).append(":");
            createCmd.append(dataSource.getHeartBeat()).append(':');
            createCmd.append(dataSource.getMin()).append(':');
            createCmd.append(dataSource.getMax());
        }


        for (Iterator it = rraList.iterator(); it.hasNext();) {
            String rra = (String) it.next();
            createCmd.append(' ');
            createCmd.append(rra);
        }

        return createCmd.toString();
    }

