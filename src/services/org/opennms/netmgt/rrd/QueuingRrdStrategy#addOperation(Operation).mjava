    /**
     * Add an operation to the queue.
     */
    public void addOperation(Operation op) {
        synchronized (this) {
            storeAssignment(op);

            totalOperationsPending++;
            enqueuedOperations++;
            if (op.isSignificant())
                significantOpsEnqueued++;
            notifyAll();
            ensureThreadsStarted();
        }
    }

