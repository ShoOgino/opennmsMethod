    /**
     * Creates and returns a RrdDef represented by the parameters.
     */
    public Object createDefinition(String creator, String directory, String dsName, int step, String dsType, int dsHeartbeat, String dsMin, String dsMax, List rraList) throws Exception {

        File f = new File(directory);
        f.mkdirs();

        String fileName = directory + File.separator + dsName + ".rrd";

        RrdDef def = new RrdDef(fileName);

        // def.setStartTime(System.currentTimeMillis()/1000L - 2592000L);
        def.setStartTime(1000);
        def.setStep(step);

        double min = (dsMin == null || "U".equals(dsMin) ? Double.NaN : Double.parseDouble(dsMin));
        double max = (dsMax == null || "U".equals(dsMax) ? Double.NaN : Double.parseDouble(dsMax));
        def.addDatasource(dsName, dsType, dsHeartbeat, min, max);

        for (Iterator it = rraList.iterator(); it.hasNext();) {
            String rra = (String) it.next();
            def.addArchive(rra);
        }

        return def;

    }

