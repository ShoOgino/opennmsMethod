    public void run() {
        try {
           
            long waitStart = -1L;
            long delayed = 0;
            while (delayed < WRITE_THREAD_EXIT_DELAY) {
                if (totalOperationsPending > 0) {
                    delayed = 0;
                    waitStart = -1L;
                    processPendingOperations();
                }
                else {
                    if (waitStart < 0) {
                        waitStart = System.currentTimeMillis();
                    }
                    try { Thread.sleep(WRITE_THREAD_SLEEP_TIME); } catch (InterruptedException e) {}
                    long now = System.currentTimeMillis();
                    delayed = now - waitStart;
                }
                

            }
        } finally {
            synchronized (this) {
                threadsRunning--;
                completeAssignment();
            }
        }
    }

