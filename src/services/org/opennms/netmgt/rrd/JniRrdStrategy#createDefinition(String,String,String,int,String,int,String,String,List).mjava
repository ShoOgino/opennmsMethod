    /**
     * Constructs an rrdtool create command string that can be used to create the rrd file
     * and returns it as the rrdDefinition object.
     * 
     */
    public Object createDefinition(String creator, String directory, String dsName, int step, String dsType, int dsHeartbeat, String dsMin,
            String dsMax, List rraList) throws Exception {
        
        File f = new File(directory);
        f.mkdirs();
        
        String fileName = directory+File.separator+dsName+".rrd";

        StringBuffer createCmd = new StringBuffer("create");

        createCmd.append(' ' + fileName);
        
        createCmd.append(" --start="+(System.currentTimeMillis()/1000L - 10L));

        createCmd.append(" --step=" + step);

        createCmd.append(" DS:" + dsName + ":"+dsType+":" + dsHeartbeat + ':' + dsMin + ':' + dsMax);
        
        for (Iterator it = rraList.iterator(); it.hasNext();) {
            String rra = (String) it.next();
            createCmd.append(' ');
            createCmd.append(rra);
        }

        return createCmd.toString();
    }

