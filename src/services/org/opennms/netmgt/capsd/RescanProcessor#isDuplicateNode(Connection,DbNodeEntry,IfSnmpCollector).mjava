	/**
	 * This method checks if a suspect node entry is a duplicate node to the
         * updating node by verify if each interface in the suspect node is 
         * contained in the ipAddrTable of the updating node.
	 * 
         * @param dbc           Database connection
	 * @param suspectNode	the suspect node to verify duplication. 
	 * @param snmpc         the SNMP collection of the updating node.
	 */
        private boolean isDuplicateNode(Connection dbc, DbNodeEntry suspectNode, IfSnmpCollector snmpc)
        {

		Category log = ThreadCategory.getInstance(getClass());
		if (suspectNode == null)
                {
		        if (log.isDebugEnabled())
			        log.debug("isDuplicateNode: null node.");
                        return false;

                }
						
		// Retrieve list of interfaces associated with the suspect node
                try 
                {
		        DbIpInterfaceEntry[] tmpIfArray = suspectNode.getInterfaces(dbc);
				
			for (int i = 0; i < tmpIfArray.length; i++)
			{
			        InetAddress addr = tmpIfArray[i].getIfAddress();
				int index = tmpIfArray[i].getIfIndex();
							
                                InetAddress[] updateIfs = snmpc.getIfAddressAndMask(index);
                                if (updateIfs == null)
                                {
				        if (log.isDebugEnabled())
					        log.debug("isDuplicateNode: Interface: " + addr.getHostAddress()
                                                        + " is not in the ipAddrTable of the updating node.");
                                        return false;
			        }
                                else
                                {       
                                        boolean match = false;
                                        for (int inx = 0; inx < updateIfs.length; inx ++)
                                        {
                                                if (updateIfs[inx].getHostAddress().equals(addr.getHostAddress()))
                                                {
				                        if (log.isDebugEnabled())
					                        log.debug("isDuplicateNode: Interface: " + addr.getHostAddress()
                                                                        + " found a match in the ipAddrTable of the updating node.");
                                                        match = true;
                                                        break;
                                                }
                                        }

                                        if (!match)
                                        {
				                if (log.isDebugEnabled())
					                log.debug("isDuplicateNode: Interface: " + addr.getHostAddress()
                                                                + " is not in the ipAddrTable of the updating node.");
                                                return false;
                                        }
                                }
                        }
			
                        return true;
                }
                catch (SQLException sqlE)
                {
                        log.error("isDuplicateNode: failed to retrieve all interfaces for the supect node"
                                + suspectNode.getNodeId(), sqlE);
                        return false;
                }
        }

