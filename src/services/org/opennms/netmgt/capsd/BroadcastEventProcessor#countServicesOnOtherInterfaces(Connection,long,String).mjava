    /**
     * Counts the number of non deleted services on a node on interfaces other
     * than a given interface
     * 
     * @param dbConn
     *            the database connection
     * @param nodeId
     *            the nodeid to check
     * @param ipAddr
     *            the address of the interface not to include
     * @return the number of non deleted services on other interfaces
     */
    private int countServicesOnOtherInterfaces(Connection dbConn, long nodeId, String ipAddr) throws SQLException {
        Category log = ThreadCategory.getInstance(getClass());

        final String DB_COUNT_SERVICES_ON_OTHER_INTERFACES = "SELECT count(*) FROM ifservices WHERE nodeID=? and ipAddr != ? and status != 'D'";

        PreparedStatement stmt = dbConn.prepareStatement(DB_COUNT_SERVICES_ON_OTHER_INTERFACES);
        stmt.setLong(1, nodeId);
        stmt.setString(2, ipAddr);
        ResultSet rs = stmt.executeQuery();

        int count = 0;
        while (rs.next()) {
            count = rs.getInt(1);
        }

        if (log.isDebugEnabled())
            log.debug("countServicesOnOtherInterfaces: count services for node " + nodeId + ": found " + count);

        stmt.close();

        return count;
    }

