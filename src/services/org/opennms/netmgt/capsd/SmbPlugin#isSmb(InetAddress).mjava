	/**
	 * Test to see if the passed host talks SMB &amp; has a NetBIOS name.
	 *
	 * @param host	The remote host to check.
	 *
	 * @return True if the remote interface responds talks SMB and has a
	 *        NETBIOS name.  False otherwise.
	 */
	private boolean isSmb(InetAddress host)
	{
		Category log = ThreadCategory.getInstance(getClass());
		boolean isAServer = false;
		try
		{
			NbtAddress nbtAddr = NbtAddress.getByName(host.getHostAddress());
			
			// If the retrieved SMB name is equal to the IP address
			// of the host, the it is safe to assume that the interface
			// does not support SMB
			//
			if(nbtAddr.getHostName().equals(host.getHostAddress()))
			{
				if (log.isDebugEnabled())
					log.debug("SmbPlugin: failed to retrieve SMB name for " + host.getHostAddress());
			}
			else
			{
				isAServer = true;
			}
		}
		catch(UnknownHostException e)
		{
			if (log.isDebugEnabled())
				log.debug("SmbPlugin: UnknownHostException: " + e.getMessage());
		}
		catch(IOException e)
		{
			log.info("SmbPlugin: An unexpected I/O exception occured checking host " + host.getHostAddress(), e);
		}
		catch(Throwable t)
		{
			log.error("SmbPlugin: An undeclared throwable exception was caught checking host " + host.getHostAddress(), t);
		}	
			
		return isAServer;
	}

