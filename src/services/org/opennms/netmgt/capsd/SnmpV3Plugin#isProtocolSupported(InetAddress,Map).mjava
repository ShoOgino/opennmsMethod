    /**
     * This is the method used by the plugin to attempt SNMPv3 communications
     * with an agent specified at @param address using @param qualifiers specified
     * in capsd-configuration.xml
     * 
     * @param address
     *      The IP address of the agent.
     * @param qualifiers
     *      A HashMap of parameter keys set in the config.
     * 
     * @return True if SNMPv3 is supported by the address.
     */
    public boolean isProtocolSupported(InetAddress address, Map qualifiers) {

        InetAddress inetAddress = address;
        
        //Get a target from the PeerFactory and force to version 3
        Target target = SnmpPeerFactory.getInstance().getTarget(inetAddress, SnmpConstants.version3);
        
        String vbValue = (String)qualifiers.get("vbvalue");
        String oid = ParameterMap.getKeyedString(qualifiers, "vbname", DEFAULT_OID);
        
        boolean isSupported = false;
        
        MPv3.setEnterpriseID(5813);
        
        Snmp snmp = null;
        try {
            snmp = SnmpHelpers.createSnmpSession();
            snmp.listen();
            PDU requestPDU = SnmpHelpers.createPDU();
            VariableBinding vb = new VariableBinding(new OID(oid));
            requestPDU.add(vb);
            
            PDU responsePDU = null;
            ResponseEvent responseEvent;
            responseEvent = snmp.get(requestPDU, target);
            snmp.close();
            
            if (responseEvent.getResponse() != null) {
                isSupported = true;
            } else {
                isSupported = false;
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }

        return isSupported;
    }

