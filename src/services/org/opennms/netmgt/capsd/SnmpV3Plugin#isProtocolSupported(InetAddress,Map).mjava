    /**
     * This is the method used by the plugin to attempt SNMPv3 communications
     * with an agent specified at @param address using @param qualifiers specified
     * in capsd-configuration.xml
     * 
     * @param address
     *      The IP address of the agent.
     * @param qualifiers
     *      A HashMap of parameter keys set in the config.
     * 
     * @return True if SNMPv3 is supported by the address.
     */
    public boolean isProtocolSupported(InetAddress address, Map qualifiers) {

        InetAddress inetAddress = address;
        String port =  (qualifiers.get("port") == null ? DEFAULT_PORT : (String)qualifiers.get("port"));
        String timeout = (qualifiers.get("timeout") == null ? DEFAULT_TIMEOUT : (String)qualifiers.get("timeout"));
        String retry = (qualifiers.get("retry") == null ? DEFAULT_RETRY : (String)qualifiers.get("retry"));
//        String forceVersion = (qualifiers.get("forced version") == null ? DEFAULT_VERSION : (String)qualifiers.get("forced version"));
        String vbValue = (String)qualifiers.get("vbvalue");
        String oid = ParameterMap.getKeyedString(qualifiers, "vbname", DEFAULT_OID);
        
        String uname = (qualifiers.get("security name") == null ? DEFAULT_SECURITY_NAME : (String)qualifiers.get("security name"));
        
        boolean isSupported = false;
        
        MPv3.setEnterpriseID(5813);
        
        String transportAddress = inetAddress.getHostAddress() + "/" + DEFAULT_PORT;
        
        Address targetAddress = new UdpAddress(transportAddress);
        Snmp snmp = null;
        try {
            snmp = SnmpHelpers.createSnmpSession(new OctetString(uname));
            UserTarget target = new UserTarget();
            target.setSecurityLevel(SecurityLevel.NOAUTH_NOPRIV);
            target.setVersion(SnmpConstants.version3);
            target.setAddress(targetAddress);
            target.setRetries(Integer.parseInt(retry));
            target.setTimeout(Integer.parseInt(timeout));
            target.setSecurityName(new OctetString(uname));
            snmp.listen();
            PDU request = SnmpHelpers.createPDU(target);
            VariableBinding vb = new VariableBinding(new OID(DEFAULT_OID));
            request.add(vb);
            
            PDU response = null;
            ResponseEvent responseEvent;
            responseEvent = snmp.send(request, target);
            snmp.close();
            
            if (responseEvent.getResponse() != null) {
                isSupported = true;
            } else {
                isSupported = false;
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }

        return isSupported;
    }

