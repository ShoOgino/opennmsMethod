    /**
     * This method is used to <em>probe</em> the target addresses using the
     * configured list of protocol specifications from the Configuration
     * Manager. The list of supported protocols are added to the supports list.
     * Any failures in the plugins are logged and discarded.
     * 
     * @param target
     *            The target to probe
     * @param supports
     *            The supported protocols (SupportedProtocol)
     * 
     */
    private static void probe(InetAddress target, List supports) {
        Category log = ThreadCategory.getInstance(IfCollector.class);
        String logAddr = target.getHostAddress();

        CapsdConfigFactory.ProtocolInfo[] plugins = CapsdConfigFactory.getInstance().getProtocolSpecification(target);

        // First run the plugins to find out all the capabilities
        // for the interface
        //
        for (int i = 0; i < plugins.length; i++) {
            log.debug(logAddr + " testing plugin " + plugins[i].getProtocol());
            if (plugins[i].autoEnabled()) {
                log.debug(logAddr + " protocol " + plugins[i].getProtocol() + " is auto enabled");
                supports.add(new SupportedProtocol(plugins[i].getProtocol(), null));
                continue;
            }

            try {
                Plugin p = plugins[i].getPlugin();
                Map q = plugins[i].getParameters();
                boolean r = p.isProtocolSupported(target, q);

                log.debug(logAddr + " protocol " + plugins[i].getProtocol() + " supported? " + (r ? "true" : "false"));

                if (r)
                    supports.add(new SupportedProtocol(plugins[i].getProtocol(), q));
            } catch (UndeclaredThrowableException utE) {
                Throwable t = utE.getUndeclaredThrowable();
                if (t instanceof NoRouteToHostException) {
                    if (CapsdConfigFactory.getInstance().getAbortProtocolScansFlag()) {
                        log.warn("IfCollector: No route to host " + logAddr + ", aborting protocol scans.");
                        break; // Break out of plugin loop
                    } else {
                        log.warn("IfCollector: No route to host " + logAddr + ", continuing protocol scans.");
                    }
                } else {
                    log.warn("IfCollector: Caught undeclared throwable exception when testing for protocol " + plugins[i].getProtocol() + " on host " + logAddr, utE);
                }
            } catch (Throwable t) {
                log.warn("IfCollector: Caught an exception when testing for protocol " + plugins[i].getProtocol() + " on host " + logAddr, t);
            }
            log.debug(logAddr + " plugin " + plugins[i].getProtocol() + " completed!");
        }
    }

