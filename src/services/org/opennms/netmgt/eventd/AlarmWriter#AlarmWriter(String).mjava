    /**
     * Constructor
     * @param connectionFactory 
     */
    public AlarmWriter(String getNextAlarmIdStr) throws SQLException {
        super();
        //
        // prepare the SQL statement
        //
        m_getSvcIdStmt = m_dbConn.prepareStatement(EventdConstants.SQL_DB_SVCNAME_TO_SVCID);
        m_getHostNameStmt = m_dbConn.prepareStatement(EventdConstants.SQL_DB_HOSTIP_TO_HOSTNAME);
        m_getNextIdStmt = m_dbConn.prepareStatement(getNextAlarmIdStr);
        m_insStmt = m_dbConn.prepareStatement(EventdConstants.SQL_DB_ALARM_INS_EVENT);
        m_reductionQuery = m_dbConn.prepareStatement(EventdConstants.SQL_DB_ALARM_REDUCTION_QUERY);
        m_upDateStmt = m_dbConn.prepareStatement(EventdConstants.SQL_DB_ALARM_UPDATE_EVENT);
        // set the database for rollback support
        //
        try {
            m_dbConn.setAutoCommit(false);
        } catch (SQLException se) {
            ThreadCategory.getInstance(AlarmWriter.class).warn("Unable to set auto commit mode");
        }
    }

