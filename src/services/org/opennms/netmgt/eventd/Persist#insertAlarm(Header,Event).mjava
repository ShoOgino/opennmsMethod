    /**
     * Insert values into the ALARMS table
     * 
     * @exception java.sql.SQLException
     *                Thrown if there is an error adding the event to the
     *                database.
     * @exception java.lang.NullPointerException
     *                Thrown if a required resource cannot be found in the
     *                properties file.
     */
    protected void insertAlarm(Header eventHeader, Event event) throws SQLException {
        int alarmID = -1;
        Category log = ThreadCategory.getInstance(AlarmWriter.class);
        
        alarmID = getNextId();
        if (log.isDebugEnabled()) log.debug("AlarmWriter: DBID: "+ alarmID);

        //Column 1, alarmId
        m_insStmt.setInt(1, alarmID);
        
        //Column 2, eventUie
        m_insStmt.setString(2, Constants.format(event.getUei(), EVENT_UEI_FIELD_SIZE));
        
        //Column 3, dpName
        m_insStmt.setString(3, (eventHeader != null) ? Constants.format(eventHeader.getDpName(), EVENT_DPNAME_FIELD_SIZE) : "undefined");
        
        // Column 4, nodeID
        int nodeid = (int) event.getNodeid();
        m_insStmt.setInt(4, event.hasNodeid() ? nodeid : -1);
        
        //Column 5, serviceId
        //
        // convert the service name to a service id
        //
        int svcId = -1;
        if (event.getService() != null) {
            try {
                svcId = getServiceID(event.getService());
            } catch (SQLException sqlE) {
                log.warn("AlarmWriter.insertAlarm: Error converting service name \"" + event.getService() + "\" to an integer identifier, storing -1", sqlE);
            }
        }
        m_insStmt.setInt(5, svcId);

        //Column 6, reductionKey
        m_insStmt.setString(6, event.getReductionKey());
        
        //Column 7, counter
        m_insStmt.setInt(7, 1);
        
        //Column 8, serverity
        set(m_insStmt, 8, Constants.getSeverity(event.getSeverity()));

        //Column 9, lastEventId
        m_insStmt.setInt(9, event.getDbid());
        
        java.sql.Timestamp eventTime = getEventTime(event, log);
        m_insStmt.setTimestamp(10, eventTime);
        
        //Column 11, lastEventTime
        m_insStmt.setTimestamp(11, eventTime);
        
        //Column 12, description
        set(m_insStmt, 12, Constants.format(event.getDescr(), EVENT_DESCR_FIELD_SIZE));

        //Column 13, logMsg
        if (event.getLogmsg() != null) {
            // set log message
            set(m_insStmt, 13, Constants.format(event.getLogmsg().getContent(), EVENT_LOGMSG_FIELD_SIZE));
        } else {
            m_insStmt.setNull(13, Types.VARCHAR);
        }

        //Column 14, operInstruct
        set(m_insStmt, 14, Constants.format(event.getOperinstruct(), EVENT_OPERINSTRUCT_FIELD_SIZE));
        
        //Column 15, tticketId
        //Column 16, tticketState
        if (event.getTticket() != null) {
            set(m_insStmt, 15, Constants.format(event.getTticket().getContent(), EVENT_TTICKET_FIELD_SIZE));
            int ttstate = 0;
            if (event.getTticket().getState().equals("on"))
                ttstate = 1;
            set(m_insStmt, 16, ttstate);
        } else {
            m_insStmt.setNull(15, Types.VARCHAR);
            m_insStmt.setNull(16, Types.INTEGER);
        }

        //Column 17, mouseOverText
        set(m_insStmt, 17, Constants.format(event.getMouseovertext(), EVENT_MOUSEOVERTEXT_FIELD_SIZE));

        //Column 18, suppressedUntil
        //FIXME:
        m_insStmt.setTimestamp(18, eventTime);
        
        //Column 19, suppressedUser
        m_insStmt.setString(19, null);
        
        //Column 20, suppressedTime
        //FIXME:
        m_insStmt.setTimestamp(20, eventTime);
        
        //Column 21, alarmAckUser
        m_insStmt.setString(21, null);
        
        //Column 22, alarmAckTime
        m_insStmt.setTimestamp(22, eventTime);
        
        if (log.isDebugEnabled())
            log.debug("m_insStmt is: "+m_insStmt.toString());

        m_insStmt.executeUpdate();

        if (log.isDebugEnabled())
            log.debug("SUCCESSFULLY added " + event.getUei() + " related  data into the ALARMS table");
   
    }

