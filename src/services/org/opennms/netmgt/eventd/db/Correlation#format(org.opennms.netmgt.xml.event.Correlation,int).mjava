	/**
	 * Format the correlation block to have the xml
	 *
	 * @param ec	the correlation
	 * @param sz	the size to which the formatted string is to be limited to(usually the size of the column in the database)
	 *
	 * @return the formatted event correlation
	 */
	public static String format(org.opennms.netmgt.xml.event.Correlation ec, int sz)
	{
		StringWriter out = new StringWriter();
		try
		{
			Marshaller.marshal(ec, out);
		}
		catch(MarshalException e)
		{
			ThreadCategory.getInstance(Correlation.class).error("Failed to convert new event to XML", e);
			return null;
		}
		catch(ValidationException e)
		{
			ThreadCategory.getInstance(Correlation.class).error("Failed to convert new event to XML", e);
			return null;
		}

		String outstr = out.getBuffer().toString();
		if(outstr.length() >= sz)
		{
			StringBuffer	buf = new StringBuffer(outstr);

			buf.setLength(sz-4);
			buf.append(Constants.VALUE_TRUNCATE_INDICATOR);

			return buf.toString();
		}
		else
		{
			return outstr;
		}


	}

