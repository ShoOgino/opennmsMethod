    /**
     * Constructor
     */
    public EventWriter(String getNextEventIdStr) throws SQLException {
        // Get a database connection
        //
        m_dbConn = null;
        try {
            DatabaseConnectionFactory.init();
            m_dbConn = DatabaseConnectionFactory.getInstance().getConnection();
        } catch (MarshalException me) {
            ThreadCategory.getInstance(EventWriter.class).fatal("Marshall Exception getting database connection", me);
            throw new UndeclaredThrowableException(me);
        } catch (ValidationException ve) {
            ThreadCategory.getInstance(EventWriter.class).fatal("Validation Exception getting database connection", ve);
            throw new UndeclaredThrowableException(ve);
        } catch (ClassNotFoundException cnfE) {
            ThreadCategory.getInstance(EventWriter.class).fatal("Driver Class Not Found Exception getting database connection", cnfE);
            throw new UndeclaredThrowableException(cnfE);
        } catch (IOException ioE) {
            ThreadCategory.getInstance(EventWriter.class).fatal("IO Exception getting database connection", ioE);
            throw new UndeclaredThrowableException(ioE);
        }

        //
        // prepare the SQL statement
        //
        m_getSvcIdStmt = m_dbConn.prepareStatement(EventdConstants.SQL_DB_SVCNAME_TO_SVCID);
        m_getHostNameStmt = m_dbConn.prepareStatement(EventdConstants.SQL_DB_HOSTIP_TO_HOSTNAME);
        m_getNextEventIdStmt = m_dbConn.prepareStatement(getNextEventIdStr);
        m_eventInsStmt = m_dbConn.prepareStatement(EventdConstants.SQL_DB_INS_EVENT);
        // set the database for rollback support
        //
        try {
            m_dbConn.setAutoCommit(false);
        } catch (SQLException se) {
            ThreadCategory.getInstance(EventWriter.class).warn("Unable to set auto commit mode");
        }
    }

