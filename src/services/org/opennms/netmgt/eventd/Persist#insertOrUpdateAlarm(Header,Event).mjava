    public void insertOrUpdateAlarm(Header eventHeader, Event event) throws SQLException {
        
        Category log = ThreadCategory.getInstance(AlarmWriter.class);
        int alarmId = isReductionNeeded(eventHeader, event);
        if (alarmId != -1) {
            log.debug("AlarmWriter is reducing event for: " +event.getDbid()+ ": "+ event.getUei());
            updateAlarm(eventHeader, event, alarmId);
        } else {
            log.debug("AlarmWriter is not reducing event for: " +event.getDbid()+ ": "+ event.getUei());
            insertAlarm(eventHeader, event);
        }
    }

