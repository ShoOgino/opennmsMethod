	Double fetchLastValue(LatencyInterface latIface, LatencyParameters latParms) throws ThresholdingException {
		String datasource = getDatasourceName();
		// Use RRD JNI interface to "fetch" value of the
	    // datasource from the RRD file
	    //
	    Double dsValue = null;
	    try {
	        if (getDatasourceType().equals("if")) {
	            log().debug("Fetching last value from dataSource '" + datasource + "'");
	            
	            File rrdFile = new  File(latIface.getLatencyDir(), datasource+RrdUtils.getExtension());
	            if (!rrdFile.exists()) {
	                log().info("rrd file "+rrdFile+" does not exist");
	                return null;
	            }
	            
	            if (!rrdFile.canRead()) {
	               log().error("Unable to read existing rrd file "+rrdFile);
	                return null;
	            }
	            
	            if (latParms.getRange() == 0) {
	            	dsValue = RrdUtils.fetchLastValue(rrdFile.getAbsolutePath(), latParms.getInterval());
	            } else {
	            	dsValue = RrdUtils.fetchLastValueInRange(rrdFile.getAbsolutePath(), latParms.getInterval(), latParms.getRange());
	            }
	        } else {
	           throw new ThresholdingException("expr types not yet implemented", LatencyThresholder.THRESHOLDING_FAILED);
	        }
	        log().debug("Last value from dataSource '" + datasource + "' was "+dsValue);
	    } catch (NumberFormatException nfe) {
	        log().warn("Unable to convert retrieved value for datasource '" + datasource + "' to a double, skipping evaluation.");
	    } catch (RrdException e) {
	        log().error("An error occurred retriving the last value for datasource '" + datasource + "'", e);
	    }
	    return dsValue;
	}

