    private Target getTarget(SnmpAgentConfig agentConfig) {

        Target target = null;
        int requestedSnmpVersion = agentConfig.getVersion();

        if (requestedSnmpVersion == SnmpAgentConfig.VERSION3) {
            target = new UserTarget();
            target.setVersion(SnmpConstants.version3);
            ((UserTarget)target).setSecurityLevel(adaptSecurityLevel(agentConfig));
            ((UserTarget)target).setSecurityName(adaptSecurityName(agentConfig));
        } else if (requestedSnmpVersion == SnmpAgentConfig.VERSION1){
            target = new CommunityTarget();
            target.setVersion(SnmpConstants.version1);
            ((CommunityTarget)target).setCommunity(adaptCommunity(agentConfig));
        } else if (requestedSnmpVersion == SnmpAgentConfig.VERSION2C) {
            target = new CommunityTarget();
            target.setVersion(SnmpConstants.version2c);
            ((CommunityTarget)target).setCommunity(adaptCommunity(agentConfig));
        }

        target.setVersion(agentConfig.getVersion());
        target.setRetries(agentConfig.getRetries());
        target.setTimeout(agentConfig.getTimeout());
        target.setAddress(determineAddress(agentConfig));
        target.setMaxSizeRequestPDU(agentConfig.getMaxRequestSize());
            
        return target;
    }

