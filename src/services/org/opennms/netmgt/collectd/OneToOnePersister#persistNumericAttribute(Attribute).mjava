    /* (non-Javadoc)
     * @see org.opennms.netmgt.collectd.Persister#persistNumericAttribute(org.opennms.netmgt.collectd.Attribute)
     */
    public void persistNumericAttribute(Attribute attribute) {
        RrdRepository repository = m_repository;
        CollectionResource resource = attribute.getResource();
        SnmpValue value = attribute.getValue();
        String owner = resource.getCollectionAgent().getHostAddress();
        AttributeType attrType = attribute.getAttributeType();
        File resourceDir = resource.getResourceDir(repository);
    
        String val = (value == null ? null : Long.toString(value.toLong()));
        if (val == null) {
            log().info("No data collected for attribute "+attribute+". Skipping");
            return;
        }
    
        int step = repository.getStep();
        List rraList = repository.getRraList();
    
        try {
            int heartBeat = repository.getHeartBeat();
            String name = attrType.getName();
            String type = attrType.getType();
            // FIXME: pull these values from config file
            String min = "U";
            String max = "U";
            String truncated = StringUtils.truncate(name, NumericAttributeType.MAX_DS_NAME_LENGTH);
            RrdUtils.createRRD(owner, resourceDir.getAbsolutePath(), truncated, step, NumericAttributeType.mapType(type), heartBeat, min, max, rraList);
    
            RrdUtils.updateRRD(owner, resourceDir.getAbsolutePath(), truncated, val);
        } catch (Throwable e) {
            log().error("Unable to persist data for attribute "+attribute, e);
        }
    }

