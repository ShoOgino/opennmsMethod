	/**
	 * Perform data collection.
	 * 
	 * @param agent
	 *            Network interface to be data collected.
	 * @param eproxy
	 *            Eventy proxy for sending events.
	 * @param parameters
	 *            Key/value pairs from the package to which the interface
	 *            belongs.
	 */
	public int collect(CollectionAgent agent, EventProxy eproxy, Map parameters) {
        try {
        
            agent.collect();
            
            checkForNewInterfaces(agent, eproxy);
            
            // Update RRD with values retrieved in SNMP collection
            updateRRds(agent, parameters, eproxy);
        
        	// return the status of the collection
        	return ServiceCollector.COLLECTION_SUCCEEDED;
        } catch (CollectionError e) {
        	return e.reportError();
        } catch (Throwable t) {
        	return this.unexpected(agent, t);
        }
	}

