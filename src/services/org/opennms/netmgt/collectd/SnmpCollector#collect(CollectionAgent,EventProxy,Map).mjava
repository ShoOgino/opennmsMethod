	/**
	 * Perform data collection.
	 * 
	 * @param agent
	 *            Network interface to be data collected.
	 * @param eventProxy
	 *            Eventy proxy for sending events.
	 * @param parameters
	 *            Key/value pairs from the package to which the interface
	 *            belongs.
	 */
	public int collect(CollectionAgent agent, EventProxy eventProxy, Map parameters) {
        ForceRescanState forceRescanState = new ForceRescanState(agent, eventProxy);
        try {
        
            agent.collect();
            
            checkForNewInterfaces(agent, forceRescanState);
            
            // Update RRD with values retrieved in SNMP collection
            updateRRds(agent, parameters, forceRescanState);
            
        
        	// return the status of the collection
        	return ServiceCollector.COLLECTION_SUCCEEDED;
        } catch (CollectionError e) {
        	return e.reportError();
        } catch (Throwable t) {
        	return this.unexpected(agent, t);
        } finally {
            
            // want to make sure we send any pending events 
            forceRescanState.sendEvent();
            
        }
	}

