    /**
     * Creates a single RRD file for the specified RRD data source.
     * 
     * @param collectionName
     *            Name of the collection
     * @param ipaddr
     *            Interface address
     * @param directory
     *            RRD repository directory
     * @param ds
     *            RRD data source
     * 
     * @return TRUE if new RRD file created, FALSE if RRD file was not created
     *         because it already existed.
     */
    public boolean createRRD(String collectionName, InetAddress ipaddr, String directory, RRDDataSource ds) throws RrdException {
        String creator = "primary SNMP interface " + ipaddr.getHostAddress();
        int step = DataCollectionConfigFactory.getInstance().getStep(collectionName);
        List rraList = DataCollectionConfigFactory.getInstance().getRRAList(collectionName);

        return RrdUtils.createRRD(creator, directory, ds.getName(), step, ds.getType(), ds.getHeartbeat(), ds.getMin(), ds.getMax(), rraList);
    }

