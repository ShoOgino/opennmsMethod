	public void checkConstraints() throws Exception {
		String[][] constraints = getForeignKeyConstraints();

		m_out.print("- checking for rows that violate constraints... ");

		Statement st = m_dbconnection.createStatement();
		for (int a = 0; a < constraints.length; a++) {
			String name = constraints[a][0];
			String table = constraints[a][1];
			String column = constraints[a][2];
			String ftable = constraints[a][3];
			String fcolumn = constraints[a][4];

			if (!tableExists(table) || !tableColumnExists(table, column)) {
				// The constrained table or column does not exist
				continue;
			}

			String query = "SELECT count(" + table + "." + column + ") FROM "
					+ table + " "
					+ getForeignConstraintWhere(table, column, ftable, fcolumn);
			
			ResultSet rs = st.executeQuery(query);

			rs.next();
			int count = rs.getInt(1);
			rs.close();

			if (count != 0) {
				rs = st.executeQuery("SELECT count(*) FROM " + table);
				rs.next();
				int total = rs.getInt(1);
				rs.close();
				st.close();

				throw new Exception("Table " + table + " contains " + count
						+ " rows " + "(out of " + total
						+ ") that violate new constraint " + name + ".  "
						+ "See the install guide for details "
						+ "on how to correct this problem.");
			}
		}
		st.close();

		m_out.println("NONE");
	}

