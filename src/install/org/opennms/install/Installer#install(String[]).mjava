    public void install(String[] argv) throws Exception {
	printHeader();
	loadProperties();
	parseArguments(argv);


	if (!m_update_database &&
	    !m_do_inserts &&
	    !m_update_iplike &&
	    m_tomcat_conf == null &&
	    m_server_xml == null &&
	    !m_install_webapp) {
	    throw new Exception("Nothing to do.\n" + m_required_options +
				"\nUse '-h' for help.");
	}
	    
	checkJava();
	// XXX Check Tomcat version?

	if (m_update_database || m_update_iplike) {
	    databaseConnect("template1");
	    databaseCheckVersion();
	}

	printDiagnostics();

	verifyFilesAndDirectories();

	if (m_update_database) {
	    readTables();

	    // XXX Check and optionally modify pg_hba.conf

	    if (!databaseUserExists()) {
		databaseAddUser();
	    }
	    if (!databaseDBExists()) {
		databaseAddDB();
	    }
	}

	if (m_update_database || m_update_iplike) {
	    databaseDisconnect();
	    
	    databaseConnect(m_database);
	}

	if (m_update_database) {
	    createSequences();
	    createTables();
	    createIndexes();
	    // createFunctions(m_cfunctions); // Unused, not in create.sql
	    // createLanguages(); // Unused, not in create.sql
	    // createFunctions(m_functions); // Unused, not in create.sql
	    
	    fixData();
	    insertData();

	    checkUnicode();
	}

	if (m_install_webapp) {
	    installWebApp();
	}

	if (m_tomcat_conf != null) {
	    updateTomcatConf();
	}
       
	if (m_server_xml != null) {
	    updateServerXml();
	}
	
	if (m_update_iplike) {
	    updateIplike();
	}

	if (m_update_database) {
	    // XXX should we be using createFunctions and createLanguages
	    //     instead?
	    updatePlPgsql();
       
	    // XXX should we be using createFunctions instead?
	    addStoredProcedures();
	}

	if (m_update_database || m_update_iplike) {
	    databaseDisconnect();
	}
    }

