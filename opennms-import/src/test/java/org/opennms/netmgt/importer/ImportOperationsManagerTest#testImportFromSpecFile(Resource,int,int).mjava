    private void testImportFromSpecFile(Resource specFileResource, int writeThreads, int scanThreads) throws IOException, ModelImportException {
        expectServiceTypeCreate("HTTP");
        final SpecFile specFile = new SpecFile();
        specFile.loadResource(specFileResource);

        Map assetNumbers = (Map)m_transTemplate.execute(new TransactionCallback() {
            public Object doInTransaction(TransactionStatus status) {
                return getAssetNumberMap(specFile.getForeignSource());
            }
        });
        
        final ImportOperationsManager opsMgr = new ImportOperationsManager(assetNumbers, getModelImporter());
        opsMgr.setWriteThreads(writeThreads);
        opsMgr.setScanThreads(scanThreads);
        opsMgr.setForeignSource(specFile.getForeignSource());
        
        m_transTemplate.execute(new TransactionCallback() {

            public Object doInTransaction(TransactionStatus status) {
                AbstractImportVisitor accountant = new ImportAccountant(opsMgr);
                specFile.visitImport(accountant);
                return null;
            }
            
        });
        
//        assertEquals(2, opsMgr.getDeleteCount());
//        assertEquals(2, opsMgr.getUpdateCount());
//        assertEquals(2, opsMgr.getInsertCount());
//        assertEquals(6, opsMgr.getOperationCount());
        
        opsMgr.persistOperations(m_transTemplate, getNodeDao());
        
    }

