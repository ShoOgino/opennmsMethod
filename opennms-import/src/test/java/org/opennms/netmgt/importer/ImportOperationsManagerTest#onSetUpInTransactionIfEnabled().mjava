    @Override
    protected void onSetUpInTransactionIfEnabled() throws Exception {
        Properties p = new Properties();
        p.setProperty("log4j.logger.org.snmp4j.Snmp", "FATAL");
        p.setProperty("log4j.logger.org.opennms.netmgt.snmp.SnmpWalker", "FATAL");
        MockLogAppender.setupLogging(p);

        m_populator.populateDatabase();
        setComplete();
        endTransaction();
        startNewTransaction();
        
        m_agent = MockSnmpAgent.createAgentAndRun(new ClassPathResource("org/opennms/netmgt/snmp/snmpTestData1.properties"), "127.0.0.1/1691");

        SnmpPeerFactory spf = new SnmpPeerFactory(new StringReader("<?xml version=\"1.0\"?>\n" + 
        		"<snmp-config port=\"1691\" retry=\"3\" timeout=\"800\"\n" + 
        		"             read-community=\"public\" \n" + 
        		"             version=\"v1\" \n" + 
        		"             max-vars-per-pdu=\"10\" proxy-host=\"127.0.0.1\">\n" + 
        		"\n" + 
        		"</snmp-config>\n" + 
        		"\n" + 
        		""));
        SnmpPeerFactory.setInstance(spf);

        super.onSetUpInTransactionIfEnabled();
    }

