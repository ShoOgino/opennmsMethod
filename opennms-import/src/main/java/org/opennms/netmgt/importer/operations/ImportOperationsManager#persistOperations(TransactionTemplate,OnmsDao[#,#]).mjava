    /**
     * <p>persistOperations</p>
     *
     * @param template a {@link org.springframework.transaction.support.TransactionTemplate} object.
     * @param dao a {@link org.opennms.netmgt.dao.OnmsDao} object.
     */
    public void persistOperations(TransactionTemplate template, OnmsDao<?, ?> dao) {
    	m_stats.beginProcessingOps();
    	m_stats.setDeleteCount(getDeleteCount());
    	m_stats.setInsertCount(getInsertCount());
    	m_stats.setUpdateCount(getUpdateCount());
    	ExecutorService pool = Executors.newFixedThreadPool(m_writeThreads, new LogPreservingThreadFactory(getClass().getSimpleName() + ".persistOperations", m_writeThreads, false));

		preprocessOperations(template, dao, new OperationIterator(), pool);

		shutdownAndWaitForCompletion(pool, "persister interrupted!");

		m_stats.finishProcessingOps();
    	
    }

