	protected void persistOperation(final ImportOperation oper, TransactionTemplate template, final OnmsDao dao) {
		m_stats.beginPersisting(oper);
		log().info("Persist: "+oper);

		// now persiste the changes to the database
		List events = (List)template.execute(new TransactionCallback() {
			public Object doInTransaction(TransactionStatus status) {
				List result = oper.persist();
                return result;
			}
		});
		
		m_stats.finishPersisting(oper);
		
		
		if (m_eventMgr != null && events != null) {
			m_stats.beginSendingEvents(oper, events);
			log().info("Send Events: "+oper);
			// now send the events for the update
			for (Iterator eventIt = events.iterator(); eventIt.hasNext();) {
				Event event = (Event) eventIt.next();
				m_eventMgr.sendNow(event);
			}
			m_stats.finishSendingEvents(oper, events);
		}

		log().info("Clear cache: "+oper);
		// clear the cache to we don't use up all the memory
		dao.clear();
	}

