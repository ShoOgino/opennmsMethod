    @Test
    public void testAddAndRemoveRoles() throws Exception {
        createUser("test");
        String xml = sendRequest(GET, "/users/test", 200);
        assertFalse(xml.contains("<role>"));

        // Verify add an invalid role
        sendRequest(PUT, "/users/test/roles/ROLE_INVALID", 400);

        // Verify delete an invalid role
        sendRequest(DELETE, "/users/test/roles/ROLE_INVALID", 400);

        // Verify add an a new role
        sendRequest(PUT, "/users/test/roles/ROLE_PROVISION", 204);
        xml = sendRequest(GET, "/users/test", 200);
        assertTrue(xml.contains("<role>ROLE_PROVISION</role>"));

        // Verify delete an existing role
        sendRequest(DELETE, "/users/test/roles/ROLE_PROVISION", 204);
        xml = sendRequest(GET, "/users/test", 200);
        assertFalse(xml.contains("<role>ROLE_PROVISION</role>"));
    }

