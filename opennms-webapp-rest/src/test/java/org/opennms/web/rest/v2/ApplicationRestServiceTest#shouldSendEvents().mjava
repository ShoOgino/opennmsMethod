    @Test
    public void shouldSendEvents() throws EventProxyException {

        EventProxy proxy = mock(EventProxy.class);
        ApplicationDao dao = new MockApplicationDao();
        ApplicationRestService service = new ApplicationRestService(dao, proxy);
        UriInfo uriInfo = mock(UriInfo.class);
        when(uriInfo.getRequestUriBuilder()).thenReturn(new UriBuilderMock());

        // Create
        OnmsApplication application = new OnmsApplication();
        application.setName("myApp");
        ArgumentCaptor<Event> argument = ArgumentCaptor.forClass(Event.class);
        service.doCreate(mock(SecurityContext.class), uriInfo, application);
        verify(proxy).send(argument.capture());
        assertEquals(EventConstants.APPLICATION_CREATED_EVENT_UEI, argument.getValue().getUei());

        // Delete
        service.doDelete(mock(SecurityContext.class), uriInfo, application);
        verify(proxy, times(2)).send(argument.capture());
        assertEquals(EventConstants.APPLICATION_DELETED_EVENT_UEI, argument.getValue().getUei());
    }

