    @Test
    public void testWriteUserWithEmail() throws Exception {
        setUser("doesntHavePermissions", new String[] { "ROLE_USER" });
        createUser("test123", "test123@opennms.org", 400, null);

        setUser("admin", new String[] { "ROLE_ADMIN" });
        createUser("test123", "test123@opennms.org", 303, "/users/test123");

        // validate creation
        String xml = sendRequest(GET, "/users/test123", 200);
        assertNotNull(xml);
        OnmsUser testUser = JaxbUtils.unmarshal(OnmsUser.class,  xml);
        assertNotNull(testUser);
        assertEquals("test123", testUser.getUsername());
        assertEquals("test123@opennms.org", testUser.getEmail());
    }

