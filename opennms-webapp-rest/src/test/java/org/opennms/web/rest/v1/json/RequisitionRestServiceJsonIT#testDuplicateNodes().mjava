    @Test
    public void testDuplicateNodes() throws Exception {
        MockLogAppender.setupLogging(true, "DEBUG");

        JSONObject req = new JSONObject();
        req.put("date-stamp", "2006-03-09T00:03:09");
        req.put("foreign-source", "test");
        JSONArray nodeArray = new JSONArray();
        JSONObject nodeA = new JSONObject();
        nodeA.put("node-label", "a");
        nodeA.put("foreign-id", "a");
        nodeArray.put(nodeA);
        JSONObject nodeB = new JSONObject();
        nodeB.put("node-label", "b");
        nodeB.put("foreign-id", "c");
        nodeArray.put(nodeB);
        JSONObject nodeC = new JSONObject();
        nodeC.put("node-label", "c");
        nodeC.put("foreign-id", "c");
        nodeArray.put(nodeC);
        req.put("node", nodeArray);
        final MockHttpServletResponse response = sendPost("/requisitions", req.toString(), 400, null);
        assertTrue("response should say 'c' has duplicates",  response.getContentAsString().contains("Duplicate nodes found on foreign source test: c (2 found)"));
    }

