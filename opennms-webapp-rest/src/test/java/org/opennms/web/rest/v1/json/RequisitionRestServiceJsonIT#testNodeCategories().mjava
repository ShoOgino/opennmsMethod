    @Test
    public void testNodeCategories() throws Exception {
        createRequisition();

        String base = "/requisitions/test/nodes/4243/categories";

        // create a category
        JSONObject category = new JSONObject();
        category.put("name", "Dead Servers");
        sendPost(base, category.toString(), 303, "/nodes/4243/categories/Dead%20Servers");

        // get list of categories
        String url = base;
        String json = sendRequest(GET, url, 200);
        JSONObject categories = new JSONObject(json);
        assertEquals(4, categories.getInt("count"));
        boolean lowFound = false;
        boolean deadFound = false;
        assertTrue(categories.has("category"));
        JSONArray categoriesArray = categories.getJSONArray("category");
        for (int i=0; i < categoriesArray.length(); i++) {
            JSONObject obj = categoriesArray.getJSONObject(i);
            assertTrue(obj.has("name"));
            if ("low".equals(obj.getString("name"))) {
                lowFound = true;
            }
            if ("Dead Servers".equals(obj.getString("name"))) {
                deadFound = true;
            }
        }
        assertTrue(lowFound);
        assertTrue(deadFound);

        // get individual category
        url = "/requisitions/test/nodes/4243/categories/low";
        json = sendRequest(GET, url, 200);
        category = new JSONObject(json);
        assertEquals("low", category.getString("name"));

        // delete category
        json = sendRequest(DELETE, url, 200);
        json = sendRequest(GET, url, 404);

        // confirm there are less categories
        json = sendRequest(GET, "/requisitions/test/nodes/4243/categories", 200);
        categories = new JSONObject(json);
        assertEquals(3, categories.getInt("count"));

        // create a category on a node that is not in the requisition
        base = "/requisitions/test/nodes/4244/categories";
        category = new JSONObject();
        category.put("name", "New Category");

        sendPost(base, category.toString(), 303, "/nodes/4244/categories/New%20Category");
        json = sendRequest(GET, base + "/New%20Category", 404);
    }

