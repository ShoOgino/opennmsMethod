    @Test
    public void testWriteUser() throws Exception {
        createUser("test");

        // validate creation
        String xml = sendRequest(GET, "/users/test", 200);
        assertTrue(xml.contains("<user><user-id>test</user-id>"));

        // change password and email
        sendPut("/users/test", "password=MONKEYS&email=test@opennms.org", 303, "/users/test"); 

        // validate change of password
        xml = sendRequest(GET, "/users/test", 200); 
        OnmsUser testUser = JaxbUtils.unmarshal(OnmsUser.class,  xml);
        // ... but in xml-file
        User castorUser = getWebAppContext().getBean(UserManager.class).getUser("test");
        assertEquals(castorUser.getPassword().getContent(), "MONKEYS");

        // validate change of email
        assertEquals("test@opennms.org", testUser.getEmail());
    }

