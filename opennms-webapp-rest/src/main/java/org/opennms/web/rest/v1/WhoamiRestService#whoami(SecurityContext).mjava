    @GET
    @Produces({MediaType.APPLICATION_JSON})
    @Path("/")
    public Response whoami(@Context final SecurityContext securityContext) {
        final String userName = securityContext.getUserPrincipal().getName();
        final JSONArray userRoles = new JSONArray();
        for (String eachRole : Authentication.getAvailableRoles()) {
            if (securityContext.isUserInRole(eachRole)) {
                userRoles.put(eachRole);
            }
        }

        final JSONObject userInfo = new JSONObject();
        userInfo.put("id", userName);
        userInfo.put("roles", userRoles);
        userInfo.put("internal", false);

        // Check if the user exists in users.xml, if so it is an internal
        // user and email, full name, etc. can be populated
        try {
            final OnmsUser onmsUser = userManager.getOnmsUser(userName);
            if (onmsUser != null) {
                userInfo.put("internal", true);
                if (!Strings.isNullOrEmpty(onmsUser.getEmail())) {
                    userInfo.put("email", onmsUser.getEmail());
                }
                if (!Strings.isNullOrEmpty(onmsUser.getFullName())) {
                    userInfo.put("fullName", onmsUser.getFullName());
                }
            }
        } catch (IOException ex) {
            // ignore
        }
        return Response.ok().entity(userInfo.toString()).build();
    }

