    private static CriteriaBuilder filterForNodeIds(CriteriaBuilder builder, Collection<Integer> nodeIds) {
        return builder.ne("type", "D")
                .in("id", nodeIds)
                .distinct();
    }

