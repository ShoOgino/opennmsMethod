    /**
     * This is an attempt at testing scheduled automations.
     * @throws InterruptedException
     */
    @Test
    @Ignore
    public final void testConcurrency() throws InterruptedException {
        try {
        /*
         * Test status of threads
         */
        assertEquals(Fiber.START_PENDING, m_vacuumd.getStatus());
        assertEquals(Fiber.START_PENDING, m_vacuumd.getScheduler().getStatus());
        
        /*
         * Testing the start
         */
        m_vacuumd.start();
        assertTrue(m_vacuumd.getStatus() >= 1);
        Thread.sleep(200);
        assertEquals(Fiber.RUNNING, m_vacuumd.getStatus());
        assertEquals(Fiber.RUNNING, m_vacuumd.getScheduler().getStatus());
        
        /*
         * Testing the pause
         */
        m_vacuumd.pause();
        Thread.sleep(200);
        assertEquals(PausableFiber.PAUSED, m_vacuumd.getStatus());
        assertEquals(PausableFiber.PAUSED, m_vacuumd.getScheduler().getStatus());

        m_vacuumd.resume();
        Thread.sleep(200);
        assertEquals(PausableFiber.RUNNING, m_vacuumd.getStatus());
        assertEquals(PausableFiber.RUNNING, m_vacuumd.getScheduler().getStatus());
        
        //Get an alarm in the db
        bringNodeDownCreatingEvent(1);
        // Sleep and wait for the alarm to be written
        Thread.sleep(1000);
        
        /*
         * Changes to the automations to the config will
         * probably affect this.  There should be one node down
         * alarm.
         */
        assertEquals("event count", 3, countEvents());
        assertEquals("alarm count", 1, countAlarms());
        assertEquals("counter in the alarm", 1, m_jdbcTemplate.queryForInt("select counter from alarms"));

        // Create another node down event
        bringNodeDownCreatingEvent(1);
        // Sleep and wait for the alarm to be written
        Thread.sleep(1000);

        // Make sure there's still one alarm...
        assertEquals("alarm count", 1, countAlarms());
        // ... with a counter value of 2
        assertEquals("counter in the alarm", 2, m_jdbcTemplate.queryForInt("select counter from alarms"));
        
        /*
         * Get the current severity, sleep long enough for the escalation
         * automation to run, then check that it was escalated.
         */
        int currentSeverity = m_jdbcTemplate.queryForInt("select severity from alarms");
        Thread.sleep(VacuumdConfigFactory.getInstance().getAutomation("autoEscalate").getInterval()+100);
        assertEquals("alarm severity -- should have been escalated", currentSeverity+1, verifyAlarmEscalated());
        
        EventBuilder builder = new EventBuilder(EventConstants.RELOAD_VACUUMD_CONFIG_UEI, "test");
        Event e = builder.getEvent();
        m_eventdIpcMgr.sendNow(e);
        } finally {
        //Stop what you start.
        m_vacuumd.stop();
        }
    }

