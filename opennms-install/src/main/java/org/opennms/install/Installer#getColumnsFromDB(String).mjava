	public List<Column> getColumnsFromDB(String tableName) throws Exception {
		LinkedList<Column> columns = new LinkedList<Column>();
		
		Statement st = m_dbconnection.createStatement();
		ResultSet rs;
		
		String query = "SELECT "
			+ "        attname, "
			+ "        format_type(atttypid, atttypmod), "
			+ "        attnotnull "
			+ "FROM "
			+ "        pg_attribute "
			+ "WHERE "
			+ "        attrelid = "
			+ "                (SELECT oid FROM pg_class WHERE relname = '"
								+ tableName.toLowerCase()
								+ "') AND "
			+ "        attnum > 0";

		if (m_pg_version >= 7.3) {
			query = query + " AND attisdropped = false";
		}

		query = query
			+ " ORDER BY "
			+ "        attnum";

		rs = st.executeQuery(query);

		while (rs.next()) {
			Column c = new Column();
			c.setName(rs.getString(1));
			String columnType = rs.getString(2); 
			try {
				c.parseColumnType(columnType);
			} catch (Exception e) {
				throw new Exception("Error parsing column type '" + columnType + "' for column '" + rs.getString(1) + "' in table '" + tableName + "'.  Nested: " + e.getMessage(), e);
			}
			c.setNotNull(rs.getBoolean(3));

			columns.add(c);
		}
		
		rs.close();
		st.close();
		
		return columns;

	}

