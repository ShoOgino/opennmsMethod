    public String findLibrary(String libname, String path) {
    	String fullname = System.mapLibraryName(libname);

    	String defaultPath = System.getProperty("java.library.path");
    	if (defaultPath != null) {
    		if (path != null) {
    			path += File.pathSeparator + defaultPath;
    		} else {
    			path = defaultPath;
    		}
    	}
    	
    	if (path != null) {
    		String[] paths = path.split(File.pathSeparator);
    		m_out.println("- searching for " + libname + ":");
    		for (int i = 0; i < paths.length; i++) {
    		    File entry = new File(paths[i]);
    		    
                if (entry.isFile()) {
                    // if they specified a file, try the parent directory instead
                    paths[i] = entry.getParent();
                }

   			    String fullpath = paths[i] + File.separator + fullname;
   			    if (loadLibrary(fullpath)) {
   			        return fullpath;
   			    }
    		}
    	}
    	return null;
    }

