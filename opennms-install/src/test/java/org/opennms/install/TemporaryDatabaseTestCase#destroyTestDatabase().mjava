    private void destroyTestDatabase() throws Exception {
        if (m_leaveDatabase || (m_leaveDatabaseOnFailure && m_failure)) {
            System.err.println("Not dropping database '" + m_testDatabase
                    + "' for test '" + getName() + "'");
            return;
        }

        /*
         * Sleep before destroying the test database because PostgreSQL
         * doesn't seem to notice immediately clients have disconnected. Yeah,
         * it's a hack.
         */
        Thread.sleep(100);

        Connection adminConnection = getAdminConnection();

        Statement st = adminConnection.createStatement();
        st.execute("DROP DATABASE " + m_testDatabase);
        st.close();

        adminConnection.close();

        /*
         * Sleep after disconnecting from template1, otherwise creating
         * a new test database in future tests may fail. Man, I hate this.
         */
        Thread.sleep(100);
    }

