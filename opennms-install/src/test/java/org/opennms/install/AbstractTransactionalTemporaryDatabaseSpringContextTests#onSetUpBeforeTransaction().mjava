    @Override
    protected void onSetUpBeforeTransaction() throws Exception {
        super.onSetUpBeforeTransaction();
        
        try {
            m_populatedTempDb.setUp();
        } catch (Exception e) {
            m_populatedTempDb.fail("setUp failed on " + m_populatedTempDb.getClass().getName(), e);
        }
        
        DataSource dataSource = jdbcTemplate.getDataSource();
        if (!(dataSource instanceof TemporaryDatabaseDataSource)) {
            throw new Exception("dataSource is not an instance of "
                                + "TemporaryDatabaseDataSource");
        }
        
        TemporaryDatabaseDataSource temporaryDatabaseDataSource =
            (TemporaryDatabaseDataSource) dataSource;
        
        temporaryDatabaseDataSource.setTemporaryDatabaseTestCase(m_populatedTempDb);
        DataSourceFactory.setInstance(dataSource);
    }

