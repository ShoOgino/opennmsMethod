    /**
     * {@inheritDoc}
     *
     * The method that inserts the event into the database
     */
    @Override
    public void process(final Header eventHeader, final Event event) throws SQLException, DataAccessException {
        if (!checkEventSanityAndDoWeProcess(event, "JdbcEventWriter")) {
            return;
        }

        LOG.debug("JdbcEventWriter: processing {} nodeid: {} ipaddr: {} serviceid: {} time: {}", event.getUei(), event.getNodeid(), event.getInterface(), event.getService(), event.getTime());

        final Connection connection = getDataSource().getConnection();

        try {
            connection.setAutoCommit(false);

            try {
                insertEvent(eventHeader, event, connection);

                connection.commit();
            } catch (final SQLException e) {
                LOG.warn("Error inserting event into the datastore.", e);
                try {
                    connection.rollback();
                } catch (final Throwable e2) {
                    LOG.warn("Rollback of transaction failed.", e2);
                }

                throw e;
            } catch (final DataAccessException e) {
                LOG.warn("Error inserting event into the datastore.", e);
                try {
                    connection.rollback();
                } catch (final Throwable e2) {
                    LOG.warn("Rollback of transaction failed.", e2);
                }

                throw e;
            }
        } finally {
            try {
                connection.close();
            } catch (final SQLException e) {
                LOG.warn("SQLException while closing database connection.", e);
            }
        }

        LOG.debug("EventWriter finished for : {}", event.getUei());
    }

