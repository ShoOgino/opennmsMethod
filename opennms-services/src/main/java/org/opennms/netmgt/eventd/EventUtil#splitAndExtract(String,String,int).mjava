    private static String splitAndExtract(String src, String sep, int offset) {
        String sepLiteral = Pattern.quote(sep);
        
        // If the src string starts with the separator, lose the first separator
        if (src.startsWith(sep)) {
            src = src.replaceFirst(sepLiteral, "");
        }
        
        String components[] = src.split(sepLiteral);
        if ((Math.abs(offset) > components.length) || (offset == 0)) {
            return null;
        } else if (offset < 0) {
            return components[components.length + offset];
        } else {
            // offset is, by definition, > 0
            return components[offset - 1];
        }
    }

