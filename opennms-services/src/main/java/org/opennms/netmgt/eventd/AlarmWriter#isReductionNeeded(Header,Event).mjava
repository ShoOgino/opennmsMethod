    protected int isReductionNeeded(Header eventHeader, Event event) throws SQLException {
        if (log().isDebugEnabled()) {
            log().debug("Persist.isReductionNeeded: reductionKey: " + event.getAlarmData().getReductionKey());
        }
    
        m_reductionQuery.setString(1, event.getAlarmData().getReductionKey());
    
        ResultSet rs = null;
        int alarmId;
        try {
            rs = m_reductionQuery.executeQuery();
            alarmId = -1;
            while (rs.next()) {
                alarmId = rs.getInt(1);
            }
        } catch (SQLException e) {
            throw e;
        } finally {
            rs.close();
        }
        return alarmId;
    }

