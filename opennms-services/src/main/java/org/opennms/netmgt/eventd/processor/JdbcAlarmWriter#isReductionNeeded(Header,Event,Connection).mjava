    // FIXME: This uses JdbcTemplate and not the passed in Connection
    private int isReductionNeeded(Header eventHeader, Event event, Connection connection) throws SQLException {
        try {
            int alarmId = new JdbcTemplate(getDataSource()).queryForInt(EventdConstants.SQL_DB_ALARM_REDUCTION_QUERY, new Object[] { event.getAlarmData().getReductionKey() });

            if (log().isDebugEnabled()) {
                log().debug("Persist.isReductionNeeded: yes for reductionKey: " + event.getAlarmData().getReductionKey());
            }
            
            return alarmId;
        } catch (EmptyResultDataAccessException e) {
            if (log().isDebugEnabled()) {
                log().debug("Persist.isReductionNeeded: no for reductionKey: " + event.getAlarmData().getReductionKey());
            }
                
            return -1;
        }
    }

