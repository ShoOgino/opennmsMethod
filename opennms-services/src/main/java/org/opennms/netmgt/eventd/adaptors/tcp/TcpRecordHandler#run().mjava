    /**
     * The execution context.
     */
    public void run() {
        // get the thread context right off
        m_context = Thread.currentThread();
        synchronized (m_context) {
            m_context.notifyAll();
        }

        /*
         * Check the stop flag, if it is set then go a head and exit
         * before doing any work on the socket
         */
        if (m_stop) {
            log().debug("Stop flag set before thread startup, thread exiting");

            return;
        } else if (log().isDebugEnabled()) {
            log().debug("Thread started, remote is " + m_connection.getInetAddress().getHostAddress());
        }

        // get the input stream
        InputStream socketIn = null;
        try {
            m_connection.setSoTimeout(500); // needed in case connection closed!
            socketIn = new BufferedInputStream(m_connection.getInputStream());
        } catch (IOException e) {
            if (!m_stop) {
                log().warn("An I/O Exception occured: " + e, e);
            }
            m_xchange.add(e);

            if (log().isDebugEnabled()) {
                log().debug("Thread exiting due to socket exception, stop flag = " + m_stop);
            }

            return;
        }

        int level = 8;
        int ch = 0;
        boolean moreInput = true;
        while (moreInput) {
            // check to see if the thread is interrupted
            if (Thread.interrupted()) {
                log().debug("Thread Interrupted");
                break;
            }

            try {
                ch = socketIn.read();
                if (ch == -1) {
                    moreInput = false;
                    continue;
                }

            } catch (InterruptedIOException e) {
                // this was expected
                continue;
            } catch (EOFException e) {
                m_xchange.add(e);
                moreInput = false;
                continue;
            } catch (IOException e) {
                m_xchange.add(e);
                if (!m_stop) {
                    log().warn("An I/O error occured reading from the remote host: " + e, e);
                }
                moreInput = false;
                continue;
            }

            try {
                level = m_tokenizer[level].next((char) ch);
            } catch (IOException e) {
                if (!m_stop) {
                    log().warn("An I/O error occured writing to the processor stream: " + e, e);
                    log().warn("Discarding the remainder of the event contents");
                    try {
                        /*
                         * this will discard current stream
                         * and cause all forwards to be discarded.
                         */
                        closeStream();
                    } catch (IOException e2) {
                    }
                } else {
                    m_xchange.add(e);
                    moreInput = false;
                }
            }
        }

        // ensure that the receiver knows that no new element is coming!
        try {
            if (m_out != null) {
                m_out.close();
            }
        } catch (IOException e) {
            if (!m_stop) {
                log().warn("An I/O Error occured closing the processor stream: " + e, e);
            }
        }

        m_xchange.add(new EOFException("No More Input"));

        log().debug("Thread Terminated");

    }

