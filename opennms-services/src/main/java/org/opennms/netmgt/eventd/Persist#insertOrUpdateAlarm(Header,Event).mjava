    public void insertOrUpdateAlarm(Header eventHeader, Event event) throws SQLException {
        
        int alarmId = isReductionNeeded(eventHeader, event);
        if (alarmId != -1) {
            log().debug("AlarmWriter is reducing event for: " +event.getDbid()+ ": "+ event.getUei());
            updateAlarm(eventHeader, event, alarmId);
            
            /*
             * This removes all previous events that have been reduced.
             */
            log().debug("insertOrUpdate: auto-clean is: "+event.getAlarmData().getAutoClean());
            if (event.getAlarmData().getAutoClean() == true) {
                log().debug("insertOrUpdate: deleting previous events.");
                cleanPreviousEvents(alarmId, event.getDbid());
            }
            
        } else {
            log().debug("AlarmWriter is not reducing event for: " +event.getDbid()+ ": "+ event.getUei());
            insertAlarm(eventHeader, event);
        }
    }

