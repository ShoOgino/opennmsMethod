    /**
     * The constructor for this object
     *
     * @param categories
     *            The category map.
     * @param numSenders
     *            The number of senders.
     */
    public DataSender(final AvailabilityService dataMgr, final RTCConfigFactory configFactory) {
        m_dataMgr = dataMgr;

        // NMS-7622: Limit the number of queued update tasks with a bounded queue
        m_queue = new LinkedBlockingDeque<Runnable>(Math.max(4 * configFactory.getSenders(), 32));

        m_dsrPool = new ThreadPoolExecutor(1, configFactory.getSenders(),
                30, TimeUnit.SECONDS,
                m_queue,
                new LogPreservingThreadFactory(getClass().getSimpleName(), configFactory.getSenders()));

        // get post error limit
        POST_ERROR_LIMIT = configFactory.getErrorsBeforeUrlUnsubscribe();
    }

