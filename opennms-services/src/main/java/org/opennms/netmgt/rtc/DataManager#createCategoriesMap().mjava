    /**
     * Creates the categories map. Reads the categories from the categories.xml
     * and creates the 'RTCCategory's map
     */
    private void createCategoriesMap() {
        CatFactory cFactory = null;
        try {
            CategoryFactory.init();
            cFactory = CategoryFactory.getInstance();

        } catch (IOException ex) {
            log().error("Failed to load categories information", ex);
            throw new UndeclaredThrowableException(ex);
        } catch (MarshalException ex) {
            log().error("Failed to load categories information", ex);
            throw new UndeclaredThrowableException(ex);
        } catch (ValidationException ex) {
            log().error("Failed to load categories information", ex);
            throw new UndeclaredThrowableException(ex);
        }

        m_categories = new HashMap<String, RTCCategory>();

        for (Categorygroup cg : cFactory.getConfig().getCategorygroupCollection()) {
            String commonRule = cg.getCommon().getRule();

            Categories cats = cg.getCategories();

            Enumeration<org.opennms.netmgt.config.categories.Category> enumCat = cats.enumerateCategory();
            while (enumCat.hasMoreElements()) {
                org.opennms.netmgt.config.categories.Category cat = enumCat.nextElement();

                RTCCategory rtcCat = new RTCCategory(cat, commonRule);
                m_categories.put(rtcCat.getLabel(), rtcCat);
            }
        }
    }

