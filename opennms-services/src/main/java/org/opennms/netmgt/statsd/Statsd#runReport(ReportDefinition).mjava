    /**
     * <p>runReport</p>
     *
     * @param reportDef a {@link org.opennms.netmgt.statsd.ReportDefinition} object.
     * @throws java.lang.Throwable if any.
     */
    public void runReport(ReportDefinition reportDef) throws Throwable {
        final ReportInstance report;
        try {
            report = reportDef.createReport(m_nodeDao, m_resourceDao, m_rrdDao, m_filterDao);
        } catch (Throwable t) {
            log().error("Could not create a report instance for report definition " + reportDef + ": " + t, t);
            throw t;
        }
        
        // FIXME What if the walker or the persister throws an exception ?
        getTransactionTemplate().execute(new TransactionCallbackWithoutResult() {
            public void doInTransactionWithoutResult(TransactionStatus status) {
                long reportStartTime = System.currentTimeMillis();
                log().debug("Starting report " + report);
                accountReportStart();
                report.walk();
                log().debug("Completed report " + report);
                accountReportComplete();
                
                m_reportPersister.persist(report);
                log().debug("Report " + report + " persisted");
                accountReportPersist();
                accountReportRunTime(System.currentTimeMillis() - reportStartTime);
            }
        });
    }

