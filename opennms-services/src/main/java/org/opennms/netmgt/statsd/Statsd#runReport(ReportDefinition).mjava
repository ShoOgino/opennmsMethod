    /**
     * <p>runReport</p>
     *
     * @param reportDef a {@link org.opennms.netmgt.statsd.ReportDefinition} object.
     * @throws java.lang.Throwable if any.
     */
    public void runReport(ReportDefinition reportDef) throws Throwable {
        final ReportInstance report;
        try {
            report = reportDef.createReport(m_nodeDao, m_resourceDao, m_rrdDao, m_filterDao);
        } catch (Throwable t) {
            LOG.error("Could not create a report instance for report definition {}", reportDef, t);
            throw t;
        }
        
        // FIXME What if the walker or the persister throws an exception ?
        getTransactionTemplate().execute(new TransactionCallbackWithoutResult() {
            @Override
            public void doInTransactionWithoutResult(TransactionStatus status) {
                long reportStartTime = System.currentTimeMillis();
                LOG.debug("Starting report {}", report);
                accountReportStart();
                report.walk();
                LOG.debug("Completed report {}", report);
                accountReportComplete();
                
                m_reportPersister.persist(report);
                LOG.debug("Report {} persisted", report);
                accountReportPersist();
                accountReportRunTime(System.currentTimeMillis() - reportStartTime);
            }
        });
    }

