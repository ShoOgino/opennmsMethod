    private void processAction(Automation auto) throws SQLException {

        if (log().isDebugEnabled())
            log().debug("runAutomation: running action(s): "+auto.getActionName());

        getConn().setAutoCommit(false);
        if (isTriggerInAutomation()) {
            getTriggerResultSet().beforeFirst();
            
            //Loop through the select results
            while (getTriggerResultSet().next()) {                        
                processActionStatement(getActionSQL(auto), getTriggerResultSet());
                /*
                 * TODO: create new XSD configuration to allow a way to send an event for each action per row.
                 * Currently, the XSD presents itself as one event per automation.
                 */
            }
            setActionSuccessful(true);
            sendAutoEvent(auto);
        } else {
            //No trigger defined, just running the action.
            if (getTokenCount(getActionSQL(auto)) != 0) {
                log().info("runAutomation: not running action: "+auto.getActionName()+".  Action contains tokens in an automation ("+auto.getName()+") with no trigger.");
                setActionSuccessful(false);
            } else {
                processActionStatement(getActionSQL(auto), getTriggerResultSet());
                sendAutoEvent(auto);
                setActionSuccessful(true);
            }
        }
        getConn().commit();
    }

