    public synchronized void init() {
        ThreadCategory.setPrefix(LOG4J_CATEGORY);

        try {
            // Get the newSuspectOnTrap flag
            boolean m_newSuspect = m_trapdConfig.getNewSuspectOnTrap();

            // set up the trap processor
            m_backlogQ = new FifoQueueImpl<TrapNotification>();
            m_processor = new TrapQueueProcessor(m_backlogQ, m_newSuspect,
                                                 m_eventMgr, m_eventConfDao);

            log().debug("start: Creating the trap queue processor");
            
            SnmpUtils.registerForTraps(this, this,
                                       m_trapdConfig.getSnmpTrapPort());

            log().debug("start: Creating the trap session");
        } catch (IOException e) {
            log().error("Failed to setup SNMP trap port", e);
            throw new UndeclaredThrowableException(e);
        }

        try {
            m_eventReader = new BroadcastEventProcessor();
            m_eventReader.setEventManager(m_eventMgr);
            m_eventReader.open();
        } catch (Exception e) {
            log().error("Failed to create event reader",
                                               e);
            throw new UndeclaredThrowableException(e);
        }
    }

