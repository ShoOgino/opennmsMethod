    /** Get the interface labels for each interface on a given node. */
    public static String[] getIfLabels(int nodeId) throws SQLException {
        ArrayList<String> list = new ArrayList<String>();
        Connection conn = Vault.getDbConnection();

        final DBUtils d = new DBUtils(IfLabel.class);
        try {
            PreparedStatement stmt = conn.prepareStatement("SELECT DISTINCT snmpifname, snmpifdescr,snmpphysaddr from snmpinterface, ipinterface where (ipinterface.ismanaged!='D') AND ipinterface.nodeid=snmpinterface.nodeid AND ifindex = snmpifindex AND ipinterface.nodeid=?");
            d.watch(stmt);
            stmt.setInt(1, nodeId);

            ResultSet rs = stmt.executeQuery();
            d.watch(rs);

            while (rs.next()) {
                String name = rs.getString("snmpifname");
                String descr = rs.getString("snmpifdescr");
                String physAddr = rs.getString("snmpphysaddr");

                list.add(getIfLabel(name, descr, physAddr));
            }
        } finally {
            d.cleanUp();
            Vault.releaseDbConnection(conn);
        }

        String[] labels = list.toArray(new String[list.size()]);

        return labels;
    }

