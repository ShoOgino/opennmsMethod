    private void checkHostname(final String hostname) {
        if (hostname == null) throw new NullPointerException("hostname must not be null");
        if (hostname.length() > 512) throw new IllegalArgumentException("Illegal hostname "+hostname+". Hostnames must not be longer than 512 characters");
    }

