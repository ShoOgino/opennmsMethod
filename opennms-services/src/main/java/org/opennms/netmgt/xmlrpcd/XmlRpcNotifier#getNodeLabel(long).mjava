    /**
     * <p>
     * This method retrieves the nodeLable from the database for a given nodeId.
     * </p>
     * 
     * @param nodeId
     *            the nodeId to retrieve the node label for.
     */
    private String getNodeLabel(long nodeId) {
        Connection dbConn = null;
        String nodeLabel = null;

        final DBUtils d = new DBUtils(getClass());
        try {
            dbConn = DataSourceFactory.getInstance().getConnection();
            d.watch(dbConn);

            if (log().isDebugEnabled()) {
                log().debug("getNodeLabel: retrieve node label for: " + nodeId);
            }

            PreparedStatement stmt = dbConn.prepareStatement("SELECT nodelabel FROM NODE WHERE nodeid = ?");
            d.watch(stmt);
            stmt.setLong(1, nodeId);
            ResultSet rs = stmt.executeQuery();
            d.watch(rs);

            while (rs.next()) {
                nodeLabel = rs.getString(1);
            }

        } catch (SQLException sqle) {
            log().warn("SQL exception while retrieving nodeLabel for: " + nodeId, sqle);
        } finally {
            d.cleanUp();
        }

        if (log().isDebugEnabled()) {
            log().debug("getNodeLabel: retrieved node label '" + nodeLabel + "' for: " + nodeId);
        }

        return nodeLabel;
    }

