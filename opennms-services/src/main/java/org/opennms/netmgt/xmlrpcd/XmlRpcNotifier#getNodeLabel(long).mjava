    /**
     * <p>
     * This method retrieves the nodeLable from the database for a given nodeId.
     * </p>
     * 
     * @param nodeId
     *            the nodeId to retrieve the node label for.
     */
    private String getNodeLabel(long nodeId) {
        Connection dbConn = null;
        String nodeLabel = null;

        try {
            dbConn = DataSourceFactory.getInstance().getConnection();

            if (log().isDebugEnabled()) {
                log().debug("getNodeLabel: retrieve node label for: " + nodeId);
            }

            PreparedStatement stmt = dbConn.prepareStatement("SELECT nodelabel FROM NODE WHERE nodeid = ?");
            stmt.setLong(1, nodeId);
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                nodeLabel = rs.getString(1);
            }
            stmt.close();

        } catch (SQLException sqle) {
            log().warn("SQL exception while retrieving nodeLabel for: " + nodeId, sqle);
        } finally {
            try {
                if (dbConn != null) {
                    dbConn.close();
                }
            } catch (SQLException e) {
                log().warn("Exception closing JDBC connection", e);
            }
        }

        if (log().isDebugEnabled()) {
            log().debug("getNodeLabel: retrieved node label '" + nodeLabel + "' for: " + nodeId);
        }

        return nodeLabel;
    }

