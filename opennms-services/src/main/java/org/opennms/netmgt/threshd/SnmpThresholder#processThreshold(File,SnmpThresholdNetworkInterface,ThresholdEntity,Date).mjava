    private List<Event> processThreshold(File directory, SnmpThresholdNetworkInterface snmpIface, ThresholdEntity threshold, Date date) {
        //Find out what data sources this threshold needs, check if they are available, and if so,
        // then get them and evaluate with them
        SnmpThresholdConfiguration thresholdConfiguration = snmpIface.getThresholdConfiguration();
        Collection<String> requiredDatasources=threshold.getThresholdConfig().getRequiredDatasources();
        Map<String, Double> values=new HashMap<String,Double>();
        String group = snmpIface.getThresholdConfiguration().getGroupName();
        for(String ds: requiredDatasources) {
            File dsFile= ResourceTypeUtils.getRrdFileForDs(directory,ds);
            Double dsValue=null;
            if(dsFile.exists() && passedThresholdFilters(directory, group, threshold.getDatasourceType(), ds)) {
                dsValue = getDataSourceValue(thresholdConfiguration, dsFile, ds);
            }
            if(dsValue==null) {
                log().info("Could not get data source value for '" + ds + "'.  Not evaluating threshold.");
                return null;
            }
            values.put(ds,dsValue);
        }
        List<Event> eventList=threshold.evaluateAndCreateEvents(values, date);
        return eventList;
    }

