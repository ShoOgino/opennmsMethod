	public ExpressionConfigWrapper(Expression expression) throws ThresholdExpressionException {
		super(expression);
		m_expression = expression;

		// Fetch an instance of the JEXL script engine
		JexlEngine expressionParser = new JexlEngine();

		BindingsSniffer sniffer = new BindingsSniffer();
		sniffer.put("math", new MathBinding());
		sniffer.put("datasources", new HashMap<String,Double>()); // To workaround NMS-5019

		// Test parsing of the expression and collect the variable names by using
		// a Bindings instance that sniffs all of the variable names
		try {
			expressionParser.createExpression(m_expression.getExpression()).evaluate(sniffer);
		} catch (Throwable e) {
			throw new ThresholdExpressionException("Could not parse threshold expression:" + e.getMessage(), e);
		}

		m_datasources = sniffer.getSniffedKeys();
	}

