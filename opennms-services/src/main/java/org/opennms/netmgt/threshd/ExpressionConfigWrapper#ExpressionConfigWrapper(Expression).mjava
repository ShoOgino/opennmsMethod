	public ExpressionConfigWrapper(Expression expression) throws ThresholdExpressionException {
		super(expression);
		m_expression = expression;

		// Fetch an instance of the JEXL script engine
		ScriptEngineManager mgr = new ScriptEngineManager();
		m_parser = mgr.getEngineByName("jexl");

		BindingsSniffer sniffer = new BindingsSniffer();
		// DelegateScriptContext context = new DelegateScriptContext();

		// Test parsing of the expression and collect the variable names by inserting
		// a ScriptContext that sniffs calls to getAttribute()
		try {
			// ScriptContext context = m_parser.getContext();
			// context.setBindings(sniffer, ScriptContext.ENGINE_SCOPE);
			// context.setBindings(sniffer, ScriptContext.GLOBAL_SCOPE);
			// m_parser.setBindings(sniffer, ScriptContext.ENGINE_SCOPE);
			// m_parser.setBindings(sniffer, ScriptContext.GLOBAL_SCOPE);

			// m_parser.setContext(context);
			m_parser.eval(m_expression.getExpression(), sniffer);
		} catch (Throwable e) {
			throw new ThresholdExpressionException("Could not parse threshold expression:" + e.getMessage());
		}

		//m_datasources.addAll(m_parser.getBindings(ScriptContext.ENGINE_SCOPE).keySet());
		m_datasources = sniffer.getSniffedKeys();
	}

