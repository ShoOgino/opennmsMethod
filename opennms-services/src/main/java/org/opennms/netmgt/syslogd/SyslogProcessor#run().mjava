    /**
     * The event processing execution context.
     */
    public void run() {
        // The runnable context
        m_context = Thread.currentThread();

        // get a logger
        ThreadCategory.setPrefix(m_logPrefix);
        ThreadCategory log = ThreadCategory.getInstance(getClass());
        boolean isTracing = log.isEnabledFor(Level.TRACE);

        if (m_stop) {
            if (isTracing)
                log.trace("Stop flag set before thread started, exiting");
            return;
        } else if (isTracing)
            log.trace("Thread context started");

        while (!m_stop) {

            ConvertToEvent o = null;

            o = SyslogHandler.queueManager.getFromQueue();

            if (o != null) {
                try {
                    if (isTracing)  {
                        log.trace("Processing a syslog to event dispatch" + o.toString());
                        String uuid = o.getEvent().getUuid();
                        log.trace("Event {");
                        log.trace("  uuid  = "
                                + (uuid != null && uuid.length() > 0 ? uuid
                                : "<not-set>"));
                        log.trace("  uei   = " + o.getEvent().getUei());
                        log.trace("  src   = " + o.getEvent().getSource());
                        log.trace("  iface = " + o.getEvent().getInterface());
                        log.trace("  time  = " + o.getEvent().getTime());
                        log.trace("  Msg   = "
                                + o.getEvent().getLogmsg().getContent());
                        log.trace("  Dst   = "
                                + o.getEvent().getLogmsg().getDest());
                        Parm[] parms = (o.getEvent().getParms() == null ? null
                                : o.getEvent().getParms().getParm());
                        if (parms != null) {
                            log.trace("  parms {");
                            for (Parm parm : parms) {
                                if ((parm.getParmName() != null)
                                        && (parm.getValue().getContent() != null)) {
                                    log.trace("    ("
                                            + parm.getParmName().trim()
                                            + ", "
                                            + parm.getValue().getContent().trim()
                                            + ")");
                                }
                            }
                            log.trace("  }");
                        }
                        log.trace("}");
                    }

                    EventIpcManagerFactory.getIpcManager().sendNow(o.getEvent());

                    if (m_NewSuspectOnMessage && !o.getEvent().hasNodeid()) {
                        if (isTracing) {
                            log.trace("Syslogd: Found a new suspect " + o.getEvent().getInterface());
                        }
                        sendNewSuspectEvent(o.getEvent().getInterface());
                    }

                } catch (Throwable t) {
                    log.error("Unexpected error processing SyslogMessage - Could not send", t);
                }
            }

        }

    }

