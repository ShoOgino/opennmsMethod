    /**
     * Build the preferences string with the appropriate plugins and safe_checks
     * settings from the config file.
     */
    private String buildPreferencesString() {
        String retval = NTP_CLIENT_ENTITY + NTP_SEP + "PREFERENCES" + NTP_SEP + "\n" + "plugin_set" + NTP_SEP + pluginLists[config.scanLevel] + "\n" + "safe_checks" + NTP_SEP;

        if (safeChecks[config.scanLevel])
            retval += "yes";
        else
            retval += "no";

        retval += "\nmax_hosts" + NTP_SEP + "1\n" + "ntp_short_status" + NTP_SEP + "yes\n" +  "reverse_lookup" + NTP_SEP + "yes\n" + NTP_SEP + NTP_CLIENT_ENTITY;

        return retval;
    }

