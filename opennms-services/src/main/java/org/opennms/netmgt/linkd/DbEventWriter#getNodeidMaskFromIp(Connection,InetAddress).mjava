    private RouterInterface getNodeidMaskFromIp(Connection dbConn, InetAddress ipaddr) throws SQLException {
        if (ipaddr.isLoopbackAddress() || ipaddr.getHostAddress().equals("0.0.0.0")) return null;

        int nodeid = -1;
        int ifindex = -1;
        String netmask = null;

        PreparedStatement stmt = null;
        stmt = dbConn.prepareStatement(SQL_GET_NODEID__IFINDEX_MASK);
        stmt.setString(1, ipaddr.getHostAddress());

        if (log().isDebugEnabled())
            log().debug("getNodeidMaskFromIp: executing query " + SQL_GET_NODEID__IFINDEX_MASK + " with ip address=" + ipaddr.getHostAddress());

        ResultSet rs = stmt.executeQuery();

        if (!rs.next()) {
            rs.close();
            stmt.close();
            if (log().isDebugEnabled()) log().debug("getNodeidMaskFromIp: no entries found in snmpinterface");
            return null;
        }
        // extract the values.
        //
        // get the node id
        //
        nodeid = rs.getInt("nodeid");
        if (rs.wasNull()) {
            rs.close();
            stmt.close();
            if (log().isDebugEnabled()) log().debug("getNodeidMaskFromIp: no nodeid found");
            return null;
        }

        ifindex = rs.getInt("snmpifindex");
        if (rs.wasNull()) {
            if (log().isDebugEnabled()) log().debug("getNodeidMaskFromIp: no snmsnmpifindex found");
            ifindex = -1;
        }

        netmask = rs.getString("snmpipadentnetmask");
        if (rs.wasNull()) {
            if (log().isDebugEnabled()) log().debug("getNodeidMaskFromIp: no snmpipadentnetmask found");
            netmask = "255.255.255.255";
        }

        rs.close();
        stmt.close();
        RouterInterface ri = new RouterInterface(nodeid, ifindex, netmask);
        return ri;

    }

