    /** {@inheritDoc} */
    public String getSnmpPrimaryIp(int nodeid) throws SQLException {

        final DBUtils d = new DBUtils(getClass());
        try {

            Connection dbConn = getConnection();
            d.watch(dbConn);

            /**
             * Query to select info for specific node
             */
    
            String ipaddr = null;
            PreparedStatement stmt = dbConn.prepareStatement(SQL_SELECT_SNMP_IP_ADDR);
            d.watch(stmt);
            stmt.setInt(1, nodeid);
            if (log().isDebugEnabled()) log().debug("getSnmpPrimaryIp: SQL statement = " + stmt.toString());
    
            ResultSet rs = stmt.executeQuery();
            d.watch(rs);
    
            while (rs.next()) {
                ipaddr = rs.getString("ipaddr");
                if (ipaddr == null) return null;
                if (log().isDebugEnabled()) log().debug("getSnmpPrimaryIp: found node element: nodeid " + nodeid + " ipaddr " + ipaddr);
    
            }
            return ipaddr;
        } finally {
            d.cleanUp();
        }

    }

