    private int getSnmpIfType(Connection dbConn, int nodeid, int ifindex) throws SQLException {

        int snmpiftype = -1;
        PreparedStatement stmt = null;
        stmt = dbConn.prepareStatement(SQL_GET_SNMPIFTYPE);
        stmt.setInt(1, nodeid);
        stmt.setInt(2, ifindex);

        if (log().isDebugEnabled()) log().debug("getSnmpIfType: executing query " + SQL_GET_SNMPIFTYPE + " with nodeid=" + nodeid + " and ifindex=" + ifindex);

        ResultSet rs = stmt.executeQuery();

        if (!rs.next()) {
            rs.close();
            stmt.close();
            if (log().isDebugEnabled()) log().debug("getSnmpIfType: no entries found in snmpinterface");
            return -1;
        }

        // extract the values.
        //
        int ndx = 1;

        // get the node id
        //
        snmpiftype = rs.getInt(ndx++);
        if (rs.wasNull()) snmpiftype = -1;

        if (log().isDebugEnabled()) log().debug("getSnmpIfType: found in snmpinterface snmpiftype=" + snmpiftype);

        stmt.close();

        return snmpiftype;

    }

