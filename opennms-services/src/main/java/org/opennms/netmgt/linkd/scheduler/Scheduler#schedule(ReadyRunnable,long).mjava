	/**
	 * This method is used to schedule a ready runnable in the system. The
	 * interval is used as the key for determining which queue to add the
	 * runnable.
	 *
	 * @param runnable
	 *            The element to run when interval expires.
	 * @param interval
	 *            The queue to add the runnable to.
	 * @throws java.lang.RuntimeException
	 *             Thrown if an error occurs adding the element to the queue.
	 */
	public synchronized void schedule(ReadyRunnable runnable, long interval) {
	    LogUtils.debugf(this, "schedule: Adding ready runnable at interval %d", interval);

		if (!m_queues.containsKey(interval)) {
		    LogUtils.debugf(this, "schedule: interval queue did not exist, a new one has been created");
			m_queues.put(interval, new PeekableFifoQueue<ReadyRunnable>());
		}

		try {
			(m_queues.get(interval)).add(runnable);
			if (m_scheduled++ == 0) {
			    LogUtils.debugf(this, "schedule: queue element added, calling notify all since none were scheduled");
				notifyAll();
			} else {
			    LogUtils.debugf(this, "schedule: queue element added, notification not performed");
			}
		} catch (InterruptedException ie) {
		    LogUtils.infof(this, ie, "schedule: failed to add new ready runnable instance %s to scheduler", runnable);
			Thread.currentThread().interrupt();
		} catch (FifoQueueException ex) {
		    LogUtils.infof(this, ex, "schedule: failed to add new ready runnable instance %s to scheduler", runnable);
		}
	}

