		/**
		 * Inserts the new row into the StpNode table
		 * of the OpenNMS database.
		 *
		 * @param c	The connection to the database.
		 *
		 * @throws java.sql.SQLException Thrown if an error occurs
		 * 	with the connection
		 */
		private void insert(Connection c) throws SQLException {
			if (m_fromDb)
				throw new IllegalStateException(
						"The record already exists in the database");

			// first extract the next node identifier
			//
			StringBuffer names = new StringBuffer(
					"INSERT INTO StpNode (nodeid,basevlan");
			StringBuffer values = new StringBuffer("?,?");

			if ((m_changed & CHANGED_BRIDGEADDR) == CHANGED_BRIDGEADDR) {
				values.append(",?");
				names.append(",baseBridgeAddress");
			}

			if ((m_changed & CHANGED_NUMPORTS) == CHANGED_NUMPORTS) {
				values.append(",?");
				names.append(",baseNumPorts");
			}

			if ((m_changed & CHANGED_BASETYPE) == CHANGED_BASETYPE) {
				values.append(",?");
				names.append(",basetype");
			}
			
			if ((m_changed & CHANGED_STPPROTSPEC) == CHANGED_STPPROTSPEC) {
				values.append(",?");
				names.append(",stpProtocolSpecification");
			}

			if ((m_changed & CHANGED_STPPRIORITY) == CHANGED_STPPRIORITY) {
				values.append(",?");
				names.append(",stpPriority");
			}

			if ((m_changed & CHANGED_STPDESROOT) == CHANGED_STPDESROOT) {
				values.append(",?");
				names.append(",stpdesignatedroot");
			}

			if ((m_changed & CHANGED_STPROOTCOST) == CHANGED_STPROOTCOST) {
				values.append(",?");
				names.append(",stprootcost");
			}

			if ((m_changed & CHANGED_STPROOTPORT) == CHANGED_STPROOTPORT) {
				values.append(",?");
				names.append(",stprootport");
			}

			if ((m_changed & CHANGED_VLANNAME) == CHANGED_VLANNAME) {
				values.append(",?");
				names.append(",basevlanname");
			}

			if ((m_changed & CHANGED_STATUS) == CHANGED_STATUS) {
				values.append(",?");
				names.append(",status");
			}

			if ((m_changed & CHANGED_POLLTIME) == CHANGED_POLLTIME) {
				values.append(",?");
				names.append(",lastpolltime");
			}

			names.append(") VALUES (").append(values).append(')');

			LogUtils.debugf(this, "DbStpNodeEntry.insert: SQL insert statment = %s", names.toString());

			final DBUtils d = new DBUtils(getClass());
			
			try {
                PreparedStatement stmt = c.prepareStatement(names.toString());
                d.watch(stmt);

                int ndx = 1;
                stmt.setInt(ndx++, m_nodeId);
                stmt.setInt(ndx++, m_basevlan);

                if ((m_changed & CHANGED_BRIDGEADDR) == CHANGED_BRIDGEADDR)
                	stmt.setString(ndx++, m_basebridgeaddress);

                if ((m_changed & CHANGED_NUMPORTS) == CHANGED_NUMPORTS)
                	stmt.setInt(ndx++, m_basenumports);

                if ((m_changed & CHANGED_BASETYPE) == CHANGED_BASETYPE)
                	stmt.setInt(ndx++, m_basetype);
                
                if ((m_changed & CHANGED_STPPROTSPEC) == CHANGED_STPPROTSPEC) 
                	stmt.setInt(ndx++, m_stpprotocolspecification);

                if ((m_changed & CHANGED_STPPRIORITY) == CHANGED_STPPRIORITY) 
                	stmt.setInt(ndx++, m_stppriority);

                if ((m_changed & CHANGED_STPDESROOT) == CHANGED_STPDESROOT)
                	stmt.setString(ndx++, m_stpdesignatedroot);

                if ((m_changed & CHANGED_STPROOTCOST) == CHANGED_STPROOTCOST)
                	stmt.setInt(ndx++, m_stprootcost);

                if ((m_changed & CHANGED_STPROOTPORT) == CHANGED_STPROOTPORT) 
                	stmt.setInt(ndx++, m_stprootport);
                
                if ((m_changed & CHANGED_VLANNAME) == CHANGED_VLANNAME) 
                	stmt.setString(ndx++, m_basevlanname);

                if ((m_changed & CHANGED_STATUS) == CHANGED_STATUS)
                	stmt.setString(ndx++, new String(new char[] { m_status }));

                if ((m_changed & CHANGED_POLLTIME) == CHANGED_POLLTIME) {
                	stmt.setTimestamp(ndx++, m_lastPollTime);
                }

                // Run the insert
                //
                int rc = stmt.executeUpdate();
                LogUtils.debugf(this, "StpNodeEntry.insert: row %d", rc);
			} finally {
			    d.cleanUp();
            }

			// clear the mask and mark as backed
			// by the database
			//
			m_fromDb = true;
			m_changed = 0;
		}

