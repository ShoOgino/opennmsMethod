    protected void processOspf(final LinkableNode node, final SnmpCollection snmpcoll, final Connection dbConn, final Timestamp scanTime) {
        
        InetAddress ospfRouterId = snmpcoll.getOspfGeneralGroup().getOspfRouterId();

        LogUtils.debugf(this, "processOspf: ospf node/ospfrouterid: %d/%s", node.getNodeId(), str(ospfRouterId)); 
        try {
            if (InetAddress.getByName("0.0.0.0").equals(ospfRouterId)) {
                LogUtils.infof(this, "processOspf: invalid ospf ruoter id. node/ospfrouterid: %d/%s. Skipping!", node.getNodeId(), str(ospfRouterId)); 
                return;
            }
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }

        node.setOspfRouterId(ospfRouterId);

        Map<InetAddress,Integer> ospfipaddresstoifindex = new HashMap<InetAddress, Integer>();
        for (final OspfIfTableEntry ospfIfTableEntry: snmpcoll.getOspfIfTable()) {
            InetAddress ospfIfAddress = ospfIfTableEntry.getOspfIpAddress();
            LogUtils.debugf(this, "processOspf: addind ospf node/ospfifipaddress: %d/%s", node.getNodeId(), str(ospfIfAddress)); 
            try {
                if (InetAddress.getByName("0.0.0.0").equals(ospfIfAddress)) {
                    LogUtils.infof(this, "processOspf: invalid ospf interface ip address. node/ospfipipaddr: %d/%s. Skipping!", node.getNodeId(), str(ospfIfAddress)); 
                    continue;
                }
            } catch (UnknownHostException e) {
                e.printStackTrace();
            }
            Integer ifIndex = ospfIfTableEntry.getOspfAddressLessIf();
            LogUtils.debugf(this, "processOspf: ospf node/ospfifipaddress/ospfAddressLessIf: %d/%s/%d", node.getNodeId(), str(ospfIfAddress),ifIndex); 
            if (ifIndex.intValue() == 0) {
                ifIndex = getIfIndex(node.getNodeId(), str(ospfIfAddress));
            }
            LogUtils.infof(this, "processOspf: ospf node/ospfifipaddress/ifIndex: %d/%s/%d", node.getNodeId(), str(ospfIfAddress),ifIndex); 
            if (ifIndex != null && ifIndex.intValue() > 0)
                ospfipaddresstoifindex.put(ospfIfAddress, ifIndex);
            else 
                LogUtils.infof(this, "processOspf: ospf invalid if index. node/ospfifipaddress/ifIndex: %d/%s/%d. Skipping!", node.getNodeId(), str(ospfIfAddress),ifIndex);                 
        }
        node.setOspfipaddresstoifindex(ospfipaddresstoifindex);
        
        List<OspfNbrInterface> ospfinterfaces = new ArrayList<OspfNbrInterface>();
        
        for (final OspfNbrTableEntry ospfNbrTableEntry: snmpcoll.getOspfNbrTable()) {
            InetAddress ospfNbrRouterId = ospfNbrTableEntry.getOspfNbrRouterId();
            InetAddress ospfNbrIpAddr = ospfNbrTableEntry.getOspfNbrIpAddress();
            LogUtils.debugf(this, "processOspf: addind ospf node/ospfnbraddress/ospfnbrrouterid: %d/%s/%s", node.getNodeId(), str(ospfNbrIpAddr),str(ospfNbrRouterId)); 
            try {
                if (InetAddress.getByName("0.0.0.0").equals(ospfNbrIpAddr) || InetAddress.getByName("0.0.0.0").equals(ospfNbrRouterId)) {
                    LogUtils.infof(this, "processOspf: ospf invalid ip address for node/ospfnbraddress/ospfnbrrouterid: %d/%s/%s", node.getNodeId(), str(ospfNbrIpAddr),str(ospfNbrRouterId)); 
                    continue;
                }
            } catch (UnknownHostException e) {
                e.printStackTrace();
            }
            Integer ifIndex = ospfNbrTableEntry.getOspfNbrAddressLessIndex();
            LogUtils.debugf(this, "processOspf: ospf node/ospfnbraddress/ospfnbrrouterid/ospfnbrAddressLessIfIndex: %d/%s/%s/%d", node.getNodeId(), str(ospfNbrIpAddr),str(ospfNbrRouterId),ifIndex); 
            List<OnmsIpInterface> ipinterfaces = getIpInterfaceDao().findByIpAddress(str(ospfNbrIpAddr));
            for (OnmsIpInterface ipinterface:ipinterfaces ) {
                
                if (ifIndex.intValue() == 0) 
                    ifIndex = ipinterface.getIfIndex();
                LogUtils.debugf(this, "processOspf: ospf node/ospfnbraddress/ospfnbrrouterid/ifIndex: %d/%s/%s/%d", ipinterface.getNode().getId(), str(ospfNbrIpAddr),str(ospfNbrRouterId),ifIndex);             
                if (ifIndex != null && ifIndex.intValue() > 0) {
                    OspfNbrInterface ospfinterface = new OspfNbrInterface(ospfNbrRouterId);
                    ospfinterface.setOspfNbrNodeId(ipinterface.getNode().getId());
                    ospfinterface.setOspfNbrIpAddr(ospfNbrIpAddr);
                    ospfinterface.setOspfNbrNetMask(getSnmpInterfaceDao().findByNodeIdAndIfIndex(ipinterface.getNode().getId(), ifIndex).getNetMask());
                    ospfinterface.setOspfNbrIfIndex(ifIndex);
                    LogUtils.debugf(this, "processOspf: adding ospf interface. node/ospfinterface: %d/%s", node.getNodeId(), ospfinterface);           
                    ospfinterfaces.add(ospfinterface);
                } else {
                    LogUtils.infof(this, "processOspf: ospf invalid if index. node/ospfnbraddress/ospfnbrrouterid/ifIndex: %d/%s/%s/%d. Skipping!", node.getNodeId(), str(ospfNbrIpAddr),str(ospfNbrRouterId),ifIndex);                             
                }
            }
        }
        node.setOspfinterfaces(ospfinterfaces);
    }

