    private DataLinkInterface getDatabaseLink(
            Collection<DataLinkInterface> links, int nodeparentid,
            int parentifindex, DiscoveryProtocol protocol) {
        for (DataLinkInterface link : links) {
            if (link.getNodeParentId().intValue() == nodeparentid
                    && link.getParentIfIndex().intValue() == parentifindex
                    && link.getProtocol() == protocol) {
                LOG.info("storeDiscoveryLink: found link {} on database.",
                         link);
                return link;
            }
        }
        return null;
    }

