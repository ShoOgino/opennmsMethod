    // Here all the information related to the
    // mapping between ipaddress and mac address is stored
    // also the correlated ifindex is found
    public void addAtInterface(final AtInterface atinterface) {
        for (final String packageName : getActivePackages()) {
            final String macAddress = atinterface.getMacAddress();
            final InetAddress ipAddress = atinterface.getIpAddress();

            if (!isInterfaceInPackage(ipAddress, packageName)) continue;

            synchronized (m_macToAtinterface) {
                if (!m_macToAtinterface.containsKey(packageName)) {
                    m_macToAtinterface.put(packageName, new HashMap<String, List<AtInterface>>());
                }

                final List<AtInterface> atis;
                if (m_macToAtinterface.get(packageName).containsKey(macAddress)) {
                    atis = m_macToAtinterface.get(packageName).get(macAddress);
                } else {
                    atis = new ArrayList<AtInterface>();
                }

                if (atis.contains(atinterface)) {
                } else {
                    atis.add(atinterface);
                    m_macToAtinterface.get(packageName).put(macAddress, atis);
                }
            }
        }
    }

