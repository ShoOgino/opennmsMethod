    protected void processStpNode(final LinkableNode node, final SnmpCollection snmpcoll, final Connection dbConn, final Timestamp scanTime, final OnmsVlan vlan, final SnmpVlanCollection snmpVlanColl) throws SQLException {
        LogUtils.debugf(this, "processStpNode: Starting STP node processing.");

        final Dot1dBaseGroup dod1db = snmpVlanColl.getDot1dBase();
        final String baseBridgeAddress = dod1db.getBridgeAddress();

        if (vlan.getVlanId() != null) {
            node.addBridgeIdentifier(baseBridgeAddress, vlan.getVlanId().toString());
        }

        final OnmsNode onmsNode = getNode(node.getNodeId());
        final OnmsStpNode stpNode = new OnmsStpNode(onmsNode, vlan.getVlanId());
        stpNode.setLastPollTime(scanTime);
        stpNode.setStatus(DbStpNodeEntry.STATUS_ACTIVE);

        if (snmpcoll.getSaveStpNodeTable()) {
            LogUtils.debugf(this, "baseBridgeAddress = %s", baseBridgeAddress);
            stpNode.setBaseBridgeAddress(baseBridgeAddress);
            stpNode.setBaseNumPorts(dod1db.getNumberOfPorts());
            stpNode.setBaseType(dod1db.getBridgeType());
            stpNode.setBaseVlanName(vlan.getVlanName());
        }

        if (snmpVlanColl.hasDot1dStp()) {
            LogUtils.debugf(this, "store: adding Dot1dStpGroup in stpnode table");

            final Dot1dStpGroup dod1stp = snmpVlanColl.getDot1dStp();

            stpNode.setStpProtocolSpecification(dod1stp.getStpProtocolSpecification());
            stpNode.setStpPriority(dod1stp.getStpPriority());
            stpNode.setStpRootCost(dod1stp.getStpRootCost());
            stpNode.setStpRootPort(dod1stp.getStpRootPort());

            String stpDesignatedRoot = dod1stp.getStpDesignatedRoot();

            if (stpDesignatedRoot == null || stpDesignatedRoot == "0000000000000000") {
                LogUtils.debugf(this, "store: Dot1dStpGroup found stpDesignatedRoot " + stpDesignatedRoot + " not adding to Linkable node");
                stpDesignatedRoot = "0000000000000000";
            } else {
                if (stpNode.getBaseVlan() != null) {
                    node.setVlanStpRoot(vlan.getVlanId().toString(), stpDesignatedRoot);
                }
            }
            stpNode.setStpDesignatedRoot(stpDesignatedRoot);
        }
        // store object in database
        if (snmpcoll.getSaveStpNodeTable()) {
            saveStpNode(dbConn, stpNode);
        }
    }

