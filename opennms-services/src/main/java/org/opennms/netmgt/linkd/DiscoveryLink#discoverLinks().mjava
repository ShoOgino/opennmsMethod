    private void discoverLinks() {   
        Collection<LinkableNode> linkableNodes = m_linkd.getLinkableNodesOnPackage(getPackageName());
        LOG.info("run: Found {} LinkableNodes  on package \"{}\"", linkableNodes.size(), getPackageName());
        
        // this part could have several special function to get inter-router
        // links, but at the moment we worked much on switches.
        // In future we can try to extend this part.
        if (discoveryUsingRoutes)
            getLinksFromRouteTable(linkableNodes);

        if (discoveryUsingOspf)
            getLinksFromOspf(linkableNodes);
        
        if (discoveryUsingIsis)
            getLinksFromIsis(linkableNodes);
        
        if (discoveryUsingWifi)
            getLinksFromWifi(linkableNodes);
        
        // try get backbone links between switches using STP info
        // and store information in Bridge class
        // finding links using MAC address on ports
        if (discoveryUsingBridge) {
            getLinksFromBridge(linkableNodes);
        }
        
        // Try Link Layer Discovery Protocol to found link among all nodes
        if (discoveryUsingLldp)
            getLinksFromLldp(linkableNodes);
        
        // Try Cisco Discovery Protocol to found link among all nodes
        if (discoveryUsingCdp)
            getLinksFromCdp(linkableNodes);

        getLinkd().clearPackageSavedData(getPackageName());

        m_linkd.updateDiscoveryLinkCollection(this);

        m_links.clear();
        runned = true;
    }

