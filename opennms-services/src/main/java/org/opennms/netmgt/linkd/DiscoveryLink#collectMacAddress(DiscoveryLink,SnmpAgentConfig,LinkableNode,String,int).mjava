    private static LinkableNode collectMacAddress(
            DiscoveryLink discoveryLink, SnmpAgentConfig agentConfig,
            LinkableNode node, String mac, int vlan) {
        FdbTableGet coll = new FdbTableGet(agentConfig, mac);
        LogUtils.debugf(discoveryLink,
                        "collectMacAddress: finding entry in bridge forwarding table for MAC on node: %s/%d",
                        mac, node.getNodeId());
        int bridgeport = coll.getBridgePort();
        if (bridgeport > 0
                && coll.getBridgePortStatus() == QueryManager.SNMP_DOT1D_FDB_STATUS_LEARNED) {
            node.addMacAddress(bridgeport, mac, Integer.toString(vlan));
            LogUtils.debugf(discoveryLink,
                            "collectMacAddress: found MAC on bridge port: %d",
                            bridgeport);
        } else {
            bridgeport = coll.getQBridgePort();
            if (bridgeport > 0
                    && coll.getQBridgePortStatus() == QueryManager.SNMP_DOT1D_FDB_STATUS_LEARNED) {
                node.addMacAddress(bridgeport, mac, Integer.toString(vlan));
                LogUtils.debugf(discoveryLink,
                                "collectMacAddress: found MAC on bridge port: %d",
                                bridgeport);
            } else {
                LogUtils.debugf(discoveryLink,
                                "collectMacAddress: MAC not found: %d",
                                bridgeport);
            }
        }
        return node;
    }

