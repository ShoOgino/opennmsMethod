	public void run() {

		Category log = ThreadCategory.getInstance(getClass());
		Connection dbConn = null;
		Timestamp now = new Timestamp(System.currentTimeMillis());

		try {
			dbConn = DataSourceFactory.getInstance().getConnection();
			if (log.isDebugEnabled()) {
				log.debug("run: Storing information into database");
			}
			if (action == ACTION_STORE)
				storeSnmpCollection(dbConn, now);
			else if (action == ACTION_UPTODATE || action == ACTION_DELETE)
				update(dbConn, action);
			else if (action == ACTION_STORE_LINKS)
				storeDiscoveryLink(dbConn,now);
			else
				log.warn("Unknown action: " + action + " . Exiting");
		} catch (SQLException sqlE) {
			log
					.fatal(
							"SQL Exception while syncing node object with database information.",
							sqlE);
			throw new UndeclaredThrowableException(sqlE);
		} catch (Throwable t) {
			log
					.fatal(
							"Unknown error while syncing node object with database information.",
							t);
			throw new UndeclaredThrowableException(t);
		} finally {
			try {
				if (dbConn != null) {
					dbConn.close();
				}
			} catch (Exception e) {
				log
						.fatal(
								"Unknown error while closing database connection.",
								e);
			}
		}
	}

