    @Override
    protected List<Integer> getNodeidFromIp(Connection dbConn, InetAddress ipaddr) throws SQLException {

        List<Integer> nodeids = new ArrayList<Integer>();

        final String hostAddress = str(ipaddr);
        final DBUtils d = new DBUtils(getClass());
        try {
        	final PreparedStatement stmt = dbConn.prepareStatement(SQL_GET_NODEID);
            d.watch(stmt);
            stmt.setString(1, hostAddress);
    
            LogUtils.debugf(this, "getNodeidFromIp: executing query " + SQL_GET_NODEID + " with IP address=" + hostAddress);
    
            ResultSet rs = stmt.executeQuery();
            d.watch(rs);
    
            if (!rs.next()) {
                LogUtils.debugf(this, "getNodeidFromIp: no entries found in ipinterface");
                return nodeids;
            }
            // extract the values.
            //
            while (rs.next()) {                    
            // get the node id
            //
                int nodeid = rs.getInt("nodeid");
                nodeids.add(nodeid);
    
                LogUtils.debugf(this, "getNodeidFromIp: found nodeid " + nodeid);
            }
        } finally {
            d.cleanUp();
        }

        return nodeids;

    }

