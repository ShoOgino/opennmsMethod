    private void doPoll(SnmpPollInterfaceMonitor pollMonitor, List<SnmpMinimalPollInterface> mifaces) {
        
        log().info("doPoll: input interfaces number: " + mifaces.size());
    	
        mifaces = pollMonitor.poll(getAgentConfig(), mifaces);
        
        if (mifaces != null) {
            log().info("doPoll: PollerMonitor return interfaces number: " + mifaces.size());
            Iterator<SnmpMinimalPollInterface> ite = mifaces.iterator();
            while (ite.hasNext()) {
                SnmpMinimalPollInterface miface = ite.next();
                log().debug("Working on interface with ifindex: " + miface.getIfindex());
                log().debug("Interface PollStatus is " + miface.getStatus().getStatusName());
                if (miface.getStatus().isUp()) {
                    OnmsSnmpInterface iface = m_snmpinterfaces.get(new Integer(miface.getIfindex()));
                    boolean changed = false;
                    log().debug("Previuos status Admin/Oper: " + iface.getIfAdminStatus() + "/" + iface.getIfOperStatus());
                    log().debug("Current status Admin/Oper: " + miface.getAdminstatus() + "/" + miface.getOperstatus());
                    
                    if (firstrun) {
                        // If the interface is Admin Up, and the interface is Operational Down, we generate an alarm
                        // if no alarm exist in alarm table.
                        if ( miface.getAdminstatus() == SnmpMinimalPollInterface.IF_UP
                          && miface.getOperstatus() == SnmpMinimalPollInterface.IF_DOWN 
                          && !hasOperDownAlarm(miface.getIfindex())) {
                                sendOperDownEvent(iface);
                        } 
                        
                        // If the interface is Admin Up, and the interface is Operational Up, we generate a clean alarm
                        // if exist an alarm in alarm table
                        if ( miface.getAdminstatus() == SnmpMinimalPollInterface.IF_UP
                                && miface.getOperstatus() == SnmpMinimalPollInterface.IF_UP 
                                && hasOperDownAlarm(miface.getIfindex())) {
                                      sendOperUpEvent(iface);
                        } 
                        
                        
                        if (!suppressAdminDownEvent() && miface.getAdminstatus() == SnmpMinimalPollInterface.IF_DOWN 
                                && ! hasAdminDownAlarm(miface.getIfindex())) {
                                sendAdminDownEvent(iface);
                        }

                        if (!suppressAdminDownEvent() && miface.getAdminstatus() == SnmpMinimalPollInterface.IF_UP 
                                && hasAdminDownAlarm(miface.getIfindex())) {
                                sendAdminUpEvent(iface);
                        }

                    } // end firstrun
                    
                    if (iface.getIfAdminStatus() != miface.getAdminstatus()) {
                        changed = true;
                        iface.setIfAdminStatus(new Integer(miface.getAdminstatus()));
                        // We create event if and only if status changes from first run
                        // and suppressAdminDownEvent is false
                        if (!firstrun && !suppressAdminDownEvent()) {
                            if (miface.getAdminstatus() == SnmpMinimalPollInterface.IF_DOWN)
                                sendAdminDownEvent(iface);
                            if (miface.getAdminstatus() == SnmpMinimalPollInterface.IF_UP)
                                sendAdminUpEvent(iface);
                        }
                    }
                                        
                    if (iface.getIfOperStatus() != miface.getOperstatus()) {
                        changed = true;
                        iface.setIfOperStatus(new Integer(miface.getOperstatus()));
                        // We create event if and only if status changes from first run
                        // and the interface is administratevely up
                        if (!firstrun && (miface.getAdminstatus() == SnmpMinimalPollInterface.IF_UP)) {
                            if (miface.getOperstatus() == SnmpMinimalPollInterface.IF_DOWN)
                                sendOperDownEvent(iface);
                            if (miface.getOperstatus() == SnmpMinimalPollInterface.IF_UP)
                                sendOperUpEvent(iface);
                        }
                    }
                    
                    //Admin status management
                    log().debug("Interface changed = " + changed);
                    
                    // Save Data to Database
                    if (changed) {
                        update(iface);
                    }
                } else {
                    log().warn("run: " + getContext().getServiceName() + " not available, doing nothing.....");
                } //End if status OK
            } //end while on interface
        } else {
            log().error("the monitor return null object");
        } //end If not null

    }

