    private void doPoll(SnmpPollInterfaceMonitor pollMonitor, List<SnmpMinimalPollInterface> mifaces) {
        
        LOG.info("doPoll: input interfaces number: {}", mifaces.size());
    	
        mifaces = pollMonitor.poll(getAgentConfig(), mifaces);
        
        boolean refresh = false;
        
        Date now = getDate();
        
        if (mifaces != null) {
            LOG.info("doPoll: PollerMonitor return interfaces number: {}", mifaces.size());
            for (SnmpMinimalPollInterface miface : mifaces) {
                LOG.debug("Working on interface with ifindex: {}", miface.getIfindex());
                LOG.debug("Interface PollStatus is {}", miface.getStatus().getStatusName());
                if (miface.getStatus().isUp()) {
                    OnmsSnmpInterface iface = m_snmpinterfaces.get(Integer.valueOf(miface.getIfindex()));

                    LOG.debug("Previous status Admin/Oper: {}/{}", iface.getIfAdminStatus(), iface.getIfOperStatus());
                    LOG.debug("Current status Admin/Oper: {}/{}", miface.getAdminstatus(), miface.getOperstatus());

                    // If the interface is Admin Up and the oper status is newly down, we generate an alarm.
                    if ( m_upValues.contains(miface.getAdminstatus())
                         && m_downValues.contains(miface.getOperstatus())
                         && !m_downValues.contains(SnmpInterfaceStatus.statusFromMibValue(iface.getIfOperStatus()))) {
                        sendOperDownEvent(iface);
                        if (miface.getOperstatus() != SnmpInterfaceStatus.DOWN) {
                            sendOperDownishEvent(miface.getOperstatus(), iface);
                        }
                        miface.setOperPollStatus(PollStatus.unavailable("ifOperStatus is " + miface.getOperstatus().getLabel()));
                        miface.setAdminPollStatus(PollStatus.available());
                    }
                    
                    // If the interface is Admin Up and Operational Up and previously not operational up
                    // we send the operational up event
                    if ( m_upValues.contains(miface.getAdminstatus())
                         && m_upValues.contains(miface.getOperstatus())
                         && !m_upValues.contains(SnmpInterfaceStatus.statusFromMibValue(iface.getIfOperStatus()))) {
                        sendOperUpEvent(iface);
                        miface.setOperPollStatus(PollStatus.available());
                        miface.setAdminPollStatus(PollStatus.available());
                    }
                                            
                    // if the interface is now admin down but was not previously, send the admin down event
                    if ( m_downValues.contains(miface.getAdminstatus())
                         && !m_downValues.contains(SnmpInterfaceStatus.statusFromMibValue(iface.getIfAdminStatus()))) {
                        sendAdminDownEvent(iface);
                        miface.setAdminPollStatus(PollStatus.unavailable("ifAdminStatus is " + miface.getAdminstatus().getLabel()));
                    }
                    
                    // if the interface is now admin up and was previously in a non-up state
                    // send the admin up event
                    if ( m_upValues.contains(miface.getAdminstatus())
                         && !m_upValues.contains(SnmpInterfaceStatus.statusFromMibValue(iface.getIfAdminStatus()))) {
                        sendAdminUpEvent(iface);
                        miface.setAdminPollStatus(PollStatus.available());
                    }

                    iface.setIfAdminStatus(miface.getAdminstatus().getMibValue());
                    iface.setIfOperStatus(miface.getOperstatus().getMibValue());
                    iface.setLastSnmpPoll(now);

                    // Save Data to Database
                    try {
                        update(iface);
                    } catch (Throwable e) {
                        LOG.warn("Failing updating Interface {} {}", iface.getIfName(), e.getLocalizedMessage());
                        refresh = true;
                    }
                } else {
                    LOG.debug("No {} data available for interface.", getContext().getServiceName());
                } //End if status OK
            } //end while on interface
            
            if (refresh) 
                getParent().getParent().refresh(getParent().getNodeid());
        } else {
            LOG.error("the monitor return null object");
        } //end If not null

    }

