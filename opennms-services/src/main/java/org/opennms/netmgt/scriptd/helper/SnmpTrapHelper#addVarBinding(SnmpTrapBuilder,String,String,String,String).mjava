    /**
     * Create a new variable binding and add it to the specified SNMP V1 trap.
     *
     * @param trap
     *            The trap to which the variable binding should be added.
     * @param name
     *            The name (a.k.a. "id") of the variable binding to be created
     * @param type
     *            The type of variable binding to be created
     * @param encoding
     *            Describes the way in which the value content has been encoded
     *            (i.e. XML_ENCODING_TEXT, or XML_ENCODING_BASE64)
     * @param value
     *            The variable binding value
     * @exception Throws
     *                SnmpTrapHelperException if the variable binding cannot be
     *                added to the trap for any reason.
     * @throws org.opennms.netmgt.scriptd.helper.SnmpTrapHelperException if any.
     */
    public void addVarBinding(SnmpTrapBuilder trap, String name, String type, String encoding, String value) throws SnmpTrapHelperException {

        if (name == null) {
            throw new SnmpTrapHelperException("Name is null");
        }

        VarBindFactory factory = (VarBindFactory) m_factoryMap.get(type);

        if (factory == null) {
            throw new SnmpTrapHelperException("Type " + type + " is invalid or not implemented");
        }

        factory.addVarBind(trap, name, encoding, value);
    }

