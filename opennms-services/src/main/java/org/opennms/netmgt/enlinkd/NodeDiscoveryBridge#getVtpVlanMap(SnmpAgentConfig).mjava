    private Map<Integer, String> getVtpVlanMap(SnmpAgentConfig peer) {

        final Map<Integer, String> vlanmap = new HashMap<Integer, String>();
        final CiscoVtpTracker vtpStatus = new CiscoVtpTracker();
        
        try {
            m_linkd.getLocationAwareSnmpClient().walk(peer, vtpStatus).
            withDescription("vtpVersion").
            withLocation(getLocation()).
            execute().
            get();
       } catch (ExecutionException e) {
           LOG.info("run: node [{}]: ExecutionException: vtpVersion: {}", 
                    getNodeId(), e.getMessage());
           return vlanmap;
       } catch (final InterruptedException e) {
           LOG.info("run: node [{}]: InterruptedException: vtpVersion: {}", 
                    getNodeId(), e.getMessage());
           return vlanmap;
       }

        if (vtpStatus.getVtpVersion() == null) {
            LOG.info("run: node [{}]: cisco vtp mib not supported.", getNodeId());
            return vlanmap;
        }

        LOG.info("run: node [{}]: cisco vtp mib supported.", getNodeId());
        LOG.debug("run: node [{}]: walking cisco vtp.", getNodeId());

        final CiscoVtpVlanTableTracker ciscoVtpVlanTableTracker = new CiscoVtpVlanTableTracker() {
            @Override
            public void processCiscoVtpVlanRow(final CiscoVtpVlanRow row) {
                if (row.isTypeEthernet() && row.isStatusOperational()) {
                    vlanmap.put(row.getVlanIndex(), row.getVlanName());
                }
            }
        };
        try {
            m_linkd.getLocationAwareSnmpClient().walk(peer, ciscoVtpVlanTableTracker).
            withDescription("ciscoVtpVlan").
            withLocation(getLocation()).
            execute().
            get();
        } catch (ExecutionException e) {
            LOG.info("run: node [{}]: ExecutionException: ciscoVtpVlan table: {}", 
                     getNodeId(), e.getMessage());
        } catch (final InterruptedException e) {
            LOG.info("run: node [{}]: InterruptedException: ciscoVtpVlan table: {}", 
                     getNodeId(), e.getMessage());
        }
        return vlanmap;
    }

