	@Transactional
    protected void saveBridgeMacLink(int nodeId, final BridgeMacLink saveMe) {
		new UpsertTemplate<BridgeMacLink, BridgeMacLinkDao>(m_transactionManager,m_bridgeMacLinkDao) {

			@Override
			protected BridgeMacLink query() {
				return m_dao.getByNodeIdBridgePortMac(nodeId,saveMe.getBridgePort(),saveMe.getMacAddress());
			}

			@Override
			protected BridgeMacLink doUpdate(BridgeMacLink link) {
				link.merge(saveMe);
				m_dao.update(link);
				m_dao.flush();
				return link;
			}

			@Override
			protected BridgeMacLink doInsert() {
                            final OnmsNode node = m_nodeDao.get(nodeId);
                            if ( node == null )
                                    return null;
                            saveMe.setNode(node);
                            saveMe.setBridgeMacLinkLastPollTime(saveMe.getBridgeMacLinkCreateTime());
                            m_dao.saveOrUpdate(saveMe);
                            m_dao.flush();
                            return saveMe;
			}
			
		}.execute();
	}

