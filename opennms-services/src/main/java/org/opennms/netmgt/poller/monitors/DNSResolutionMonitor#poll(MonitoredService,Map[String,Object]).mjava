    @Override
    public PollStatus poll(MonitoredService svc, Map<String, Object> parameters) {

        String nodeLabel = svc.getNodeLabel();
        
        String resolutionType = ParameterMap.getKeyedString(parameters, RESOLUTION_TYPE_PARM, RESOLUTION_TYPE_DEFAULT);
        boolean requireV4 = RT_V4.equalsIgnoreCase(resolutionType) || RT_BOTH.equals(resolutionType);
        boolean requireV6 = RT_V6.equalsIgnoreCase(resolutionType) || RT_BOTH.equals(resolutionType);
        

        try {
            long start = System.currentTimeMillis();
            InetAddress[] addrs = resolve(nodeLabel);
            long end = System.currentTimeMillis();

            boolean v4found = false;
            boolean v6found = false;
            for(InetAddress addr : addrs) {
                log().debug("Resolved " + nodeLabel + " to " + addr);
                if (addr instanceof Inet4Address) {
                    v4found = true;
                } else if(addr instanceof Inet6Address) {
                    v6found = true;
                }
            }

            if (!v4found && !v6found) {
                return logDown(Level.INFO, "Unable to resolve " + nodeLabel);
            } 
            if (requireV4 && !v4found) {
                return logDown(Level.INFO, nodeLabel + "count only be resolved to a v6 address");
            }
            if (requireV6 && !v6found) {
                return logDown(Level.INFO, nodeLabel + "count only be resolved to a v4 address");
            }
            return logUp(Level.INFO, (double)(end - start), "Resolved " + nodeLabel + " correctly!");

        } catch (TextParseException e) {
            return logDown(Level.INFO,"Unable to resolve "+nodeLabel+": "+e.getMessage());
        }

    }

