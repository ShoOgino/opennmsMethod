    /** {@inheritDoc} */
    @Override
    public boolean pollerStarting(final int locationMonitorId, final Map<String, String> pollerDetails) {
        final OnmsLocationMonitor mon = m_locMonDao.get(locationMonitorId);
        if (mon == null) {
            return false;
        }
        mon.setStatus(MonitorStatus.STARTED);
        mon.setLastCheckInTime(m_timeKeeper.getCurrentDate());

        Map<String,String> allDetails = new HashMap<String,String>();
        allDetails.putAll(pollerDetails);

        String remoteHost = RemoteHostThreadLocal.INSTANCE.get();
        if (remoteHost != null) {
            allDetails.put("org.opennms.netmgt.poller.remote.remoteHostName", remoteHost);
            try {
                allDetails.put("org.opennms.netmgt.poller.remote.remoteHostAddress", InetAddressUtils.str(InetAddressUtils.getInetAddress(remoteHost)));
            } catch (Throwable e) {
                // In case there is an UnknownHostException
            }
        }

        mon.setDetails(allDetails);
        m_locMonDao.update(mon);

        sendMonitorStartedEvent(mon);

        return true;
    }

