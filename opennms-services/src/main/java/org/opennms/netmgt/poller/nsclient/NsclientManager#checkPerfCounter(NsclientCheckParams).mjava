    /**
     * This method performs a check of a perfmon object as defined by the
     * 'parameter' string. An example of this string would be:
     * \Memory(_Total)\Pool Paged Bytes - the warning and critical members of
     * param will define thresholds used to validate the perfmon object value.
     * 
     * @param param
     *            The param string should contain a perfmon OID, warning and
     *            critical should contain non-zero values.
     * @return the processed <code>NsclientPacket</code>.
     * @throws NsclientException
     *             this method rethrows the exception thrown by
     *             <code>sendCheckRequest</code>
     */
    private NsclientPacket checkPerfCounter(NsclientCheckParams param)
            throws NsclientException {
        NsclientPacket pack = null;

        try {
            // send/receive the request
            pack = sendCheckRequest(m_Password + "&" + CHECK_COUNTER + "&"
                    + prepList(param.getParamString()));
            pack.setResultCode(NsclientPacket.RES_STATE_OK);

            // Check for "ERROR" string.
            if (pack.getResponse().matches(".*ERROR.*")) {
                pack.setResultCode(NsclientPacket.RES_STATE_UNKNOWN);
                return pack;
            }

            // parse out the response.
            float counterValue = Float.parseFloat(pack.getResponse().replace(",", "."));

            // if a warning percent was configured, check it.
            if (param.getWarningPercent() != 0) {
                if (counterValue > (float) param.getWarningPercent()) {
                    pack.setResultCode(NsclientPacket.RES_STATE_WARNING);
                }
            }

            // if a critical percent was configured, check it, overriding
            // warning percent.
            if (param.getCriticalPercent() != 0) {
                if (counterValue > (float) param.getCriticalPercent()) {
                    pack.setResultCode(NsclientPacket.RES_STATE_CRIT);
                }
            }

            return pack;
        } catch (NumberFormatException nfe) {
            throw new NsclientException("Unable to parse numeric value returned from parameter '" + param.getParamString() + "'", nfe);
        } catch (NsclientException e) {
            throw e;
        }
    }

