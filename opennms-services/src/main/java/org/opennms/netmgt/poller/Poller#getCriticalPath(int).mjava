    private String[] getCriticalPath(int nodeId) {
        Category log = ThreadCategory.getInstance(getClass());
        String SQL_DB_RETRIEVE_PATHOUTAGE = "SELECT criticalpathip, criticalpathservicename FROM pathoutage where nodeid=?";
        String[] cpath = new String[2];
	Connection dbc = null;
        try {
            dbc = DataSourceFactory.getInstance().getConnection();
            PreparedStatement stmt = dbc.prepareStatement(SQL_DB_RETRIEVE_PATHOUTAGE);
            stmt.setLong(1, nodeId);
            ResultSet rs = stmt.executeQuery();
            while (rs.next()) {
                cpath[0] = rs.getString(1);
                cpath[1] = rs.getString(2);
            }
            rs.close();
            stmt.close();
        } catch (SQLException sqlE) {
            log.error("getCriticalPath: SQLException " + sqlE);
        } finally {
            try {
                dbc.close();
            } catch (Exception e) {
                log.error("getCriticalPath: Exception on close" + e);
            }
        }

        if (cpath[0] == null || cpath[0].equals("")) {
            cpath[0] = OpennmsServerConfigFactory.getInstance().getDefaultCriticalPathIp();
            cpath[1] = "ICMP";
        }
        if (cpath[1] == null || cpath[1].equals("")) {
            cpath[1] = "ICMP";
        }
        return cpath;
    }

