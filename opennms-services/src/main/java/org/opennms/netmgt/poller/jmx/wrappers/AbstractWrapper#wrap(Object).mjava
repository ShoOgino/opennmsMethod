    /**
     * Helper to wrap an arbitary result in a wrapper if required.
     *
     * @param result the result to wrap
     * @return a wrapper or the result itself
     */
    protected Object wrap(final Object result) {
        if (result instanceof TabularDataSupport) {
            return new TabularDataWrapper(this.connection, (TabularDataSupport) result);
        }

        if (result instanceof CompositeDataSupport) {
            return new CompositeDataWrapper(this.connection, (CompositeDataSupport) result);
        }

        return result;
    }

