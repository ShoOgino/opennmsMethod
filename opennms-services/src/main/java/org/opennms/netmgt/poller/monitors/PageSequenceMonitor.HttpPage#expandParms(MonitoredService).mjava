        private NameValuePair[] expandParms(MonitoredService svc) {
            List<NameValuePair> expandedParms = new ArrayList<NameValuePair>();
            Properties svcProps = getServiceProperties(svc);
            if (svcProps != null && log().isDebugEnabled()) {
                log().debug("I have " + svcProps.size() + " service properties.");
            }
            Properties seqProps = getSequenceProperties();
            if (seqProps != null && log().isDebugEnabled()) {
                log().debug("I have " + seqProps.size() + " sequence properties.");
            }
            for (NameValuePair nvp : m_parms) {
                NameValuePair expanded = new NameValuePair();
                expanded.setName(nvp.getName());
                expanded.setValue(PropertiesUtils.substitute(nvp.getValue(), getServiceProperties(svc), getSequenceProperties()));
                expandedParms.add(expanded);
                if (log().isDebugEnabled() && !nvp.getValue().equals(expanded.getValue()) ) {
                    log().debug("Expanded parm with name '" + nvp.getName() + "' from '" + nvp.getValue() + "' to '" + expanded.getValue() + "'");
                }
            }
            return expandedParms.toArray(new NameValuePair[expandedParms.size()]);
        }

