        private void buildCommand() {
            /*
             * Sorting this map just in case the poller gets changed and the Map
             * is no longer a TreeMap.
             */
            String cmd = "GET " + determineUrl(m_parameters) + " HTTP/1.1\r\n";
            cmd += "Connection: CLOSE \r\n";
            cmd = cmd + "Host: " + determineVirtualHost(m_iface, m_parameters) +"\r\n";
            cmd += "User-Agent: "+determineUserAgent(m_parameters) +"\r\n";
            
            if (determineBasicAuthentication(m_parameters) != null) {
                cmd += "Authorization: Basic "+determineBasicAuthentication(m_parameters) +"\r\n";
            }

            for (Iterator<String> it = m_parameters.keySet().iterator(); it.hasNext();) {
                String parmKey = (String) it.next();
                if (parmKey.matches("header[0-9]+$")) {
                    cmd += determineHttpHeader(m_parameters, parmKey)+"\r\n";
                }
            }
            
            cmd = cmd + "\r\n";
            log().debug("checkStatus: cmd:\n" + cmd);
            m_httpCmd = cmd;
        }

