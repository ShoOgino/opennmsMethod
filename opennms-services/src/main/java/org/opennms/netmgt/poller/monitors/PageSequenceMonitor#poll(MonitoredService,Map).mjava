    @SuppressWarnings("unchecked")
    public PollStatus poll(MonitoredService svc, Map parameterMap) {
        HttpClient client = null;
        
        try {
            PageSequenceMonitorParameters parms = PageSequenceMonitorParameters.get(parameterMap);

            client = parms.createHttpClient();

            long startTime = System.nanoTime();

            parms.getPageSequence().execute(client, svc);

            long endTime = System.nanoTime();
            double responseTime = (endTime - startTime)/1000000.0;
            
            return PollStatus.available(responseTime);
        } catch (PageSequenceMonitorException e) {
            return PollStatus.unavailable(e.getMessage());
        } catch (IllegalArgumentException e) {
            log().error("Invalid parameters to monitor: " + e, e);
            return PollStatus.unavailable("Invalid parameter to monitor: " + e.getMessage() + ".  See log for details.");
        } finally {
            if (client != null) {
                client.getHttpConnectionManager().closeIdleConnections(0);
            }
        }
    }

