    /**
     * This method is used to establish package against IP list mapping, with
     * which, the IP list is selected per package via the configured filter rules
     * from the database.
     */
    public void createPackageIpListMap() {
        for (final org.opennms.netmgt.config.linkd.Package pkg : m_config.getPackageCollection()) {
            //
            // Get a list of IP addresses per package against the filter rules from
            // database and populate the package, IP list map.
            //
            try {
                final List<String> ipList = getIpList(pkg);
                LogUtils.tracef(this, "createPackageIpMap: package %s: ipList size = %d", pkg.getName(), ipList.size());

                if (ipList != null && ipList.size() > 0) {
                    m_pkgIpMap.put(pkg, ipList);
                }
            } catch (final Throwable t) {
                LogUtils.errorf(this, t, "createPackageIpMap: failed to map package: %s to an IP list", pkg.getName());
            }
        }
    }

