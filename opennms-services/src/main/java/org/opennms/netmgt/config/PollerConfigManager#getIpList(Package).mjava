    /** {@inheritDoc} */
    public List<String> getIpList(final Package pkg) {
        getReadLock().lock();
        try {
            final StringBuffer filterRules = new StringBuffer(pkg.getFilter().getContent());
            if (m_verifyServer) {
                filterRules.append(" & (serverName == ");
                filterRules.append('\"');
                filterRules.append(m_localServer);
                filterRules.append('\"');
                filterRules.append(")");
            }
            LogUtils.debugf(this, "createPackageIpMap: package is %s. filter rules are %s", pkg.getName(), filterRules.toString());
            return FilterDaoFactory.getInstance().getIPList(filterRules.toString());
        } finally {
            getReadLock().unlock();
        }
    }

