        @Override
        public Resource getResource(String location) {
        	location = StringUtils.cleanPath(location);

        	// Check if this is a spring classpath:foo style resource
        	// but first make sure if we're on windows that it's not
        	// just a C:\foo path.
        	
        	boolean uriResource = false;
        	if (org.opennms.core.utils.StringUtils.isLocalWindowsPath(location)) {
        		uriResource = false;
        	} else if (location.contains(":")) {
        		// otherwise, something with a : is probably a spring URI resource
        		uriResource = true;
        	}

            if (uriResource) {
                return super.getResource(location);
            } else {
                File file = new File(location);
                if (file.isAbsolute()) {
                    return new FileSystemResource(file);
                } else {
                    try {
                        return getConfigResource().createRelative(location);
                    } catch (IOException e) {
                        throw new ObjectRetrievalFailureException(Resource.class, location, "Resource location has a relative path, however the configResource does not reference a file, so the relative path cannot be resolved.  The location is: " + location, null);
                    }
                }
            }
        }

