    public Set<InetAddress> getAllIpAddresses(ScanLevel level) {
        Set<InetAddress> retval = new TreeSet<InetAddress>();

        Enumeration<?> e = level.enumerateRange();
        while (e.hasMoreElements()) {
            Range ir = (Range) e.nextElement();

            try {
                for (long i = Long.parseLong(ir.getBegin()); i <= Long.parseLong(ir.getEnd()); i++) {
	              retval.add(toInetAddress(i));
                }
	    } catch (NumberFormatException wanker) {
            	ThreadCategory.getInstance(getClass()).warn("Failed to convert address range (" + ir.getBegin() + ", " + ir.getEnd() + ")", wanker);
            } catch (UnknownHostException uhE) {
                ThreadCategory.getInstance(getClass()).warn("Failed to convert address range (" + ir.getBegin() + ", " + ir.getEnd() + ")", uhE);
            }

        }

        e = level.enumerateSpecific();
        while (e.hasMoreElements()) {
            String current = (String) e.nextElement();
            try {
                retval.add(InetAddress.getByName(current));
            } catch (UnknownHostException uhE) {
                ThreadCategory.getInstance().warn("Failed to convert address: " + current, uhE);
            }
        }

        return retval;
    }

