    /**
     * 
     */
    public synchronized void saveCurrent() throws MarshalException, IOException, ValidationException {        
        for (File file : m_eventFiles.keySet()) {
            Events fileEvents = m_eventFiles.get(file);
            StringWriter stringWriter = new StringWriter();
            Marshaller.marshal(fileEvents, stringWriter);
            if (stringWriter.toString() != null) {
                FileWriter fileWriter = new FileWriter(file);
                fileWriter.write(stringWriter.toString());
                fileWriter.flush();
                fileWriter.close();
            }
        }
        
        // Delete the programmatic store if it exists on disk, but isn't in the main store.  This is for cleanliness
        if (m_programmaticStoreFile.exists() && (!m_eventFiles.containsKey(m_programmaticStoreFile))) {
            m_programmaticStoreFile.delete(); 
        }
    }

