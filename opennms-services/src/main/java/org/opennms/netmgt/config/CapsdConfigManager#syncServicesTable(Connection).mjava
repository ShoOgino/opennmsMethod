    public List syncServicesTable(Connection conn) throws SQLException {
        List serviceNames;
        // synchronize configured services list with
        // the database
        //
    
        PreparedStatement insStmt = conn.prepareStatement(SVCTBL_ADD_SQL);
        PreparedStatement nxtStmt = conn.prepareStatement(getNextSvcIdSql());
        PreparedStatement loadStmt = conn.prepareStatement(SVCTBL_LOAD_SQL);
        try {
            // go ahead and load the table first if it
            // can be loaded.
            //
            serviceNames = new ArrayList();
            ResultSet rs = loadStmt.executeQuery();
            while (rs.next()) {
                Integer id = new Integer(rs.getInt(1));
                String name = rs.getString(2);
    
                m_serviceIds.put(id, name);
                m_serviceIds.put(name, id);
                serviceNames.add(name);
            }
            rs.close();
    
            List protocols = getConfiguredProtocols();
    
            // now iterate over the configured protocols
            // and make sure that each is represented in the database.
            //
            Iterator protos = protocols.iterator();
            while (protos.hasNext()) {
                String protocol = (String) protos.next();
                if (!serviceNames.contains(protocol)) {
                    // get the next identifier
                    //
                    int id = -1;
                    rs = nxtStmt.executeQuery();
                    rs.next();
                    id = rs.getInt(1);
                    rs.close();
    
                    insStmt.setInt(1, id);
                    insStmt.setString(2, protocol);
                    insStmt.executeUpdate();
    
                    Integer xid = new Integer(id);
                    m_serviceIds.put(xid, protocol);
                    m_serviceIds.put(protocol, xid);
    
                    serviceNames.add(protocol);
                }
            }
        } finally {
            if (insStmt != null)
                insStmt.close();
            if (nxtStmt != null)
                nxtStmt.close();
            if (loadStmt != null)
                loadStmt.close();
        }
        return serviceNames;
    }

