	public InetAddress getSnmpPrimaryIp(Connection dbConn, int nodeid)
			throws SQLException, UnknownHostException {

		Category log = ThreadCategory.getInstance(getClass());

		/**
		 * Query to select info for specific node
		 */
		String SQL_SELECT_SNMP_NODE = "SELECT ipaddr FROM node "
				+ "LEFT JOIN ipinterface ON node.nodeid = ipinterface.nodeid "
				+ "WHERE node.nodeid = ? AND issnmpprimary = 'P'";

		String ipaddr = null;
		PreparedStatement stmt = dbConn.prepareStatement(SQL_SELECT_SNMP_NODE);
		stmt.setInt(1, nodeid);
		if (log.isDebugEnabled())
			log.debug("getSnmpPrimaryIp: SQL statement = " + stmt.toString());

		ResultSet rs = stmt.executeQuery();

		while (rs.next()) {
			ipaddr = rs.getString("ipaddr");
			if (ipaddr == null)
				return null;
			if (log.isDebugEnabled())
				log.debug("getSnmpPrimaryIp: found node element: nodeid " + nodeid
						+ " ipaddr " + ipaddr);


		}
		rs.close();
		stmt.close();

		return 	InetAddress.getByName(ipaddr);

	}

