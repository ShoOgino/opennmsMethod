    /**
     * Saves the current in-memory configuration to disk and reloads
     * 
     * @throws org.exolab.castor.xml.MarshalException
     *             if any.
     * @throws java.io.IOException
     *             if any.
     * @throws org.exolab.castor.xml.ValidationException
     *             if any.
     */
    public void saveCurrent() throws MarshalException, IOException, ValidationException {
        getWriteLock().lock();

        try {
            // Marshal to a string first, then write the string to the file.
            // This
            // way the original configuration isn't lost if the XML from the
            // marshal is hosed.
            StringWriter stringWriter = new StringWriter();
            Marshaller.marshal(getConfig(), stringWriter);

            String xmlString = stringWriter.toString();
            if (xmlString != null) {
                saveXML(xmlString);
            }

            update();
        } finally {
            getWriteLock().unlock();
        }
    }

