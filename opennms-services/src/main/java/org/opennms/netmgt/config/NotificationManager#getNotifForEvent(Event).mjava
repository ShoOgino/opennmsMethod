    public Notification[] getNotifForEvent(Event event) throws IOException, MarshalException, ValidationException {
        update();
        List<Notification> notifList = new ArrayList<Notification>();
        Notification[] notif = null;
        boolean matchAll = getConfigManager().getNotificationMatch();
        Category log = ThreadCategory.getInstance(getClass());
    
        for (Enumeration e = m_notifications.enumerateNotification(); e.hasMoreElements();) {
            Notification curNotif = (Notification) e.nextElement();
    
            boolean curHasUei = false;
            boolean curHasSeverity = false;

            log.debug("Checking " + event.getUei() + " against " + curNotif.getUei());
 
            if (event.getUei().equals(curNotif.getUei()) || "MATCH-ANY-UEI".equals(curNotif.getUei())) {
               curHasUei = true;
            } else if (curNotif.getUei().charAt(0) == '~') {
               if (event.getUei().matches(curNotif.getUei().substring(1))) {
                       curHasUei = true;
               }
            }

            /**
             * Check if event severity matches pattern in notification
             */
            log.debug("Checking event severity: " + event.getSeverity() + " against notification severity: " + curNotif.getEventSeverity());
            // parameter is optional, return true if not set
            if (curNotif.getEventSeverity() == null) {
               curHasSeverity = true;
            } else if (event.getSeverity().toLowerCase().matches(curNotif.getEventSeverity().toLowerCase())) {
               curHasSeverity = true;
            }
           
            if (curNotif.getStatus().equals("on") && curHasSeverity && (curHasUei || "MATCH-ANY-UEI".equals(curNotif.getUei()) && (nodeInterfaceServiceValid(curNotif, event) || !event.hasNodeid()))) {
                boolean parmsmatched = getConfigManager().matchNotificationParameters(event, curNotif);

                if (!parmsmatched) {
                    log().debug("Event " + event.getUei() + " did not match parameters for notice " + curNotif.getName());
                    continue;
                }
                notifList.add(curNotif);

                log().debug("Event " + event.getUei() + " matched notice " + curNotif.getName());
                
                if (!matchAll)
                    break;
            }
        }
    
        if (!notifList.isEmpty()) {
            notif = (Notification[]) notifList.toArray(new Notification[0]);
        }
        return notif;
    }

