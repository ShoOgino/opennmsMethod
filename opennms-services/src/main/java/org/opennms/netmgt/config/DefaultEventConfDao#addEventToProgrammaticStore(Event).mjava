    /* (non-Javadoc)
     * @see org.opennms.netmgt.config.EventConfDao#addEventToProgrammaticStore(org.opennms.netmgt.xml.eventconf.Event)
     */
    public void addEventToProgrammaticStore(Event event) {
        // Check for, and possibly add the programmatic store to the in-memory structure
        if (!m_eventFiles.containsKey(m_programmaticStoreFile)) {
            // Programmatic store did not already exist.  Add an empty Events object for that file
            m_eventFiles.put(m_programmaticStoreFile, new Events());
        }
        
        // Check for, and possibly add, the programmatic store event-file entry to the in-memory structure of the root config file
        Events root = m_eventFiles.get(m_rootConfigFile);
        String programmaticStorePath = m_programmaticStoreFile.getAbsolutePath();
        if (!root.getEventFileCollection().contains(programmaticStorePath)) {
            root.addEventFile(programmaticStorePath);
        }
        
        Events events = m_eventFiles.get(m_programmaticStoreFile);
        events.addEvent(event);
    }

