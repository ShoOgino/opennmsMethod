    private URI buildUri(final HttpCollectionSet collectionSet) throws URIException {
        return new URI(collectionSet.getUriDef().getUrl().getScheme(),
                collectionSet.getUriDef().getUrl().getUserInfo(),
                determineHost(collectionSet.getAgent().getInetAddress(), collectionSet.getUriDef()),
                collectionSet.getUriDef().getUrl().getPort(),
                collectionSet.getUriDef().getUrl().getPath(),
                collectionSet.getUriDef().getUrl().getQuery(),
                collectionSet.getUriDef().getUrl().getFragment());
    }

