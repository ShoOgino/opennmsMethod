    public static CollectionAgent create(final OnmsIpInterface iface, final TransactionTemplate transTemplate) {
        CollectionAgent agent = new DefaultCollectionAgent(iface, transTemplate);
        
        TransactionProxyFactoryBean bean = new TransactionProxyFactoryBean();
        bean.setTransactionManager(transTemplate.getTransactionManager());
        bean.setTarget(agent);
        
        Properties props = new Properties();
        props.put("*", "PROPAGATION_REQUIRED,readOnly");
        
        bean.setTransactionAttributes(props);
        
        bean.afterPropertiesSet();
        
        return (CollectionAgent) bean.getObject();
    }

