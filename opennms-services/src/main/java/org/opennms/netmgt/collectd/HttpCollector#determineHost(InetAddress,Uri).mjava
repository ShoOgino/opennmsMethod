    //note: trouble deciding here on getHost() vs. getIpAddress() or 
    //getCanonicalHost() even.
    private String determineHost(InetAddress address, Uri uri) {
        if ("${ipaddr}".equals(uri.getUrl().getHost())) {
            return address.getHostName();
        } else {
            return uri.getUrl().getHost();
        }
    }

