    private URI buildUri(InetAddress address, Uri uri) throws URIException {
        //FIXME: need to convert to agent address if = "${ipaddr}"
        return new URI(uri.getUrl().getScheme(),
                uri.getUrl().getUserInfo(),
                determineHost(address, uri),
                uri.getUrl().getPort(),
                uri.getUrl().getPath(),
                uri.getUrl().getQuery(),
                uri.getUrl().getFragment());
    }

