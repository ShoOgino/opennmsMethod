    private void saveUpdatedProperties(File propertiesFile, Properties props) throws FileNotFoundException, IOException {
        if (!propertiesFile.getParentFile().isDirectory()) {
            log().info("Parent directory for properties file '" + propertiesFile.getParentFile().getAbsolutePath() + "' does not exist (or is not a directory).  Creating it.");
            if (!propertiesFile.getParentFile().mkdirs()) {
                log().error("Could not create parent directories for properties file: " + propertiesFile.getAbsolutePath());
                throw new IOException("Could not create parent directories for properties file: " + propertiesFile.getAbsolutePath());
            }
        }
        FileOutputStream fileOutputStream = null;
        try {
            fileOutputStream = new FileOutputStream(propertiesFile);
            props.store(fileOutputStream, null);
        } finally {
            try {
                if (fileOutputStream != null) {
                    fileOutputStream.flush();
                    fileOutputStream.close();
                }
            } catch (IOException e) {
                log().error("performUpdate: Error closing file: " + e, e);
            }
        }
    }

