    /**
     * Builds a list of NodeInfo objects representing each of the nodes in the
     * database capable of being scheduled for rescan.
     * 
     * @throws SQLException
     *             if there is a problem accessing the database.
     */
    private void loadKnownNodes() throws SQLException {
        Connection db = null;

        PreparedStatement nodeStmt = null;
        PreparedStatement ifStmt = null;
        ResultSet rs = null;
        ResultSet rset = null;
        
        final DBUtils d = new DBUtils(getClass());
        try {
            db = DataSourceFactory.getInstance().getConnection();
            d.watch(db);
            // Prepare SQL statements in advance
            //
            nodeStmt = db.prepareStatement(SQL_RETRIEVE_NODES);
            d.watch(nodeStmt);
            ifStmt = db.prepareStatement(SQL_GET_LAST_POLL_TIME);
            d.watch(ifStmt);

            // Retrieve non-deleted nodes from the node table in the database
            //
            rs = nodeStmt.executeQuery();
            d.watch(rs);

            while (rs.next()) {
                // Retrieve an interface from the ipInterface table in
                // the database for its last polled/scanned time

                int nodeId = rs.getInt(1);
                ifStmt.setInt(1, nodeId); // set nodeid
                if (log().isDebugEnabled())
                    log().debug("loadKnownNodes: retrieved nodeid " + nodeId + ", now getting last poll time.");

                final DBUtils dbu = new DBUtils(getClass());
                try {
                    rset = ifStmt.executeQuery();
                    dbu.watch(rs);
                    if (rset.next()) {
                        Timestamp lastPolled = rset.getTimestamp(1);
                        if (lastPolled != null && rset.wasNull() == false) {
                            if (log().isDebugEnabled())
                                log().debug("loadKnownNodes: adding node " + nodeId + " with last poll time " + lastPolled);
                            NodeInfo nodeInfo = new NodeInfo(nodeId, lastPolled, m_interval);
                            m_knownNodes.add(nodeInfo);
                        }
                    } else {
                        if (log().isDebugEnabled())
                            log().debug("Node w/ nodeid " + nodeId + " has no managed interfaces from which to retrieve a last poll time...it will not be scheduled.");
                    }
                } finally {
                    dbu.cleanUp();
                }
            }
        } finally {
            d.cleanUp();
        }

    }

