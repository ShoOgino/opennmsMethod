    private int addSnmpInterfaces(Connection dbc, InetAddress ifaddr,
            int nodeId, IfCollector collector, DbIpInterfaceEntry ipIfEntry)
    throws SQLException {
        boolean addedSnmpInterfaceEntry =
            addIfTableSnmpInterfaces(dbc, ifaddr, nodeId, collector);
        
        int ifIndex = getIfIndexForNewInterface(dbc, ifaddr, collector,
                                                ipIfEntry);
        
        if (ifIndex == CapsdConfig.LAME_SNMP_HOST_IFINDEX
                || !addedSnmpInterfaceEntry) {
            DbSnmpInterfaceEntry snmpEntry =
                DbSnmpInterfaceEntry.create(nodeId, ifIndex);
            snmpEntry.store(dbc);
        }

        LOG.debug("SuspectEventProcessor: setting ifindex for {}/{} to {}", nodeId, ifaddr, ifIndex);
        
        ipIfEntry.setIfIndex(ifIndex);
        ipIfEntry.store(dbc);
        
        return ifIndex;
    }

