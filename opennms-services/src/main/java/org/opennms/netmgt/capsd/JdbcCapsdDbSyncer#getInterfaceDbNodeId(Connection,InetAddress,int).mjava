    /* (non-Javadoc)
     * @see org.opennms.netmgt.capsd.CapsdDbSyncerI#getInterfaceDbNodeId(java.sql.Connection, java.net.InetAddress, int)
     */
    /**
     * <p>getInterfaceDbNodeId</p>
     *
     * @param dbConn a {@link java.sql.Connection} object.
     * @param ifAddress a {@link java.net.InetAddress} object.
     * @param ifIndex a int.
     * @return a int.
     * @throws java.sql.SQLException if any.
     */
    public int getInterfaceDbNodeId(Connection dbConn, InetAddress ifAddress, int ifIndex) throws SQLException {
        if (log().isDebugEnabled()) {
            log().debug("getInterfaceDbNodeId: attempting to lookup interface " + InetAddressUtils.str(ifAddress) + "/ifindex: " + ifIndex + " in the database.");
        }
    
        // Set connection as read-only
        // dbConn.setReadOnly(true);
    
        StringBuffer qs = new StringBuffer(RETRIEVE_IPADDR_NODEID_SQL);
        if (ifIndex != -1) {
            qs.append(" AND ifindex=?");
        }
        
        int nodeid = -1;
    
        final DBUtils d = new DBUtils(getClass());
        try {
            PreparedStatement s = dbConn.prepareStatement(qs.toString());
            d.watch(s);
            s.setString(1, InetAddressUtils.str(ifAddress));
    
            if (ifIndex != -1) {
                s.setInt(2, ifIndex);
            }
    
            ResultSet rs = s.executeQuery();
            d.watch(rs);
            if (rs.next()) {
                nodeid = rs.getInt(1);
            }
        } finally {
            d.cleanUp();
        }
    
        return nodeid;
    }

