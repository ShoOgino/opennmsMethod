    DbSnmpInterfaceEntry[] getSnmpInterfaces(Connection db) throws SQLException {
        PreparedStatement stmt = db.prepareStatement(SQL_LOAD_SNMP_LIST);
        stmt.setInt(1, m_nodeId);

        ResultSet rset = stmt.executeQuery();
        List<DbSnmpInterfaceEntry> l = new ArrayList<DbSnmpInterfaceEntry>();

        while (rset.next()) {
            String saddr = rset.getString(1);
            int ifIndex = rset.getInt(2);
            if (rset.wasNull())
                ifIndex = -1;

            InetAddress addr = null;
            try {
                addr = InetAddress.getByName(saddr);
            } catch (UnknownHostException e) {
                ThreadCategory.getInstance(getClass()).warn("Failed to convert address " + saddr + " to InetAddress for node " + m_nodeId + ", ifIndex " + ifIndex, e);
                continue;
            }

            DbSnmpInterfaceEntry entry = null;
            if (ifIndex != -1) {
                entry = DbSnmpInterfaceEntry.get(db, m_nodeId, ifIndex);

                if (entry != null)
                    l.add(entry);
            }
        }

        rset.close();
        stmt.close();

        DbSnmpInterfaceEntry[] entries = new DbSnmpInterfaceEntry[l.size()];
        return l.toArray(entries);
    }

