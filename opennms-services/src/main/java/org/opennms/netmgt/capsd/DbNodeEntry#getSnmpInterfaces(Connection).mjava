    DbSnmpInterfaceEntry[] getSnmpInterfaces(Connection db) throws SQLException {
        PreparedStatement stmt = null;
        ResultSet rset = null;
        final DBUtils d = new DBUtils(getClass());

        List<DbSnmpInterfaceEntry> l;
        try {
            stmt = db.prepareStatement(SQL_LOAD_SNMP_LIST);
            d.watch(stmt);
            stmt.setInt(1, m_nodeId);

            rset = stmt.executeQuery();
            d.watch(rset);
            l = new ArrayList<DbSnmpInterfaceEntry>();

            while (rset.next()) {
                String saddr = rset.getString(1);
                int ifIndex = rset.getInt(2);
                if (rset.wasNull())
                    ifIndex = -1;

                try {
                    InetAddress.getByName(saddr);
                } catch (UnknownHostException e) {
                    log().warn("Failed to convert address " + saddr + " to InetAddress for node " + m_nodeId + ", ifIndex " + ifIndex, e);
                    continue;
                }

                DbSnmpInterfaceEntry entry = null;
                if (ifIndex != -1) {
                    entry = DbSnmpInterfaceEntry.get(db, m_nodeId, ifIndex);

                    if (entry != null)
                        l.add(entry);
                }
            }
        } finally {
            d.cleanUp();
        }

        DbSnmpInterfaceEntry[] entries = new DbSnmpInterfaceEntry[l.size()];
        return l.toArray(entries);
    }

