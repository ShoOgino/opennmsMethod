    /**
     * Responsible for setting the value of the 'isSnmpPrimary' field of the
     * ipInterface table to 'P' (Primary) for the primary SNMP interface
     * address.
     * 
     * @param dbc
     *            Database connection.
     * @param node
     *            DbNodeEntry object representing the suspect interface's
     *            parent node table entry
     * @param newPrimarySnmpIf
     *            New primary SNMP interface.
     * @param oldPrimarySnmpIf
     *            Old primary SNMP interface.
     * @throws SQLException
     *             if an error occurs updating the ipInterface table
     */
    static void setPrimarySnmpInterface(Connection dbc, DbNodeEntry node, InetAddress newPrimarySnmpIf, InetAddress oldPrimarySnmpIf)
            throws SQLException {
        if (newPrimarySnmpIf == null) {
            if (log().isDebugEnabled())
                log().debug("setPrimarySnmpInterface: newSnmpPrimary is null, nothing to set, returning.");
            return;
        } else {
            if (log().isDebugEnabled())
                log().debug("setPrimarySnmpInterface: newSnmpPrimary = "
                        + newPrimarySnmpIf);
        }

        // Verify that old and new primary interfaces are different
        //
        if (oldPrimarySnmpIf != null
                && oldPrimarySnmpIf.equals(newPrimarySnmpIf)) {
            // Old and new primary interfaces are the same
            if (log().isDebugEnabled())
                log().debug("setPrimarySnmpInterface: Old and new primary interfaces are the same");
        }

        // Set primary SNMP interface 'isSnmpPrimary' field to 'P' for primary
        //
        if (newPrimarySnmpIf != null) {
            if (log().isDebugEnabled())
                log().debug("setPrimarySnmpInterface: Updating primary SNMP interface "
                        + str(newPrimarySnmpIf));

            // Update the appropriate entry in the 'ipInterface' table
            //

            final DBUtils d = new DBUtils(SuspectEventProcessor.class);
            try {
                PreparedStatement stmt = dbc.prepareStatement("UPDATE ipInterface SET isSnmpPrimary='P' WHERE nodeId=? AND ipaddr=? AND isManaged!='D'");
                d.watch(stmt);
                stmt.setInt(1, node.getNodeId());
                stmt.setString(2, str(newPrimarySnmpIf));

                stmt.executeUpdate();
                if (log().isDebugEnabled())
                    log().debug("setPrimarySnmpInterface: Completed update of new primary interface to PRIMARY.");
            } finally {
                d.cleanUp();
            }
        }
    }

