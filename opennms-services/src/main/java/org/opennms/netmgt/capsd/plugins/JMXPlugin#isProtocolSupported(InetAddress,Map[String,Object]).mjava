    public boolean isProtocolSupported(InetAddress address, Map<String, Object> map) {
        
        if (protocolName == null) {
            protocolName = getProtocolName(map);
        }

        ThreadCategory log = ThreadCategory.getInstance(getClass());
        boolean res = false;
        ConnectionWrapper connection = null;
        try {
            
            connection = getMBeanServerConnection(map, address);
            
            Integer result = connection.getMBeanServer().getMBeanCount();
            log.debug("isProtocolSupported? " + getProtocolName() + " " + result + " " + connection);
            if (result != null) {
                res = true;
            }
        } catch (Exception e) {
            log.debug(getProtocolName(map) + " - isProtocolSupported - failed! " + address.getHostAddress());
        } finally {
            if (connection != null) {
                connection.close();
            }
        }
        
        return res;
    }

