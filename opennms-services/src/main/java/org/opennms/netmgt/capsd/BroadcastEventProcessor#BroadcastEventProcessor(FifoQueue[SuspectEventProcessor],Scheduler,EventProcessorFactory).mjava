    /**
     * Constructor
     * @param suspectQ
     *            The queue where new SuspectEventProcessor objects are enqueued
     *            for running..
     * @param scheduler
     *            Rescan scheduler.
     * @param eventProcessorFactory TODO
     * @param capsdDbSyncer capsd database syncer that manages service mappings in the database with the configuration file
     * @param pluginManager plugin manager that is used when doing capabilities scanning
     */
    BroadcastEventProcessor(FifoQueue<SuspectEventProcessor> suspectQ, Scheduler scheduler, EventProcessorFactory eventProcessorFactory) {
        
        m_eventProcessorFactory = eventProcessorFactory;
        

        // Suspect queue
        //
        m_suspectQ = suspectQ;

        // Scheduler
        //
        m_scheduler = scheduler;

        // the local servername
        m_localServer = OpennmsServerConfigFactory.getInstance().getServerName();

        // Subscribe to eventd
        //
        createMessageSelectorAndSubscribe();
    }

