    private org.opennms.netmgt.config.poller.Package getPackageForNewInterface(
            Connection dbc, InetAddress ifaddr, DbIpInterfaceEntry ipIfEntry,
            boolean addrUnmanaged) throws SQLException {
        if (addrUnmanaged) {
            return null;
        }

        Category log = ThreadCategory.getInstance(getClass());
        PollerConfig pollerCfgFactory = PollerConfigFactory.getInstance();

        org.opennms.netmgt.config.poller.Package ipPkg = null;

        /*
         * The newly discoveried IP addr is not in the Package IPList Mapping
         * yet, so rebuild the list.
         */
        pollerCfgFactory.rebuildPackageIpListMap();

        boolean ipToBePolled = false;
        ipPkg = pollerCfgFactory.getFirstPackageMatch(ifaddr.getHostAddress());
        if (ipPkg != null) {
            ipToBePolled = true;
        }

        if (log.isDebugEnabled()) {
            log.debug("addInterfaces: " + ifaddr + " is to be polled = "
                    + ipToBePolled);
        }

        if (!ipToBePolled) {
            // update ismanaged to 'N' in ipinterface
            ipIfEntry.setManagedState(DbIpInterfaceEntry.STATE_NOT_POLLED);
            ipIfEntry.store(dbc);
        }

        return ipPkg;
    }

