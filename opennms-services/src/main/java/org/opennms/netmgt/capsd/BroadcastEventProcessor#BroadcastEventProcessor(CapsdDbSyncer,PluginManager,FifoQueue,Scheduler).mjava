    /**
     * Constructor
     * @param capsdDbSyncer capsd database syncer that manages service mappings in the database with the configuration file
     * @param pluginManager plugin manager that is used when doing capabilities scanning
     * @param suspectQ
     *            The queue where new SuspectEventProcessor objects are enqueued
     *            for running..
     * @param scheduler
     *            Rescan scheduler.
     */
    BroadcastEventProcessor(CapsdDbSyncer capsdDbSyncer, PluginManager pluginManager, FifoQueue suspectQ, Scheduler scheduler) {
        m_capsdDbSyncer = capsdDbSyncer;
        
        m_pluginManager = pluginManager;
        
        // Suspect queue
        //
        m_suspectQ = suspectQ;

        // Scheduler
        //
        m_scheduler = scheduler;

        // the local servername
        m_localServer = OpennmsServerConfigFactory.getInstance().getServerName();

        // Subscribe to eventd
        //
        createMessageSelectorAndSubscribe();
    }

