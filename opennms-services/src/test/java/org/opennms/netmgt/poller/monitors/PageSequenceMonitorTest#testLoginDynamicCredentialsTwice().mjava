    @Test
    public void testLoginDynamicCredentialsTwice() throws Exception {
        m_params.put("page-sequence", "" +
                "<?xml version=\"1.0\"?>" +
                "<page-sequence>\n" + 
                "  <page path=\"/opennms\" port=\"80\" virtual-host=\"demo.opennms.org\" successMatch=\"(?s)User:.*&lt;strong&gt;(.*?)&lt;/strong&gt;.*?Password:.*?&lt;strong&gt;(.*?)&lt;/strong&gt;\">\n" +
                "    <session-variable name=\"username\" match-group=\"1\" />\n" +
                "    <session-variable name=\"password\" match-group=\"2\" />\n" +
                "  </page>\n" +
                "  <page path=\"/opennms/j_acegi_security_check\"  port=\"80\" virtual-host=\"demo.opennms.org\" method=\"POST\" failureMatch=\"(?s)Your log-in attempt failed.*Reason: ([^&lt;]*)\" failureMessage=\"Login Failed: ${1}\" successMatch=\"Log out\">\n" + 
                "    <parameter key=\"j_username\" value=\"${username}\"/>\n" + 
                "    <parameter key=\"j_password\" value=\"${password}\"/>\n" + 
                "  </page>\n" + 
                "  <page path=\"/opennms/event/index.jsp\" port=\"80\" virtual-host=\"demo.opennms.org\" successMatch=\"Event Queries\" />\n" + 
                "  <page path=\"/opennms/j_acegi_logout\" port=\"80\" virtual-host=\"demo.opennms.org\" successMatch=\"logged off\" />\n" + 
                "\n" +
                "  <page path=\"/opennms\" port=\"80\" virtual-host=\"demo.opennms.org\" successMatch=\"(?s).*(.*?) is the world's first (.*?) grade network management platform.*\">\n" +
                "    <session-variable name=\"username\" match-group=\"1\" />\n" +
                "    <session-variable name=\"password\" match-group=\"2\" />\n" +
                "  </page>\n" +
                "  <page path=\"/opennms/j_acegi_security_check\"  port=\"80\" virtual-host=\"demo.opennms.org\" method=\"POST\" successMatch=\"(?s)Your log-in attempt failed.*Reason: ([^&lt;]*)\" failureMessage=\"Login succeeded but should have failed.\" failureMatch=\"Log out\">\n" + 
                "    <parameter key=\"j_username\" value=\"${username}\"/>\n" + 
                "    <parameter key=\"j_password\" value=\"${password}\"/>\n" + 
                "  </page>\n" + 
                "</page-sequence>\n");
        
        
        PollStatus status = m_monitor.poll(getHttpService("demo.opennms.org"), m_params);
        assertTrue("Expected available but was "+status+": reason = "+status.getReason(), status.isAvailable());
    }

