    public void testPoll() throws Exception {
        
        expect(m_settings.getMonitorId()).andReturn(1).atLeastOnce();
        expect(m_backEnd.getPollerConfiguration(1)).andReturn(m_pollerConfiguration);
        
        PollStatus up = PollStatus.available(1234);
        expect(m_pollService.poll(m_pollerConfiguration.getFirstService())).andReturn(up);
        
        m_backEnd.reportResult(1, m_pollerConfiguration.getFirstId(), up);
        
        ServicePollStateChangedEvent e = new ServicePollStateChangedEvent(m_pollerConfiguration.getFirstService(), 0);
        m_polledServiceListener.pollStateChange(eq(e));
        expectLastCall().atLeastOnce();

        replayMocks();
        
        m_frontEnd.afterPropertiesSet();
        
        m_frontEnd.addServicePollStateChangedListener(m_polledServiceListener);
        
        m_frontEnd.pollService(m_pollerConfiguration.getFirstId());
        
        ServicePollState pollState = m_frontEnd.getServicePollState(m_pollerConfiguration.getFirstId());
        
        verifyMocks();

                
    }

