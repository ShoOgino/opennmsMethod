    @Test
    public void testGetNodeServices() {
        List<String[]> services = m_queryManager.getNodeServices(1);
        assertEquals(4, services.size());
        for (String[] findMe : new String[][] {
            new String[] { "192.168.1.1", "ICMP" },
            new String[] { "192.168.1.1", "SMTP" },
            new String[] { "192.168.1.2", "ICMP" },
            new String[] { "192.168.1.2", "SMTP" }
        }) {
            boolean foundIt = false;
            for (String[] service : services) {
                if (service[0].equals(findMe[0]) && service[1].equals(findMe[1])) {
                    foundIt = true;
                    break;
                }
            }

            if (!foundIt) {
                fail("Could not find service: " + findMe[0] + " " + findMe[1]);
            }
        }

        services = m_queryManager.getNodeServices(2);
        assertEquals(2, services.size());
        for (String[] findMe : new String[][] {
            new String[] { "192.168.1.3", "ICMP" },
            new String[] { "192.168.1.3", "HTTP" }
        }) {
            boolean foundIt = false;
            for (String[] service : services) {
                if (service[0].equals(findMe[0]) && service[1].equals(findMe[1])) {
                    foundIt = true;
                    break;
                }
            }

            if (!foundIt) {
                fail("Could not find service: " + findMe[0] + " " + findMe[1]);
            }
        }

        services = m_queryManager.getNodeServices(3);
        assertEquals(4, services.size());
        for (String[] findMe : new String[][] {
            new String[] { "192.168.1.4", "HTTP" },
            new String[] { "192.168.1.4", "SMTP" },
            new String[] { "192.168.1.5", "HTTP" },
            new String[] { "192.168.1.5", "SMTP" }
        }) {
            boolean foundIt = false;
            for (String[] service : services) {
                if (service[0].equals(findMe[0]) && service[1].equals(findMe[1])) {
                    foundIt = true;
                    break;
                }
            }

            if (!foundIt) {
                fail("Could not find service: " + findMe[0] + " " + findMe[1]);
            }
        }
    }

