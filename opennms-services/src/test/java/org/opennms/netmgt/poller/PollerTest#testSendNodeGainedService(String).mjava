	public void testSendNodeGainedService(String svcName) {

		MockNode node = m_network.addNode(99, "TestNode");
		m_db.writeNode(node);
		MockInterface iface = m_network.addInterface(99, "10.1.1.1");
		m_db.writeInterface(iface);
		MockService element = m_network.addService(99, "10.1.1.1", svcName);
		m_db.writeService(element);
		m_pollerConfig.addService(element);
		MockService smtp = m_network.addService(99, "10.1.1.1", "HTTP");
		m_db.writeService(smtp);
		m_pollerConfig.addService(smtp);

		MockVisitor gainSvcSender = new MockVisitorAdapter() {
			public void visitService(MockService svc) {
				Event event = MockUtil
						.createNodeGainedServiceEvent("Test", svc);
				m_eventMgr.sendEventToListeners(event);
			}
		};
		node.visit(gainSvcSender);

		PollAnticipator anticipator = new PollAnticipator();
		element.addAnticipator(anticipator);

		anticipator.anticipateAllServices(element);

		assertEquals(0, anticipator.waitForAnticipated(10000).size());

		anticipateDown(element);

		element.bringDown();

		verifyAnticipated(10000);

	}

