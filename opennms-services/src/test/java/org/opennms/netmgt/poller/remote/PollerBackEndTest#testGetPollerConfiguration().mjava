    public void testGetPollerConfiguration() {
        
        expect(m_locMonDao.get(m_locationMonitor.getId())).andReturn(m_locationMonitor);
        expect(m_locMonDao.findMonitoringLocationDefinition(m_locationDefinition.getName())).andReturn(m_locationDefinition);
        
        expect(m_pollerConfig.getPackage(m_locationDefinition.getPollingPackageName())).andReturn(m_package);
        expect(m_pollerConfig.getServiceSelectorForPackage(m_package)).andReturn(m_serviceSelector);
        expect(m_pollerConfig.getServiceInPackage("HTTP", m_package)).andReturn(m_httpSvcConfig);
        expect(m_pollerConfig.getServiceInPackage("DNS", m_package)).andReturn(m_dnsSvcConfig);
        
        expect(m_monSvcDao.findMatchingServices(m_serviceSelector)).andReturn(Arrays.asList(m_monServices));
        
        replayMocks();
        
        PollerConfiguration config = m_backEnd.getPollerConfiguration(m_locationMonitor.getId());
        
        verifyMocks();
        
        assertNotNull(config);
        assertEquals(m_startTime, config.getConfigurationTimestamp());
        assertEquals(2, config.getConfigurationForPoller().length);
        assertEquals(m_httpService, config.getConfigurationForPoller()[0].getMonitoredService());
        assertEquals(m_dnsService, config.getConfigurationForPoller()[1].getMonitoredService());
        assertEquals(5678, config.getConfigurationForPoller()[1].getPollModel().getPollInterval());
        assertTrue(config.getConfigurationForPoller()[1].getMonitorConfiguration().containsKey("hostname"));
    }

