    public void anticipateAndSend(boolean newSuspectOnTrap, boolean nodeKnown,
                                  String event,
                                  String version, String enterprise,
                                  int generic, int specific, SnmpValue[] varbinds) throws Exception {
        setUpTrapHandler(newSuspectOnTrap);
        
        if (newSuspectOnTrap) {
            // Note: the nodeId will be zero because the node is not known
            anticipateEvent("uei.opennms.org/internal/discovery/newSuspect",
                            m_ip, 0);
        }

        if (event != null) {
            if (nodeKnown) {
                anticipateEvent(event);
            } else {
                /*
                 * If the node is unknown, the nodeId on the trap event
                 * will be zero.
                 */
                anticipateEvent(event, m_ip, 0);
            }
        }
        
        sendTrap(version, enterprise, generic, specific, varbinds);
        
        finishUp();
    }

