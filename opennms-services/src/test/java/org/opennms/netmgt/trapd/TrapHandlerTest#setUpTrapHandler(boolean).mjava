    protected void setUpTrapHandler(boolean newSuspectOnTrap) {
        MockTrapdConfig mockTrapdConfig = new MockTrapdConfig();
        mockTrapdConfig.setSnmpTrapPort(m_port);
        mockTrapdConfig.setNewSuspectOnTrap(newSuspectOnTrap);

        DefaultEventConfDao eventConfDao = new DefaultEventConfDao(ConfigurationTestUtils.getFileForResource(this, "eventconf.xml"));
        eventConfDao.reload();

        m_trapHandler = new TrapHandler();
        m_trapHandler.setTrapdConfig(mockTrapdConfig);
        m_trapHandler.setEventManager(m_eventMgr);
        m_trapHandler.setEventConfDao(eventConfDao);
        m_trapHandler.afterPropertiesSet();
        m_trapHandler.init();
        m_trapHandler.start();
    }

