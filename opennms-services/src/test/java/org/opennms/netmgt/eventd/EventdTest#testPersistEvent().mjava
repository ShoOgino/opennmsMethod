    @Test
    @JUnitTemporaryDatabase
    public void testPersistEvent() throws Exception {
        assertEquals(0, m_database.countRows(String.format("select * from events where eventuei = '%s'", EventConstants.NODE_DOWN_EVENT_UEI)));

        OnmsNode node = m_databasePopulator.getNode1();
        assertNotNull(node);
        sendNodeDownEvent(null, node);
        Thread.sleep(1000);

        assertEquals(1, m_database.countRows(String.format("select * from events where eventuei = '%s'", EventConstants.NODE_DOWN_EVENT_UEI)));

        node = m_databasePopulator.getNode2();
        assertNotNull(node);
        Event generatedEvent = sendNodeDownEvent(null, node);
        Thread.sleep(1000);

        assertEquals(2, m_database.countRows(String.format("select * from events where eventuei = '%s'", EventConstants.NODE_DOWN_EVENT_UEI)));

        assertNull(generatedEvent.getInterfaceAddress());
        assertEquals(2, m_database.countRows(String.format("select * from events where eventuei = '%s' AND ipaddr IS NULL", EventConstants.NODE_DOWN_EVENT_UEI)));
    }

