    public void testSendEventWithService() throws Exception {
        int serviceId = 1;
        String serviceName = "some bogus service";

        m_daemon.onStart();

        getSimpleJdbcTemplate().update("insert into service (serviceId, serviceName) values (?, ?)", new Object[] { serviceId, serviceName });
        setComplete();
        endTransaction();
        startNewTransaction();
        
        EventBuilder builder = new EventBuilder("uei.opennms.org/foo", "someSource");
        builder.setLogMessage("logndisplay");
        builder.setService(serviceName);
        m_eventIpcManager.sendNow(builder.getEvent());
        
        Thread.sleep(1000);
        
        assertEquals("event count", 1, getJdbcTemplate().queryForInt("select count(*) from events"));
        assertEquals("event service ID", serviceId, getJdbcTemplate().queryForInt("select serviceID from events"));

        m_daemon.onStop();
    }

