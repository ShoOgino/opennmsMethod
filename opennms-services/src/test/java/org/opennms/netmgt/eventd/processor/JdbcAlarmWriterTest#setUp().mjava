    @Before
    public void setUp() throws Exception {
        m_mockNetwork.createStandardNetwork();

        m_eventdIpcMgr.setEventWriter(m_database);

        m_alarmd = new Alarmd();
        m_alarmd.setEventForwarder(m_eventdIpcMgr);
        m_alarmd.setEventSubscriptionService(m_eventdIpcMgr);
        AlarmPersisterImpl persister = new AlarmPersisterImpl();
        persister.setAlarmDao(m_alarmDao);
        persister.setEventDao(m_eventDao);
        m_alarmd.setPersister(persister);
        m_alarmd.afterPropertiesSet();
        // Doesn't do anything yet
        m_alarmd.start();
        
        // Insert some empty nodes to avoid foreign-key violations on subsequent events/alarms
        OnmsNode node = new OnmsNode();
        node.setId(1);
        m_nodeDao.save(node);
    }

