    /*
     *
     * CISCO_C870:  FastEthernet2 3  ------> port  2/44 (ifindex 52):CISCO_WS_C2948_IP
     * 
     */
    @Test
    @JUnitSnmpAgents(value={
            @JUnitSnmpAgent(host=CISCO_WS_C2948_IP, port=161, resource=CISCO_WS_C2948_SNMP_RESOURCE),
            @JUnitSnmpAgent(host=CISCO_C870_IP, port=161, resource=CISCO_C870_SNMP_RESOURCE)
    })
    public void testLinkCiscoRouterCiscoWsUsingCdp() throws Exception {
        Package example1 = m_linkdConfig.getPackage("example1");
        example1.setUseLldpDiscovery(false);
        example1.setUseOspfDiscovery(false);
        example1.setUseIpRouteDiscovery(false);
        example1.setUseBridgeDiscovery(false);
        example1.setUseIsisDiscovery(false);
        example1.setUseCdpDiscovery(true);
        
        example1.setSaveRouteTable(false);
        example1.setSaveStpNodeTable(false);
        example1.setSaveStpInterfaceTable(false);
        example1.setEnableVlanDiscovery(false);

    	
    	m_nodeDao.save(builder.getCiscoC870());
        m_nodeDao.save(builder.getCiscoWsC2948());
        m_nodeDao.flush();

        assertEquals(2, m_nodeDao.countAll());
        final OnmsNode ciscorouter = m_nodeDao.findByForeignId("linkd", CISCO_C870_NAME);
        final OnmsNode ciscows = m_nodeDao.findByForeignId("linkd", CISCO_WS_C2948_NAME);

        assertTrue(m_linkd.scheduleNodeCollection(ciscows.getId()));
        assertTrue(m_linkd.scheduleNodeCollection(ciscorouter.getId()));

        assertTrue(m_linkd.runSingleSnmpCollection(ciscows.getId()));
        assertTrue(m_linkd.runSingleSnmpCollection(ciscorouter.getId()));
        
        final Collection<LinkableNode> linkables = m_linkd.getLinkableNodesOnPackage("example1");
        assertEquals(2, linkables.size());
        
        for (LinkableNode lnode: linkables) {
            assertEquals(true, lnode.hasCdpInterfaces());
            assertEquals(1, lnode.getCdpInterfaces().size());
        }
        

        assertEquals(0,m_dataLinkInterfaceDao.countAll());
                                        
        assertEquals(2, m_linkd.getLinkableNodesOnPackage("example1").size());

        assertTrue(m_linkd.runSingleLinkDiscovery("example1"));

        
        final List<DataLinkInterface> links = m_dataLinkInterfaceDao.findAll();
        assertEquals(1,links.size());
        
        final DataLinkInterface link = links.get(0);
        
        printLink(link);
        
        assertEquals(ciscows.getId(), link.getNode().getId());
        assertEquals(52, link.getIfIndex().intValue());
        assertEquals(ciscorouter.getId(), link.getNodeParentId());
        assertEquals(3,link.getParentIfIndex().intValue());
    }

