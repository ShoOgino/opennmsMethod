    /**
     * Refactored from org.opennms.netmgt.capsd.CapsdTest
     */
    @Test
    @JUnitSnmpAgent(host=FOREIGN_NODE_IP_ADDRESS, resource="classpath:org/opennms/netmgt/snmp/snmpTestData1.properties")
    @JUnitTemporaryDatabase(tempDbClass=MockDatabase.class)
    public final void testRescanOfForeignNode() throws Exception {

        m_db.getJdbcTemplate().update("update node set foreignSource='testSource', foreignId='123' where nodeid = ?", FOREIGN_NODEID);

        assertEquals("Initally only 2 interfaces", 2, m_db.countRows("select * from ipinterface where nodeid = ?", FOREIGN_NODEID));

        m_capsd.init();
        m_capsd.start();

        m_capsd.rescanInterfaceParent(FOREIGN_NODEID);

        Thread.sleep(10000);

        m_capsd.stop();

        assertEquals("after scanning should still be 2 since its foreign", 2, m_db.countRows("select * from ipinterface where nodeid = ?", FOREIGN_NODEID));
    }

