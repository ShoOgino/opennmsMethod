    public static void persistCollectionSet(RrdStrategy<?, ?> rrdStrategy, ResourceStorageDao resourceStorageDao,
            CollectionSpecification spec, CollectionSet collectionSet) {
        RrdRepository repository=spec.getRrdRepository("default");
        System.err.println("repository = " + repository);
        ServiceParameters params = spec.getServiceParameters();
        System.err.println("service parameters = " + params);
        BasePersister persister;
        if (Boolean.getBoolean("org.opennms.rrd.storeByGroup")) {
            persister=new GroupPersister(params, repository, rrdStrategy, resourceStorageDao);
        } else {
            persister=new OneToOnePersister(params, repository, rrdStrategy, resourceStorageDao);
        }
        System.err.println("persister = " + persister);
        collectionSet.visit(persister);
    }

