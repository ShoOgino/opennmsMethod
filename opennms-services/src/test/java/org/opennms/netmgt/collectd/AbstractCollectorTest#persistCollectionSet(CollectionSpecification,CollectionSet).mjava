    protected void persistCollectionSet(CollectionSpecification spec, CollectionSet collectionSet) {
        RrdRepository repository=spec.getRrdRepository("default");
        ServiceParameters params=new ServiceParameters(spec.getReadOnlyPropertyMap());
        BasePersister persister;
        if (Boolean.getBoolean("org.opennms.rrd.storeByGroup")) {
            persister= new GroupPersister(params, repository);
        } else {
            persister= new OneToOnePersister(params, repository);
        }
        collectionSet.visit(persister);
    }

