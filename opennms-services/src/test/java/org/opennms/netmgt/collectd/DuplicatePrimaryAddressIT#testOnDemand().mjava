    /**
     * Test on demand.
     * <p>This test assumes that the database is empty. The data collection will be triggered through events.<p>
     *
     * @throws Exception the exception
     */
    @Test
    public void testOnDemand() throws Exception {
        initialize(false);

        EventBuilder nodeGained = new EventBuilder(EventConstants.NODE_GAINED_SERVICE_EVENT_UEI, "Test");
        nodeGained.setInterface(InetAddressUtils.addr("192.168.1.1"));
        nodeGained.setService("SNMP");

        EventBuilder reinitialize = new EventBuilder(EventConstants.REINITIALIZE_PRIMARY_SNMP_INTERFACE_EVENT_UEI, "Test");
        reinitialize.setInterface(InetAddressUtils.addr("192.168.1.1"));

        // Emulate Provisiond events for node1
        nodeGained.setNodeid(1);
        reinitialize.setNodeid(1);
        m_collectd.onEvent(ImmutableMapper.fromMutableEvent(nodeGained.getEvent()));
        m_collectd.onEvent(ImmutableMapper.fromMutableEvent(reinitialize.getEvent()));

        // Emulate Provisiond events for node3
        nodeGained.setNodeid(3);
        reinitialize.setNodeid(3);
        m_collectd.onEvent(ImmutableMapper.fromMutableEvent(nodeGained.getEvent()));
        m_collectd.onEvent(ImmutableMapper.fromMutableEvent(reinitialize.getEvent()));

        verify();
    }

