    public void testOneMatchingSpec() {
        String svcName = "SNMP";
        OnmsIpInterface iface = getInterface();
        List<CollectionSpecification> specs = Collections.singletonList(getCollectionSpecification());

        setupCollector(svcName);
        
        m_collector.initialize(isA(CollectionAgent.class), isA(Map.class));
        expect(m_collector.collect(isA(CollectionAgent.class), isA(EventProxy.class), isAMap(String.class, String.class))).andReturn(ServiceCollector.COLLECTION_SUCCEEDED);
        
        setupInterface(iface);
        setupSpecs(iface, svcName, specs);
        
        setupTransactionManager();
        
        m_easyMockUtils.replayAll();

        m_collectd.init();
        m_collectd.start();
        
        m_scheduler.next();

        assertEquals(1, m_scheduler.getEntryCount());

        m_scheduler.next();

        m_collectd.stop();

        m_easyMockUtils.verifyAll();
    }

