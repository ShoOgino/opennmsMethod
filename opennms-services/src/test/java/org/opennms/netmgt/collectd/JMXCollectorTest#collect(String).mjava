    private CollectionResult collect(String collectionName) {
        jmxNodeInfo.setMBeans(jmxConfigFactory.getMBeanInfo(collectionName));
        jmxNodeInfo.setDsMap(generateDataSourceMap(collectionName, jmxConfigFactory.getAttributeMap(collectionName, "", "")));
        collectionAgent.setAttribute("collectionName", collectionName);

        //start collection
        final CollectionSet collectionSet = jmxCollector.collect(collectionAgent, null, new HashMap<String, Object>());
        final SingleResourceCollectionSet jmxCollectionSet = (SingleResourceCollectionSet) collectionSet;
        final JMXCollectionResource jmxCollectionResource = (JMXCollectionResource)jmxCollectionSet.getCollectionResource();

        assertEquals("Collection: " + collectionName + " failed", 1, collectionSet.getStatus());

        final CollectionResult collectionResult = new CollectionResult(jmxCollectionSet, jmxCollectionResource);
        return collectionResult;
    }

