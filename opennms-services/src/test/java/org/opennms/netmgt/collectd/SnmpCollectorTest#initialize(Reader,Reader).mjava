    public void initialize(Reader snmpConfig, Reader dataCollectionConfig)
            throws MarshalException, ValidationException, IOException {
        RrdConfig.loadProperties(new ByteArrayInputStream(
                                                          s_rrdConfig.getBytes()));

        SnmpPeerFactory.setInstance(new SnmpPeerFactory(snmpConfig));
        DataCollectionConfigFactory.setInstance(new DataCollectionConfigFactory(
                                                                                dataCollectionConfig));

        Reader rdr = ConfigurationTestUtils.getReaderForResource(this,
                                                                 "/org/opennms/netmgt/config/test-database-schema.xml");
        DatabaseSchemaConfigFactory.setInstance(new DatabaseSchemaConfigFactory(
                                                                                rdr));
        rdr.close();

        m_snmpCollector = new SnmpCollector();
        m_snmpCollector.initialize(null); // no properties are passed
    }

