    public static void collectNTimes(RrdStrategy<?, ?> rrdStrategy, FilesystemResourceStorageDao resourceStorageDao,
            CollectionSpecification spec, CollectionAgent agent, int numUpdates) throws InterruptedException, CollectionException {

        for(int i = 0; i < numUpdates; i++) {
            // now do the actual collection
            CollectionSet collectionSet = spec.collect(agent);
            assertEquals("collection status", CollectionStatus.SUCCEEDED, collectionSet.getStatus());

            persistCollectionSet(rrdStrategy, resourceStorageDao, spec, collectionSet);

            System.err.println("COLLECTION "+i+" FINISHED");

            //need a one second time elapse to update the RRD
            Thread.sleep(1010);
        }
    }

