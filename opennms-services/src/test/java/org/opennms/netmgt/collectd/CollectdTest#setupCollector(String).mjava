    @SuppressWarnings("unchecked")
    private void setupCollector(String svcName) throws CollectionInitializationException {
        ServiceCollector svcCollector = m_easyMockUtils.createMock(ServiceCollector.class);
        svcCollector.initialize();
        svcCollector.validateAgent(isA(CollectionAgent.class), isA(Map.class));
        expectLastCall().anyTimes();

        expect(svcCollector.getEffectiveLocation(anyObject())).andReturn(LocationUtils.DEFAULT_LOCATION_NAME).anyTimes();
        expect(svcCollector.getRuntimeAttributes(isA(CollectionAgent.class),isA(Map.class))).andReturn(Collections.emptyMap()).anyTimes();
        expect(svcCollector.collect(isA(CollectionAgent.class),isA(Map.class)))
                .andAnswer(new IAnswer<CollectionSet>() {
                    @Override
                    public CollectionSet answer() throws Throwable {
                        CollectionAgent agent = (CollectionAgent) EasyMock.getCurrentArguments()[0];
                        return new CollectionSetBuilder(agent).build();
                    }
                })
                .anyTimes();
        setupCollector(svcName, svcCollector);
    }

