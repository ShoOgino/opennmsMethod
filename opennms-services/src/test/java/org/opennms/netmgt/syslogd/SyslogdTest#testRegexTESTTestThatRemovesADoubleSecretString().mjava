    public void testRegexTESTTestThatRemovesADoubleSecretString() throws InterruptedException {
    	String localhost = myLocalHost();
    	final String testPDU = "2007-01-01 www.opennms.org foo: 100 out of 666 tests failed for bar";
    	final String testUEI = "uei.opennms.org/tests/syslogd/regexUeiRewriteTest";
    	final String testMsg = ConvertToEvent.HIDDEN_MESSAGE;
    	final String[] testGroups = { "100", "666", "bar" };
    	
        Event e = new Event();
        e.setUei("uei.opennms.org/tests/syslogd/regexUeiRewriteTest");
        e.setSource("syslogd");
        e.setInterface(localhost);
        Logmsg logmsg = new Logmsg();
        logmsg.setDest("logndisplay");
        logmsg.setContent(testMsg);
        e.setLogmsg(logmsg);
        
        Parms eventParms = new Parms();
        Parm eventParm = null;
        Value parmValue = null;
        
        eventParm = new Parm();
        eventParm.setParmName("group1");
        parmValue = new Value();
        parmValue.setContent(testGroups[0]);
        eventParm.setValue(parmValue);
        
        eventParm = new Parm();
        eventParm.setParmName("group2");
        parmValue = new Value();
        parmValue.setContent(testGroups[1]);
        eventParm.setValue(parmValue);
        
        eventParm = new Parm();
        eventParm.setParmName("group3");
        parmValue = new Value();
        parmValue.setContent(testGroups[2]);
        eventParm.setValue(parmValue);
        
        e.setParms(eventParms);

        EventAnticipator ea = new EventAnticipator();
        ea.anticipateEvent(e);
        
        SyslogClient s = null;
        try {
            s = new SyslogClient(null, 10, SyslogClient.LOG_DEBUG);
            s.syslog(SyslogClient.LOG_DEBUG, testPDU);
        } catch (UnknownHostException uhe) {
            //Failures are for weenies
        }

        assertEquals(1, ea.waitForAnticipated(1000).size());
        Thread.sleep(2000);
        assertEquals(0, ea.unanticipatedEvents().size());
        
        assertFalse(ea.getAnticipatedEvents().isEmpty());
        
        Event ne = (Event) ea.getAnticipatedEvents().iterator().next();
        assertEquals(testUEI, ne.getUei());
        assertEquals("syslogd", ne.getSource());
        assertEquals(testMsg, ne.getLogmsg().getContent());      
    }

