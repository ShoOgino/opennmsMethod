    private SnmpCollectionAgent createCollectionAgent() {
        SnmpCollectionAgent agent = EasyMock.createMock(SnmpCollectionAgent.class);
        EasyMock.expect(agent.getNodeId()).andReturn(1).anyTimes();
        EasyMock.expect(agent.getHostAddress()).andReturn("127.0.0.1").anyTimes();
        EasyMock.expect(agent.getSnmpInterfaceInfo((IfResourceType)EasyMock.anyObject())).andReturn(new HashSet<IfInfo>()).anyTimes();
        EasyMock.expect(agent.getForeignSource()).andReturn("JUnit").anyTimes();
        EasyMock.expect(agent.getForeignId()).andReturn("T001").anyTimes();
        EasyMock.expect(agent.getStorageDir()).andReturn(new File(DefaultResourceDao.FOREIGN_SOURCE_DIRECTORY + File.separator + "JUnit" + File.separator + "T001")).anyTimes();
        EasyMock.replay(agent);
        return agent;
    }

