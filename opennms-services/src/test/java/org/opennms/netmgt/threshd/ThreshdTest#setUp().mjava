    protected void setUp() throws Exception {
        super.setUp();
        MockLogAppender.setupLogging();
        
		setupDatabase();
		
        Resource dbConfig = new ClassPathResource("/org/opennms/netmgt/config/test-database-schema.xml");
        InputStreamReader r = new InputStreamReader(dbConfig.getInputStream());
        DatabaseSchemaConfigFactory dscf = new DatabaseSchemaConfigFactory(r);
        r.close();
        DatabaseSchemaConfigFactory.setInstance(dscf);
        
        Properties rrdProperties = new Properties();
        rrdProperties.put("org.opennms.rrd.strategyClass", "org.opennms.netmgt.mock.NullRrdStrategy");
        rrdProperties.put("org.opennms.rrd.usequeue", "false");
        RrdConfig.setProperties(rrdProperties);
        
        EventIpcManagerFactory.setIpcManager(new MockEventIpcManager());
		
        String dirName = "/tmp/192.168.1.1";
        String fileName = "icmp.rrd";
        String ipAddress = "192.168.1.1";
        String serviceName = "ICMP";
        String groupName = "icmp-latency";
		
		setupThresholdConfig(dirName, fileName, ipAddress, serviceName, groupName);
        
		Resource resource = new ClassPathResource("etc/poll-outages.xml");
		InputStreamReader pollOutagesRdr = new InputStreamReader(resource.getInputStream());
        PollOutagesConfigFactory.setInstance(new PollOutagesConfigFactory(pollOutagesRdr));
        pollOutagesRdr.close();
        
    }

