	protected void setupThresholdConfig(String dirName, String fileName, int nodeId, String ipAddress, String serviceName, String groupName) throws IOException, UnknownHostException, FileNotFoundException, MarshalException, ValidationException {
		File dir = new File(dirName);
		File f = createFile(dir, fileName);
		m_fileName = f.getAbsolutePath();
		m_step = 300000;
		m_iface = new ThresholdNetworkInterfaceImpl(nodeId, InetAddress.getByName(ipAddress));
		m_serviceParameters = new HashMap<Object, Object>();
		m_serviceParameters.put("svcName", serviceName);
		m_parameters = new HashMap<Object, Object>();
		m_parameters.put("thresholding-group", groupName);
        m_ipAddress = ipAddress;
        m_serviceName = serviceName;
		
		Resource config = new ClassPathResource("/test-thresholds.xml");
		Reader r = new InputStreamReader(config.getInputStream());
		ThresholdingConfigFactory.setInstance(new ThresholdingConfigFactory(r));
		r.close();
		ThresholdingConfigFactory.getInstance().getGroup(groupName).setRrdRepository(dir.getParentFile().getAbsolutePath());
	}

