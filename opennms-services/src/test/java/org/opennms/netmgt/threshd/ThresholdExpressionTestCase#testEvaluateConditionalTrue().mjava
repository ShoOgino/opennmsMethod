    public void testEvaluateConditionalTrue() throws Exception {
        // Doesn't work because the expression is actually being evaluated to sniff 
        // the variable names and trueval is never visited by the parser
        // expression.setExpression("a < b ? trueval : falseval");
        
        // Force trueval to be visited by the parser
        expression.setExpression("(trueval == trueval && a < b) ? trueval : falseval");
        
        ExpressionConfigWrapper wrapper=new ExpressionConfigWrapper(expression);
        assertEquals(4, wrapper.getRequiredDatasources().size());
        for (String ds : new String[] { "a", "b", "trueval", "falseval" }) {
            assertTrue("Could not find expected variable: " + ds, wrapper.getRequiredDatasources().contains(ds));
        }
        
        Map<String, Double> values=new HashMap<String,Double>();
        values.put("a",2.0);
        values.put("b",5.0);
        values.put("trueval",3.0);
        values.put("falseval",7.0);
        
        double result=wrapper.evaluate(values);
        assertEquals("Conditional Expression result", new Double(result), new Double(3.0));
    }

