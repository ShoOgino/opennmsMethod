    private void addEvent(String uei, String ipaddr, String service, Integer trigger, Double threshold, Double rearm, Double value, String label, String instance, String ds, String ifLabel, String ifIndex) {
        Event e = new Event();
        e.setUei(uei);
        e.setNodeid(1);
        e.setInterface(ipaddr);
        e.setService(service);
        Parms parms = new Parms();

        Parm p = new Parm();
        p.setParmName("label");
        Value v = new Value();
        v.setContent(label);
        p.setValue(v);
        parms.addParm(p);

        if (ifLabel != null) {
            p = new Parm();
            p.setParmName("ifLabel");
            v = new Value();
            v.setContent(ifLabel);
            p.setValue(v);
            parms.addParm(p);            
        }
        
        if (ifIndex != null) {
            p = new Parm();
            p.setParmName("ifIndex");
            v = new Value();
            v.setContent(ifIndex);
            p.setValue(v);
            parms.addParm(p);   
        }
        
        p = new Parm();
        p.setParmName("ds");
        v = new Value();
        v.setContent(ds);
        p.setValue(v);
        parms.addParm(p);
        
        if (value != null) {
            p = new Parm();
            p.setParmName("value");
            v = new Value();
            String pattern = System.getProperty("org.opennms.threshd.value.decimalformat", "###.##"); // See Bug 3427
            DecimalFormat valueFormatter = new DecimalFormat(pattern);
            v.setContent(valueFormatter.format(value));
            p.setValue(v);
            parms.addParm(p);
        }

        p = new Parm();
        p.setParmName("instance");
        v = new Value();
        v.setContent(instance);
        p.setValue(v);
        parms.addParm(p);

        p = new Parm();
        p.setParmName("trigger");
        v = new Value();
        v.setContent(Integer.toString(trigger));
        p.setValue(v);
        parms.addParm(p);

        if (threshold != null) {
            p = new Parm();
            p.setParmName("threshold");
            v = new Value();
            v.setContent(Double.toString(threshold));
            p.setValue(v);
            parms.addParm(p);
        }

        if (rearm != null) {
            p = new Parm();
            p.setParmName("rearm");
            v = new Value();
            v.setContent(Double.toString(rearm));
            p.setValue(v);
            parms.addParm(p);
        }

        e.setParms(parms);
        m_anticipator.anticipateEvent(e, true);
        m_anticipatedEvents.add(e);
    }

