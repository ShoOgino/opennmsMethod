    /**
     * Similar to {@link #testThresholdFiltersOnGenericResource()}, but
     * we generate the collection set using the CollectionSetBuilder instead
     * of using SnmpCollector specific types.
     */
    @Test
    public void testThresholdFiltersOnGenericResourceWithCollectionSetBuilder() throws Exception {
        ThresholdingVisitor visitor = createVisitor();

        String highExpression = "(((hrStorageAllocUnits*hrStorageUsed)/(hrStorageAllocUnits*hrStorageSize))*100)";
        addHighThresholdEvent(1, 30, 25, 50, "/opt", "1", highExpression, null, null);
        addHighThresholdEvent(1, 30, 25, 60, "/opt01", "2", highExpression, null, null);

        runFileSystemDataTestWithCollectionSetBuilder(visitor, 1, "/opt", 50, 100);
        runFileSystemDataTestWithCollectionSetBuilder(visitor, 2, "/opt01", 60, 100);
        runFileSystemDataTestWithCollectionSetBuilder(visitor, 3, "/home", 70, 100);

        verifyEvents(0);
    }

