    /**
     * Test method for {@link org.opennms.netmgt.config.SnmpEventInfo#optimizeAllDefs()}.
     * @throws ValidationException 
     * @throws MarshalException 
     * @throws IOException 
     */
    public final void testOptimizeAllDefs() throws MarshalException, ValidationException, IOException {

        MergeableDefinition def;
        
        Reader rdr = new StringReader(m_SnmpSpec);
        SnmpPeerFactory.setInstance(new SnmpPeerFactory(rdr));
        SnmpConfigManager mgr = new SnmpConfigManager(SnmpPeerFactory.getSnmpConfig());
        
        SnmpEventInfo info = new SnmpEventInfo();
        
        SnmpConfig SnmpConfig = SnmpPeerFactory.getSnmpConfig();
        assertEquals(6, SnmpConfig.getDefinitionCount());
        
        info.setCommunityString("opennmsrules2");
        def = mgr.findDefMatchingAttributes(info.createDef());
        assertNotNull(def);
        assertEquals(9, def.getConfigDef().getRangeCount());
        
        //do bunch more...
        
        mgr.optimizeAllDefs();
//      String config = SnmpPeerFactory.marshallConfig();
//      System.err.println(config);
        
        def = mgr.findDefMatchingAttributes(info.createDef());
        assertNotNull(def);
        assertEquals(2, def.getConfigDef().getRangeCount());
        

    }

