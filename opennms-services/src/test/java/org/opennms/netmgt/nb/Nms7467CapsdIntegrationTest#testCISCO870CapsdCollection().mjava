    @Test
    @JUnitSnmpAgents(value={
            @JUnitSnmpAgent(host=CISCO_C870_IP_PRIMARY, port=161, resource=CISCO_C870_SNMP_RESOURCE)
    })
    @Transactional
    public final void testCISCO870CapsdCollection() throws MarshalException, ValidationException, IOException {
        m_capsd.init();
        m_capsd.start();
        m_capsd.scanSuspectInterface(CISCO_C870_IP_PRIMARY);
        
        OnmsIpInterface ipmain = m_interfaceDao.findByIpAddress(CISCO_C870_IP_PRIMARY).get(0);
        assertTrue("should have a master not null ip interface ",ipmain != null);
        
        Set<OnmsIpInterface> ifs = ipmain.getNode().getIpInterfaces();
        
        assertTrue("Should have 4 ip interface. Found: " + ifs.size(), ifs.size() == 4);
        
        for (OnmsIpInterface ipinterface: ifs) {
            assertTrue("The ifindex should not be null for ipaddress: " +ipinterface.getIpHostName(), ipinterface.getIfIndex() != null);
            assertTrue("The ifindex is not corresponding: found: " + ipinterface.getIfIndex() + " should be: "
                       + CISCO_C870_IP_IF_MAP.get(ipinterface.getIpAddress())
                       , ipinterface.getIfIndex().intValue() == CISCO_C870_IP_IF_MAP.get(ipinterface.getIpAddress()).intValue());
            assertTrue("The snmp interface is null",ipinterface.getSnmpInterface() != null);
            assertTrue("The mac address is null",ipinterface.getSnmpInterface().getPhysAddr() != null);
            assertTrue("The mac address is not corresponding"
                   ,ipinterface.getSnmpInterface().getPhysAddr().equals(CISCO_C870_IF_MAC_MAP.get(ipinterface.getIfIndex())));
        }

        assertTrue("Has 16 snmp interface", ipmain.getNode().getSnmpInterfaces().size() == 16);
        
        m_capsd.stop();

        
    }

