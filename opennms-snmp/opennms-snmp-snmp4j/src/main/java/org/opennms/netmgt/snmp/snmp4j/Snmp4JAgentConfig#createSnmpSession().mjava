    public Snmp createSnmpSession() throws IOException {
        TransportMapping transport = new DefaultUdpTransportMapping();
        Snmp session = new Snmp(transport);
        
        if (isSnmpV3()) {
            session.getUSM().addUser(getSecurityName(),
                    new UsmUser(getSecurityName(),
                            getAuthProtocol(),
                            getAuthPassPhrase(),
                            getPrivProtocol(),
                            getPrivPassPhrase()));
        }
        
        return session;
    }

