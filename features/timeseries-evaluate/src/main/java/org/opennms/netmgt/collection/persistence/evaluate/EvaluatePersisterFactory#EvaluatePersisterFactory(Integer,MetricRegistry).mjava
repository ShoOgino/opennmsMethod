    /**
     * Instantiates a new evaluate persister factory.
     *
     * @param dumpFreq the dump frequency
     * @param registry the metric registry
     */
    @Inject
    public EvaluatePersisterFactory(@Named("evaluate.dump_stats_frequency") Integer dumpFreq, MetricRegistry registry) {
        Preconditions.checkArgument(dumpFreq > 0, "dumpFreq must be positive");
        Preconditions.checkNotNull(registry, "metric registry");

        stats = new EvaluateStats(registry);

        Logging.withPrefix(LOGGING_PREFFIX, () -> {
            final Slf4jReporter reporter = Slf4jReporter.forRegistry(registry)
                    .outputTo(LoggerFactory.getLogger(LOGGING_PREFFIX))
                    .convertRatesTo(TimeUnit.SECONDS)
                    .convertDurationsTo(TimeUnit.MILLISECONDS)
                    .build();
            reporter.start(dumpFreq, TimeUnit.MINUTES);
        });
    }

