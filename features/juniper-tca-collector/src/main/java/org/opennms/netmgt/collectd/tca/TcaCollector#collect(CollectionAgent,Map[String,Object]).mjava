	@Override
	public CollectionSet collect(CollectionAgent agent, Map<String, Object> parameters) throws CollectionException {
		try {
			String collectionName = ParameterMap.getKeyedString(parameters, "collection", null);
			if (collectionName == null) {
				collectionName = ParameterMap.getKeyedString(parameters, "tca-collection", null);
			}
			if (collectionName == null) {
				throw new CollectionException("Parameter collection is required for the TCA Collector!");
			}
			TcaCollectionHandler collectionHandler = new TcaCollectionHandler((SnmpCollectionAgent)agent, getRrdRepository(collectionName),
			        m_resourceStorageDao, m_resourceTypesDao, m_locationAwareSnmpClient);
			return collectionHandler.collect();
		} catch (CollectionException e) {
			throw e;
		} catch (Throwable t) {
			LOG.error("Unexpected error during node TCA collection for: {}", agent.getHostAddress(), t);
			throw new CollectionException("Unexpected error during node TCA collection for: " + agent.getHostAddress() + ": " + t, t);
		}
	}

