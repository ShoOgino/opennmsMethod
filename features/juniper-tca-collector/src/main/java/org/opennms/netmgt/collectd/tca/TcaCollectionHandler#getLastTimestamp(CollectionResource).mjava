	/**
	 * Gets the last timestamp.
	 *
	 * @param resource the TCA resource
	 * @return the last timestamp
	 */
	private long getLastTimestamp(CollectionResource resource) {
		long timestamp = 0;
		ResourcePath path = ResourceTypeUtils.getResourcePathWithRepository(m_repository, resource.getPath());
		try {
			LOG.debug("Retrieving timestamp from path {}", path);
			String ts = m_resourceStorageDao.getStringAttribute(path, LAST_TIMESTAMP);
			if (ts != null) {
				timestamp = Long.parseLong(ts);
			}
		} catch (Exception e) {
			LOG.error("Failed to retrieve timestamp from path {}", path, e);
		}
		return timestamp;
	}

