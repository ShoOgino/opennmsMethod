    @Override
    public List<String> getTags(String prefix) throws FeedbackException {
        String query = "{\n" + 
                "  \"size\": 0,\n" + 
                "  \"aggs\": {\n" + 
                "    \"terms\": {\n" + 
                "      \"terms\": {\n" + 
                "        \"field\": \"tags\",\n" + 
                "        \"include\": \"" + gson.toJson(prefix) + ".*\"\n" + 
                "      }\n" + 
                "    }\n" + 
                "  }\n" + 
                "}";

        Search.Builder builder = new Search.Builder(query);
        Search search = builder.build();
        SearchResult result;
        try {
            result = client.execute(search);
        } catch (IOException e) {
            throw new FeedbackException("Failed to execute Tags search", e);
        }
        if (result == null) {
            return Collections.emptyList();
        }
        final MetricAggregation aggregations = result.getAggregations();
        if (aggregations == null) {
            return Collections.emptyList();
        }
        final TermsAggregation terms = aggregations.getTermsAggregation("terms");
        if (terms == null) {
            return Collections.emptyList();
        }
        return terms.getBuckets().stream().map(TermsAggregation.Entry::getKey).collect(Collectors.toList());
    }

