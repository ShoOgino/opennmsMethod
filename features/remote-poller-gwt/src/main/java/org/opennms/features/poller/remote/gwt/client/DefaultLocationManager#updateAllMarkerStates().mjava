    private void updateAllMarkerStates() {
        for (final LocationInfo location : m_locations.values()) {
            final GWTMarkerState markerState = location.getMarkerState();

            // if it's within the map bounds, it's visible
            markerState.setVisible(location.isVisible(m_mapPanel.getBounds()));
            // markerState.setVisible(true);
            if (markerState.isVisible()) {
                // unless it's not in the list of selected statuses
                markerState.setVisible(m_selectedStatuses.contains(location.getStatusDetails().getStatus()));
            }

            boolean selected = false;
            if (m_locationViewActive || m_selectedApplications.size() == 0) {
                selected = true;
            } else {
                for (final ApplicationInfo app : m_selectedApplications) {
                    if (app.getLocations().contains(location.getName())) {
                        selected = true;
                        break;
                    }
                }
            }
            if (selected) {
                if (m_selectedTag != null) {
                    selected = location.getTags() != null && location.getTags().contains(m_selectedTag);
                }
            }
            markerState.setSelected(selected);
            m_mapPanel.placeMarker(markerState);
        }
    }

