    @Override
    public void update(OnmsTopologyUpdater updater,
            OnmsTopologyMessage message) throws OnmsTopologyException {
        final OnmsTopologyProtocol protocol = updater.getProtocol();
        if (!m_updatersMap.containsKey(protocol)) {
            throw new OnmsTopologyException(String.format("cannot update message with id: %s. Protocol not supported",
                                                          message.getMessagebody().getId()),
                                            protocol,
                                            message.getMessagestatus());
        }
        if (m_updatersMap.get(protocol) != updater) {
            throw new OnmsTopologyException(String.format("cannot update message with id: %s. Updater not registered",
                                                          message.getMessagebody().getId()),
                                            protocol,
                                            message.getMessagestatus());
        }
        synchronized (m_consumers) {
            m_consumers
                .stream()
                .filter(consumer ->  consumer.getProtocols().contains(protocol))
                .forEach(consumer -> consumer.consume(message));            
        }
    }

