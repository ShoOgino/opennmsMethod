    @Override
    public Response listPersistedReports(UriInfo uriInfo) {
        final QueryParameters queryParameters = QueryParametersBuilder.buildFrom(uriInfo);
        final List<ReportCatalogEntry> persistedReports = reportStoreService.getPage(queryParameters.getOffset(), queryParameters.getLimit());
        if (persistedReports.isEmpty()) {
            return Response.noContent().build();
        }
        final Map<String, Object> formatMap = reportStoreService.getFormatMap();
        final JSONArray jsonArray = new JSONArray();
        for (ReportCatalogEntry eachEntry : persistedReports) {
            final JSONObject jsonObject = new JSONObject(eachEntry);
            final List<ReportFormat> formats = (List<ReportFormat>)formatMap.get(eachEntry.getReportId());
            if (formats != null && !formats.isEmpty()) {
                jsonObject.put("formats", new JSONArray(formats));
            } else {
                // Special Reportd behaviour:
                // Reportd persists the reports as PDF/CSV and therefore formats is empty.
                // In that case the format is the format of the file

                final String format = eachEntry.getLocation().substring(eachEntry.getLocation().lastIndexOf(".") + 1);
                final JSONArray formatsArray = new JSONArray();
                formatsArray.put(format.toUpperCase());
                jsonObject.put("formats", formatsArray);
            }
            jsonArray.put(jsonObject);
        }
        return Response.ok()
                .header("Content-Range", ResponseUtils.getContentRange(jsonArray.length(), queryParameters.getOffset(), reportStoreService.countAll()))
                .entity(jsonArray.toString())
                .type(MediaType.APPLICATION_JSON_TYPE)
                .build();
    }

