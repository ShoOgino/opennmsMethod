    private DeliveryOptions parseDeliveryOptions(Map<String, Object> parameters) {
        final DeliveryOptions options = new DeliveryOptions();
        final JSONObject jsonParameters = new JSONObject(parameters);
        final JSONObject jsonOptions = jsonParameters.getJSONObject("deliveryOptions");
        options.setInstanceId(jsonOptions.getString("instanceId"));
        options.setSendMail(jsonOptions.getBoolean("sendMail"));
        if (options.isSendMail() && jsonOptions.has("mailTo")) {
            options.setMailTo(jsonOptions.getString("mailTo"));
        }
        if (jsonOptions.has("webhook")) {
            options.setWebhook(jsonOptions.getBoolean("webhook"));
        }
        if (options.isWebhook() && jsonOptions.has("webhookUrl")) {
            options.setWebhookUrl(jsonOptions.getString("webhookUrl"));
        }
        options.setPersist(jsonOptions.getBoolean("persist"));
        options.setFormat(parseReportFormat(jsonOptions.getString("format")));
        return options;
    }

