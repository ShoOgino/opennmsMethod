    /**
     * Generate PDF from castor classes.
     *
     * @param xsltFileName a {@link java.lang.String} object.
     * @param out a {@link java.io.OutputStream} object.
     * @param format a {@link java.lang.String} object.
     * @throws java.lang.Exception if any.
     */
    public void generatePDF(String xsltFileName, OutputStream out,
            String format) throws Exception {
        MDC.put("prefix", LOG4J_CATEGORY);
        LOG.debug("inside generatePDF");
        File file = new File(ConfigFileConstants.getHome()
                + "/share/reports/AvailReport.xml");
        try {
            LOG.debug("The xml marshalled from the castor classes is saved in {}/share/reports/AvailReport.xml", ConfigFileConstants.getHome());
            Reader fileReader = new InputStreamReader(new FileInputStream(file), "UTF-8");
            if (!format.equals("HTML")) {
                new PDFReportRenderer().render(fileReader, out, new InputStreamReader(new FileInputStream(xsltFileName), "UTF-8"));
            } else {
                new HTMLReportRenderer().render(fileReader, out, new InputStreamReader(new FileInputStream(xsltFileName), "UTF-8"));
            }
        } catch (Throwable e) {
            LOG.error("Exception", e);
        }
        LOG.info("leaving generatePDF");
        MDC.remove("prefix");
    }

