    /** {@inheritDoc} */
    public void render(String ReportId, String location, ReportFormat format, OutputStream outputStream) throws ReportException {
        try {
            
            JasperPrint jasperPrint = getJasperPrint(location);
            
            switch (format) {
            case PDF:
                log.debug("rendering as PDF");
                exportReportToPdf(jasperPrint, outputStream);
                break;
                
            case CSV:
                log.debug("rendering as CSV");
                exportReportToCsv(jasperPrint, outputStream);
                break;
                
            default:
                log.debug("rendering as PDF as no valid format found");
                exportReportToPdf(jasperPrint, outputStream);
            }
        } catch (JRException e) {
            log.error("unable to render report", e);
            throw new ReportException("unable to render report", e);
        }

    }

