    /**
     * {@inheritDoc}
     */
    @Override
    public void render(String ReportId, String location, ReportFormat format,
                       OutputStream outputStream) throws ReportException {
        try {

            JasperPrint jasperPrint = getJasperPrint(location);

            switch (format) {
                case PDF:
                    LOG.debug("rendering as PDF");
                    exportReportToPdf(jasperPrint, outputStream);
                    break;

                case CSV:
                    LOG.debug("rendering as CSV");
                    exportReportToCsv(jasperPrint, outputStream);
                    break;

                default:
                    LOG.debug("rendering as PDF as no valid format found");
                    exportReportToPdf(jasperPrint, outputStream);
            }
        } catch (JRException e) {
            LOG.error("unable to render report", e);
            throw new ReportException("unable to render report", e);
        }
    }

