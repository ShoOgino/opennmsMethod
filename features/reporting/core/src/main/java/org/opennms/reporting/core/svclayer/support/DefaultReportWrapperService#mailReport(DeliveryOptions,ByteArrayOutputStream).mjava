    private void mailReport(DeliveryOptions deliveryOptions,
            ByteArrayOutputStream outputStream) {
        try {
            JavaMailer jm = new JavaMailer();
            jm.setTo(deliveryOptions.getMailTo());
            jm.setSubject("OpenNMS Report");
            jm.setMessageText("Here is your report from the OpenNMS report service.");
            jm.setInputStream(new ByteArrayInputStream(outputStream.toByteArray()));
            switch (deliveryOptions.getFormat()) {

                case HTML:
                    jm.setInputStreamName("report.htm");
                    jm.setInputStreamContentType("text/html");
                    break;
                case PDF:
                    jm.setInputStreamName("report.pdf");
                    jm.setInputStreamContentType("application/pdf");
                    break;
                case SVG:
                    jm.setInputStreamName("svgreport.pdf");
                    jm.setInputStreamContentType("application/pdf");
                    break;
                default:
                    jm.setInputStreamName("report.htm");
                    jm.setInputStreamContentType("text/html");
                
            }
            jm.mailSend();
        } catch (JavaMailerException e) {
            log.error("Caught JavaMailer exception sending report", e);
        }
    }

