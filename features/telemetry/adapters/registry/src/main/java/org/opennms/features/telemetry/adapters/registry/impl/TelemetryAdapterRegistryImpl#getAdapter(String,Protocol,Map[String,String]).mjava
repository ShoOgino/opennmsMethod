    @Override
    public Adapter getAdapter(String className, Protocol protocol, Map<String, String> properties) {
        final AdapterFactoryRegistration registration = delegate.lookup(className, null);
        if (registration != null) {
            final Adapter adapter = registration.getAdapterFactory().createAdapter(protocol, properties);
            if (registration.shouldAutowire()) {
                // Autowire!
                final AutowireCapableBeanFactory beanFactory = applicationContext.getAutowireCapableBeanFactory();
                beanFactory.autowireBean(adapter);
                beanFactory.initializeBean(adapter, "adapter");
            }
            return adapter;
        }

        return null;
    }

