    @Test
    public void canReadJuniperMX80Netflow5() {
        execute("/flows/netflow5_test_juniper_mx80.dat", flowPacket -> {
            assertThat(flowPacket.isValid(), is(true));

            // Verify Flow Header
            assertThat(flowPacket.getVersion(), is((NetflowPacket.VERSION)));
            assertThat(flowPacket.getCount(), is(29));
            assertThat(flowPacket.getRecords(), hasSize(29));
            assertThat(flowPacket.getSysUptime(), is(190649064L)); // Hex: 0x0B5D12E8
            assertThat(flowPacket.getUnixSecs(), is(1469109172L)); // Hex: 0x5790D3B4
            assertThat(flowPacket.getUnixNSecs(), is(00000000L)); // Hex: 0x00000000
            assertThat(flowPacket.getFlowSequence(), is(528678L));
            assertThat(flowPacket.getEngineId(), is(0));
            assertThat(flowPacket.getEngineType(), is(0));
            assertThat(flowPacket.getSamplingInterval(), is(1000));
            assertThat(flowPacket.getSamplingAlgorithm(), is(0));

            // Verify Last Flow Record
            assertThat(flowPacket.getRecord(28).getSrcAddr(), is("66.249.92.75"));
            assertThat(flowPacket.getRecord(28).getDstAddr(), is("192.168.0.1"));
            assertThat(flowPacket.getRecord(28).getNextHop(), is("192.168.0.1"));
            assertThat(flowPacket.getRecord(28).getSrcPort(), is(37387));
            assertThat(flowPacket.getRecord(28).getDstPort(), is(80));
            assertThat(flowPacket.getRecord(28).getSrcAs(), is(15169));
            assertThat(flowPacket.getRecord(28).getDstAs(), is(64496));
            assertThat(flowPacket.getRecord(28).getToS(), is(0));
            assertThat(flowPacket.getRecord(28).getInput(), is(542));
            assertThat(flowPacket.getRecord(28).getOutput(), is(536));
            assertThat(flowPacket.getRecord(28).getDPkts(), is(2L));
            assertThat(flowPacket.getRecord(28).getDOctets(), is(104L));
            assertThat(flowPacket.getRecord(28).getFirst(), is(190631000L)); // Hex: 0x0B5CCC58
            assertThat(flowPacket.getRecord(28).getLast(), is(190631000L)); // Hex: 0x0B5CCC58
            assertThat(flowPacket.getRecord(28).getTcpFlags(), is(16));
            assertThat(flowPacket.getRecord(28).getProt(), is(6));
            assertThat(flowPacket.getRecord(28).getSrcAs(), is(15169));
            assertThat(flowPacket.getRecord(28).getDstAs(), is(64496));
            assertThat(flowPacket.getRecord(28).getSrcMask(), is(19));
            assertThat(flowPacket.getRecord(28).getDstMask(), is(24));
            assertThat(flowPacket.getRecord(28).isEgress(), is(false));
        });
    }

