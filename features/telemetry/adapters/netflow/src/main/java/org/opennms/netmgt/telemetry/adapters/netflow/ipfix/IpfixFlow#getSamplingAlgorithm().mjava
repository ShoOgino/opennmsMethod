    @Override
    public FlowSelectorAlgorithm getSamplingAlgorithm() {
        final Integer deprecatedSamplingAlgorithm = first(
                getInt64(this.document,  "samplingAlgorithm"),
                getInt64(this.document,  "samplerMode"))
                .map(Long::intValue).orElse(null);

        if (deprecatedSamplingAlgorithm == 1) {
            return FlowSelectorAlgorithm.SystematicCountBasedSampling;
        }

        if (deprecatedSamplingAlgorithm == 2) {
            return FlowSelectorAlgorithm.RandomNoutOfNSampling;
        }

        final Integer selectorAlgorithm = getInt64(this.document,  "selectorAlgorithm").map(Long::intValue).orElse(null);

        if (selectorAlgorithm != null) {
            return FlowSelectorAlgorithm.fromId(selectorAlgorithm);
        }

        return FlowSelectorAlgorithm.Unassigned;
    }

