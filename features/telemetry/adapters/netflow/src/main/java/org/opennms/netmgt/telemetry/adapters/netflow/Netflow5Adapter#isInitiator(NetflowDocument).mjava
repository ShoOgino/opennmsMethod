    // Determine if the provided flow is the initiator.
    // Yes, this may not be 100% accurate, but is a very easy way of defining the direction of the flow in most cases.
    protected static boolean isInitiator(NetflowDocument document) {
        if (document.getSourcePort()  > document.getDestPort()) {
            return true;
        } else if (document.getSourcePort() == document.getDestPort()) {
            // Tie breaker
            final BigInteger sourceAddressAsInt = InetAddressUtils.toInteger(InetAddressUtils.addr(document.getIpv4SourceAddress()));
            final BigInteger destAddressAsInt = InetAddressUtils.toInteger(InetAddressUtils.addr(document.getIpv4DestAddress()));
            return sourceAddressAsInt.compareTo(destAddressAsInt) > 0;
        }
        return false;
    }

