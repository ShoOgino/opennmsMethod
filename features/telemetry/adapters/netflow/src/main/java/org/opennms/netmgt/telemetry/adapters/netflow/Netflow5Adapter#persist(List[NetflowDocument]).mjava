    private void persist(List<NetflowDocument> documents) throws Exception {
        if (documents.isEmpty()) {
            LOG.debug("Nothing to persist");
            return;
        }

        try {
            flowRepository.save(documents);
        } catch (PersistenceException ex) {
            LOG.error("Not all flows have been persisted: {}", ex.getMessage());
            ex.getFailedItems().forEach(failedItem -> {
                LOG.error("Flow {} could not be persisted. Reason: {}", failedItem.getItem(), failedItem.getCause().getMessage(), failedItem.getCause());
            });
        }
    }

