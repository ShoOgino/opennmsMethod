    private NetflowPacket parseMessage(TelemetryMessageDTO messageDTO) {
        // Create NetflowPacket which delegates all calls to the byte array
        try {
            final NetflowPacket flowPacket = new NetflowPacket(messageDTO.getBytes());
            if (flowPacket.getVersion() != NetflowPacket.VERSION) {
                LOG.warn("Invalid Version. Expected {}, received {}. Skipping flow packet.", NetflowPacket.VERSION, flowPacket.getVersion());
            } else if (flowPacket.getCount() == 0) {
                LOG.warn("Received packet has no content. Skipping flow packet.");
            } else if (!flowPacket.isValid()) {
                // TODO MVR an invalid packet is skipped for now, but we may want to persist it anyways
                LOG.warn("Received packet is not valid. Skipping flow packet.");
            } else {
                return flowPacket;
            }
        } catch (Throwable e) {
            LOG.error("Received packet cannot be read.", e);
        }
        return null;
    }

