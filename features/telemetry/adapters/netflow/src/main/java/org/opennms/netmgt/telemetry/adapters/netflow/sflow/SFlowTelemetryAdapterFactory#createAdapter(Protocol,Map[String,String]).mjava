    @Override
    public Adapter createAdapter(Protocol protocol, Map<String, String> properties) {
        // TODO MVR this is extending AbstractPersistingAdapter, but not setting all fields, so it runs inside osgi.
        // This may not be an ideal use-case
        final SFlowTelemetryAdapter adapter = new SFlowTelemetryAdapter();
        adapter.setProtocol(protocol);
        adapter.setInterfaceToNodeCache(getInterfaceToNodeCache());
        adapter.setNodeDao(getNodeDao());
        adapter.setFilterDao(getFilterDao());
        adapter.setBundleContext(getBundleContext());

        final BeanWrapper wrapper = PropertyAccessorFactory.forBeanPropertyAccess(adapter);
        wrapper.setPropertyValues(properties);

        return adapter;
    }

