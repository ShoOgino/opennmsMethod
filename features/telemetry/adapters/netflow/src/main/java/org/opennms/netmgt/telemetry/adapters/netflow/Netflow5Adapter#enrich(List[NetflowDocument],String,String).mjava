    protected void enrich(final List<NetflowDocument> documents, final String location, final String sourceAddress) {
        if (documents.isEmpty()) {
            LOG.debug("Nothing to enrich.");
            return;
        }

        transactionOperations.execute(callback -> {
            documents.stream().forEach(document -> {
                // Metadata from message
                document.setExporterAddress(sourceAddress);
                document.setLocation(location);
                document.setInitiator(isInitiator(document));

                // Node data
                getNodeInfoFromCache(location, sourceAddress).ifPresent(node -> document.setExporterNodeInfo(node));
                getNodeInfoFromCache(location, document.getIpv4DestAddress()).ifPresent(node -> document.setDestNodeInfo(node));
                getNodeInfoFromCache(location, document.getIpv4SourceAddress()).ifPresent(node -> document.setSourceNodeInfo(node));

                // Apply Application mapping
                document.setApplication(classificationEngine.classify(document));
            });
            return null;
        });
    }

