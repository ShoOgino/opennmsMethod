    @Override
    public Long getLastSwitched() {
        // TODO: What about flowDuration* ?
        return first(
                first(getTime(this.document, "flowEndSeconds"),
                      getTime(this.document, "flowEndMilliseconds"),
                      getTime(this.document, "flowEndMicroseconds"),
                      getTime(this.document, "flowEndNanoseconds")
                ).map(Instant::toEpochMilli),
                getInt64(this.document, "flowEndDeltaMicroseconds").map(t -> this.getTimestamp() + t),
                getInt64(this.document, "flowEndSysUpTime").flatMap(t ->
                        getTime(this.document, "systemInitTimeMilliseconds").map(ts -> ts.toEpochMilli() + t)
                )
        ).orElse(null);
    }

