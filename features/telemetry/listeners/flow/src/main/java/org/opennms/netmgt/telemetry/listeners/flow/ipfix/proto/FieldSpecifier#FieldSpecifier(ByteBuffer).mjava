    public FieldSpecifier(final ByteBuffer buffer) throws InvalidPacketException {
        final int elementId = BufferUtils.uint16(buffer);

        this.informationElementId = elementId & 0x7FFF;
        this.fieldLength = BufferUtils.uint16(buffer);

        if ((elementId & 0x8000) == 0) {
            this.enterpriseNumber = Optional.empty();
        } else {
            long enterpriseNumber = BufferUtils.uint32(buffer);
            this.enterpriseNumber = Optional.of(enterpriseNumber);
        }

        final InformationElement informationElement = InformationElementDatabase.instance
                .lookup(Protocol.IPFIX, this.enterpriseNumber, this.informationElementId).orElseGet(() -> {
                    LOG.warn("Undeclared information element: {}", UndeclaredValue.nameFor(this.enterpriseNumber, this.informationElementId));
                    return UndeclaredValue.parser(this.enterpriseNumber, this.informationElementId);
                });

        if (this.fieldLength > informationElement.getMaximumFieldLength() || this.fieldLength < informationElement.getMinimumFieldLength()) {
            throw new InvalidPacketException(buffer, "Template field '%s' has illegal size: %d (min=%d, max=%d)",
                    informationElement.getName(),
                    this.fieldLength,
                    informationElement.getMinimumFieldLength(),
                    informationElement.getMaximumFieldLength());
        }

        this.specifier = new Field(this.fieldLength, informationElement);
    }

