    public static FlowSet.RecordParser<DataRecord> parser(final Template template, final TemplateManager.TemplateResolver templateResolver) throws InvalidPacketException {
        return new FlowSet.RecordParser<DataRecord>() {
            @Override
            public DataRecord parse(final ByteBuffer buffer) throws InvalidPacketException {
                return new DataRecord(templateResolver, template, buffer);
            }

            @Override
            public int getMinimumRecordLength() {
                return template.fields.stream()
                        .mapToInt(f -> f.length).sum();
            }
        };
    }

