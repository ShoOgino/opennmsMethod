    @Override
    public Stream<RecordProvider.Record> getRecords() {
        return this.sets.stream()
                .filter(s -> s.header.getType() == FlowSetHeader.Type.DATA_FLOWSET)
                .flatMap(s -> ((FlowSet<DataRecord>) s).records.stream())
                .map(r -> new RecordProvider.Record(this.header.sourceId, this.header.unixSecs, r.template.scopeFieldsCount, Iterables.transform(r.fields, f -> f.value)));
    }

