    public DataRecord(final DataSet set,
                      final TemplateManager.TemplateResolver templateResolver,
                      final Template template,
                      final ByteBuffer buffer) throws InvalidPacketException {
        this.set = Objects.requireNonNull(set);

        this.template = Objects.requireNonNull(template);

        final List<FieldValue> values = new ArrayList<>(template.count());
        for (final Field templateField : template) {
            values.add(new FieldValue(templateResolver, templateField, buffer));
        }

        this.fields = Collections.unmodifiableList(values);
    }

