    @Override
    public Stream<RecordProvider.Record> getRecords() {
        final int recordCount = this.dataSets.stream()
                .mapToInt(s -> s.records.size())
                .sum();

        return this.dataSets.stream()
                .flatMap(s -> s.records.stream())
                .map(r -> new RecordProvider.Record(
                        this.header.observationDomainId,
                        this.header.exportTime,
                        r.template.scopes.size(),
                        recordCount,
                        this.header.sequenceNumber,
                        Iterables.transform(r.fields, f -> f.value)
                ));
    }

