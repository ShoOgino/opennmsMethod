    @Override
    public void deleted(String pid) {
        final Entity entity = this.entities.remove(pid);
        if (entity.healthCheck != null) {
            entity.healthCheck.unregister();
        }
        if (entity.listener != null) {
            LOG.info("Stopping listener for pid: {}", pid);
            try {
                entity.listener.stop();
            } catch (InterruptedException e) {
                LOG.error("Error occurred while stopping listener for pid: {}", pid, e);
            }
        }
        if (entity.queueNames != null) {
            stopQueues(entity.queueNames);
        }
    }

