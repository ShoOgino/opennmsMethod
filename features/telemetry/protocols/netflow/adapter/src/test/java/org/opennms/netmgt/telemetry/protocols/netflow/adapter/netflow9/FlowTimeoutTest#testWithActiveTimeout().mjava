    @Test
    public void testWithActiveTimeout() {
        final BsonDocument bsonDocument = new BsonDocument();
        final BsonDocumentWriter bsonDocumentWriter = new BsonDocumentWriter(bsonDocument);
        bsonDocumentWriter.writeStartDocument();

        bsonDocumentWriter.writeInt64("@unixSecs", 0);
        bsonDocumentWriter.writeInt64("@sysUpTime", 0);

        bsonDocumentWriter.writeInt64("FIRST_SWITCHED", 123000);
        bsonDocumentWriter.writeInt64("LAST_SWITCHED", 987000);

        bsonDocumentWriter.writeInt64("IN_BYTES", 10);
        bsonDocumentWriter.writeInt64("IN_PKTS", 10);

        bsonDocumentWriter.writeInt64("FLOW_ACTIVE_TIMEOUT", 10);
        bsonDocumentWriter.writeInt64("FLOW_INACTIVE_TIMEOUT", 300);

        bsonDocumentWriter.writeEndDocument();

        final Netflow9Flow flow = new Netflow9Flow(bsonDocument);

        assertThat(flow.getTimeout().isPresent(), is(true));
        assertThat(flow.getTimeout().get().getActive(), is(10000L));
        assertThat(flow.getTimeout().get().getInactive(), is(300000L));

        assertThat(flow.getFirstSwitched(), is(123000L));
        assertThat(flow.getDeltaSwitched(), is(987000L - 10000L));
        assertThat(flow.getLastSwitched(), is(987000L));
    }

