    @Test
    public void testWithActiveTimeout() {
        final BsonDocument bsonDocument = new BsonDocument();
        final BsonDocumentWriter bsonDocumentWriter = new BsonDocumentWriter(bsonDocument);
        bsonDocumentWriter.writeStartDocument();

        bsonDocumentWriter.writeStartDocument("flowStartSeconds");
        bsonDocumentWriter.writeInt64("epoch", 123);
        bsonDocumentWriter.writeEndDocument();

        bsonDocumentWriter.writeStartDocument("flowEndSeconds");
        bsonDocumentWriter.writeInt64("epoch", 987);
        bsonDocumentWriter.writeEndDocument();

        bsonDocumentWriter.writeInt64("octetDeltaCount", 10);
        bsonDocumentWriter.writeInt64("packetDeltaCount", 10);

        bsonDocumentWriter.writeInt64("flowActiveTimeout", 10);
        bsonDocumentWriter.writeInt64("flowInactiveTimeout", 300);

        bsonDocumentWriter.writeEndDocument();

        final IpfixFlow flow = new IpfixFlow(bsonDocument);

        assertThat(flow.getTimeout().isPresent(), is(true));
        assertThat(flow.getTimeout().get().getActive(), is(10000L));
        assertThat(flow.getTimeout().get().getInactive(), is(300000L));

        assertThat(flow.getFirstSwitched(), is(123000L));
        assertThat(flow.getDeltaSwitched(), is(987000L - 10000L));
        assertThat(flow.getLastSwitched(), is(987000L));
    }

