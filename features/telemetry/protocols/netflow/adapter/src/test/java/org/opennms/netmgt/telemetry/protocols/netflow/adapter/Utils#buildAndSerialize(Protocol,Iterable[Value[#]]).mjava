    public static byte[] buildAndSerialize(Protocol protocol, Iterable<Value<?>> record) {
        RecordEnrichment enrichment = (address -> Optional.empty());
        if (protocol.equals(Protocol.NETFLOW5)) {
            Netflow5MessageBuilder builder = new Netflow5MessageBuilder(record, enrichment);
            return builder.buildData();
        } else if (protocol.equals(Protocol.NETFLOW9)) {
            Netflow9MessageBuilder builder = new Netflow9MessageBuilder(record, enrichment);
            return builder.buildData();
        } else if (protocol.equals(Protocol.IPFIX)) {
            IpFixMessageBuilder builder = new IpFixMessageBuilder(record, enrichment);
            return builder.buildData();
        }
        return null;
    }

