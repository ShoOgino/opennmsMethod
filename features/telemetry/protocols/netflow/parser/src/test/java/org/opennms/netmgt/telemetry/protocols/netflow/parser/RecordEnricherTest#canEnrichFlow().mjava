    /**
     * Test flow enrichment by mocking the {@link DnsResolver}.
     */
    @Test
    public void canEnrichFlow() throws InvalidPacketException, ExecutionException, InterruptedException, UnknownHostException {
        enrichFlow(CompletableFuture.completedFuture(Optional.of("test")), Optional.of("test"));
        enrichFlow(CompletableFuture.completedFuture(Optional.empty()), Optional.empty());

        CompletableFuture exceptionalFuture = new CompletableFuture();
        exceptionalFuture.completeExceptionally(new RuntimeException());
        enrichFlow(exceptionalFuture, Optional.empty());
    }

