    @Test(expected = IllegalFlowException.class)
    public void illegalFlowTest() throws Exception {
        final RecordEnrichment enrichment = (address -> Optional.empty());
        final List<Value<?>> record = new ArrayList<>();
        record.add(new UnsignedValue("@unixSecs", 1000));
        record.add(new UnsignedValue("@sysUpTime", 1000));
        // first > last, this should trigger an exception
        record.add(new UnsignedValue("FIRST_SWITCHED", 3000));
        record.add(new UnsignedValue("LAST_SWITCHED", 2000));
        final Netflow9MessageBuilder builder = new Netflow9MessageBuilder(record, enrichment);
        builder.buildData();
    }

