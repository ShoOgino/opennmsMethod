    private static String appendPosition(final String message, final ByteBuf buffer) {
        if (buffer.hasArray()) {
            return String.format("%s [0x%04X]", message, buffer.arrayOffset() + buffer.readerIndex());
        } else {
            return message;
        }
    }

