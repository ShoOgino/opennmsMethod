    @VisibleForTesting
    public static ByteBuffer serialize(final Protocol protocol, final Iterable<Value<?>> record) {
        return serialize(protocol, record, new RecordEnrichment() {
            @Override
            public Optional<String> getHostnameFor(InetAddress srcAddress) {
                return Optional.empty();
            }
        });
    }

