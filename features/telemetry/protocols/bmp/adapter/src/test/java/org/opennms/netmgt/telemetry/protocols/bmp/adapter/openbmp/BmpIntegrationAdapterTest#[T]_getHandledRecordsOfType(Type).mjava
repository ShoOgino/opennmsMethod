    private <T> List<T> getHandledRecordsOfType(Type type) {
        return messagesHandled.stream()
                .filter(m -> type.equals(m.getType()))
                .flatMap(m -> m.getRecords().stream())
                .map(m -> (T)m)
                .collect(Collectors.toList());
    }

