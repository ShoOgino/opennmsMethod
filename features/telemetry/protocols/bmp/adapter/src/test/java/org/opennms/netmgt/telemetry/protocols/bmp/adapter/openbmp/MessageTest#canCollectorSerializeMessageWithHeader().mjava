    @Test
    public void canCollectorSerializeMessageWithHeader() {
        final Collector collector = new Collector();
        collector.action = Collector.Action.CHANGE;
        collector.sequence = 8L;
        collector.adminId = "collector";
        collector.hash = "91e3a7ff9f5676ed6ae6fcd8a6b455ec";
        collector.routers = Collections.singletonList(InetAddressUtils.addr("10.10.10.10"));

        long timeMicros = 1_582_456_123_795_452L;
        collector.timestamp = Instant.EPOCH.plus(timeMicros, ChronoUnit.MICROS);

        Message msg = new Message("91e3a7ff9f5676ed6ae6fcd8a6b455ec", Type.COLLECTOR, ImmutableList.of(collector));

        final StringBuffer buffer = new StringBuffer();
        msg.serialize(buffer);
        assertThat(buffer.toString(), equalTo("V: 1.7\n" +
                "C_HASH_ID: 91e3a7ff9f5676ed6ae6fcd8a6b455ec\n" +
                "T: collector\n" +
                "L: 93\n" +
                "R: 1\n" +
                "\n" +
                "change\t8\tcollector\t91e3a7ff9f5676ed6ae6fcd8a6b455ec\t10.10.10.10\t1\t2020-02-23 11:08:43.795452\n"));
    }

