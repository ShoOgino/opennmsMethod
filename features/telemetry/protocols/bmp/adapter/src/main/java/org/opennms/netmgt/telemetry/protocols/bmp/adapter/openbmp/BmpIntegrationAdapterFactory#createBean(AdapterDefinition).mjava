    @Override
    public Adapter createBean(final AdapterDefinition adapterConfig) {
        // Find topic prefix
        final String topicPrefix = adapterConfig.getParameterMap().remove("topicPrefix");

        // Extract kafka producer config
        final Map<String, Object> kafkaConfig = Maps.newHashMap();
        adapterConfig.getParameterMap().entrySet().removeIf(e -> {
            final Optional<String> prefix = StringUtils.truncatePrefix(e.getKey(), "kafka.");
            prefix.ifPresent(k -> kafkaConfig.put(k, e.getValue()));
            return prefix.isPresent();
        });

        return new BmpIntegrationAdapter(adapterConfig,
                                         this.getTelemetryRegistry().getMetricRegistry(),
                                         new BmpKafkaProducer(topicPrefix, kafkaConfig));
    }

