    public Header(final ByteBuf buffer) throws InvalidPacketException {
        final byte[] marker = bytes(buffer, 16);
        if (!Arrays.equals(marker, EXPECTED_MARKER)) {
            throw new InvalidPacketException(buffer, "Invalid BGP packet marker");
        }

        this.length = uint16(buffer);
        this.type = Type.from(buffer);
    }

