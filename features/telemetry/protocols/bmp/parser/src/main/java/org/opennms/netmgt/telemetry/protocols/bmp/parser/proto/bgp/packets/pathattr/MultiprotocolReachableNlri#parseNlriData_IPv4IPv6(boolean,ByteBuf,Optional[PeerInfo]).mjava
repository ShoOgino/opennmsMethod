    static List<UpdatePacket.Prefix> parseNlriData_IPv4IPv6(boolean isIPv4, final ByteBuf buffer, final Optional<PeerInfo> peerInfo) {
        final boolean addPathCapabilityEnabled = peerInfo.isPresent() ? peerInfo.get().isAddPathEnabled(isIPv4 ? BGP_AFI_IPV4 : BGP_AFI_IPV6, BGP_SAFI_UNICAST) : false;

        return BufferUtils.repeatRemaining(buffer, b -> {
            final UpdatePacket.Prefix tuple = new UpdatePacket.Prefix();

            if (addPathCapabilityEnabled) {
                tuple.pathId = BufferUtils.uint32(b);
            }

            tuple.length = BufferUtils.uint8(b);
            final int byteCount = tuple.length / 8 + (tuple.length % 8 > 0 ? 1 : 0);
            final byte[] prefixBytes = BufferUtils.bytes(b, byteCount);

            tuple.prefix = isIPv4 ? InetAddressUtils.getInetAddress(Arrays.copyOf(prefixBytes, 4)) : InetAddressUtils.getInetAddress(Arrays.copyOf(prefixBytes, 16));

            return tuple;
        });
    }

