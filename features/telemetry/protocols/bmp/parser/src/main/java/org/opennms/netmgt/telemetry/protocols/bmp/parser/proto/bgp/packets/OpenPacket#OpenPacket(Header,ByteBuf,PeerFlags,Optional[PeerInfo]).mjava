    public OpenPacket(final Header header, final ByteBuf buffer, final PeerFlags flags, final Optional<PeerInfo> peerInfo) {
        this.header = Objects.requireNonNull(header);

        this.version = uint8(buffer);
        this.as = uint16(buffer);
        this.holdTime = uint16(buffer);
        this.id = InetAddressUtils.getInetAddress(bytes(buffer, 4));

        final int parametersLength = uint8(buffer);

        // see https://tools.ietf.org/html/rfc4271#section-4.2
        this.parameters = repeatRemaining(slice(buffer, parametersLength), Parameter::new);
        // see https://tools.ietf.org/html/rfc3392
        this.capabilities = this.parameters.stream().filter(p -> p.type == 2).flatMap(p -> repeatRemaining(slice(p.value, p.length), Capability::new).stream()).collect(Collectors.toList());
    }

