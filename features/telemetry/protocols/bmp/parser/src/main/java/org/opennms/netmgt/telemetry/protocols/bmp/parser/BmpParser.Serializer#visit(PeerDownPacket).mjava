        @Override
        public void visit(final PeerDownPacket packet) {
            this.writePeerHeader(packet.peerHeader);

            this.writer.writeString("type", packet.type.name());

            packet.reason.accept(new Reason.Visitor() {
                @Override
                public void visit(final LocalBgpNotification localNotification) {
                    Serializer.this.writer.writeString("error", localNotification.notification.error.name());
                }

                @Override
                public void visit(final LocalNoNotification localNoNotification) {
                    Serializer.this.writer.writeInt64("code", localNoNotification.code);
                }

                @Override
                public void visit(final RemoteBgpNotification remoteNotification) {
                    Serializer.this.writer.writeString("error", remoteNotification.notification.error.name());
                }

                @Override
                public void visit(final RemoteNoNotification remoteNoNotification) {
                    // No data
                }

                @Override
                public void visit(final Unknown unknown) {
                    // No data
                }
            });
        }

