    static Packet parse(final ByteBuffer buffer, final PeerFlags flags) throws InvalidPacketException {
        final Header header = new Header(buffer);
        return header.parsePayload(buffer, flags);
    }

