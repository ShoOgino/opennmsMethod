    private Function<Transport.Message.Builder, CompletableFuture<Transport.Message.Builder>> resolveSysName(final Packet packet, final InetAddress sourceAddress) {
        return message -> packet.map(new Packet.Mapper.Adapter<CompletableFuture<Transport.Message.Builder>>(CompletableFuture.completedFuture(message)) {

            @Override
            public CompletableFuture<Transport.Message.Builder> map(final InitiationPacket packet) {
                return BmpParser.this.dnsResolver.reverseLookup(sourceAddress)
                        .thenApply(hostname -> {
                            hostname.ifPresent(message.getInitiationBuilder()::setHostname);
                            return message;
                        });
            }
        });
    }

