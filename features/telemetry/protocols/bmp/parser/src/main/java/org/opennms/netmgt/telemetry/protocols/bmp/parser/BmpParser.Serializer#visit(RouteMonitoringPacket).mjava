        @Override
        public void visit(final RouteMonitoringPacket packet) {
            final Transport.RouteMonitoringPacket.Builder message = this.message.getRouteMonitoringBuilder();
            message.setPeer(peer(packet.peerHeader));

            packet.updateMessage.ifPresent(updateMessage -> {
                for (final UpdatePacket.Prefix prefix : updateMessage.withdrawRoutes) {
                    message.addWithdrawsBuilder()
                            .setPrefix(address(prefix.prefix))
                            .setLength(prefix.length);
                }

                for (final UpdatePacket.Prefix prefix : updateMessage.reachableRoutes) {
                    message.addReachablesBuilder()
                            .setPrefix(address(prefix.prefix))
                            .setLength(prefix.length);
                }

                for (final UpdatePacket.PathAttribute attribute : updateMessage.pathAttributes) {
                    message.addAttributes(pathAttribute(attribute));
                }
            });
        }

