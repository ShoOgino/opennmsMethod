    public InetAddress parseAddress(final ByteBuf buffer) {
        return InetAddressUtils.getInetAddress(this.addressVersion.<byte[]>map(v -> {switch (v) {
            case IP_V4:
                return bytes(buffer, 4);
            case IP_V6:
                return bytes(buffer, 16);
            default:
                throw new IllegalStateException();
        }}));
    }

