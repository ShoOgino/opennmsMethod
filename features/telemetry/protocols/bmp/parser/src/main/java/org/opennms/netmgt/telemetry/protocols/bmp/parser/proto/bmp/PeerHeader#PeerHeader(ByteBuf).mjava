    public PeerHeader(final ByteBuf buffer) throws InvalidPacketException {
        this.type = Type.from(buffer);

        if (this.type == Type.LOC_RIB_INSTANCE) {
            this.flags = null;
            this.locRibFlags = new LocRibFlags(uint8(buffer));
        } else {
            this.flags = new PeerFlags(uint8(buffer));
            this.locRibFlags = null;
        }

        this.distinguisher = uint64(buffer);

        this.address = this.flags.parsePaddedAddress(buffer);

        this.as = uint32(buffer);
        this.id = InetAddressUtils.getInetAddress(bytes(buffer, 4));

        this.timestamp = Instant.ofEpochSecond(uint32(buffer), uint32(buffer) * 1000);
    }

