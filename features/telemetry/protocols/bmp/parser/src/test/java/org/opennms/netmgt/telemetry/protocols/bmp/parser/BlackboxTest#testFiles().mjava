    @Test
    public void testFiles() throws Exception {
        try (final FileChannel channel = FileChannel.open(FOLDER.resolve(file))) {
            final ByteBuffer buffer = ByteBuffer.allocate((int) channel.size());
            channel.read(buffer);
            buffer.flip();

            final ByteBuf buf = Unpooled.wrappedBuffer(buffer);

            final Header header = new Header(slice(buf, Header.SIZE));
            final Packet packet = header.parsePayload(buf);
            assertThat(packet, isA(clazz));
            assertThat((long) header.length, is(channel.size()));
            packet.accept(this);
        }
    }

