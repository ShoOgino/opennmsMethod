    @Override
    public List<Flow> convert(final BsonDocument packet) {
        final List<Flow> result = Lists.newLinkedList();

        final SFlow.Header header = new SFlow.Header(packet);

        for (final BsonValue sample : packet.getDocument("data").getArray("samples")) {
            final BsonDocument sampleDocument = sample.asDocument();

            if ("0:1".equals(sampleDocument.get("format").asString().getValue()) ||
                "0:3".equals(sampleDocument.get("format").asString().getValue())) {
                // Handle only (expanded) flow samples
                result.add(new SFlow(header, sampleDocument.get("data").asDocument()));
            }
        }

        return result;
    }

