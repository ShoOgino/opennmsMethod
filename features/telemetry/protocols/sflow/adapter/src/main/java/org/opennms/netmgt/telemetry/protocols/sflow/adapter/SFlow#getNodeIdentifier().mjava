    @Override
    public String getNodeIdentifier() {
        final String address = first(
                getString(document, "agent_address", "ipv6", "address"),
                getString(document, "agent_address", "ipv4", "address"))
                .orElse("unknown");

        final String subAgentId = header.getSubAgentId() == null ? "unknown" : String.valueOf(header.getSubAgentId());

        return address + ":" + subAgentId;
    }

