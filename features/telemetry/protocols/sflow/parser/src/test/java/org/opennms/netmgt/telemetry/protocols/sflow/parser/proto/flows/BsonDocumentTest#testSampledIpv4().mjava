    /**
     * These tests assure, that the test flow data is really at the right spot in the BsonDocument's structure.
     */
    @Test
    public void testSampledIpv4() {
        final BsonDocument bsonDocument = createSampledIpv4();
        final SFlow sFlow = new SFlow(SFLOW_HEADER, bsonDocument, Instant.now());
        Assert.assertEquals(new Long(LENGTH), sFlow.getBytes());
        Assert.assertEquals(Flow.Direction.INGRESS, sFlow.getDirection());
        Assert.assertEquals(DST_IPV4_STR, sFlow.getDstAddr());
        Assert.assertEquals(null, sFlow.getDstAs());
        Assert.assertEquals(null, sFlow.getDstMaskLen());
        Assert.assertEquals(new Integer(DST_PORT), sFlow.getDstPort());
        Assert.assertEquals(null, sFlow.getEngineType());
        Assert.assertEquals(new Long(CURRENT_TIME_MILLIS), sFlow.getFirstSwitched());
        Assert.assertEquals(1, sFlow.getFlowRecords());
        Assert.assertEquals(0, sFlow.getFlowSeqNum());
        Assert.assertEquals(new Integer(INPUT), sFlow.getInputSnmp());
        Assert.assertEquals(new Integer(4), sFlow.getIpProtocolVersion());
        Assert.assertEquals(new Long(CURRENT_TIME_MILLIS), sFlow.getLastSwitched());
        Assert.assertEquals(Flow.NetflowVersion.SFLOW, sFlow.getNetflowVersion());
        Assert.assertEquals(null, sFlow.getNextHop());
        Assert.assertEquals(new Integer(OUTPUT), sFlow.getOutputSnmp());
        Assert.assertEquals(new Long(1), sFlow.getPackets());
        Assert.assertEquals(new Integer(PROTOCOL), sFlow.getProtocol());
        Assert.assertEquals(Flow.SamplingAlgorithm.Unassigned, sFlow.getSamplingAlgorithm());
        Assert.assertEquals(new Double(2.0), sFlow.getSamplingInterval());
        Assert.assertEquals(SRC_IPV4_STR, sFlow.getSrcAddr());
        Assert.assertEquals(null, sFlow.getSrcAs());
        Assert.assertEquals(null, sFlow.getSrcMaskLen());
        Assert.assertEquals(new Integer(SRC_PORT), sFlow.getSrcPort());
        Assert.assertEquals(new Integer(TCP_FLAGS), sFlow.getTcpFlags());
        Assert.assertEquals(CURRENT_TIME_MILLIS, sFlow.getTimestamp());
        Assert.assertEquals(new Integer(TOS), sFlow.getTos());
        Assert.assertEquals(null, sFlow.getVlan());
    }

