    public Opaque(final ByteBuf buffer,
                  final Optional<Integer> length,
                  final Parser<T> parser) throws InvalidPacketException {
        this.length = length.orElseGet(() -> (int) BufferUtils.uint32(buffer));
        this.value = parser.parse(BufferUtils.slice(buffer, this.length));

        // Skip over optional padding
        BufferUtils.skip(buffer, (4 - (this.length % 4)) % 4);
    }

