    private static String appendPosition(final String message, final ByteBuffer buffer) {
        if (buffer.hasArray()) {
            return String.format("%s [0x%04X]", message, buffer.arrayOffset() + buffer.position());
        } else {
            return message;
        }
    }

