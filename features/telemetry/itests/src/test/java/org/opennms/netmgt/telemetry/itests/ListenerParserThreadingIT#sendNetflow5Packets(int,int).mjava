    private void sendNetflow5Packets(int udpPort, int numPackets) throws IOException {
        // Generate minimal Netflow v5 packet with 1 record
        byte[] bytes = new byte[Header.SIZE + Record.SIZE];
        Arrays.fill(bytes, (byte) 0xFF);
        bytes[0] = 0x00;
        bytes[1] = 0x05;
        bytes[2] = 0x00;
        bytes[3] = 0x01;

        System.out.printf("Sending %d packets to localhost:%d\n", numPackets, udpPort);
        try (DatagramSocket socket = new DatagramSocket()) {
            for (int i = 0; i < numPackets; i++) {
                final DatagramPacket packet = new DatagramPacket(bytes, bytes.length, InetAddress.getLocalHost(), udpPort);
                socket.send(packet);
            }
        }
    }

