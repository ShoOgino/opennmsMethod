    private String getFilter(VaadinApplicationContext applicationContext, Hashtable<String,Object> additionalProperties) {
        if (applicationContext == null && additionalProperties.isEmpty()) return null;
        String filter = "(&%s%s)";
        String sessionFilter = "(sessionId=%s)(uiId=%s)";
        String additionalPropertiesFilterString = getAdditionalPropertiesString(additionalProperties);
        String sessionFilterString = applicationContext == null ? "" : String.format(sessionFilter, applicationContext.getSessionId(), Integer.toString(applicationContext.getUiId()));
        return String.format(filter, sessionFilterString, additionalPropertiesFilterString);
    }

