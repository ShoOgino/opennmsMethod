    @Override
    public VaadinApplicationContext createApplicationContext(VaadinApplicationContextCreator creator) {
        VaadinApplicationContext newContext = creator.create(this);
        VaadinApplicationContext oldContext = getService(VaadinApplicationContext.class, newContext);
        if (oldContext != null) return oldContext;
        registerAsService(VaadinApplicationContext.class, newContext, newContext);
        return newContext;
    }

