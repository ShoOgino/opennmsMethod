	private UserDetails getUserDetails() {
		Object principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal();
	    if (principal instanceof UserDetails) {
	      return (UserDetails) principal;
	    } else {
	        throw new IllegalStateException("principal should always be instanceof UserDetails");
	    }
	}

