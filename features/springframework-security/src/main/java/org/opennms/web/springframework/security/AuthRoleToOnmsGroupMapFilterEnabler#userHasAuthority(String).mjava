    private boolean userHasAuthority(String role) {
    	for (GrantedAuthority authority: SecurityContextHolder.getContext().getAuthentication().getAuthorities()) {
    		LOG.debug("checking role: {}, with granted authority: {}", role,authority.getAuthority());
    		if (authority.getAuthority().equals(role))
    			return true;
    	}
    	return false;
    }

