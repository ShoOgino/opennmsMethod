    @Override
    protected Object getPreAuthenticatedPrincipal(final HttpServletRequest request) {
        if (m_enabled) {
            final Object user = request.getAttribute(m_principalRequestAttribute);
            if (user == null && m_failOnError) {
                throw new PreAuthenticatedCredentialsNotFoundException(m_principalRequestAttribute + " attribute not found in request.");
            }
            return user;
        }
        return null;
    }

