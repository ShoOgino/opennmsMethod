    protected Set<String> getRolesFromGroups(Set<String> groups) {
         
        Set<String> roles = new HashSet<String>();
        
        for(String group : groups) {
            List<String> rolesForGroup = groupToRoleMap.get(group);
            logger.debug("Checking " + group + " for an associated role");
            if (rolesForGroup != null) {
                for(String role : rolesForGroup) {
                    roles.add(role);
                    logger.debug("Added role: " + role + " based on group " + group);
                }
            }
        }
        
        return roles;
        
    }

