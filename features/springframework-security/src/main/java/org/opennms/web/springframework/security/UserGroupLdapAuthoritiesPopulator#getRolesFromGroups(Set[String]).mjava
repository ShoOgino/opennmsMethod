    protected Set<String> getRolesFromGroups(Set<String> groups) {
         
        Set<String> roles = new HashSet<String>();
        
        for(String group : groups) {
            List<String> rolesForGroup = groupToRoleMap.get(group);
        
            if (rolesForGroup != null) {
                for(String role : rolesForGroup) {
                    roles.add(role);
                }
            }
        }
        
        return roles;
        
    }

