    /**
     * <p>getAuthoritiesByUsername</p>
     *
     * @param username a {@link java.lang.String} object.
     * @return an array of {@link org.springframework.security.GrantedAuthority} objects.
     */
    protected Collection<? extends GrantedAuthority> getAuthoritiesByUsername(final String username) {
        if (m_roles.containsKey(username)) {
            final Collection<? extends GrantedAuthority> roles = m_roles.get(username);
            LOG.debug("User {} has roles: {}", username, roles);
            return roles;
        } else {
            final List<GrantedAuthority> roles = Arrays.asList(new GrantedAuthority[] { ROLE_USER });
            LOG.debug("User {} has roles: {}", username, roles);
            return roles;
        }
    }

