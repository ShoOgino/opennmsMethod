    /**
     * <p>getAuthoritiesByUsername</p>
     *
     * @param user a {@link java.lang.String} object.
     * @return an array of {@link org.springframework.security.GrantedAuthority} objects.
     */
    protected Collection<? extends GrantedAuthority> getAuthoritiesByUsername(String user) {
        if (m_roles.containsKey(user)) {
            return m_roles.get(user);
        } else {
            return Arrays.asList(new GrantedAuthority[] { ROLE_USER });
        }
    }

