    /**
     * Gets the authorities by username.
     *
     * @param username the username
     * @return the authorities by username
     */
    protected Collection<? extends GrantedAuthority> getAuthoritiesByUsername(final String username) {
        if (m_roles.containsKey(username)) {
            final Collection<? extends GrantedAuthority> roles = m_roles.get(username);
            if (!roles.isEmpty()) {
                LOG.debug("User {} has roles: {}", username, roles);
                return roles;
            }
        } 
        final List<GrantedAuthority> roles = Arrays.asList(new GrantedAuthority[] { ROLE_USER });
        LOG.debug("User {} has roles: {}", username, roles);
        return roles;

    }

