    @Override
    public void run() {
        ServiceParameters params = new ServiceParameters(Collections.emptyMap());

        RrdRepository repository = new RrdRepository();
        repository.setStep(Math.max(intervalInSeconds, 1));
        repository.setHeartBeat(repository.getStep() * 2);
        // Use the default list of RRAs we provide in our stock configuration files
        repository.setRraList(Lists.newArrayList(
                "RRA:AVERAGE:0.5:1:2016",
                "RRA:AVERAGE:0.5:12:1488",
                "RRA:AVERAGE:0.5:288:366",
                "RRA:MAX:0.5:288:366",
                "RRA:MIN:0.5:288:366"));
        repository.setRrdBaseDir(Paths.get(System.getProperty("opennms.home"),"share","rrd","snmp").toFile());

        while (!abort.get()) {
            final Context context = batchTimer.time();
            try {
                generateAndPersistCollectionSets(params, repository);
            } finally {
                context.stop();
            }
            try {
                Thread.sleep(intervalInSeconds * 1000);
            } catch (InterruptedException e) {
                break;
            }
        }
    }

