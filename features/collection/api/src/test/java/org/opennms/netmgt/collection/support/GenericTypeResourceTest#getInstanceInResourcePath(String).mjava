    private String getInstanceInResourcePath(String instance) {
        // Mock the ResourceType
        ResourceType rt = mock(ResourceType.class, RETURNS_DEEP_STUBS);
        when(rt.getName()).thenReturn("type");
        when(rt.getStorageStrategy().getClazz()).thenReturn(IndexStorageStrategy.class.getCanonicalName());
        when(rt.getStorageStrategy().getParameters()).thenReturn(Collections.emptyList());
        when(rt.getPersistenceSelectorStrategy().getClazz()).thenReturn(PersistAllSelectorStrategy.class.getCanonicalName());
        when(rt.getPersistenceSelectorStrategy().getParameters()).thenReturn(Collections.emptyList());

        // Create the GenericTypeResource
        NodeLevelResource nlr = new NodeLevelResource(1);
        GenericTypeResource gtr = new GenericTypeResource(nlr, rt, instance);

        // Mock the CollectionResource
        CollectionResource resource = mock(CollectionResource.class);
        when(resource.getInstance()).thenReturn(gtr.getInstance());

        // Build the resource path, and extract the instance (the last element of the path)
        ResourcePath path = gtr.getPath(resource);
        String[] elements = path.elements();
        return elements[elements.length - 1];
    }

