    @Override
    public CollectionSet collect(CollectionAgent agent, Map<String, Object> parameters) throws CollectionException {
        try {
            initialize(agent, parameters);
        } catch (CollectionInitializationException e) {
            throw new CollectionException("Agent intilization failed", e);
        }
        try {
            return collect(agent, EventIpcManagerFactory.getIpcManager(), parameters);
        } finally {
            release(agent);
        }
    }

