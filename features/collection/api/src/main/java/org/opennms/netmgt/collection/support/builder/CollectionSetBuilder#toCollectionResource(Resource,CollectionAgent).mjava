    public static AbstractCollectionResource toCollectionResource(Resource resource, CollectionAgent agent) {
        return new AbstractCollectionResource(agent) {
            private String label;

            @Override
            public String getResourceTypeName() {
                return resource.getTypeName();
            }

            @Override
            public String getInstance() {
                return resource.getInstance();
            }

            @Override
            public String getUnmodifiedInstance() {
                return resource.getUnmodifiedInstance();
            }

            @Override
            public synchronized String getInterfaceLabel() {
                if (label == null) {
                    // Cache the results, since the operation may be expensive
                    label = resource.getLabel(this);
                }
                return label;
            }

            @Override
            public ResourcePath getPath() {
                return ResourcePath.get(super.getPath(), resource.getPath(this));
            }

            @Override
            public TimeKeeper getTimeKeeper() {
                if (resource.getTimestamp() != null) {
                    return new ConstantTimeKeeper(resource.getTimestamp());
                }
                return null;
            }

            @Override
            public String toString() {
                return resource.toString();
            }
        };
    }

