    private static HttpRequestBase buildHttpMethod(final HttpCollectorAgent collectorAgent) throws URISyntaxException {
        HttpRequestBase method;
        URI uri = buildUri(collectorAgent);
        if ("GET".equals(collectorAgent.getUriDef().getUrl().getMethod())) {
            method = buildGetMethod(uri, collectorAgent);
        } else {
            method = buildPostMethod(uri, collectorAgent);
        }

        final String virtualHost = collectorAgent.getUriDef().getUrl().getVirtualHost();
        if (virtualHost != null && !virtualHost.trim().isEmpty()) {
            method.setHeader(HTTP.TARGET_HOST, virtualHost);
        }
        return method;
    }

