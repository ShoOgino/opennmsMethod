        @Override
        public Status evaluateAfterFetch(double dsValue, ThresholdValues thresholdValues) {
            Integer trigger = thresholdValues != null && thresholdValues.getTrigger() != null ?
                    thresholdValues.getTrigger() : getThresholdConfig().getTrigger();
            Double thresholdValue = thresholdValues != null && thresholdValues.getThresholdValue() != null ?
                    thresholdValues.getThresholdValue() : getThresholdConfig().getValue();
            if(thresholdValue == null || trigger == null) {
                return Status.NO_CHANGE;
            }
            try {
                if (!Double.valueOf(getPreviousTriggeringSample()).isNaN()) {
                    setTriggerCount(getTriggerCount() + 1);
                    if (!wasTriggered(dsValue, thresholdValue) && (getTriggerCount() >= trigger)) {
                        setPreviousTriggeringSample(Double.NaN);
                        setTriggerCount(0);
                        LOG.debug("{} threshold rearmed, sample value={}", TYPE, dsValue);
                        return Status.RE_ARMED;
                    }
                } else if (wasTriggered(dsValue, thresholdValue)) {
                    setPreviousTriggeringSample(getLastSample());
                    setTriggerCount(0);
                    LOG.debug("{} threshold triggered, sample value={}", TYPE, dsValue);
                    return Status.TRIGGERED;
                }
            } finally {
                setLastSample(dsValue);
            }

            return Status.NO_CHANGE;
        }

