    private Scope getScopeForResource(CollectionResourceWrapper resource) {
        // Default to empty scopes and then attempt to populate each of node, interface, and service
        // scopes below
        Scope[] scopes = new Scope[]{EmptyScope.EMPTY, EmptyScope.EMPTY, EmptyScope.EMPTY};

        if (resource != null) {
            scopes[0] = m_entityScopeProvider.getScopeForNode(resource.getNodeId());
            String interfaceIp = resource.getHostAddress();
            if (interfaceIp != null) {
                scopes[1] = m_entityScopeProvider.getScopeForInterface(resource.getNodeId(),
                        interfaceIp);
                scopes[2] = m_entityScopeProvider.getScopeForService(resource.getNodeId(),
                        InetAddresses.forString(interfaceIp), resource.getServiceName());
            }
        }
        return new FallbackScope(scopes);
    }

