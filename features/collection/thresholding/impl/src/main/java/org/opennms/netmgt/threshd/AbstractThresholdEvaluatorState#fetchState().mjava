    @SuppressWarnings("unchecked")
    private void fetchState() {
        try {
            Long lastKnownUpdate = lastUpdatedCache.get(key);

            // If we don't have a record of when this was last updated locally, get it from the store
            if (lastKnownUpdate == null) {
                kvStore.get(key, THRESHOLDING_KV_CONTEXT).ifPresent(v -> state = v);
            } else {
                // Otherwise get it from the store only if our record is stale
                kvStore.getIfStale(key, THRESHOLDING_KV_CONTEXT, lastKnownUpdate)
                        .ifPresent(o -> o.ifPresent(v -> state = v));
            }
        } catch (RuntimeException e) {
            RATE_LIMITED_LOGGER.warn("Failed to retrieve state for threshold {}", key, e);
        }
    }

