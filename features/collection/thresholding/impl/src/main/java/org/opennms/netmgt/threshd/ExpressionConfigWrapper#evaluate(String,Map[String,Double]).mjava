    /**
     * Evaluate given an already interpolated expression that contains no mate data.
     */
    public double evaluate(String expression, Map<String, Double> values) throws ThresholdExpressionException {
        // Add all of the variable values to the script context
        Map<String, Object> context = new HashMap<>(values);
        context.put("datasources", new HashMap<>(values)); // To workaround NMS-5019
        context.put("math", new MathBinding());
        double result;
        try {
            // Fetch an instance of the JEXL script engine to evaluate the script expression
            Object resultObject = jexlEngine.createExpression(expression).evaluate(new MapContext(context));
            result = Double.parseDouble(resultObject.toString());
        } catch (Throwable e) {
            throw new ThresholdExpressionException("Error while evaluating expression " + m_expression.getExpression() + ": " + e.getMessage(), e);
        }
        return result;
    }

