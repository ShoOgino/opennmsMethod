    private static SnmpCollectionAgent createCollectionAgent() {
        SnmpCollectionAgent agent = EasyMock.createMock(SnmpCollectionAgent.class);
        EasyMock.expect(agent.getNodeId()).andReturn(1).anyTimes();
        EasyMock.expect(agent.getStorageResourcePath()).andReturn(ResourcePath.get(String.valueOf(1))).anyTimes();
        EasyMock.expect(agent.getHostAddress()).andReturn("127.0.0.1").anyTimes();
        EasyMock.expect(agent.getSnmpInterfaceInfo((IfResourceType) EasyMock.anyObject())).andReturn(new HashSet<IfInfo>()).anyTimes();
        EasyMock.expect(agent.getAttributeNames()).andReturn(Collections.emptySet()).anyTimes();
        EasyMock.expect(agent.getAddress()).andReturn(InetAddrUtils.getLocalHostAddress()).anyTimes();
        EasyMock.expect(agent.isStoreByForeignSource()).andReturn(false).anyTimes();
        EasyMock.expect(agent.getNodeLabel()).andReturn("test").anyTimes();
        EasyMock.expect(agent.getForeignSource()).andReturn(null).anyTimes();
        EasyMock.expect(agent.getForeignId()).andReturn(null).anyTimes();
        EasyMock.expect(agent.getLocationName()).andReturn(null).anyTimes();
        EasyMock.expect(agent.getSysObjectId()).andReturn(null).anyTimes();
        EasyMock.expect(agent.getSavedSysUpTime()).andReturn(0L).anyTimes();
        EasyMock.replay(agent);
        return agent;
    }

