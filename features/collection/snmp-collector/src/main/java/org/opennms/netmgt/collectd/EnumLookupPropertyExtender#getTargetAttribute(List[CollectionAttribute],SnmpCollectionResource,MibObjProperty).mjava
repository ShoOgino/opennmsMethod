    /* (non-Javadoc)
     * @see org.opennms.netmgt.collectd.SnmpPropertyExtender#getTargetAttribute(java.util.List, org.opennms.netmgt.collectd.SnmpCollectionResource, org.opennms.netmgt.config.datacollection.MibObjProperty)
     */
    @Override
    public SnmpAttribute getTargetAttribute(List<CollectionAttribute> sourceAttributes, SnmpCollectionResource targetResource, MibObjProperty property) {
        final String defaultValue = property.getParameterValue(DEFAULT_VALUE);
        
        final String enumAttribute = property.getParameterValue(ENUM_ATTRIBUTE);

        if (StringUtils.isBlank(enumAttribute)) {
            LOG.warn("Cannot execute the enum-lookup property extender because: missing parameter {}", ENUM_ATTRIBUTE);
            return null;
        }

        for (AttributeGroup group : targetResource.getGroups()) {
            for (CollectionAttribute attribute : group.getAttributes()) {
                if (enumAttribute.equals(attribute.getName())) {
                    final String result = property.getParameterValue(attribute.getStringValue(), defaultValue);
                    if (result == null) {
                        return null;
                    }
                    AttributeGroupType groupType = targetResource.getGroupType(property.getGroupName());
                    MibPropertyAttributeType type = new MibPropertyAttributeType(targetResource.getResourceType(), property, groupType);
                    SnmpValue value = SnmpUtils.getValueFactory().getOctetString(result.getBytes());
                    return new SnmpAttribute(targetResource, type, value); 
                }
            }
        }

        return null;
    }

