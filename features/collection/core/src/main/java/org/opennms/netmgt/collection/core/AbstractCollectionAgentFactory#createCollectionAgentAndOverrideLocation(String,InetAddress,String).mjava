    @Override
    public T createCollectionAgentAndOverrideLocation(String nodeCriteria, InetAddress ipAddr, String location) {
        final OnmsNode node = nodeDao.get(nodeCriteria);
        if (node == null) {
            throw new IllegalArgumentException(String.format("No node found with lookup criteria: %s",
                    nodeCriteria));
        }
        final OnmsIpInterface ipInterface = ipInterfaceDao.findByNodeIdAndIpAddress(
                node.getId(), InetAddressUtils.str(ipAddr));
        if (ipInterface == null) {
            throw new IllegalArgumentException(String.format("No interface found with IP %s on node %s",
                    InetAddressUtils.str(ipAddr), nodeCriteria));
        }
        final T agent = createAgent(ipInterface.getId(), ipInterfaceDao, transMgr, location);
        return agent;
    }

