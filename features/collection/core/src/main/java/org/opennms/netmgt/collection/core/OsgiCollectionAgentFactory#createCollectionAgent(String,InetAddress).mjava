    @Override
    public CollectionAgent createCollectionAgent(String nodeCriteria, InetAddress ipAddr) {
        return transactionOperations.execute((status) -> {
            final OnmsNode node = lookupNode(nodeCriteria);
            final OnmsIpInterface ipInterface = lookupIpInterface(node, InetAddressUtils.str(ipAddr));
            final CollectionAgent agent = createAgent(ipInterface, node, node.getLocation() != null ? node.getLocation().getLocationName() : null);
            return agent;
        });
    }

