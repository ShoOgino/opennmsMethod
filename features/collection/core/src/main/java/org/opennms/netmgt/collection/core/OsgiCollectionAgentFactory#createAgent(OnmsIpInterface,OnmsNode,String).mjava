    private CollectionAgent createAgent(OnmsIpInterface ipIf, OnmsNode node, String location) {
        final CollectionAgentDTO agent = new CollectionAgentDTO();
        agent.setAddress(ipIf.getIpAddress());
        agent.setForeignId(node.getForeignId());
        agent.setForeignSource(node.getForeignSource());
        agent.setNodeId(node.getId());
        agent.setNodeLabel(node.getLabel());
        agent.setLocationName(location);
        agent.setStorageResourcePath(DefaultCollectionAgentService.createStorageResourcePath(agent));
        agent.setStoreByForeignSource(storeByForeignSource);
        return agent;
    }

