    @Test
    public void testInitializingWithHistory() throws Exception {
        m_mockHistory.setValue("search/ae");
        m_searchManager = new MockSearchStateManager(m_mockSearchInput, m_mockHistory, m_eventManager, m_componentTracker);
        assertEquals(State.SEARCHING_FINISHED, m_searchManager.getState());

        typeCharacter(m_searchManager, 'a');
        m_searchManager.updateMatchCount(1);
        assertEquals(State.SEARCHING_AUTOCOMPLETE_VISIBLE, m_searchManager.getState());
        assertEquals(true, m_searchManager.isAutocompleteVisible());
        assertEquals(false, m_searchManager.isAutocompleteFocused());
        assertEquals(true, m_searchManager.isInputFocused());
        assertEquals("aea", m_mockSearchInput.getValue());
    }

