    protected NativeEvent createEvent(final String type, final int keyCode) throws Exception {
        final NativeEvent event = PowerMock.createMock(NativeEvent.class);
        expect(event.getType()).andReturn(type).anyTimes();
        expect(event.getKeyCode()).andReturn(keyCode).anyTimes();
        PowerMock.replay(event);
        return event;
    }

