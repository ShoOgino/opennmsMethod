    private void updateNodes() {
        final List<MapNode> nodes = getState().nodes;
        LOG.info("NodeMapConnector.onStateChanged(): nodes list is now: " + nodes);
        final List<JSNodeMarker> featureCollection = new ArrayList<JSNodeMarker>();

        if (nodes.isEmpty()) {
            getWidget().setMarkers(featureCollection);
            return;
        }

        for (final MapNode node : nodes) {
            final JSNodeMarker marker = new JSNodeMarker(new LatLng(node.getLatitude(), node.getLongitude()));
            marker.putProperty(JSNodeMarker.Property.NODE_ID, node.getNodeId());
            marker.putProperty(JSNodeMarker.Property.NODE_LABEL, node.getNodeLabel());
            marker.putProperty(JSNodeMarker.Property.FOREIGN_SOURCE, node.getForeignSource());
            marker.putProperty(JSNodeMarker.Property.FOREIGN_ID, node.getForeignId());
            marker.putProperty(JSNodeMarker.Property.DESCRIPTION, node.getDescription());
            marker.putProperty(JSNodeMarker.Property.MAINTCONTRACT, node.getMaintcontract());
            marker.putProperty(JSNodeMarker.Property.IP_ADDRESS, node.getIpAddress());
            marker.putProperty(JSNodeMarker.Property.SEVERITY, node.getSeverity());
            marker.putProperty(JSNodeMarker.Property.SEVERITY_LABEL, node.getSeverityLabel());

            final List<String> categories = node.getCategories();
            if (categories != null) {
                marker.setCategories(categories.toArray(new String[]{}));
            }

            // TODO: Icon handling should be moved to the Widget
            if (m_icons.containsKey(marker.getSeverityLabel())) {
                marker.setIcon(m_icons.get(marker.getSeverityLabel()));
            } else {
                marker.setIcon(m_icons.get("Normal"));
            }

            // TODO: This should be moved to the Widget
            marker.bindPopup(NodeMarkerClusterCallback.getPopupTextForMarker(marker));

            featureCollection.add(marker);
        }
        getWidget().setMarkers(featureCollection);
        getConnection().getLoadingIndicator().hide();
    }

