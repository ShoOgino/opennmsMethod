    @Override
    public void paintContent(final PaintTarget target) throws PaintException {
        super.paintContent(target);

        if (m_nodeDao == null) return;

        final CriteriaBuilder cb = new CriteriaBuilder(OnmsNode.class);
        cb.alias("assetRecord", "asset");
        cb.orderBy("id");

        final Set<Integer> nodeIds = new HashSet<Integer>();

        target.startTag("nodes");
        for (final OnmsNode node : m_nodeDao.findMatching(cb.toCriteria())) {
            addNode(target, node);
            nodeIds.add(node.getId());
        }
        target.endTag("nodes");

        target.startTag("alarms");

        final CriteriaBuilder builder = new CriteriaBuilder(OnmsAlarm.class);
        builder.alias("node", "node");
        builder.in("node.id", nodeIds);
        builder.ge("severity", OnmsSeverity.WARNING);
        builder.orderBy("severity").desc();
        builder.distinct();

        for (final OnmsAlarm alarm : m_alarmDao.findMatching(builder.toCriteria())) {
            addAlarm(target, alarm);
        }
        
        target.endTag("alarms");
    }

