    public void refresh() {
        if (m_markers == null) {
            VConsole.log("markers not initialized yet, skipping update");
            return;
        }
        if (m_markerClusterGroup == null) {
            VConsole.log("marker cluster not initialized yet, skipping update");
            return;
        }

        VConsole.log("processing " + m_markers.size() + " markers for the node layer");
        Scheduler.get().scheduleIncremental(new RepeatingCommand() {
            final ListIterator<NodeMarker> m_markerIterator = m_markers.listIterator();
            LatLngBounds m_bounds;
            NodeMarker m_visibleMarker = null;
            int m_count = 0;

            @Override public boolean execute() {
                if (m_markerIterator.hasNext()) {
                    final NodeMarker marker = m_markerIterator.next();
                    if (markerShouldBeVisible(marker)) {
                        m_count++;
                        if (m_count == 1) {
                            m_visibleMarker = marker;
                        }
                        if (!m_markerClusterGroup.hasLayer(marker)) {
                            m_markerClusterGroup.addLayer(marker);
                        }
                        if (m_firstUpdate) {
                            if (m_bounds == null) {
                                m_bounds = new LatLngBounds();
                            }
                            m_bounds.extend(marker.getLatLng());
                        }
                    } else {
                        m_markerClusterGroup.removeLayer(marker);
                    }
                    return true;
                }

                VConsole.log("finished adding markers");

                if (m_bounds != null) {
                    VConsole.log("first update, zooming to "+ m_bounds.toBBoxString());
                    m_map.fitBounds(m_bounds);
                    m_firstUpdate = false;
                } else {
                    VConsole.log("Skipping zoom, we've already done it once.");
                }

                if (m_count == 1 && m_visibleMarker != null) {
                    m_visibleMarker.openPopup();
                }

                VConsole.log("finished updating marker cluster layer");

                return false;
            }
        });
    }

