    private void setRrdGraphEntryFromKscReportGraph(RrdGraphEntry rrdGraphEntry, Graph graph) {

        String graphLabel, graphId, graphUrl, nodeId, nodeLabel, resourceId, resourceLabel, resourceTypeId, resourceTypeLabel;

        String[] graphTypeArr = graph.getGraphtype().split("\\.");
        String[] resourceIdArr = graph.getResourceId().orElse("").split("\\.");

        nodeId = resourceIdArr[0].split("[\\[\\]]")[1];
        String resourceTypeName = resourceIdArr[1].split("[\\[\\]]")[0];

        OnmsNode onmsNode = m_nodeDao.get(nodeId);
        nodeLabel = onmsNode.getLabel();

        Map<OnmsResourceType, List<OnmsResource>> resourceTypeListMap = m_rrdGraphHelper.getResourceTypeMapForNodeId(nodeId);

        for (Map.Entry<OnmsResourceType, List<OnmsResource>> entry : resourceTypeListMap.entrySet()) {
            OnmsResourceType onmsResourceType = entry.getKey();

            if (resourceTypeName.equals(onmsResourceType.getName())) {
                resourceTypeId = "node[" + nodeId + "]." + resourceTypeName;
                resourceTypeLabel = onmsResourceType.getLabel();
                List<OnmsResource> onmsResourceList = entry.getValue();

                for (OnmsResource onmsResource : onmsResourceList) {

                    String onmsResourceId = null;

                    try {
                        onmsResourceId = URLDecoder.decode(onmsResource.getId(), StandardCharsets.UTF_8.name());
                    } catch (UnsupportedEncodingException e) {
                        e.printStackTrace();
                    }

                    if (onmsResourceId.equals(graph.getResourceId())) {
                        resourceId = onmsResourceId;
                        resourceLabel = onmsResource.getLabel();

                        Map<String, String> resultsMap = m_rrdGraphHelper.getGraphResultsForResourceId(resourceId);
                        Map<String, String> nameTitleMapping = m_rrdGraphHelper.getGraphNameTitleMappingForResourceId(resourceId);

                        graphId = onmsResourceId + "." + nameTitleMapping.get(graph.getGraphtype());

                        graphLabel = nameTitleMapping.get(graph.getGraphtype());
                        graphUrl = resultsMap.get(graph.getGraphtype());

                        rrdGraphEntry.setNodeId(nodeId);
                        rrdGraphEntry.setNodeLabel(nodeLabel);
                        rrdGraphEntry.setResourceTypeId(resourceTypeId);
                        rrdGraphEntry.setResourceTypeLabel(resourceTypeLabel);
                        rrdGraphEntry.setResourceId(resourceId);
                        rrdGraphEntry.setResourceLabel(resourceLabel);
                        rrdGraphEntry.setGraphId(graphId);
                        rrdGraphEntry.setGraphLabel(graphLabel);
                        rrdGraphEntry.setGraphUrl(graphUrl);

                        break;
                    }
                }
                break;
            }
        }
    }

