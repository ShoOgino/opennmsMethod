    /**
     * Created as business service search criteria for a given map.
     *
     * @param map the map to inverstigate
     * @return the criteria
     */
    public static BusinessServiceSearchCriteria fromMap(Map<String, String> map) {
        boolean filterByName = getBooleanForKey(map, "filterByName");
        String nameValue = getStringForKey(map, "nameValue");

        boolean filterByAttribute = getBooleanForKey(map, "filterByAttribute");
        String attributeKey = getStringForKey(map, "attributeKey");
        String attributeValue = getStringForKey(map, "attributeValue");

        boolean filterBySeverity = getBooleanForKey(map, "filterBySeverity");

        String severityValue = getStringForKey(map, "severityValue");

        if (Strings.isNullOrEmpty(severityValue)) {
            severityValue = OnmsSeverity.WARNING.getLabel();
        }

        String severityCompareOperator = BSMConfigHelper.getStringForKey(map, "severityCompareOperator");

        if (Strings.isNullOrEmpty(severityCompareOperator)) {
            severityCompareOperator = BusinessServiceSearchCriteriaBuilder.CompareOperator.GreaterOrEqual.name();
        }

        String orderBy = BSMConfigHelper.getStringForKey(map, "orderBy");

        if (Strings.isNullOrEmpty(orderBy)) {
            orderBy = BusinessServiceSearchCriteriaBuilder.Order.Name.name();
        }

        String orderSequence = BSMConfigHelper.getStringForKey(map, "orderSequence");

        if (Strings.isNullOrEmpty(orderSequence)) {
            orderSequence = BusinessServiceSearchCriteriaBuilder.Sequence.Ascending.name();
        }

        int resultsLimit = getIntForKey(map, "resultsLimit");

        BusinessServiceSearchCriteriaBuilder b = new BusinessServiceSearchCriteriaBuilder();

        if (filterByName) {
            b.name(nameValue);
        }
        if (filterByAttribute) {
            b.attribute(attributeKey, attributeValue);
        }
        if (filterBySeverity) {
            b.filterSeverity(BusinessServiceSearchCriteriaBuilder.CompareOperator.valueOf(severityCompareOperator), OnmsSeverity.get(severityValue));
        }

        return b.order(BusinessServiceSearchCriteriaBuilder.Order.valueOf(orderBy))
                .order(BusinessServiceSearchCriteriaBuilder.Sequence.valueOf(orderSequence))
                .limit(resultsLimit)
                .order(BusinessServiceSearchCriteriaBuilder.Order.Name);
    }

