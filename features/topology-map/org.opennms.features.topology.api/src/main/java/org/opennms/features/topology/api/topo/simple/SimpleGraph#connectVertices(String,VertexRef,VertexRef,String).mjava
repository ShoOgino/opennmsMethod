    protected final AbstractEdge connectVertices(String edgeId, VertexRef sourceVertexRef, VertexRef targetVertexRef, String namespace) {
        if (sourceVertexRef == null) {
            if (targetVertexRef == null) {
                LOG.warn("Source and target vertices are null");
                return null;
            } else {
                LOG.warn("Source vertex is null");
                return null;
            }
        } else if (targetVertexRef == null) {
            LOG.warn("Target vertex is null");
            return null;
        }
        SimpleConnector source = new SimpleConnector(sourceVertexRef.getNamespace(), sourceVertexRef.getId()+"-"+edgeId+"-connector", sourceVertexRef);
        SimpleConnector target = new SimpleConnector(targetVertexRef.getNamespace(), targetVertexRef.getId()+"-"+edgeId+"-connector", targetVertexRef);

        AbstractEdge edge = new AbstractEdge(namespace, edgeId, source, target);

        addEdges(edge);

        return edge;
    }

