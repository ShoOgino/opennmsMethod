    /**
     * Queries the Measuement Api for the last value found in a given timeframe.
     *
     * @param resource the resource to be used
     * @param attribute the attribute to query for
     * @param aggregation the aggregation method
     * @return the last known value
     */
    public double getLastValue(final String resource, final String attribute, final String aggregation) throws MeasurementException {
        long end = System.currentTimeMillis();
        long start = end - (15 * 60 * 1000);

        QueryResponse.WrappedPrimitive[] columns = queryInt(resource, attribute, start, end, 300000, aggregation).getColumns();

        if (columns.length > 0) {
            double[] values = columns[0].getList();
            if (values.length > 0) {
                for(int i = values.length-1; i >= 0; i--) {
                    if (!Double.isNaN(values[i])) {
                        return values[i];
                    }
                }
            }
        }
        return Double.NaN;
    }

