    @SuppressWarnings("unchecked")
    protected static <T> T getPropertyValue(final Item item, final Object id, final Class<T> clazz) {
        if (item == null) return null;

        final Property prop = item.getItemProperty(id);
        if (prop == null) return null;

        final Class<?> type = prop.getType();
        if (type == null) return null;

        final Object value = prop.getValue();
        if (value == null) return null;

        if (!type.isAssignableFrom(clazz)) {
            LoggerFactory.getLogger(AbstractOperation.class).warn("Expected " + id + " of type " + clazz.getName() + ", but got " + type.getName() + " instead.");
            return null;
        }

        return (T) value;
    }

