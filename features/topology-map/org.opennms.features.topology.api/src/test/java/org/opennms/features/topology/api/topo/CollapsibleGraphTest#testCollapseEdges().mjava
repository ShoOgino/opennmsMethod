	@Test
	public void testCollapseEdges() {
		CollapsibleCriteria collapseMe = new CollapsibleCriteria() {

			@Override
			public void setCollapsed(boolean collapsed) {}

			@Override
			public boolean isCollapsed() {
				return true;
			}

			@Override
			public Set<VertexRef> getVertices() {
				Set<VertexRef> retval = new HashSet<>();
				retval.add(new DefaultVertexRef("nodes", "g2"));
				return retval;
			}

			@Override
			public String getNamespace() {
				return "nodes";
			}

			@Override
			public String getLabel() {
				return "Test Criteria";
			}

			@Override
			public String getId() {
				return "Test Criteria";
			}

			@Override
			public Vertex getCollapsedRepresentation() {
				return new AbstractVertex("category", "c");
			}
		};

		final Set<Edge> edges = CollapsibleGraph.collapseEdges(new HashSet<>(collapsibleGraph.getEdges()), new CollapsibleCriteria[] { collapseMe });
		for (Edge edge : edges) {
			assertEquals("nodes", edge.getNamespace());
			if (edge.getId().equals("e1")) {
				assertEquals("nodes", edge.getSource().getVertex().getNamespace());
				assertEquals("g0", edge.getSource().getVertex().getId());
				assertEquals("nodes", edge.getTarget().getVertex().getNamespace());
				assertEquals("g1", edge.getTarget().getVertex().getId());
			} else if (edge.getId().equals("collapsedTarget-e2")) {
				assertEquals("nodes", edge.getSource().getVertex().getNamespace());
				assertEquals("g0", edge.getSource().getVertex().getId());
				assertEquals("category", edge.getTarget().getVertex().getNamespace());
				assertEquals("c", edge.getTarget().getVertex().getId());
			} else if (edge.getId().equals("e3")) {
				assertEquals("nodes", edge.getSource().getVertex().getNamespace());
				assertEquals("g1", edge.getSource().getVertex().getId());
				assertEquals("nodes", edge.getTarget().getVertex().getNamespace());
				assertEquals("v1", edge.getTarget().getVertex().getId());
			} else if (edge.getId().equals("e4")) {
				assertEquals("nodes", edge.getSource().getVertex().getNamespace());
				assertEquals("g1", edge.getSource().getVertex().getId());
				assertEquals("nodes", edge.getTarget().getVertex().getNamespace());
				assertEquals("v2", edge.getTarget().getVertex().getId());
			} else if (edge.getId().equals("collapsedSource-e5")) {
				assertEquals("category", edge.getSource().getVertex().getNamespace());
				assertEquals("c", edge.getSource().getVertex().getId());
				assertEquals("nodes", edge.getTarget().getVertex().getNamespace());
				assertEquals("v3", edge.getTarget().getVertex().getId());
			} else if (edge.getId().equals("collapsedSource-e6")) {
				assertEquals("category", edge.getSource().getVertex().getNamespace());
				assertEquals("c", edge.getSource().getVertex().getId());
				assertEquals("nodes", edge.getTarget().getVertex().getNamespace());
				assertEquals("v4", edge.getTarget().getVertex().getId());
			} else {
				fail("Unexpected edge found: " + edge.toString());
			}
		}
	}

