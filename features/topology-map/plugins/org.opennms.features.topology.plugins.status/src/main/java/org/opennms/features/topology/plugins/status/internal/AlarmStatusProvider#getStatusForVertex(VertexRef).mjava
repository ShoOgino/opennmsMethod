    @Override
    public Status getStatusForVertex(VertexRef vertex) {
        
        if(vertex.getNamespace().equals("nodes")) {
            int nodeId = Integer.valueOf(vertex.getId());
            
            CriteriaBuilder builder = new CriteriaBuilder(OnmsAlarm.class);
            builder.alias("node", "node");
            builder.eq("node.id", nodeId);
            builder.ge("severity", OnmsSeverity.WARNING);
            builder.orderBy("severity").desc();
            builder.limit(1);
            
            
            final List<OnmsAlarm> alarms = m_alarmDao.findMatching(builder.toCriteria());
            if(alarms != null && alarms.size() == 1) {
                final OnmsAlarm alarm = alarms.get(0);
                final OnmsSeverity severity = alarm.getSeverity();
                Status vertexStatus = new AlarmStatus(severity.getId(), severity.getLabel());
                return vertexStatus;
            } else {
                return createNormalStatus();
            }
        } else {
            return createNormalStatus();
        }
        
       
    }

