    /**
     * In order to build a valid hierarchy, each{@link org.opennms.features.topology.plugins.topo.asset.layers.LayerDefinition}
     * must ensure that the value for each node IS NOT null.
     * To let the database do the filtering, a {@link org.opennms.features.topology.plugins.topo.asset.layers.definition.Restriction}
     * annotation must be present.
     * This tests ensures that each defined {@link org.opennms.features.topology.plugins.topo.asset.layers.LayerDefinition} actually provides a restriction and that the {@link org.opennms.features.topology.plugins.topo.asset.layers.definition.Restriction} works as expected.
     */
    @Test
    public void verifyLayerRestrictions() throws Exception {
        List<LayerMapping.Mapping> mapping = new LayerMapping().getMapping(NodeParamLabels.ALL_KEYS);
        Assert.assertEquals(NodeParamLabels.ALL_KEYS.size(), Layers.values().length);
        Assert.assertEquals(Layers.values().length, mapping.size());

        final List<OnmsNode> nodes = new PersistenceDataProvider(genericPersistenceAccessor).getNodes(mapping);
        Assert.assertEquals(1, nodes.size());
        OnmsNode actualNode = nodes.get(0);
        OnmsNode expectedNode = nodeDao.findByLabel("Node 2").get(0);
        Assert.assertEquals(expectedNode.getId(), actualNode.getId());

    }

