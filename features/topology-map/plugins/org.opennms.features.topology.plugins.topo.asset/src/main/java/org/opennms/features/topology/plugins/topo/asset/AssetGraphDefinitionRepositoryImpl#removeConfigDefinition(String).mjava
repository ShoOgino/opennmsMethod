	/* (non-Javadoc)
	 * @see org.opennms.features.topology.plugins.topo.asset.AssetGraphDefinitionRepository#removeConfigDefinition(java.lang.String)
	 */
	@Override
	public void removeConfigDefinition(String providerId){
		String propId=DEFINITION_PREFIX+providerId;

		Configuration config;
		try {
			config = configurationAdmin.getConfiguration(persistentId);
			Dictionary<String, Object> props = config.getProperties();

			// if null, there is no configuration
			if (props == null) return;

			props.remove(propId);
			config.update(props);
			
			// TODO WORK AROUND for KARAF 2.4 ISSUE writing directly to file instead of through ConfigAdmin service 
			// Work around here because ConfigAdmin service can only add properties and not remove them from a cfg file
			// This might be solvable by setting config type append=false in features.xml. 
			// But this cannot be parsed by opennms's maven-features-plugin
			// see line 296 org.apache.karaf.features.internal.service.FeatureConfigInstaller
			// the FILEINSTALL_FILE_NAME is set by the <cm:property-placeholder in blueprint.xml

			String cfgFile = (String) props.get(FILEINSTALL_FILE_NAME);
			if(cfgFile!=null){
				File cfg = new File(new URL(cfgFile).toURI());
				
				Properties javaProps = new Properties();
				Enumeration<String> keys = props.keys();
				while(keys.hasMoreElements()){
					String propKey = keys.nextElement();
					javaProps.put(propKey, (String) props.get(propKey));
				}
				
				Writer out = new FileWriter(cfg);
				javaProps.store(out, "# Asset Topology Configurations updated this file");
			}

		} catch (Exception e) {
			throw new RuntimeException("problem removing graph definition "+propId+ " from "+persistentId+".cfg",e);
		}
	}

