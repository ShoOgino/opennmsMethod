	/**
	 * Generates and installs a new AssetTopology defined by the config
	 * @param config if null the default config is used
	 */
	public synchronized void createAssetTopology(GeneratorConfig config){
		Objects.requireNonNull(config);
		try {
			LOG.debug("Creating Asset Topology providerId: {}, label: {}, config: {}", config.getProviderId(), config.getLabel(), config);
			if (graphmlRepository.exists("asset")) {
				throw new IllegalStateException(String.format("Provider with id '%s' (label: %s) already exists", config.getProviderId(), config.getLabel()));
			}
			final GraphML graphML = transactionOperations.execute(status -> new AssetGraphGenerator(nodeProvider).generateGraphs(config));
			final GraphmlType graphmlType = GraphMLWriter.convert(graphML);
			graphmlRepository.save(config.getProviderId(), config.getLabel(), graphmlType);
		} catch (Exception ex){
			LOG.error("Could not create Asset Topology", ex);
			throw new RuntimeException(ex);
		}
	}

