    @Override
    public Map<VertexRef, Status> getStatusForVertices(BackendGraph graph, Collection<VertexRef> vertices, Criteria[] criteria) {
        Map<VertexRef, Status> returnMap = new HashMap<>();
        Map<Integer, Status> statusMap = new HashMap<>();

        List<MonitoredServiceStatusEntity> result = applicationDao.getAlarmStatus();
        for (MonitoredServiceStatusEntity eachRow : result) {
            DefaultStatus status = createStatus(eachRow.getSeverity(), eachRow.getCount());
            statusMap.put(eachRow.getNodeId(), status);
        }

        // status for all known node ids
        Collection<VertexRef> vertexRefsForNamespace = getVertexRefsForNamespace(vertices);
        Collection<VertexRef> vertexRefsRoot = getRootElements(vertexRefsForNamespace);
        Collection<VertexRef> vertexRefs = new ArrayList<>(vertexRefsForNamespace);
        vertexRefs.removeAll(vertexRefsRoot);

        // calculate status for children
        for (VertexRef eachVertex : vertexRefs) {
            LegacyApplicationVertex applicationVertex = (LegacyApplicationVertex) eachVertex;
            Status alarmStatus = statusMap.get(applicationVertex.getNodeID());
            if (alarmStatus == null) {
                alarmStatus = createStatus(OnmsSeverity.NORMAL, 0);
            }
            returnMap.put(eachVertex, alarmStatus);
        }

        // calculate status for root
        for (VertexRef eachRoot : vertexRefsRoot) {
            LegacyApplicationVertex eachRootApplication = (LegacyApplicationVertex) eachRoot;
            OnmsSeverity maxSeverity = OnmsSeverity.NORMAL;
            int count = 0;
            for (VertexRef eachChild : eachRootApplication.getChildren()) {
                LegacyApplicationVertex eachChildApplication = (LegacyApplicationVertex) eachChild;
                Integer childKey = eachChildApplication.getNodeID();
                Status childStatus = statusMap.get(childKey);
                if (childStatus != null && maxSeverity.isLessThan(createSeverity(childStatus.computeStatus()))) {
                    maxSeverity = createSeverity(childStatus.computeStatus());
                    count = Integer.parseInt(childStatus.getStatusProperties().get("statusCount"));
                }
            }
            returnMap.put(eachRoot, createStatus(maxSeverity, count));
        }

        return returnMap;
    }

