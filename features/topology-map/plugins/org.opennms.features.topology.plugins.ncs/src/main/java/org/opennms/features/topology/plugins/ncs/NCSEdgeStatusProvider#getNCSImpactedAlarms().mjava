    private Set<String> getNCSImpactedAlarms() {
        org.opennms.core.criteria.Criteria criteria = new org.opennms.core.criteria.Criteria(OnmsAlarm.class);
        criteria.addRestriction(new EqRestriction("uei", "uei.opennms.org/internal/ncs/componentImpacted"));

        List<OnmsAlarm> alarms = getAlarmDao().findMatching(criteria);


        Set<String> alarmsSet = new HashSet<String>();

        for (OnmsAlarm alarm : alarms) {

            String eventParms = alarm.getEventParms();
            Matcher foreignSourceMatcher = m_foreignSourcePattern.matcher(eventParms);
            Matcher foreignIdMatcher = m_foreignIdPattern.matcher(eventParms);

            String foreignSource = null;
            while (foreignSourceMatcher.find()) {
                foreignSource = foreignSourceMatcher.group(1);
            }

            String foreignId = null;
            while (foreignIdMatcher.find()) {
                foreignId = foreignIdMatcher.group(1);
            }


            if (foreignSource != null && foreignId != null) {
                alarmsSet.add(foreignSource + "::" + foreignId);
            }

        }

        return alarmsSet;
    }

