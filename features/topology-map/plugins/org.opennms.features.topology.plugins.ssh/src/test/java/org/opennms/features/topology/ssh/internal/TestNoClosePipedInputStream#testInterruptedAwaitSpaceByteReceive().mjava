    @Test 
    public void testInterruptedAwaitSpaceByteReceive() throws IOException {
        // This test creates a thread to test the waiting that the buffer
        // performs when it is either full or empty. This test gets into the
        // awaitSpace() method because the read position and write position are
        // the same, and should time out due to the fact that neither the 
        // read position nor the write position change. The timeout will cause
        // this test to pass.
        
        in.connect(out);
        in.in=1;
        in.out=1;
        boolean waited = false;
      
        Thread thread = new Thread(new Runnable() {
            @Override
            public void run() {
                try {
                    in.receive(testByte, 0, 1);
                } catch (IOException e) {
                    fail("Pipe not Connected");
                } 
            }
        });
        
        thread.start();
        long endTimeMillis = System.currentTimeMillis() + 3000;
        while (thread.isAlive()) {
            if (System.currentTimeMillis() > endTimeMillis) {
                waited = true;
                thread.interrupt();
                break;
            }
            try {
                Thread.sleep(500);
                in.in++;
            }
            catch (InterruptedException t) {
                // The thread should be interrupted, but this should not cause problems.
            }
        }
        assertEquals(false, waited);
    }

