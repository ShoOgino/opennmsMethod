    @Test
    public void testInterruptedAwaitSpaceIntRead() throws IOException, InterruptedException {
        // This test creates a thread to test the waiting that the buffer
        // performs when it is either full or empty. This test gets into the
        // awaitSpace() method because the read position and write position are
        // the same, and should time out due to the fact that neither the 
        // read position nor the write position change. The timeout will cause
        // this test to pass.

        in.connect(out);
        in.in = -1;
        in.out = 1;
        final CountDownLatch latch = new CountDownLatch(1);

        Thread thread = new Thread(new Runnable() {
            @Override
            public void run() {
                try {
                    in.read();
                    latch.countDown();
                    Thread.currentThread().interrupt();
                } catch (IOException e) {
                    e.printStackTrace();
                } 
            }
        });

        long endTime = System.currentTimeMillis();
        thread.start();
        in.in++;
        if(endTime - System.currentTimeMillis() > 1000){
            fail("The inside thread should have been interrupted");
        }
    }

