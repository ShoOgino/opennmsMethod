    private void addVertex(BusinessServiceGraph graph, GraphVertex graphVertex, AbstractBusinessServiceVertex topologyVertex) {
        if (topologyVertex == null) {
            // Create a topology vertex for the current vertex
            topologyVertex = createTopologyVertex(graphVertex);
            addVertices(topologyVertex);
        }

        for (GraphEdge graphEdge : graph.getOutEdges(graphVertex)) {
            GraphVertex childVertex = graph.getOpposite(graphVertex, graphEdge);

            // Create a topology vertex for the child vertex
            AbstractBusinessServiceVertex childToplogyVertex = createTopologyVertex(childVertex);
            graph.getInEdges(childVertex).stream()
                    .map(GraphEdge::getFriendlyName)
                    .filter(s -> !Strings.isNullOrEmpty(s))
                    .findFirst()
                    .ifPresent(childToplogyVertex::setLabel);

            addVertices(childToplogyVertex);

            // Connect the two
            childToplogyVertex.setParent(topologyVertex);
            Edge edge = createTopologyEdge(topologyVertex, childToplogyVertex);
            addEdges(edge);

            // Recurse
            addVertex(graph, childVertex, childToplogyVertex);
        }
    }

