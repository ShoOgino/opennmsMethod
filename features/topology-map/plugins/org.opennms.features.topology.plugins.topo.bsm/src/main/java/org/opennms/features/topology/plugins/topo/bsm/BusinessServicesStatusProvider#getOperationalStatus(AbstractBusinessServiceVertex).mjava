    private org.opennms.netmgt.bsm.service.model.Status getOperationalStatus(AbstractBusinessServiceVertex vertex) {
        if (vertex.getType() == AbstractBusinessServiceVertex.Type.BusinessService) {
            BusinessServiceVertex bsVertex = (BusinessServiceVertex) vertex;
            return businessServiceManager.getBusinessServiceById(bsVertex.getServiceId()).getOperationalStatus();
        }
        if (vertex.getType() == AbstractBusinessServiceVertex.Type.IpService) {
            IpServiceVertex ipServiceVertex = (IpServiceVertex) vertex;
            return businessServiceManager.getIpServiceById(ipServiceVertex.getIpServiceId()).getOperationalStatus();
        }
        if (vertex.getType() == AbstractBusinessServiceVertex.Type.ReductionKey) {
            ReductionKeyVertex rkVertex = (ReductionKeyVertex) vertex;
            return businessServiceManager.getOperationalStatusForReductionKey(rkVertex.getReductionKey());
        }
        throw new IllegalStateException("Unsupported BusinessServiceVertex type: " + vertex.getClass());
    }

