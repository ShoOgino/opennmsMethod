    private org.opennms.netmgt.bsm.service.model.Status getOperationalStatus(AbstractBusinessServiceVertex vertex) {
        if (vertex instanceof BusinessServiceVertex) {
            BusinessServiceVertex bsVertex = (BusinessServiceVertex) vertex;
            return businessServiceManager.getBusinessServiceById(bsVertex.getServiceId()).getOperationalStatus();
        }
        if (vertex instanceof IpServiceVertex) {
            IpServiceVertex ipServiceVertex = (IpServiceVertex) vertex;
            return businessServiceManager.getIpServiceById(ipServiceVertex.getIpServiceId()).getOperationalStatus();
        }
        if (vertex instanceof ReductionKeyVertex) {
            ReductionKeyVertex rkVertex = (ReductionKeyVertex) vertex;
            return businessServiceManager.getOperationalStatusForReductionKey(rkVertex.getReductionKey());
        }
        throw new IllegalStateException("Unsupported BusinessServiceVertex type: " + vertex.getClass());
    }

