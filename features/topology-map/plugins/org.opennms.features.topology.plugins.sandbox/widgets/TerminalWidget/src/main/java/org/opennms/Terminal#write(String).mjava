    public synchronized boolean write(String d) {
        d = utf8_decode(d);
        for (int c : d.toCharArray()) {
            if (vt100_write(c)) {
                continue;
            }
            if (dumb_write(c)) {
                continue;
            }
            if (c <= 0xffff) {
                dumb_echo(c);
            }
        }
        return true;
    }

