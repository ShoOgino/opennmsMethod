  private void connect(){
    si.setText("Connecting to "+user+"@"+host+"...");
    nextScreen=display.getCurrent();

    try{
      Session session=null;
      try{ session=getSession(user, host); }
      catch(JSchException ee){
	//System.out.println(ee);
	si.setText("No connection");
	f.addCommand(connectCommand);
	f.addCommand(clearKeyCommand);
	display.setCurrent(f);
	return;
      } 
      si.setText("Connected to "+user+"@"+host);

      f.addCommand(connectCommand);
      f.addCommand(clearKeyCommand);
      display.setCurrent(f);

      if(choice.isSelected(0)){
	installPKey(session);
      }
      else{
	canvas.setTitle("JCTerm: "+user+"@"+host);
	display.setCurrent(canvas);
	canvas.initGraphics();

	channel=session.openChannel("shell");
	out=channel.getOutputStream();
	in=channel.getInputStream();
	channel.connect();

	((ChannelShell)channel).setPtySize(canvas.getColumnCount(),
					   canvas.getRowCount()-1,
					   canvas.getWidth(),
					   canvas.getHeight());

	emulator=new EmulatorVT100(canvas, in);
	emulator.reset();
	canvas.setOutputStream(out);
	emulator.start();
	channel.disconnect();
	f.addCommand(connectCommand);
	f.addCommand(clearKeyCommand);
	display.setCurrent(f);
      }
    }
    catch(Exception e){
      //System.err.println(e);
    }
  }

