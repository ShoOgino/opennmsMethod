    private void buildMainLayout() {
        setMainWindow(new Window("Topology Maps"));
        getMainWindow().setImmediate(true);
        mainLayout = new VerticalLayout();
        mainLayout.setSizeFull();
        mainLayout.addComponent(createMenuBar());
        mainLayout.addComponent(horizontalSplit);
        leftLayout.setSizeFull();
        rightLayout.setSizeFull();
        leftLayout.addComponent(cartman);
        rightLayout.addComponent(butters);
        horizontalSplit.setFirstComponent(leftLayout);
        horizontalSplit.setSecondComponent(rightLayout);
        buildContextMenus();
        leftLayout.addListener(new LayoutClickListener() {

            public void layoutClick(LayoutClickEvent event) {
                if (LayoutClickEvent.BUTTON_RIGHT == event.getButton()) {
                    cartmanMenu.show(event.getClientX(), event.getClientY());
                }
            }

        });
        rightLayout.addListener(new LayoutClickListener() {

            public void layoutClick(LayoutClickEvent event) {
                if (LayoutClickEvent.BUTTON_RIGHT == event.getButton()) {
                    buttersMenu.show(event.getClientX(), event.getClientY());
                }
            }

        });
        /* Allocate all available extra space to the horizontal split panel */
        mainLayout.setExpandRatio(horizontalSplit, 1);

        getMainWindow().setContent(mainLayout);
        getMainWindow().addComponent(cartmanMenu);
        getMainWindow().addComponent(buttersMenu);
    }

