  public void setSize(int w, int h){

    super.setSize(w, h);

    if(img==null){
      initGraphics();
    }

    Image imgOrg=img;
    if(graphics!=null)
      graphics.dispose();

    int column=w/getCharWidth();
    int row=h/getCharHeight();

    term_width=column;
    term_height=row;

    if(emulator!=null)
      emulator.reset();

    img=new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
    graphics=(Graphics2D)(img.getGraphics());
    graphics.setFont(font);

    clear_area(0, 0, w, h);

    if(imgOrg!=null){
      Shape clip=graphics.getClip();
      graphics.setClip(0, 0, getTermWidth(), getTermHeight());
      graphics.drawImage(imgOrg, 0, 0, term_area);
      graphics.setClip(clip);
    }

    if(cursor_graphics!=null)
      cursor_graphics.dispose();

    cursor_graphics=(Graphics2D)(img.getGraphics());
    cursor_graphics.setColor(getForeGround());
    cursor_graphics.setXORMode(getBackGround());

    setAntiAliasing(antialiasing);

    if(connection!=null){
      connection.requestResize(this);
    }

    if(imgOrg!=null){
      imgOrg.flush();
      imgOrg=null;
    }

  }

