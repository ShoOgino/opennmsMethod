  private byte[] install32(String mapname, COPYDATASTRUCT32 cds){
    cds.dwData = 0x804e50ba;  // AGENT_COPYDATA_ID
    cds.cbData = mapname.length()+1;
    cds.lpData = new Memory(mapname.length()+1);
    {
      byte[] foo = mapname.getBytes();
      cds.lpData.write(0, foo, 0, foo.length);
      cds.lpData.setByte(foo.length, (byte)0);
      cds.write();
    }
    byte[] data = new byte[12];
    Pointer cdsp = cds.getPointer();
    cdsp.read(0, data, 0, 12);
    return data;
  }

