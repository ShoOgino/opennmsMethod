  public Vector<com.jcraft.jsch.Identity> getIdentities() {
    Vector<com.jcraft.jsch.Identity> result = 
     new Vector<com.jcraft.jsch.Identity>(); 

    Identity[] identities = agent.getIdentities();

    for(int i=0; i<identities.length; i++){

      final Identity _identity = identities[i];

      com.jcraft.jsch.Identity id = new com.jcraft.jsch.Identity(){
        byte[] blob = _identity.getBlob();
        String algname = new String((new Buffer(blob)).getString());
        public boolean setPassphrase(byte[] passphrase) throws JSchException{
          return true;
        }
        public byte[] getPublicKeyBlob() { return blob; }
        public byte[] getSignature(byte[] data){
          return agent.sign(blob, data);
        }
        public boolean decrypt() { return true; }
        public String getAlgName() { return algname; }
        public String getName() { return new String(_identity.getComment()); }
        public boolean isEncrypted() { return false; }
        public void clear() { }
      };

      result.addElement(id);
    }

    return result;
  }

