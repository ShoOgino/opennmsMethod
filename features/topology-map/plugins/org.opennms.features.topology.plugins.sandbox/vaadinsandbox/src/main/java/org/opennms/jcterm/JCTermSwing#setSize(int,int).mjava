  public void setSize(int w, int h){

    super.setSize(w, h);
    BufferedImage imgOrg=img;
    if(graphics!=null)
      graphics.dispose();

    int column=w/getCharWidth();
    int row=h/getCharHeight();
    term_width=column;
    term_height=row;

    if(emulator!=null)
      emulator.reset();

    img=new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
    graphics=(Graphics2D)(img.getGraphics());
    graphics.setFont(font);

    clear_area(0, 0, w, h);
    redraw(0, 0, w, h);

    if(imgOrg!=null){
      Shape clip=graphics.getClip();
      graphics.setClip(0, 0, getTermWidth(), getTermHeight());
      graphics.drawImage(imgOrg, 0, 0, term_area);
      graphics.setClip(clip);
    }

    resetCursorGraphics();

    setAntiAliasing(antialiasing);

    if(connection!=null){
      connection.requestResize(this);
    }

    if(imgOrg!=null){
      imgOrg.flush();
      imgOrg=null;
    }
  }

