  private Vector glob_remote(String _path) throws Exception{
    Vector v=new Vector();
    int i=0;

    int foo=_path.lastIndexOf('/');
    if(foo<0){  // it is not absolute path.
      v.addElement(Util.unquote(_path)); 
      return v;
    }

    String dir=_path.substring(0, ((foo==0)?1:foo));
    String _pattern=_path.substring(foo+1);

    dir=Util.unquote(dir);

    byte[] pattern=null;
    byte[][] _pattern_utf8=new byte[1][];
    boolean pattern_has_wildcard=isPattern(_pattern, _pattern_utf8);

    if(!pattern_has_wildcard){
      if(!dir.equals("/"))
        dir+="/";
      v.addElement(dir+Util.unquote(_pattern));
      return v;
    }

    pattern=_pattern_utf8[0];

    sendOPENDIR(Util.str2byte(dir, fEncoding));

    Header header=new Header();
    header=header(buf, header);
    int length=header.length;
    int type=header.type;

    fill(buf, length);

    if(type!=SSH_FXP_STATUS && type!=SSH_FXP_HANDLE){
      throw new SftpException(SSH_FX_FAILURE, "");
    }
    if(type==SSH_FXP_STATUS){
      i=buf.getInt();
      throwStatusError(buf, i);
    }

    byte[] handle=buf.getString();         // filename
    String pdir=null;                      // parent directory

    while(true){
      sendREADDIR(handle);
      header=header(buf, header);
      length=header.length;
      type=header.type;

      if(type!=SSH_FXP_STATUS && type!=SSH_FXP_NAME){
	throw new SftpException(SSH_FX_FAILURE, "");
      }
      if(type==SSH_FXP_STATUS){ 
        fill(buf, length);
	break;
      }

      buf.rewind();
      fill(buf.buffer, 0, 4); length-=4;
      int count=buf.getInt();

      byte[] str;
      int flags;

      buf.reset();
      while(count>0){
	if(length>0){
	  buf.shift();
          int j=(buf.buffer.length>(buf.index+length)) ? length : (buf.buffer.length-buf.index);
	  i=io_in.read(buf.buffer, buf.index, j);
	  if(i<=0)break;
	  buf.index+=i;
	  length-=i;
	}

	byte[] filename=buf.getString();
	//System.err.println("filename: "+new String(filename));
        if(server_version<=3){
          str=buf.getString();  // longname
        }
	SftpATTRS attrs=SftpATTRS.getATTR(buf);

        byte[] _filename=filename;
        String f=null;
        boolean found=false;

        if(!fEncoding_is_utf8){
          f=Util.byte2str(filename, fEncoding);
          _filename=Util.str2byte(f, UTF8);
        }
        found=Util.glob(pattern, _filename);

	if(found){
          if(f==null){
            f=Util.byte2str(filename, fEncoding);
          }
          if(pdir==null){
            pdir=dir;
            if(!pdir.endsWith("/")){
              pdir+="/";
            }
          }
	  v.addElement(pdir+f);
	}
	count--; 
      }
    }
    if(_sendCLOSE(handle, header)) 
      return v;
    return null;
  }

