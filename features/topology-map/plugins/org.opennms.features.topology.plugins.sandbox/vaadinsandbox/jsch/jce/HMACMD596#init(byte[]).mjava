  public void init(byte[] key) throws Exception{
    if(key.length>16){
      byte[] tmp=new byte[16];
      System.arraycopy(key, 0, tmp, 0, 16);	  
      key=tmp;
    }
    SecretKeySpec skey=new SecretKeySpec(key, "HmacMD5");
    mac=Mac.getInstance("HmacMD5");
    mac.init(skey);
  } 

