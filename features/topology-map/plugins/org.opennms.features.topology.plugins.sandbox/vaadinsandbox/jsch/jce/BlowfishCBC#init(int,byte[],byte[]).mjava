  public void init(int mode, byte[] key, byte[] iv) throws Exception{
    String pad="NoPadding";      
//  if(padding) pad="PKCS5Padding";
    byte[] tmp;
    if(iv.length>ivsize){
      tmp=new byte[ivsize];
      System.arraycopy(iv, 0, tmp, 0, tmp.length);
      iv=tmp;
    }
    if(key.length>bsize){
      tmp=new byte[bsize];
      System.arraycopy(key, 0, tmp, 0, tmp.length);
      key=tmp;
    }
    try{
      SecretKeySpec skeySpec = new SecretKeySpec(key, "Blowfish");
      cipher=javax.crypto.Cipher.getInstance("Blowfish/CBC/"+pad);
      cipher.init((mode==ENCRYPT_MODE?
		   javax.crypto.Cipher.ENCRYPT_MODE:
		   javax.crypto.Cipher.DECRYPT_MODE),
		  skeySpec, new IvParameterSpec(iv));
    }
    catch(Exception e){
      throw e;
    }
  }

