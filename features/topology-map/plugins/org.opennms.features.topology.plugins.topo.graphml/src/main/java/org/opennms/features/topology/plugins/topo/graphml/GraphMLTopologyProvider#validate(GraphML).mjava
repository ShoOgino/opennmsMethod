    private void validate(GraphML graphML) throws InvalidGraphException {
        final List<String> nodeIds = new ArrayList<>();
        final List<String> edgeIds = new ArrayList<>();
        final List<String> graphIds = new ArrayList<>();
        final String namespace = graphML.getProperty(GraphMLProperties.NAMESPACE);

        if (Strings.isNullOrEmpty(namespace)) {
            throw new InvalidGraphException("No namespace defined for type 'GraphML'");
        }

        for (GraphMLGraph eachGraph : graphML.getGraphs()) {
            validateNamespace(namespace, eachGraph.getProperty(GraphMLProperties.NAMESPACE));

            if (graphIds.contains(eachGraph.getId())) {
                throw new InvalidGraphException("There already exists a graph with id " + eachGraph.getId());
            }
            graphIds.add(eachGraph.getId());

            for (GraphMLNode eachNode : eachGraph.getNodes()) {
                validateNamespace(namespace, eachNode.getProperty(GraphMLProperties.NAMESPACE));
                if (nodeIds.contains(eachNode.getId())) {
                    throw new InvalidGraphException("There already exists a node with id " + eachNode.getId());
                }
                nodeIds.add(eachNode.getId());
            }
            for (org.opennms.features.topology.plugins.topo.graphml.model.GraphMLEdge eachEdge : eachGraph.getEdges()) {
                validateNamespace(namespace, eachEdge.getProperty(GraphMLProperties.NAMESPACE));
                if (edgeIds.contains(eachEdge.getId())) {
                    throw new InvalidGraphException("There already exists an edge with id " + eachEdge.getId());
                }
                edgeIds.add(eachEdge.getId());
            }
        }
    }

