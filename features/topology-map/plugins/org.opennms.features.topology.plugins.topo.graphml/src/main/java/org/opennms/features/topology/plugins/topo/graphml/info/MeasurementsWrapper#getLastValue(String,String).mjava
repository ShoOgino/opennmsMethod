    public double getLastValue(final String resource, final String attribute) {
        QueryResponse.WrappedPrimitive[] columns = query(resource, attribute).getColumns();
        LOG.debug("MEASUREMENTS: Received {} columns", columns.length);
        if (columns.length > 0) {
            double[] values = columns[0].getList();
            LOG.debug("MEASUREMENTS: First columns has {} entries", values.length);
            if (values.length > 0) {
                for(int i = values.length-1; i >= 0; i--) {
                    LOG.warn("MEASUREMENTS: Entry[{}] = {}", i, values[i]);
                    if (!Double.isNaN(values[i])) {
                        return values[i];
                    }
                }
            }
        }
        return Double.NaN;
    }

