    private void testAmounts(TopologyGenerator.Protocol protocol) throws OnmsTopologyException {

        TopologySettings settings = TopologySettings.builder()
                .protocol(protocol)
                .build();

        // 1.) Generate topology and verify that the TopologyProvider finds it:
        generator.generateTopology(settings);
        verifyAmounts(settings);

        // 2.) Delete the topology. The TopologyProvider should still find it due to the cache:
        generator.deleteTopology();
        verifyAmounts(settings);

        // 3.) Invalidate cache - nothing should be found:
        entityCache.refresh();
        refresh();
        assertEquals(0, linkdTopologyProvider.getVerticesWithoutGroups().size());
    }

