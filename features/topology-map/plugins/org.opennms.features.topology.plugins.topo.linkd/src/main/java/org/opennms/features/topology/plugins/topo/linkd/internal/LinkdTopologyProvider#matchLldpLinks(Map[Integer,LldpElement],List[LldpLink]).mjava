    List<Pair<LldpLink, LldpLink>> matchLldpLinks(Map<Integer, LldpElement> nodelldpelementidMap, List<LldpLink> allLinks) {
        List<Pair<LldpLink, LldpLink>> results = new ArrayList<>();

        // 1.) create mapping
        Map<CompositeKey, LldpLink> targetLinkMap = new HashMap<>();
        for(LldpLink targetLink : allLinks){

            CompositeKey key = new CompositeKey(
                    targetLink.getLldpRemChassisId(),
                    nodelldpelementidMap.get(targetLink.getNode().getId()).getLldpChassisId(),
                    targetLink.getLldpPortId(),
                    targetLink.getLldpPortIdSubType(),
                    targetLink.getLldpRemPortId(),
                    targetLink.getLldpRemPortIdSubType());
            targetLinkMap.put(key, targetLink);
        }

        // 2.) iterate
        Set<Integer> parsed = new HashSet<Integer>();
        for (LldpLink sourceLink : allLinks) {
            if (parsed.contains(sourceLink.getId())) {
                continue;
            }
            String sourceLldpChassisId = nodelldpelementidMap.get(sourceLink.getNode().getId()).getLldpChassisId();
            if (sourceLldpChassisId.equals(sourceLink.getLldpRemChassisId())) {
                if (LOG.isDebugEnabled()) {
                    LOG.debug("getLldpLinks: self link not adding source: {}",sourceLink.toString());
                }
                parsed.add(sourceLink.getId());
                continue;
            }
            if (LOG.isDebugEnabled()) {
                LOG.debug("getLldpLinks: source: {}",sourceLink.toString());
            }

            CompositeKey key = new CompositeKey(
                    nodelldpelementidMap.get(sourceLink.getNode().getId()).getLldpChassisId(),
                    sourceLink.getLldpRemChassisId(),
                    sourceLink.getLldpRemPortId(),
                    sourceLink.getLldpRemPortIdSubType(),
                    sourceLink.getLldpPortId(),
                    sourceLink.getLldpPortIdSubType());
            LldpLink targetLink = targetLinkMap.get(key);

            if (targetLink == null) {
                LOG.debug("getLldpLinks: cannot found target for source: '{}'", sourceLink.getId());
                continue;
            }

            if (LOG.isDebugEnabled()) {
                LOG.debug("getLldpLinks: lldp: {} target: {}", sourceLink.getLldpRemChassisId(), targetLink.toString());
            }

            parsed.add(sourceLink.getId());
            parsed.add(targetLink.getId());
            results.add(Pair.of(sourceLink, targetLink));
        }
        return results;
    }

