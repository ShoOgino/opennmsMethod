    @Override
    protected Set<Integer> getLinkIds(Map<String, EdgeRef> mappedRefs) {
        List<BridgeMacTopologyLink> bridgeMacLinks = m_bridgeMackLinkDao.getAllBridgeLinksToIpAddrToNodes();

        Multimap<String, BridgeMacTopologyLink> multimap = HashMultimap.create();
        for (BridgeMacTopologyLink macLink : bridgeMacLinks) {
            multimap.put(String.valueOf(macLink.getNodeId()) + "|" +String.valueOf(macLink.getBridgePort()), macLink);
        }

        if(m_multimapLinks == null){
            m_multimapLinks = HashMultimap.create();
        }
        m_multimapLinks.clear();

        Set<Integer> ret_val = new HashSet<Integer>();
        for (String key : multimap.keySet()) {
            Collection<BridgeMacTopologyLink> links = multimap.get(key);

            BridgeMacTopologyLink link = links.iterator().next();
            ret_val.add(link.getId());
            m_multimapLinks.putAll(key, links);

        }

        return ret_val;
    }

