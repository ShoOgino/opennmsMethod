    @Override
    protected Set<Integer> getLinkIds(Map<String, EdgeRef> mappedRefs) {
        List<BridgeMacTopologyLink> bridgeMacLinks = m_bridgeMackLinkDao.getAllBridgeLinksToIpAddrToNodes();

        Multimap<String, BridgeMacTopologyLink> multimap = HashMultimap.create();
        for (BridgeMacTopologyLink macLink : bridgeMacLinks) {
            String idKey = String.valueOf(macLink.getNodeId()) + "|" + String.valueOf(macLink.getBridgePort());
            if (mappedRefs.containsKey(idKey) && macLink.getTargetNodeId() != null && macLink.getSourceIfIndex() != null) {
                multimap.put(idKey, macLink);
            }

        }

        if(m_multimapLinks == null){
            m_multimapLinks = HashMultimap.create();
        }
        m_multimapLinks.clear();
        m_multimapLinks.putAll(multimap);

        Set<Integer> ret_val = new HashSet<Integer>();
        for (String key : multimap.keySet()) {
            Collection<BridgeMacTopologyLink> links = multimap.get(key);
            for (BridgeMacTopologyLink link : links) {
                    ret_val.add(link.getId());
            }

        }

        return ret_val;
    }

