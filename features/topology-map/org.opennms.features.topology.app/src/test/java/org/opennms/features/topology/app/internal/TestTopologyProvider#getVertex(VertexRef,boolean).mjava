    private Vertex getVertex(VertexRef vertexId, boolean required) {
        Vertex item = getVertex(vertexId);
        if(required && item == null) {
            throw new IllegalArgumentException("required vertex " + vertexId + " not found");
        }
        return item;
    }

