    void updateScale(double oldScale, double newScale, SVGElement x, int cx, int cy) {
        // TODO: There is a calculation error in this code somewhere, it doesn't get the correct scale
        double zoomFactor = newScale/oldScale;
    	
        SVGElement svg = getSVGElement();
        SVGGElement g = getSVGViewPort().cast();
    
    	if(cx == 0 ) {
    		cx = (int) (Math.ceil(svg.getParentElement().getOffsetWidth() / 2.0) - 1);
    	}
    
    	if(cy == 0) {
    		cy = (int) (Math.ceil(svg.getParentElement().getOffsetHeight() / 2.0) -1);
    	}
    
    	SVGPoint p = svg.createSVGPoint();
    	p.setX(cx);
    	p.setY(cy);
    	p = p.matrixTransform(g.getCTM().inverse());
    	SVGMatrix m = svg.createSVGMatrix()
    			.translate(p.getX(),p.getY())
    			 .scale(zoomFactor)
    			.translate(-p.getX(), -p.getY());
    	SVGMatrix ctm = g.getCTM().multiply(m);
    	String tempM = matrixTransform(ctm);
    	D3.d3().select(getSVGViewPort()).transition().duration(1000).attr("transform", tempM);
    }

