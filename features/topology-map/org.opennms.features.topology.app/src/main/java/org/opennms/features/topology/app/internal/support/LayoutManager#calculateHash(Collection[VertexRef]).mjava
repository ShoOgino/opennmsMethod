    protected static String calculateHash(Collection<VertexRef> vertices) {
        final String vertexKey = vertices.stream()
                .sorted(Comparator.comparing(VertexRef::getNamespace).thenComparing(VertexRef::getId))
                .map(v -> String.format("%s:%s", v.getNamespace(), v.getId()))
                .collect(Collectors.joining(","));
        return Hashing.sha256().hashString(vertexKey, Charsets.UTF_8).toString();
    }

