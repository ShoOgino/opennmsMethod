    // Builds the menu
    public void buildMenu(GraphContainer graphContainer, UI mainWindow, CommandManager commandManager) {
        removeItems();

        final DefaultOperationContext operationContext = new DefaultOperationContext(mainWindow, graphContainer, OperationContext.DisplayLocation.MENUBAR);
        final MenuBarBuilder menuBarBuilder = new MenuBarBuilder();
        menuBarBuilder.setTopLevelMenuOrder(commandManager.getTopLevelMenuOrder());
        menuBarBuilder.setSubMenuGroupOrder(commandManager.getSubMenuGroupOrder());

        for (org.opennms.features.topology.app.internal.Command command : commandManager.getCommandList()) {
            String menuPosition = command.getMenuPosition();
            MenuBar.Command menuCommand = (Command) selectedItem -> {
                List<VertexRef> targets = new ArrayList<>(graphContainer.getSelectionManager().getSelectedVertexRefs());
                operationContext.setChecked(selectedItem.isChecked());
                command.doCommand(targets, operationContext);
                notifyMenuUpdateListener();
            };
            menuBarBuilder.addMenuCommand(menuCommand, menuPosition);
            commandToOperationMap.put(menuCommand, command.getOperation());
        }
        menuBarBuilder.apply(this);
    }

