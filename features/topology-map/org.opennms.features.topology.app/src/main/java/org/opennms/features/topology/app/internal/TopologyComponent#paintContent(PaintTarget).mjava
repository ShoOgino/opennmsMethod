    @Override
    public void paintContent(PaintTarget target) throws PaintException {
        super.paintContent(target);
        target.addAttribute("scale", (Double)m_scale.getValue());
        target.addAttribute("clientX", m_mapManager.getClientX());
        target.addAttribute("clientY", m_mapManager.getClientY());
        target.addAttribute("semanticZoomLevel", m_graphContainer.getSemanticZoomLevel());
        target.addAttribute("activeTool", m_activeTool);
        
        BoundingBox boundingBox = getBoundingBox();
        target.addAttribute("boundX", boundingBox.getX());
        target.addAttribute("boundY", boundingBox.getY());
        target.addAttribute("boundWidth", boundingBox.getWidth());
        target.addAttribute("boundHeight", boundingBox.getHeight());
        
        
        boolean panToSelection = getPanToSelection();
        target.addAttribute("panToSelection", panToSelection);
        m_panToManager.reset();
        
        target.addAttribute("fitToView", isFitToView());
        setFitToView(false);
        
		Graph graph = getGraph();

		GraphVisitor painter = new GraphPainter(m_graphContainer, graph.getLayout(), m_iconRepoManager, target);

		try {
			graph.visit(painter);
		} catch(PaintException e) {
			throw e;
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
        
        
    }

