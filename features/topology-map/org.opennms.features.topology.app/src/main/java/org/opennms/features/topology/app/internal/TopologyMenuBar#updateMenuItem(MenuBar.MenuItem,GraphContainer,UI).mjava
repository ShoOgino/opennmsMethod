    private void updateMenuItem(MenuBar.MenuItem menuItem, GraphContainer graphContainer, UI mainWindow) {
        try {
            final Operation operation = commandToOperationMap.get(menuItem.getCommand());
            // Check for null because separators have no Operation
            if(operation != null) {
                final DefaultOperationContext operationContext = new DefaultOperationContext(mainWindow, graphContainer, OperationContext.DisplayLocation.MENUBAR);
                final List<VertexRef> selectedVertices = new ArrayList<VertexRef>(graphContainer.getSelectionManager().getSelectedVertexRefs());
                final boolean visibility = operation.display(selectedVertices, operationContext);
                final boolean enabled = operation.enabled(selectedVertices, operationContext);

                menuItem.setVisible(visibility);
                menuItem.setEnabled(enabled);

                if (operation instanceof CheckedOperation) {
                    if (!menuItem.isCheckable()) {
                        menuItem.setCheckable(true);
                    }
                    menuItem.setChecked(((CheckedOperation) operation).isChecked(selectedVertices, operationContext));
                }
            }
        } catch (final RuntimeException e) {
            LoggerFactory.getLogger(this.getClass()).warn("updateMenuItem: operation failed", e);
        }
    }

