    @Test
    public void canEvaluteSystemDefinitionRules() throws UnknownHostException {
        OnmsNode node = mock(OnmsNode.class);
        CollectionAgent agent = mock(CollectionAgent.class);
        Definition config = new Definition();
        config.setProductVendor("Dell Inc.");
        config.setProductVersion(" iDRAC 6");

        SystemDefinition sysDef = new SystemDefinition();
        sysDef.addRule("#productVendor matches 'Dell.*' and #productVersion matches '.*DRAC.*'");
        
        assertTrue("agent should be matched", WSManDataCollectionConfigDaoJaxb.isAgentSupportedBySystemDefinition(sysDef, agent, config, node));
    }

