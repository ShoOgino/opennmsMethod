    public List<SystemDefinition> getSystemDefinitionsForCollection(Collection collection) {
        if (collection.getIncludeAllSystemDefinitions() != null) {
            // Return all available system definitions if requested
            return getConfig().getSystemDefinition();
        } else {
            // Map all of the available system definitions by name for easy lookup
            final Map<String, SystemDefinition> sysDefsByName = Maps.uniqueIndex(getConfig().getSystemDefinition(), SystemDefinition::getName);
            // Gather the requested system definitions
            final List<SystemDefinition> sysDefs = Lists.newArrayList();
            for (String sysDefName : collection.getIncludeSystemDefinition()) {
                SystemDefinition sysDef = sysDefsByName.get(sysDefName);
                if (sysDef == null) {
                    LOG.warn("Collection with name {} includes system definition with name {}, but no such definition was found.",
                            collection.getName(), sysDefName);
                    continue;
                }
                sysDefs.add(sysDef);
            }
            return sysDefs;
        }
    }

