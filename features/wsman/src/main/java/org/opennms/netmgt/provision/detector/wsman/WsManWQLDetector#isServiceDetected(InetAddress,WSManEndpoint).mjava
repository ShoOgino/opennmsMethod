    public DetectResults isServiceDetected(InetAddress address, WSManEndpoint endpoint) {

        // Issue the query!
        List<Node> nodes = Lists.newLinkedList();
        final WSManClient client = m_factory.getClient(endpoint);
        try {
            LOG.debug("Issuing an ENUM on '{}' with query '{}'", resourceUri, wql);
            client.enumerateAndPullUsingFilter(resourceUri, WSManConstants.XML_NS_WQL_DIALECT, wql, nodes, true);
        } catch (WSManException e) {
            LOG.debug("ENUM failed for address '{}' with endpoint '{}', resourceUri '{}', query '{}'", address, endpoint, resourceUri, wql, e);
        }
        return new DetectResultsImpl(nodes.size() > 0);
    }

