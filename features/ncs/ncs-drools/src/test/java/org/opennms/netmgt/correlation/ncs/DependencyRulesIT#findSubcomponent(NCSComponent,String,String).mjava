    private NCSComponent findSubcomponent(NCSComponent svc, String foreignSource, String foreignId) {
        Set<NCSComponent> components = findMatchingComponents(svc, byId(foreignSource, foreignId));

        if (components.size() > 1) {
            throw new IllegalStateException("Found more than one subcomponent with the same id " + foreignSource + ":" + foreignId);
        }
        
        if ( components.isEmpty() ) {
            throw new IllegalStateException("Unabled to find component with id " + foreignSource + ":" + foreignId);
        }
        
        return components.iterator().next();
    }

