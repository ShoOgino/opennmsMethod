	/*
	 * Deletes everything but the top-level "Service" component.
	 */
	@Test
	public void testDeleteOrphansRecursive() throws Exception {
		sendPost("/NCS", m_serviceXML);

		m_eventAnticipator.reset();

		setupLogging("DEBUG");

		// skip the 1st, since it will be "updated" instead of "deleted"
		for (int i = 1; i < m_components.length; i++) {
			anticipateEvent(EventConstants.COMPONENT_DELETED_UEI, m_components[i]);
		}
		anticipateEvent(EventConstants.COMPONENT_UPDATED_UEI, new String[] { "Service", "CokeP2P", "NA-Service", "123" });

		final MockHttpServletRequest request = createRequest(POST, "/NCS");
		request.setContentType(MediaType.APPLICATION_XML);
		request.setContent(m_serviceXMLTopFragment.getBytes());
		request.setQueryString("deleteOrphans=true");
		sendRequest(request, 200);
	}

