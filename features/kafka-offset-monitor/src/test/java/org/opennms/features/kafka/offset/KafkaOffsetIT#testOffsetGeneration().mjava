    @Test
    public void testOffsetGeneration() throws Exception {

        KafkaMessageConsumer kafkaConsumer = new KafkaMessageConsumer(kafkaServer.getKafkaConnectString());
        kafkaConsumer.startConsumer();
        KafkaMessageProducer kafkaProducer = new KafkaMessageProducer(kafkaServer.getKafkaConnectString());
        kafkaProducer.produce();
        KafkaOffsetConsumer consumer = new KafkaOffsetConsumer();
        consumer.setMessageConsumerManager(consumerManager);
        consumer.afterPropertiesSet();
        Thread.sleep(30000);
        Set<KafkaOffset> offsets = consumer.getKafkaOffsets();
        List<String> groupName = new ArrayList<>();
        offsets.forEach(offset -> groupName.add(offset.getConsumerGroupName()));
        assertThat(offsets, not(IsEmptyCollection.empty()));

        await().atMost(1, MINUTES).until(() -> groupName.contains(kafkaConsumer.getGroupName()));
        assertTrue(groupName.contains(kafkaConsumer.getGroupName()));
    }

