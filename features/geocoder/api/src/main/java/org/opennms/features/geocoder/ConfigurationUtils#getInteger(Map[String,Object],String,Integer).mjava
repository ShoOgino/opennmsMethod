    public static Integer getInteger(Map<String, Object> properties, String key, Integer defaultValue) {
        Object value = properties.get(key);
        if (value == null) {
            return defaultValue;
        }
        if (value instanceof Integer) {
            return (Integer)value;
        }
        if (value instanceof String) {
            return Integer.valueOf(value.toString());
        }
        return defaultValue;
    }

