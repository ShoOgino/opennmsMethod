    public void update(Map<String, Object> newProperties) throws IOException {
        final Dictionary<String, Object> currentProperties = configuration.getProperties() == null ? new Hashtable<>() : configuration.getProperties();
        if (!Objects.equals(currentProperties, newProperties)) {
            applyProperties(currentProperties, newProperties);
            saveToDisk(configuration.getPid(), currentProperties);
            configuration.update(currentProperties);
        }
    }

