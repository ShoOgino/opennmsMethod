    private Proxy selectProxy(String targetUri) throws URISyntaxException {
        final List<Proxy> proxies = ProxySelector.getDefault().select(new URI(targetUri));
        return proxies.stream()
                .filter(proxy -> proxy.type() == Proxy.Type.DIRECT || proxy.type() == Proxy.Type.HTTP)
                .findFirst()
                .orElse(Proxy.NO_PROXY);
    }

