    /**
     * {@inheritDoc}
     */
    @Override
    public List<OnmsAlarm> getAlarmsForCategories(final Set<OnmsCategory> rowCategories, final Set<OnmsCategory> colCategories) {
        return m_transactionOperations.execute(new TransactionCallback<List<OnmsAlarm>>() {
            @Override
            public List<OnmsAlarm> doInTransaction(TransactionStatus transactionStatus) {
                final CriteriaBuilder criteriaBuilder = new CriteriaBuilder(OnmsAlarm.class);

                criteriaBuilder.alias("node", "node");
                criteriaBuilder.ne("node.type", "D");

                criteriaBuilder.limit(100);
                criteriaBuilder.distinct();

                // Restrict on OnmsAlarm.nodeId
                criteriaBuilder.sql(createQuery("{alias}.nodeId", rowCategories, colCategories));

                return m_alarmDao.findMatching(criteriaBuilder.toCriteria());
            }
        });
    }

