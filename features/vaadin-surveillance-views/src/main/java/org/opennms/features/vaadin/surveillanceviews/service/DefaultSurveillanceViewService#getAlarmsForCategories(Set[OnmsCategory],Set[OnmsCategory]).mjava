    @Override
    public List<OnmsAlarm> getAlarmsForCategories(Set<OnmsCategory> rowCategories, Set<OnmsCategory> colCategories) {
        List<OnmsNode> nodes = retrieveNodesForCategories(rowCategories, colCategories);

        final CriteriaBuilder criteriaBuilder = new CriteriaBuilder(OnmsAlarm.class);

        criteriaBuilder.alias("node", "node");
        criteriaBuilder.alias("lastEvent", "event");
        criteriaBuilder.ne("node.type", "D");
        criteriaBuilder.limit(100);
        criteriaBuilder.distinct();

        if (nodes != null && nodes.size() > 0) {
            criteriaBuilder.in("node", nodes);
            return m_alarmDao.findMatching(criteriaBuilder.toCriteria());
        }

        return new ArrayList<>();
    }

