    /**
     * Creates a SQL query string for filtering on categories.
     *
     * @param rowCategories the row categories
     * @param colCategories the column categories
     * @return the SQL query string
     */
    private static String createQuery(final String nodeIdProperty, final Set<OnmsCategory> rowCategories, final Set<OnmsCategory> colCategories) {
        final StringBuilder stringBuffer = new StringBuilder();

        stringBuffer.append(nodeIdProperty + " in (select distinct cn.nodeId from category_node cn join categories c on cn.categoryId = c.categoryId where c.categoryName in (");

        String[] questionMarks = new String[rowCategories.size()];
        Arrays.fill(questionMarks, "?");
        stringBuffer.append(String.join(",", questionMarks));

        stringBuffer.append("))");

        stringBuffer.append("and " + nodeIdProperty + " in (select distinct cn.nodeId from category_node cn join categories c on cn.categoryId = c.categoryId where c.categoryName in (");

        questionMarks = new String[colCategories.size()];
        Arrays.fill(questionMarks, "?");
        stringBuffer.append(String.join(",", questionMarks));

        stringBuffer.append("))");

        return stringBuffer.toString();
    }

