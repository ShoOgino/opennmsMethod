    /**
     * Creates a SQL query string for filtering on categories.
     *
     * @param rowCategories the row categories
     * @param colCategories the column categories
     * @return the SQL query string
     */
    private static String createQuery(final String nodeIdProperty, final Set<OnmsCategory> rowCategories, final Set<OnmsCategory> colCategories) {
        StringBuffer stringBuffer = new StringBuffer();

        boolean first = true;

        stringBuffer.append(nodeIdProperty + " in (select distinct cn.nodeId from category_node cn join categories c on cn.categoryId = c.categoryId where c.categoryName in (");

        for (OnmsCategory onmsCategory : rowCategories) {

            if (first) {
                stringBuffer.append("'");
                first = false;
            } else {
                stringBuffer.append(",'");
            }

            stringBuffer.append(onmsCategory.getName());
            stringBuffer.append("'");
        }

        stringBuffer.append("))");

        first = true;

        stringBuffer.append("and " + nodeIdProperty + " in (select distinct cn.nodeId from category_node cn join categories c on cn.categoryId = c.categoryId where c.categoryName in (");

        for (OnmsCategory onmsCategory : colCategories) {

            if (first) {
                stringBuffer.append("'");
                first = false;
            } else {
                stringBuffer.append(",'");
            }

            stringBuffer.append(onmsCategory.getName());
            stringBuffer.append("'");
        }

        stringBuffer.append("))");

        return stringBuffer.toString();
    }

