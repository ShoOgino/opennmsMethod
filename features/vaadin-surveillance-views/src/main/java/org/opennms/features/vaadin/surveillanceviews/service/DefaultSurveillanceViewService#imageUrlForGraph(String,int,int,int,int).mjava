    /**
     * Creates the image url for a given graph parameter and width/height.
     *
     * @param query         the parameter combination for this report graph
     * @param width         the width
     * @param height        the height
     * @param calendarField the calendar field to substract from
     * @param calendarDiff  the value to be substracted
     * @return the url string
     */
    private String imageUrlForGraph(String query, int width, int height, int calendarField, int calendarDiff) {
        Calendar cal = new GregorianCalendar();
        long end = cal.getTime().getTime();
        cal.add(calendarField, -calendarDiff);
        long start = cal.getTime().getTime();
        return "/opennms/graph/graph.png?" + query + "&start=" + start + "&end=" + end + (width > 0 ? "&width=" + width : "") + (height > 0 ? "&height=" + height : "");
    }

