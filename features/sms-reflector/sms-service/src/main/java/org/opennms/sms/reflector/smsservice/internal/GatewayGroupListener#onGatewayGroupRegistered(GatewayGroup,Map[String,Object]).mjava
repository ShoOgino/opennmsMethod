    /**
     * <p>onGatewayGroupRegistered</p>
     *
     * @param gatewayGroup a {@link org.opennms.sms.reflector.smsservice.GatewayGroup} object.
     * @param properties a {@link java.util.Map} object.
     */
    public void onGatewayGroupRegistered(GatewayGroup gatewayGroup, Map<String, Object> properties){
        AGateway[] gateways = gatewayGroup.getGateways();

        if (gateways.length == 0) {
            log.error("A Gateway group was registered with ZERO gateways!");
            return;
        }

        SmsServiceImpl smsService = new SmsServiceImpl();
        smsService.setOutboundNotification(new OutboundMessageNotification(getOutboundListeners()));
        smsService.setInboundNotification(new InboundMessageNotification(getInboundListeners()));
        smsService.setGatewayStatusNotification(new GatewayStatusNotification(getGatewayStatusListeners()));
        smsService.setUSSDNotification(new UssdNotificationDispatcher(getUssdListeners()));

        for(int i = 0; i < gateways.length; i++){

            try {
                if(smsService.getServiceStatus() == ServiceStatus.STARTED){
                    smsService.stop();
                }
                smsService.addGateway(gateways[i]);

            } catch (final GatewayException e) {
                LogUtils.warnf(this, e, "Unable to add gateway (%s) to SMS service", gateways[i]);
            }
        }

        smsService.start();

        smsService.register(m_smsServiceRegistrar);

        m_services.put(gatewayGroup, smsService);


    }

