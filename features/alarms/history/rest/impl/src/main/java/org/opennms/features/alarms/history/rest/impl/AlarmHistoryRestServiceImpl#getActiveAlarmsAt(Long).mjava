    @Override
    public Collection<AlarmState> getActiveAlarmsAt(Long time) {
        long timestampInMillis = time == null ? System.currentTimeMillis() : time;
        return alarmHistoryRepository.getActiveAlarmsAt(timestampInMillis);
    }

