    @Override
    public long getNumActiveAlarmsAt(long time) {
        TimeRange timeRange = getTimeRange(time);
        return findAlarmsWithCompositeAggregation((afterAlarmWithId) -> queryProvider.getActiveAlarmIdsAt(timeRange, afterAlarmWithId), timeRange).size();
    }

