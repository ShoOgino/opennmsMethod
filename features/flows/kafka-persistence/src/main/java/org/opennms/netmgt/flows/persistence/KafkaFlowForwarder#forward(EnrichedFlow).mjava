    @Override
    public void forward(EnrichedFlow enrichedFlow) {

        if (producer == null) {
            RATE_LIMITED_LOG.warn("Kafka Producer is not configured for flow forwarding.");
            return;
        }

        try {
            FlowDocument flowDocument = FlowDocumentBuilder.buildFlowDocument(enrichedFlow);
            final ProducerRecord<String, byte[]> record = new ProducerRecord<>(topicName, flowDocument.toByteArray());
            producer.send(record, (recordMetadata, e) -> {
                if (e != null) {
                    RATE_LIMITED_LOG.warn("Failed to send flow document to kafka: {}.", record, e);
                } else if (LOG.isTraceEnabled()) {
                    LOG.trace("Persisted flow document {} to kafka.", flowDocument);
                }
            });
        } catch (Exception e) {
            LOG.error("Exception while sending flow to kafka.", e);
        }
    }

