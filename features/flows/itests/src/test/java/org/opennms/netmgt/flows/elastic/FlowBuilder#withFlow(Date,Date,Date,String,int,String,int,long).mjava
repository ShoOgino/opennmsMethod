    public FlowBuilder withFlow(Date firstSwitched, Date deltaSwitched, Date lastSwitched, String sourceIp, int sourcePort, String destIp, int destPort, long numBytes) {
        final FlowDocument flow = new FlowDocument();
        flow.setTimestamp(lastSwitched.getTime());
        flow.setFirstSwitched(firstSwitched.getTime());
        flow.setDeltaSwitched(deltaSwitched.getTime());
        flow.setLastSwitched(lastSwitched.getTime());
        flow.setSrcAddr(sourceIp);
        flow.setSrcPort(sourcePort);
        if (this.srcHostname != null) {
            flow.setSrcAddrHostname(this.srcHostname);
        }
        flow.setDstAddr(destIp);
        flow.setDstPort(destPort);
        if (this.dstHostname != null) {
            flow.setDstAddrHostname(this.dstHostname);
        };
        flow.setBytes(numBytes);
        flow.setProtocol(6); // TCP
        if (exporterNode !=  null) {
            flow.setNodeExporter(exporterNode);
        }
        if (direction == Direction.INGRESS) {
            flow.setInputSnmp(snmpInterfaceId);
        } else if (direction == Direction.EGRESS) {
            flow.setOutputSnmp(snmpInterfaceId);
        }
        flow.setApplication(application);
        flow.setDirection(direction);
        flow.setSrcLocality(Locality.PRIVATE);
        flow.setDstLocality(Locality.PRIVATE);
        flow.setFlowLocality(Locality.PRIVATE);
        flow.setTos(tos);
        flows.add(flow);
        return this;
    }

