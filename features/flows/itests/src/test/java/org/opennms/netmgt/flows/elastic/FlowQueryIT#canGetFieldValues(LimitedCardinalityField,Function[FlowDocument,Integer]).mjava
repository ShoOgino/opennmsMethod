    private void canGetFieldValues(LimitedCardinalityField field, Function<FlowDocument, Integer> aggregateBy) throws Exception {
        loadDefaultFlows();

        Object[] memoryResult = DEFAULT_FLOWS
                .stream()
                .map(aggregateBy)
                .distinct()
                .sorted()
                .map(i -> i.toString())
                .toArray()
                ;

        List<String> elasticResult = smartQueryService.getFieldValues(field, getFilters()).get();

        assertThat(elasticResult, containsInAnyOrder(memoryResult));
    }

