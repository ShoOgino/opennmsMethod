    /**
     * Perform a best-effort classification of the application based on
     * the context of the conversation key.
     *
     * This currently has the following limitations:
     *  * The application will be classified using the current configuration which may not match
     *    that at the time that the flow were originally classified
     *  * The classification does not take the exporter into account, and as a result can be classified
     *    differently then the related flows
     *
     * @param convo the conversation key to classify
     * @return the classified application name
     */
    private String classify(ConversationKey convo) {
        final ClassificationRequest request = new ClassificationRequest();
        request.setSrcAddress(convo.getSrcIp());
        request.setSrcPort(convo.getSrcPort());
        request.setDstAddress(convo.getSrcIp());
        request.setDstPort(convo.getDstPort());

        Protocol protocol = Protocols.getProtocol(convo.getProtocol());
        if (protocol == null) {
            protocol = new Protocol(convo.getProtocol(), null, null);
        }
        request.setProtocol(protocol);
        request.setLocation(convo.getLocation());

        String application = classificationEngine.classify(request);
        if (application != null) {
            return application;
        }

        // Flip the source and destination addresses and try again
        request.setSrcAddress(convo.getDstIp());
        request.setSrcPort(convo.getDstPort());
        request.setDstAddress(convo.getSrcIp());
        request.setDstPort(convo.getSrcPort());
        return classificationEngine.classify(request);
    }

