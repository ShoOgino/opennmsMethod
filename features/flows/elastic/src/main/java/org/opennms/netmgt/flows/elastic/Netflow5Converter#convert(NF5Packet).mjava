    public List<FlowDocument> convert(NF5Packet packet) {
        if (packet == null) {
            LOG.debug("Nothing to convert.");
            return Collections.emptyList();
        }
        return packet.getRecords().stream()
                .map(record -> {
                    final FlowDocument document = new FlowDocument();

                    // Netflow 5
                    document.setNetflowVersion(NetflowVersion.V5);

                    // Compute the effective timestamp
                    final long timestampMs = packet.getUnixSecs() * 1000L + packet.getUnixNSecs() / 1000L / 1000L;
                    document.setTimestamp(timestampMs);

                    // Netflow 5 is only captured on ingress
                    document.setDirection(Direction.INGRESS.getValue());

                    // All Netflow 5 flows are IPv4
                    document.setIpProtocolVersion(FlowDocument.IPV4_PROTOCOL_VERSION);

                    // Header
                    document.setFlowRecords(packet.getCount());
                    document.setFlowSeqNum(packet.getFlowSequence());
                    document.setEngineType(packet.getEngineType());
                    document.setEngineId(packet.getEngineId());
                    document.setSamplingInterval(packet.getSamplingInterval());

                    // Body
                    document.setSrcAddr(record.getSrcAddr());
                    document.setSrcPort(record.getSrcPort());
                    document.setDstAddr(record.getDstAddr());
                    document.setDstPort(record.getDstPort());
                    document.setNextHop(record.getNextHop());
                    document.setInputSnmp(record.getInput());
                    document.setOutputSnmp(record.getOutput());
                    document.setBytes(record.getDOctets());
                    document.setPackets(record.getDPkts());
                    document.setFirstSwitched(getSwitched(timestampMs, packet.getSysUptime(), record.getFirst()));
                    document.setLastSwitched(getSwitched(timestampMs, packet.getSysUptime(), record.getLast()));
                    document.setTcpFlags(record.getTcpFlags());
                    document.setProtocol(record.getProt());
                    document.setTos(record.getToS());
                    document.setSrcAs(record.getSrcAs());
                    document.setDstAs(record.getDstAs());
                    document.setSrcMaskLen(record.getSrcMask());
                    document.setDstMaskLen(record.getDstMask());

                    return document;
                })
                .collect(Collectors.toList());
    }

