    public CompletableFuture<Conversation> resolveHostnameForConversation(final Conversation convo, final List<Filter> filters) {
        final CompletableFuture<Optional<String>> lowerHostname = this.resolveHostname(convo.getLowerIp(), filters);
        final CompletableFuture<Optional<String>> upperHostname = this.resolveHostname(convo.getUpperIp(), filters);

        return lowerHostname.thenCombine(upperHostname, (lower, upper) -> {
            final Conversation.Builder result = Conversation.from(convo);
            lower.ifPresent(result::withLowerHostname);
            upper.ifPresent(result::withUpperHostname);
            return result.build();
        });
    }

