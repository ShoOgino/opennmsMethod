    @Override
    public CompletableFuture<Table<Directional<String>, Long, Double>> getTopNApplicationSeries(int N, long step,
                                                                                                boolean includeOther,
                                                                                                List<Filter> filters) {
        if (aggFlowRepository.shouldUseAggregatedDocuments(filters)) {
            return aggFlowRepository.getTopNApplicationSeries(N, step, includeOther, filters);
        }
        return getSeriesFromTopN(N, step, "netflow.application", UNKNOWN_APPLICATION_NAME, includeOther, filters)
                .thenCompose((res) -> mapTable(res, CompletableFuture::completedFuture));
    }

