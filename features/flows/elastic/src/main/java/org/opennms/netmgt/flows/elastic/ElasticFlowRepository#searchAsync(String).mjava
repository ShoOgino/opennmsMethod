    private CompletableFuture<SearchResult> searchAsync(String query) {
        LOG.debug("Executing asynchronous query: {}", query);
        final CompletableFuture<SearchResult> future = new CompletableFuture<>();
        client.executeAsync(new Search.Builder(query)
                .addType(TYPE)
                .build(), new JestResultHandler<SearchResult>() {

            @Override
            public void completed(SearchResult result) {
                future.complete(result);
            }

            @Override
            public void failed(Exception ex) {
                future.completeExceptionally(ex);
            }
        });
        return future;
    }

