    @Override
    public CompletableFuture<Set<Integer>> getSnmpInterfaceIdsWithFlows(int limit, List<Filter> filters) {
        final String query = searchQueryProvider.getUniqueSnmpInterfaces(limit, filters);
        return searchAsync(query, extractTimeRangeFilter(filters))
                .thenApply(res -> {
            final Set<Integer> interfaces = Sets.newHashSet();
            res.getAggregations().getTermsAggregation("input_snmp").getBuckets()
                    .stream()
                    .map(TermsAggregation.Entry::getKey)
                    .map(Integer::valueOf)
                    .forEach(interfaces::add);
            res.getAggregations().getTermsAggregation("output_snmp").getBuckets()
                    .stream()
                    .map(TermsAggregation.Entry::getKey)
                    .map(Integer::valueOf)
                    .forEach(interfaces::add);
            return interfaces;
        });
    }

