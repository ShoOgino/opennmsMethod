        /** Start/End/Step are calculated such that the interval is covered by a single step */
        public FilterAndGroupBy(
                List<Filter> filters,
                String groupByTerm
                               ) {
            Objects.requireNonNull(filters);
            Objects.requireNonNull(groupByTerm);
            this.filters = filters;
            this.groupByTerm = groupByTerm;
            timeRangeFilter = getRequiredTimeRangeFilter(filters);
            start = timeRangeFilter.getStart();
            // Remove 1 from the end to make sure we have a single bucket
            end = Math.max(timeRangeFilter.getStart(), timeRangeFilter.getEnd() - 1);
            // A single step
            step = timeRangeFilter.getEnd() - timeRangeFilter.getStart();
        }

