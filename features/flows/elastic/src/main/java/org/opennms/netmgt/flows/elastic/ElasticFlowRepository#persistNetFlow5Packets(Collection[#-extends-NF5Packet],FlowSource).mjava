    @Override
    public void persistNetFlow5Packets(Collection<? extends NF5Packet> packets, FlowSource source) throws FlowException {
        LOG.debug("Converting {} Netflow 5 packets from {} to flow documents.", packets.size(), source);
        final List<FlowDocument> flowDocuments = packets.stream()
                .map(converter::convert)
                .flatMap(Collection::stream)
                .collect(Collectors.toList());
        enrichAndPersistFlows(flowDocuments, source);
    }

