    @Override
    public void save(List<NetflowDocument> flowDocuments) throws FlowException {
        if (flowDocuments != null && !flowDocuments.isEmpty()) {
            final String index = indexStrategy.getIndex(new Date());
            final String type = "flow";

            if (flowDocuments != null && !flowDocuments.isEmpty()) {
                final Bulk.Builder bulkBuilder = new Bulk.Builder();
                for (NetflowDocument document : flowDocuments) {
                    final Index.Builder indexBuilder = new Index.Builder(document)
                            .index(index)
                            .type(type);
                    bulkBuilder.addAction(indexBuilder.build());
                }
                final Bulk bulk = bulkBuilder.build();
                final BulkResult result = executeRequest(bulk);
                if (!result.isSucceeded()) {
                    final List<FailedItem> failedFlows = determineFailedFlows(flowDocuments, result);
                    throw new PersistenceException(result.getErrorMessage(), failedFlows);
                }
            }
        } else {
            LOG.warn("Received empty or null flows. Nothing to do.");
        }
    }

