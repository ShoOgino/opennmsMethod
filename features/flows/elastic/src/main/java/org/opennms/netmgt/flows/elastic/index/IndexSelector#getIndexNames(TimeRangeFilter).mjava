    /**
     * We assume that timeRange is valid:
     * - not Null
     * - start and end date is positive
     * - start date <= end date
     * <p>
     * We need to be aware that the indexes are part of the GET URL and therefor we can't have too many, it will result
     * in  a HTTP 400 from elasticsearch. Therefor we collapse the indexes with wildcards where applicable</p>
     */
    public List<String> getIndexNames(TimeRangeFilter timeRange) {
        List<String> all = new ArrayList<>();
        // we expand the time range by a bit in order to be sure to find all relevant events:
        long expandTimeRangeInMs = 2 * 60 * 1000; // 2 min
        Date endDate = adjustEndTime(new Date(timeRange.getEnd()+expandTimeRangeInMs));
        Date startDate = new Date(timeRange.getStart()-expandTimeRangeInMs);
        Date currentDate = startDate;

        while (currentDate.before(endDate)) {
            String index = strategy.getIndex(prefix, currentDate);
            all.add(index);
            currentDate = plusOne(currentDate);
        }

        // collapse the indexes in order to reduce the length of the URL:
        String elementAfterSequence = strategy.getIndex(prefix, currentDate);
        String elementBeforeSequence = strategy.getIndex(prefix, minusOne(startDate));

        return collapseList(all, elementBeforeSequence, elementAfterSequence, 0);
    }

