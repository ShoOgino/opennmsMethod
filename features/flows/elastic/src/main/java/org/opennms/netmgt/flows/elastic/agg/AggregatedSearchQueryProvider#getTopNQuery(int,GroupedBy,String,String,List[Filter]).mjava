    public String getTopNQuery(int N, GroupedBy groupedBy, String aggregationType, String key, List<Filter> filters) {
        return render("agg_top_n.ftl", ImmutableMap.builder()
                .put("filters", getFilterQueries(filters))
                .put("N", N)
                .put("groupedBy", groupedBy)
                .put("aggregationType", aggregationType)
                .put("key", key)
                .build());
    }

