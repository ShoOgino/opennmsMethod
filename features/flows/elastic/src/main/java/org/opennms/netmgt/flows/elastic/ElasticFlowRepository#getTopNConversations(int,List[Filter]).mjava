    @Override
    public CompletableFuture<List<TrafficSummary<Conversation>>> getTopNConversations(int N, List<Filter> filters) {
        return getTotalBytesFromTopN(N, "netflow.convo_key", null, false, filters).thenApply((res) -> res.stream()
                .map(summary -> {
                    final ConversationKey convo = ConversationKeyUtils.fromJsonString(summary.getEntity());
                    final Conversation conversation = new Conversation(convo, classify(convo));
                    final TrafficSummary<Conversation> out = new TrafficSummary<>(conversation);
                    out.setBytesIn(summary.getBytesIn());
                    out.setBytesOut(summary.getBytesOut());
                    return out;
                })
                .collect(Collectors.toList()));
    }

