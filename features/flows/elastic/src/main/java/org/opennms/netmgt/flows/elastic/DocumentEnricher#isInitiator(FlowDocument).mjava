    // Determine if the provided flow is the initiator.
    // Yes, this may not be 100% accurate, but is a very easy way of defining the direction of the flow in most cases.
    protected static Boolean isInitiator(FlowDocument document) {
        if (document.getSrcPort() != null && document.getDstPort() != null) {
            if (document.getSrcPort() > document.getDstPort()) {
                return true;
            } else if (document.getSrcPort() < document.getDstPort()) {
                return false;
            }
        }

        // Tie breaker
        if (document.getSrcAddr() != null && document.getDstAddr() != null) {
            final BigInteger srcAddressAsInt = InetAddressUtils.toInteger(InetAddressUtils.addr(document.getSrcAddr()));
            final BigInteger dstAddressAsInt = InetAddressUtils.toInteger(InetAddressUtils.addr(document.getDstAddr()));
            if (srcAddressAsInt.compareTo(dstAddressAsInt) > 0) {
                return true;
            } else if (srcAddressAsInt.compareTo(dstAddressAsInt) < 0) {
                return false;
            }
        }

        return null;
    }

