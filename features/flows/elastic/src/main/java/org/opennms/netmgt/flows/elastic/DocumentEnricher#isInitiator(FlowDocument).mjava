    // Determine if the provided flow is the initiator.
    // Yes, this may not be 100% accurate, but is a very easy way of defining the direction of the flow in most cases.
    protected static boolean isInitiator(FlowDocument document) {
        if (document.getSrcPort()  > document.getDstPort()) {
            return true;
        } else if (document.getSrcPort() == document.getDstPort()) {
            // Tie breaker
            final BigInteger sourceAddressAsInt = InetAddressUtils.toInteger(InetAddressUtils.addr(document.getSrcAddr()));
            final BigInteger destAddressAsInt = InetAddressUtils.toInteger(InetAddressUtils.addr(document.getDstAddr()));
            return sourceAddressAsInt.compareTo(destAddressAsInt) > 0;
        }
        return false;
    }

