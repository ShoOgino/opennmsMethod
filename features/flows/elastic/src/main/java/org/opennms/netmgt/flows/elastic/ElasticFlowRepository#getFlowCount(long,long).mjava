    @Override
    public CompletableFuture<Long> getFlowCount(long start, long end) {
        final String query = "{\n" +
                "  \"size\": 0,\n" +
                "  \"query\": {\n" +
                "    \"bool\": {\n" +
                "      \"filter\": [\n" +
                "        {\n" +
                "          \"range\": {\n" +
                "            \"@timestamp\": {\n" +
                String.format("              \"gte\": %d,\n", start) +
                String.format("              \"lte\": %d,\n", end) +
                "              \"format\": \"epoch_millis\"\n" +
                "            }\n" +
                "          }\n" +
                "        }\n" +
                "      ]\n" +
                "    }\n" +
                "  }\n" +
                "}\n";
        return searchAsync(query).thenApply(SearchResult::getTotal);
    }

