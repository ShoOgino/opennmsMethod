    @Test
    public void testCreateClassificationRequest() {
        final MockDocumentEnricherFactory factory = new MockDocumentEnricherFactory();
        final DocumentEnricher enricher = factory.getEnricher();

        final FlowDocument flowDocument = new FlowDocument();

        // verify that null values are handled correctly, see issue HZN-1329
        ClassificationRequest classificationRequest;

        classificationRequest = enricher.createClassificationRequest(flowDocument);
        assertEquals(false, classificationRequest.isClassifiable());

        flowDocument.setDstPort(123);

        classificationRequest = enricher.createClassificationRequest(flowDocument);
        assertEquals(false, classificationRequest.isClassifiable());

        flowDocument.setSrcPort(456);

        classificationRequest = enricher.createClassificationRequest(flowDocument);
        assertEquals(false, classificationRequest.isClassifiable());

        flowDocument.setProtocol(6);

        classificationRequest = enricher.createClassificationRequest(flowDocument);
        assertEquals(true, classificationRequest.isClassifiable());
    }

