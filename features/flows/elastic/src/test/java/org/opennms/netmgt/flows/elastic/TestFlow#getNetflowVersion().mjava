    @Override
    public NetflowVersion getNetflowVersion() {
        if (flowDocument.getNetflowVersion() == null) {
            return null;
        }

        switch (flowDocument.getNetflowVersion()) {
            case V5:
                return NetflowVersion.V5;
            case V9:
                return NetflowVersion.V9;
            case IPFIX:
                return NetflowVersion.IPFIX;
            case SFLOW:
                return NetflowVersion.SFLOW;
            default:
                throw new IllegalArgumentException("Unknown protocol version: " + flowDocument.getNetflowVersion().name());
        }
    }

