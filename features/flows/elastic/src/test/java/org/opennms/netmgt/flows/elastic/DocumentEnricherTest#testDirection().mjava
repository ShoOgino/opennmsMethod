    @Test
    public void testDirection() {
        final MockDocumentEnricherFactory factory = new MockDocumentEnricherFactory();
        final DocumentEnricher enricher = factory.getEnricher();

        final FlowDocument d1 = new FlowDocument();
        d1.setSrcAddr("1.1.1.1");
        d1.setSrcPort(1);
        d1.setDstAddr("2.2.2.2");
        d1.setDstPort(2);
        d1.setProtocol(6);
        d1.setDirection(Direction.INGRESS);

        final ClassificationRequest c1 = enricher.createClassificationRequest(d1);
        assertEquals("1.1.1.1", c1.getSrcAddress());
        assertEquals("2.2.2.2", c1.getDstAddress());
        assertEquals(new Integer(1), c1.getSrcPort());
        assertEquals(new Integer(2), c1.getDstPort());

        final FlowDocument d2 = new FlowDocument();
        d2.setSrcAddr("1.1.1.1");
        d2.setSrcPort(1);
        d2.setDstAddr("2.2.2.2");
        d2.setDstPort(2);
        d2.setProtocol(6);
        d2.setDirection(Direction.EGRESS);

        // check that fields stay as theay are even when EGRESS is used
        final ClassificationRequest c2 = enricher.createClassificationRequest(d2);
        assertEquals("1.1.1.1", c2.getSrcAddress());
        assertEquals("2.2.2.2", c2.getDstAddress());
        assertEquals(new Integer(1), c2.getSrcPort());
        assertEquals(new Integer(2), c2.getDstPort());

        final FlowDocument d3 = new FlowDocument();
        d3.setSrcAddr("1.1.1.1");
        d3.setSrcPort(1);
        d3.setDstAddr("2.2.2.2");
        d3.setDstPort(2);
        d3.setProtocol(6);
        d3.setDirection(null);

        final ClassificationRequest c3 = enricher.createClassificationRequest(d3);
        assertEquals("1.1.1.1", c3.getSrcAddress());
        assertEquals("2.2.2.2", c3.getDstAddress());
        assertEquals(new Integer(1), c3.getSrcPort());
        assertEquals(new Integer(2), c3.getDstPort());
    }

