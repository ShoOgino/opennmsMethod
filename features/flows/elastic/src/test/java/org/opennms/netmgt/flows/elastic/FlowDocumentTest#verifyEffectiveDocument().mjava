    @Test
    public void verifyEffectiveDocument() throws IOException {
        // Enrich
        final List<FlowDocument> documents = enricher.enrich(Collections.singletonList(getMockFlow()), getMockFlowSource());

        // Serialize
        assertThat(documents, hasSize(1));
        final String actualJson = gson.toJson(documents.get(0));

        // Verify
        final String expectedJson = Resources.toString(Resources.getResource("flow-document-netflow5.json"), StandardCharsets.UTF_8);
        JsonTest.assertJsonEquals(expectedJson, actualJson);
    }

