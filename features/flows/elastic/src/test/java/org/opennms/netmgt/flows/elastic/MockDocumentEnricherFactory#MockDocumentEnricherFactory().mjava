    public MockDocumentEnricherFactory() {
        nodeDao = createNodeDao();
        interfaceToNodeCache = new MockInterfaceToNodeCache();
        transactionTemplate = new MockTransactionTemplate();
        transactionTemplate.afterPropertiesSet();
        assetRecordDao = new MockAssetRecordDao();
        categoryDao = new MockCategoryDao();

        final ClassificationEngine classificationEngine = new DefaultClassificationEngine(() -> Lists.newArrayList(
                new RuleBuilder().withName("http").withPort("80").withProtocol("tcp,udp").build(),
                new RuleBuilder().withName("https").withPort("443").withProtocol("tcp,udp").build()
        ));
        enricher = new DocumentEnricher(new MetricRegistry(), nodeDao, interfaceToNodeCache, transactionTemplate, classificationEngine);

        // Required for mock node dao
        addServiceRegistry(nodeDao);
        addServiceRegistry(assetRecordDao);
        addServiceRegistry(categoryDao);
        DefaultServiceRegistry.INSTANCE.register(nodeDao, NodeDao.class);
        DefaultServiceRegistry.INSTANCE.register(assetRecordDao, AssetRecordDao.class);
        DefaultServiceRegistry.INSTANCE.register(categoryDao, CategoryDao.class);
    }

