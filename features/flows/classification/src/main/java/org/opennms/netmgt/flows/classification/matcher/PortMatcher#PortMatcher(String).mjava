    public PortMatcher(String ports) {
        final StringValue portValue = new StringValue(ports);
        if (portValue.isWildcard()) {
            throw new IllegalArgumentException("Wildcards not supported");
        }

        final List<StringValue> portValues = portValue.splitBy(",");
        final List<StringValue> rangedPortValues = portValues.stream().filter(v -> v.isRanged()).collect(Collectors.toList());
        rangedPortValues.forEach(v -> portValues.remove(v));

        final List<RangedValue> convertedRangedPortValues = rangedPortValues
                .stream()
                .map(v -> new RangedValue(v))
                .collect(Collectors.toList());

        this.concretePorts.addAll(portValues.stream().map(v -> new IntegerValue(v)).collect(Collectors.toList()));
        this.rangedPorts.addAll(convertedRangedPortValues);
    }

