    protected static ClassificationRequest createClassificationRequest(NetflowDocument document) {
        final ClassificationRequest request = new ClassificationRequest();
        request.setProtocol(Protocols.getProtocol(document.getIpProtocol()));
        request.setLocation(document.getLocation());

        // Decide whether to use source or dest address/port to determine application mapping
        if (document.isInitiator()) {
            request.setIpAddress(document.getIpv4DestAddress());
            request.setPort(document.getDestPort());
        } else {
            request.setIpAddress(document.getIpv4SourceAddress());
            request.setPort(document.getSourcePort());
        }
        return request;
    }

