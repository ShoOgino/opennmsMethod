    @Test
    public void verifyFetchingOnlyEnabledRules() {
        // Nothing of ours created yet (only default database schema)
        int initialCount = ruleDao.findAllEnabledRules().size();
        assertTrue("initial enabled classification rules should be populated (count should be non-zero)", initialCount > 0);

        // Create a bunch of rules
        ruleDao.save(new RuleBuilder().withName("Rule 1").withDstPort(1000).withGroup(staticGroup).build());
        ruleDao.save(new RuleBuilder().withName("Rule 2").withDstPort(1000).withGroup(customGroup).build());

        // Verify creation -- all default rules plus our two new ones
        assertThat(ruleDao.findAllEnabledRules(), hasSize(initialCount + 2));

        // Disable group -- no system-defined rules plus *one* of our new ones
        staticGroup.setEnabled(false);
        groupDao.saveOrUpdate(staticGroup);
        assertThat(ruleDao.findAllEnabledRules(), hasSize(1));

        // Disable other group -- no system-defined rules plus *none* of our new ones
        customGroup.setEnabled(false);
        groupDao.saveOrUpdate(customGroup);
        assertThat(ruleDao.findAllEnabledRules(), hasSize(0));
    }

