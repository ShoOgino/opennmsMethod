    @Test
    public void verifyCascadeOnInsertAndDelete() {
        // Verify nothing inserted yet
        assertThat(groupDao.countAll(), is(0));
        assertThat(ruleDao.countAll(), is(0));

        // INSERT
        final Group group = new GroupBuilder().withName("custom")
                .withRule(new RuleBuilder().withName("http").withPort(80).build())
                .withRule(new RuleBuilder().withName("http").withPort(8080).build())
                .build();
        groupDao.save(group);
        assertThat(groupDao.countAll(), is(1));
        assertThat(ruleDao.countAll(), is(2));

        // UPDATE
        group.getRules().get(0).setName("http2");
        group.getRules().remove(1);
        groupDao.saveOrUpdate(group);
        assertThat(groupDao.countAll(), is(1));
        assertThat(ruleDao.countAll(), is(1));
        assertThat(ruleDao.get(group.getRules().get(0).getId()).getName(), is("http2"));

        // DELETE
        groupDao.delete(group.getId());
        assertThat(groupDao.countAll(), is(0));
        assertThat(ruleDao.countAll(), is(0));
    }

