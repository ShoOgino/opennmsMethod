    @Override
    public int compare(RuleDefinition r1, RuleDefinition r2) {
        Objects.requireNonNull(r1);
        Objects.requireNonNull(r2);

        // Sort by group priority (highest priority first)
        int groupPriority1 = r1.getGroupPriority();
        int groupPriority2 = r2.getGroupPriority();
        int result = Integer.compare(groupPriority1, groupPriority2);

        // If group priority is identical, sort by rule position (lowest position first)
        if (result == 0) {
            return Integer.compare(r1.getPosition(), r2.getPosition());
        }
        return result;
    }

