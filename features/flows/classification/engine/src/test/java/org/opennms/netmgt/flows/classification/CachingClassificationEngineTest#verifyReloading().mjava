    @Test
    public void verifyReloading() {
        final List<Rule> rules = new ArrayList<>();

        // Create caching engine and spy o original engine
        final DefaultClassificationEngine originalEngine = new DefaultClassificationEngine((Supplier<List<Rule>>) () -> rules);
        final ClassificationEngine classificationEngine = Mockito.spy(originalEngine);
        final ClassificationEngine cachingEngine = new CachingClassificationEngine(classificationEngine);

        // Verify no rule defined
        final ClassificationRequest request = new ClassificationRequest("Default", 80, "192.168.2.1", ProtocolType.TCP);
        Assert.assertEquals(null, cachingEngine.classify(request));

        // Add rule and reload
        rules.add(new Rule("TEST", "0-10000"));
        cachingEngine.reload();

        // Verify rule is now defined
        Assert.assertEquals("TEST", cachingEngine.classify(request));
    }

