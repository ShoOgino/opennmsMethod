    private void createClassifiers(final List<Rule> rules) {
        classifierPortMap.clear();
        classifierPortMap.put(null, new ArrayList<>()); // Values for ANY port

        // Create classifiers and bind them to a port
        for (Rule eachRule : rules) {
            final Classifier classifier = new CombinedClassifier(eachRule);
            if (!Strings.isNullOrEmpty(eachRule.getPort())) {
                for (Integer eachPort : new PortValue(eachRule.getPort()).getPorts()) {
                    classifierPortMap.putIfAbsent(eachPort, new ArrayList<>());
                    classifierPortMap.get(eachPort).add(classifier);
                }
            } else {
                classifierPortMap.get(null).add(classifier);
            }
        }
    }

