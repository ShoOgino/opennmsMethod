    @Test
    public void verifyCaching() {
        // Create caching engine and spy o original engine
        final DefaultClassificationEngine originalEngine = new DefaultClassificationEngine(() -> Lists.newArrayList(new Rule("TEST", "0-10000")));
        final ClassificationEngine classificationEngine = Mockito.spy(originalEngine);
        final ClassificationEngine cachingEngine = new CachingClassificationEngine(classificationEngine, CACHE_CONFIG);

        // Create Request
        final ClassificationRequest request = new ClassificationRequest("Default", 80, "192.168.2.1", ProtocolType.TCP);

        // Verify
        final String classification1 = cachingEngine.classify(request);
        final String classification2 = cachingEngine.classify(request);
        Assert.assertEquals("TEST", classification1);
        Assert.assertEquals(classification1, classification2);

        // Should only be invoked once
        Mockito.verify(classificationEngine, Mockito.times(1)).classify(Mockito.any(ClassificationRequest.class));
    }

