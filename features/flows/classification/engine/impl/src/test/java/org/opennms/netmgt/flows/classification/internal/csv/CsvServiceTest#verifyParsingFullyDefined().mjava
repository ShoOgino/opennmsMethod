    @Test
    public void verifyParsingFullyDefined() {
        final CsvService csvService = new CsvServiceImpl(createNiceMock(RuleValidator.class));
        final List<Rule> rules = csvService.parseCSV(group,
                new ByteArrayInputStream(
                        ("dummy;tcp,udp,icmp;10.0.0.1;55555;8.8.8.8;80,1234;categoryName = 'Databases';true").getBytes()),
                false
                ).getRules();
        assertThat(rules, hasSize(1));
        final Rule rule = rules.get(0);
        assertThat(rule.getId(), is(nullValue()));
        assertThat(rule.getName(), is("dummy"));
        assertThat(rule.getProtocol(), is("tcp,udp,icmp"));
        assertThat(rule.getDstPort(), is("80,1234"));
        assertThat(rule.getDstAddress(), is("8.8.8.8"));
        assertThat(rule.getSrcPort(), is("55555"));
        assertThat(rule.getSrcAddress(), is("10.0.0.1"));
        assertThat(rule.getExporterFilter(), is("categoryName = 'Databases'"));
        assertThat(rule.isOmnidirectional(), is(true));
    }

