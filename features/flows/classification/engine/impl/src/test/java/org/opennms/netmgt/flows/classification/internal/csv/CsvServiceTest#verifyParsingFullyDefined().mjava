    @Test
    public void verifyParsingFullyDefined() {
        final CsvService csvService = new CsvServiceImpl(createNiceMock(RuleValidator.class));
        final List<Rule> rules = csvService.parseCSV(new ByteArrayInputStream("dummy;8.8.8.8;80,1234;tcp,udp,icmp".getBytes()), false).getRules();
        assertThat(rules, hasSize(1));
        final Rule rule = rules.get(0);
        assertThat(rule.getId(), is(nullValue()));
        assertThat(rule.getPort(), is("80,1234"));
        assertThat(rule.getName(), is("dummy"));
        assertThat(rule.getProtocol(), is("tcp,udp,icmp"));
        assertThat(rule.getIpAddress(), is("8.8.8.8"));
    }

