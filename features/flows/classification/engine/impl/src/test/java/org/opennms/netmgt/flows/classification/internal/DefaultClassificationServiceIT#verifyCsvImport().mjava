    @Test
    public void verifyCsvImport() {
        // Rules
        final Rule http2Rule = new RuleBuilder().withGroup(userGroupCsv).withName("http2").withProtocol("TCP,UDP").withDstAddress("127.0.0.1").build();
        final Rule googleRule = new RuleBuilder().withGroup(userGroupCsv).withName("google").withDstAddress("8.8.8.8").build();
        final Rule opennmsMonitorRule = new RuleBuilder()
                .withName("opennms-monitor")
                .withGroup(userGroupCsv)
                .withProtocol("TCP")
                .withSrcAddress("10.0.0.1").withSrcPort(1000)
                .withDstAddress("10.0.0.2").withDstPort(8980)
                .build();

        // Dummy input
        final String csv = new CsvBuilder()
                .withRule(http2Rule)
                .withRule(googleRule)
                .withRule(opennmsMonitorRule)
                .build();

        // Import
        final InputStream inputStream = new ByteArrayInputStream(csv.getBytes());
        classificationService.importRules(inputStream, true, true);

        // Verify
        assertThat(ruleDao.countAll(), is(3));
        assertThat(ruleDao.findByDefinition(new RuleBuilder()
                .withGroup(userGroupCsv)
                .withName("http") // name differs
                .withProtocol("tcp,udp")
                .withDstAddress("127.0.0.1").build()), hasSize(1));
        assertThat(ruleDao.findByDefinition(googleRule), hasSize(1));
        assertThat(ruleDao.findByDefinition(opennmsMonitorRule), hasSize(1));
    }

