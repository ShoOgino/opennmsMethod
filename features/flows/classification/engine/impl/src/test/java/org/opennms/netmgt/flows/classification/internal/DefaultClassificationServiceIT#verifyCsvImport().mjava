    @Test
    public void verifyCsvImport() {
        // Dummy input
        final StringBuilder builder = new StringBuilder();
        builder.append("name;ipAddress;port;protocol\n");
        builder.append("http2;127.0.0.1;;TCP,UDP\n");
        builder.append("google;8.8.8.8;;\n");

        // Import
        final InputStream inputStream = new ByteArrayInputStream(builder.toString().getBytes());
        classificationService.importRules(inputStream, true, true);

        // Verify
        assertThat(ruleDao.countAll(), is(2));
        assertThat(ruleDao.findByDefinition(new RuleBuilder()
                .withName("http")
                .withProtocol("tcp,udp")
                .withIpAddress("127.0.0.1").build()), hasSize(1));
        assertThat(ruleDao.findByDefinition(new RuleBuilder()
                .withName("google")
                .withIpAddress("8.8.8.8").build()), hasSize(1));
    }

