    @Test
    public void verifyExportForFullyDefinedRule() {
        // create a csv for a completely empty rule
        final CsvService csvService = new CsvServiceImpl(createNiceMock(RuleValidator.class));
        final Rule rule = new RuleBuilder().withName("dummy").withProtocol("tcp,udp,icmp").withPort("80,1234").withIpAddress("8.8.8.8").build();
        final String response = csvService.createCSV(Lists.newArrayList(rule));
        final String[] rows = response.split("\n");

        // Verify output
        assertThat(rows.length, is(2));
        assertThat(rows[1], is("dummy;8.8.8.8;80,1234;tcp,udp,icmp"));
    }

