    @Test
    public void verifyExportForFullyDefinedRule() {
        // create a csv for a completely empty rule
        final CsvService csvService = new CsvServiceImpl(createNiceMock(RuleValidator.class));
        final Rule rule = new RuleBuilder()
                .withGroup(group)
                .withName("dummy")
                .withProtocol("tcp,udp,icmp")
                .withDstPort("80,1234").withDstAddress("8.8.8.8")
                .withSrcPort("55555").withSrcAddress("10.0.0.1")
                .withExporterFilter("categoryName = 'Databases'")
                .withOmnidirectional(true)
                .build();
        final String response = csvService.createCSV(Lists.newArrayList(rule));
        final String[] rows = response.split("\n");

        // Verify output
        assertThat(rows.length, is(2));
        assertThat(rows[1], is("dummy;tcp,udp,icmp;10.0.0.1;55555;8.8.8.8;80,1234;categoryName = 'Databases';true"));
    }

