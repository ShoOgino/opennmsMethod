    @Test
    public void verifyCsvImportWithDeletingEverythingBefore() {
        // Save a rule
        Rule rule = new RuleBuilder()
                .withGroup(userGroupDb)
                .withName("http")
                .withProtocol("tcp,udp")
                .build();
        ruleDao.save(rule);

        // verify it is created
        assertThat(ruleDao.countAll(), is(1));

        // define csv and import
        final String csv = new CsvBuilder()
                .withRule(new RuleBuilder()
                        .withGroup(this.userGroupCsv)
                        .withName("http2")
                        .withDstAddress("127.0.0.1")
                        .withProtocol("TCP,UDP"))
                .build();
        classificationService.importRules(userGroupDb.getId(), new ByteArrayInputStream(csv.getBytes()), true, true);

        // Verify original one is deleted, but count is still 1
        assertThat(ruleDao.findByDefinition(rule), hasSize(0));
        assertThat(ruleDao.countAll(), is(1));
    }

