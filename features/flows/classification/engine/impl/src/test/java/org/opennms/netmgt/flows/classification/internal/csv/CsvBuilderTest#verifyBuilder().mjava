    @Test
    public void verifyBuilder() {
        final Group group = new GroupBuilder().withName(Groups.USER_DEFINED).build();
        final String actualCsv = new CsvBuilder()
                .withRule(new RuleBuilder().withGroup(group).withName("http2").withProtocol("TCP,UDP")
                        .withDstAddress("127.0.0.1"))
                .withRule(new RuleBuilder().withGroup(group).withName("google").withDstAddress("8.8.8.8"))
                .withRule(new RuleBuilder().withGroup(group).withName("opennms").withDstPort(8980))
                .withRule(new RuleBuilder()
                        .withGroup(group)
                        .withName("opennms-monitor")
                        .withSrcAddress("10.0.0.1").withSrcPort(10000)
                        .withDstAddress("10.0.0.2").withDstPort(8980))
                .withRule(new RuleBuilder().withGroup(group).withName("http").withProtocol("TCP")
                        .withOmnidirectional(true))
                .withRule(new RuleBuilder()
                        .withGroup(group)
                        .withName("xxx")
                        .withProtocol("tcp,udp")
                        .withSrcAddress("10.0.0.1").withSrcPort(10000)
                        .withDstAddress("10.0.0.2").withDstPort(8980)
                        .withExporterFilter("some-filter-value")
                )
                .build();

        final StringBuilder builder = new StringBuilder();
        builder.append(CsvServiceImpl.HEADERS_STRING);
        builder.append("http2;TCP,UDP;;;127.0.0.1;;;false\n");
        builder.append("google;;;;8.8.8.8;;;false\n");
        builder.append("opennms;;;;;8980;;false\n");
        builder.append("opennms-monitor;;10.0.0.1;10000;10.0.0.2;8980;;false\n");
        builder.append("http;TCP;;;;;;true\n");
        builder.append("xxx;tcp,udp;10.0.0.1;10000;10.0.0.2;8980;some-filter-value;false");

        final String expectedCsv = builder.toString();
        assertEquals(expectedCsv, actualCsv);
    }

