    @Test
    public void verifyRuleEngineBasic() {
        DefaultClassificationEngine engine = new DefaultClassificationEngine(() ->
            Lists.newArrayList(
                    new RuleBuilder().withName("rule1").withPosition(1).withSrcPort(80).build(),
                    new RuleBuilder().withName("rule2").withPosition(2).withDstPort(443).build(),
                    new RuleBuilder().withName("rule3").withPosition(3).withSrcPort(8888).withDstPort(9999).build(),
                    new RuleBuilder().withName("rule4").withPosition(4).withSrcPort(8888).withDstPort(80).build(),
                    new RuleBuilder().withName("rule5").withPosition(5).build()
            ), FilterService.NOOP);

        assertEquals("rule2", engine.classify(new ClassificationRequestBuilder().withSrcPort(9999).withDstPort(443).build()));
        assertEquals("rule3", engine.classify(new ClassificationRequestBuilder().withSrcPort(8888).withDstPort(9999).build()));
        assertEquals("rule4", engine.classify(new ClassificationRequestBuilder().withSrcPort(8888).withDstPort(80).build()));
    }

