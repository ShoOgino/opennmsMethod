    @Test
    public void verifyCsvImportWithoutDeletingExistingRules() {
        // Save a rule
        Rule rule1 = new RuleBuilder()
                .withGroup(userGroupDb)
                .withName("rule1")
                .withProtocol("tcp,udp")
                .withDstPort(111)
                .build();
        ruleDao.save(rule1);

        // verify it is created
        assertThat(ruleDao.countAll(), is(initialCount + 1));

        // Define another rule, to import
        Rule rule2 = new RuleBuilder()
                .withGroup(userGroupCsv)
                .withName("rule2")
                .withDstAddress("127.0.0.1")
                .withDstPort(222)
                .withProtocol("tcp,udp")
                .build();

        // define csv and import
        boolean hasHeader = false;
        boolean deleteExistingRules = false;
        final String csv = new CsvBuilder().withRule(rule2).withHeader(hasHeader).build();
        classificationService.importRules(userGroupDb.getId(), new ByteArrayInputStream(csv.getBytes()), hasHeader, deleteExistingRules);
        assertThat(ruleDao.countAll(), is(initialCount + 2));

        // Verify original one is retained, and new one was added
        assertThat(ruleDao.findByDefinition(rule1), hasSize(2));
        assertThat(ruleDao.findByDefinition(rule2), hasSize(1));

    }

