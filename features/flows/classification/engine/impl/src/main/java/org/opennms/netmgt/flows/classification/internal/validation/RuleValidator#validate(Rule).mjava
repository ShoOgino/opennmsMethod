    public void validate(Rule rule) throws InvalidRuleException {

        // Ensure that rule is associated to a group
        if (rule.getGroup() == null) {
            throw new InvalidRuleException(ErrorContext.Entity, Errors.RULE_GROUP_IS_REQUIRED);
        }
        // Name is required
        validateName(rule.getName());

        // Ensure that at least one field is defined (no catch all rule)
        if (!rule.hasDefinition()) {
            throw new InvalidRuleException(ErrorContext.Entity, Errors.RULE_NO_DEFINITIONS);
        }
        // Ensure protocol is defined correctly
        if (rule.hasProtocolDefinition()) {
            validateProtocol(rule.getProtocol());
        }
        // Ensure dst port is defined correctly
        if (rule.hasDstPortDefinition()) {
            validatePort(ErrorContext.DstPort, rule.getDstPort());
        }
        // Ensure dst ip address is defined correctly
        if (rule.hasDstAddressDefinition()) {
            validateIpAddress(ErrorContext.DstAddress, rule.getDstAddress());
        }
        // Ensure src port is defined correctly
        if (rule.hasSrcPortDefinition()) {
            validatePort(ErrorContext.SrcPort, rule.getSrcPort());
        }
        // Ensure src ip address is defined correctly
        if (rule.hasSrcAddressDefinition()) {
            validateIpAddress(ErrorContext.SrcAddress, rule.getSrcAddress());
        }
        // Ensure filter is defined correctly
        if (rule.hasExportFilterDefinition()) {
            filterService.validate(rule.getExporterFilter());
        }
    }

