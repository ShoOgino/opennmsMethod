    public void validate(Rule rule) throws InvalidRuleException {
        // Name is required
        validateName(rule.getName());

        // Ensure that at least one field is defined (no catch all rule)
        if (!rule.hasDefinition()) {
            throw new InvalidRuleException(Errors.RULE_NO_DEFINITIONS);
        }
        // Ensure protocol is defined correctly
        if (rule.hasProtocolDefinition()) {
            validateProtocol(rule.getProtocol());
        }
        // Ensure port is defined correctly
        if (rule.hasPortDefinition()) {
            validatePort(rule.getPort());
        }
        // Ensure ip address is defined correctly
        if (rule.hasIpAddressDefinition()) {
            validateIpAddress(rule.getIpAddress());
        }
    }

