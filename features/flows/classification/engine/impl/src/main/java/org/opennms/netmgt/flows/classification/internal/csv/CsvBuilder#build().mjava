    public String build() {
        final StringBuilder csv = new StringBuilder();
        if (includeHeader) {
            csv.append(CsvServiceImpl.HEADERS_STRING);
        }
        final String rowFormat = IntStream.range(0, CsvServiceImpl.HEADERS.length)
                .mapToObj(i -> "%s")
                .collect(Collectors.joining(";"));
        csv.append(
                rules.stream()
                        .map(rule ->
                                String.format(rowFormat,
                                        rule.getName() == null ? "" : rule.getName(),
                                        rule.getProtocol() == null ? "" : rule.getProtocol(),
                                        rule.getSrcAddress() == null ? "" : rule.getSrcAddress(),
                                        rule.getSrcPort() == null ? "" : rule.getSrcPort(),
                                        rule.getDstAddress() == null ? "" : rule.getDstAddress(),
                                        rule.getDstPort() == null ? "" : rule.getDstPort(),
                                        rule.getExporterFilter() == null ? "" : rule.getExporterFilter()
                                )
                        )
                        .collect(Collectors.joining("\n")));
        return csv.toString();
    }

