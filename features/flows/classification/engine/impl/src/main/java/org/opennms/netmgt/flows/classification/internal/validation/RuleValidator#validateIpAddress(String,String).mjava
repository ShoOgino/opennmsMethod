    protected static void validateIpAddress(String errorContext, String ipAddressValue) throws InvalidRuleException {
        if (Strings.isNullOrEmpty(ipAddressValue)) {
            throw new InvalidRuleException(errorContext, Errors.RULE_IP_ADDRESS_INVALID, ipAddressValue);
        }
        try {
            StringValue value = new StringValue(ipAddressValue);
            if (!value.isWildcard()) {
                // The matches method parses the pattern (in this case the ipAddressValue) and validates
                // the address, as we don't care if it actually matches. We only want to know, if it considers the
                // "pattern" (in this case a concrete address) correct.
                IPLike.matches("8.8.8.8", ipAddressValue);
            }
        } catch (Exception ex) {
            throw new InvalidRuleException(errorContext, Errors.RULE_IP_ADDRESS_INVALID, ipAddressValue);
        }
    }

