    @Override
    public Response updateClassification(int id, ClassificationDTO newValue) {
        Rule rule = classificationDao.get(id);
        if (rule == null) return Response.status(NOT_FOUND).build();
        rule.setProtocol(newValue.getProtocol());
        rule.setPort(newValue.getPort());
        rule.setIpAddress(newValue.getIpAddress());
        rule.setName(newValue.getName());
        if (!rule.isValid()) return createInvalidRuleResponse(rule);

        // Persist
        return runInTransaction(status -> {
            classificationDao.save(rule);
            return Response.ok(convert(rule)).build();
        });
    }

