    private <K> Function<FlowSummaryResponse, Consumer<List<TrafficSummary<K>>>> defaultSummaryResponseConsumer(
            final String entitiesHeader,
            final Function<K, String> entityLabel,
            final boolean includeEcnInfo
    ) {
        // the ECN info column (i.e. the last column) is dropped in some cases
        Function<List, List> maybeDropLast = list -> {
            if (!includeEcnInfo) list.remove(list.size() - 1);
            return list;
        };
        return response -> summary -> {
            response.setHeaders(maybeDropLast.apply(Lists.newArrayList(entitiesHeader, "Bytes In", "Bytes Out", "ECN")));
            response.setRows(
                    summary
                            .stream()
                            .map(sum ->
                                    (List<Object>)maybeDropLast.apply(
                                            Lists.newArrayList((Object) entityLabel.apply(sum.getEntity()), sum.getBytesIn(), sum.getBytesOut(), sum.ecnInfo())
                                    )
                            )
                    .collect(Collectors.toList())
            );
        };
    }

