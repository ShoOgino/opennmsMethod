    @Test
    public void canGenerateFiltersFromQueryString() {
        MultivaluedHashMap<String, String> queryParams = new MultivaluedHashMap<>();
        List<Filter> filters = FlowRestServiceImpl.getFiltersFromQueryString(queryParams);

        // We should generate a single time range filter when no query parameters are specified
        assertThat(filters, hasSize(1));
        assertThat(filters, hasItem(isA(TimeRangeFilter.class)));

        // If we set a start and end, we just should get a time range filter with those timestamps
        queryParams.putSingle("start", "0");
        queryParams.putSingle("end", "1");
        filters = FlowRestServiceImpl.getFiltersFromQueryString(queryParams);
        assertThat(filters, contains(new TimeRangeFilter(0, 1)));

        // If we set an ifIndex, we just should get an ifindex filter
        queryParams.putSingle("start", "0");
        queryParams.putSingle("end", "1");
        queryParams.putSingle("ifIndex", "99");
        filters = FlowRestServiceImpl.getFiltersFromQueryString(queryParams);
        assertThat(filters, contains(new TimeRangeFilter(0, 1),
                new SnmpInterfaceIdFilter(99)));

        // If we set an exporterNode, we just should get an export node filter
        queryParams.putSingle("exporterNode", "FS:FID");
        filters = FlowRestServiceImpl.getFiltersFromQueryString(queryParams);
        assertThat(filters, contains(new TimeRangeFilter(0, 1),
                new SnmpInterfaceIdFilter(99),
                new ExporterNodeFilter(new NodeCriteria("FS:FID"))));
    }

