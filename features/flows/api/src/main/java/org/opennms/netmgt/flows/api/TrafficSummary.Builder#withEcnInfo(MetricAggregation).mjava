        public Builder<T> withEcnInfo(MetricAggregation outerAgg) {
            // sets the ecn info from corresponding elastic aggregations results
            MaxAggregation ceAgg = outerAgg.getMaxAggregation("congestion_encountered");
            if (ceAgg != null) {
                this.congestionEncountered = ceAgg.getMax() != null && ceAgg.getMax() > 0;
                MaxAggregation nonEctAgg = outerAgg.getMaxAggregation("non_ect");
                this.nonEcnCapableTransport = nonEctAgg.getMax() != null && nonEctAgg.getMax() > 0;
            }
            return this;
        }

