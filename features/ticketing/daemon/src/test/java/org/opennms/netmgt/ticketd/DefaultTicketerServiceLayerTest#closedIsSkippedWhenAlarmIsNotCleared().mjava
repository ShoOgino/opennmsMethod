    @Test
    public void closedIsSkippedWhenAlarmIsNotCleared() {
        System.setProperty(DefaultTicketerServiceLayer.SKIP_CLOSE_WHEN_NOT_CLEARED_SYS_PROP, "true");

        m_defaultTicketerServiceLayer = new DefaultTicketerServiceLayer();
        m_defaultTicketerServiceLayer.setAlarmDao(m_alarmDao);
        m_defaultTicketerServiceLayer.setTicketerPlugin(m_ticketerPlugin);

        m_alarm.setSeverity(OnmsSeverity.CRITICAL);
        EasyMock.expect(m_alarmDao.get(m_alarm.getId())).andReturn(m_alarm);

        m_easyMockUtils.replayAll();

        m_defaultTicketerServiceLayer.closeTicketForAlarm(m_alarm.getId(), "id");

        // Verify that no additional calls where made (such as trying to close the ticket)
        m_easyMockUtils.verifyAll();
    }

