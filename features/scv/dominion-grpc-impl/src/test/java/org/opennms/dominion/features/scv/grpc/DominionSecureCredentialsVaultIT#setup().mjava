    @Before
    public void setup() throws IOException {
        int freePort;

        try (ServerSocket socket = new ServerSocket(0)) {
            socket.setReuseAddress(true);
            freePort = socket.getLocalPort();
        }

        channel = ManagedChannelBuilder.forAddress(HOST, freePort)
                .usePlaintext()
                .build();
        Server server = ServerBuilder.forPort(freePort).addService(new MockDominionServer()).build();
        server.start();
        CompletableFuture.runAsync(() -> {
            try {
                server.awaitTermination();
            } catch (InterruptedException e) {
                throw new RuntimeException();
            }
        });


        DominionGrpcFactory factory = new DominionGrpcFactoryImpl(HOST, Integer.toString(freePort), CLIENT_ID,
                CLIENT_SECRET);
        scv = new DominionSecureCredentialsVault(factory.scvClient());
    }

