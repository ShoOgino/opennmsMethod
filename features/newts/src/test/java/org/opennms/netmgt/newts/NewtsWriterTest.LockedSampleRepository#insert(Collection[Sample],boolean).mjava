        @Override
        public void insert(Collection<Sample> samples, boolean calculateTimeToLive) {
            numThreadsLocked.incrementAndGet();
            lock.lock();
            numSamplesInserted.addAndGet(samples.size());
            lock.unlock();
            numThreadsLocked.decrementAndGet();
        }

