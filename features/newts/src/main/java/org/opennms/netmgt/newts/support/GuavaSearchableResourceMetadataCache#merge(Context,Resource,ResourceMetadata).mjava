    @Override
    public void merge(Context context, Resource resource, ResourceMetadata metadata) {

        Optional<ResourceMetadata> o = get(context, resource);

        if (!o.isPresent()) {
            ResourceMetadata newMetadata = new ResourceMetadata(m_metricReqs, m_attributeReqs, m_metricMisses, m_attributeMisses);
            newMetadata.merge(metadata);
            String key = key(context, resource.getId());
            m_cache.put(key, newMetadata);
            m_radixTree.put(key, newMetadata);
            return;
        }

        o.get().merge(metadata);

    }

