    @Test
    public void canGenerateRepositoryList() throws IOException {
        // Create repositories
        File repositories = tempFolder.newFolder("repositories");
        repositories.mkdirs();

        // Create an empty repository
        File emptyRepository = new File(repositories, "empty");
        emptyRepository.mkdirs();

        // Create a release (non-snapshot) repository
        File releaseRepository = new File(repositories, "release");
        releaseRepository.mkdirs();
        Files.write("mvn:group.id/artifact.id/2.0.0/xml",
                new File(releaseRepository, "feature-uris.meta"), Charsets.UTF_8);

        // Create a snapshot repository
        File snapshotRepository = new File(repositories, "snapshot");
        snapshotRepository.mkdirs();
        Files.write("#feature uris\n" +
                "mvn:other.group.id/other.artifact.id/1.0-SNAPSHOT/xml",
                new File(snapshotRepository, "feature-uris.meta"), Charsets.UTF_8);

        // Read and verify
        assertEquals(Lists.newArrayList(
                new Repository(emptyRepository.toPath(), Collections.emptyList()),
                new Repository(releaseRepository.toPath(),
                        Lists.newArrayList("mvn:group.id/artifact.id/2.0.0/xml")),
                new Repository(snapshotRepository.toPath(),
                        Lists.newArrayList("mvn:other.group.id/other.artifact.id/1.0-SNAPSHOT/xml"))),
                karafExtender.getRepositories());
    }

