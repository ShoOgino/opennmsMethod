    public HeartbeatProducer(MinionIdentity identity, MessageProducerFactory messageProducerFactory) {
        final MinionIdentityDTO identityDTO = new MinionIdentityDTO(identity);
        final MessageProducer<MinionIdentityDTO> delegate = messageProducerFactory.getProducer(new HeartbeatModule());
        timer = new Timer();
        timer.scheduleAtFixedRate(new TimerTask() {
            @Override
            public void run() {
                try {
                    LOG.info("Sending heartbeat to Minion with id: {} at location: {}",
                            identity.getId(), identity.getLocation());
                    delegate.send(identityDTO);
                } catch (Throwable t) {
                    LOG.error("An error occured while sending the heartbeat. Will try again in {} ms", PERIOD_MS, t);
                }
            }
        }, 0, PERIOD_MS);
    }

