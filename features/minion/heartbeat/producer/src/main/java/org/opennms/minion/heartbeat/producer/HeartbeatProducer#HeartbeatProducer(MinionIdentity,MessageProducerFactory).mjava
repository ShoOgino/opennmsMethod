    public HeartbeatProducer(MinionIdentity identity, MessageProducerFactory messageProducerFactory) {
        final MinionIdentityDTO identityDTO = new MinionIdentityDTO(identity);
        final MessageProducer<MinionIdentityDTO> delegate = messageProducerFactory.getProducer(new HeartbeatModule());
        timer = new Timer();
        timer.scheduleAtFixedRate(new TimerTask() {
            @Override
            public void run() {
                LOG.info("Sending heartbeat to Minion with id: {} at location: {}",
                         identity.getId(), identity.getLocation());
                delegate.send(identityDTO);
            }
        }, 0, PERIOD_MS);
    }

