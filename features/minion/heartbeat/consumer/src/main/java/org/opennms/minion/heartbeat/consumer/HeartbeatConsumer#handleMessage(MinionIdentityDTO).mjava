    @Override
    @Transactional
    public void handleMessage(MinionIdentityDTO minionHandle) {
        LOG.info("Received heartbeat for Minion with id: {} at location: {}",
                minionHandle.getId(), minionHandle.getLocation());
        OnmsMinion minion = minionDao.findById(minionHandle.getId());

        // defines whether the requisition has changed and has to be synchronized
        boolean requisitionUpdated = false;
        // defines whether this is the initial creation of the requisition
        boolean requisitionCreated = false;

        if (minion == null) {
            minion = new OnmsMinion();
            minion.setId(minionHandle.getId());
            minion.setLocation(minionHandle.getLocation());
        }

        final String foreignSourceName = "Minions@"+ minion.getLocation();

        Requisition requisition = m_deployedForeignSourceRepository.getRequisition(foreignSourceName);
        if (requisition == null) {
            requisition = new Requisition(foreignSourceName);

            requisitionCreated = true;
        }

        RequisitionNode requisitionNode = requisition.getNode(minion.getId());

        if (requisitionNode == null) {
            final RequisitionMonitoredService requisitionMonitoredService = new RequisitionMonitoredService();
            requisitionMonitoredService.setServiceName("Minion-Heartbeat");

            final RequisitionInterface requisitionInterface = new RequisitionInterface();
            requisitionInterface.setIpAddr("127.0.0.1");
            requisitionInterface.putMonitoredService(requisitionMonitoredService);

            requisitionNode = new RequisitionNode();
            requisitionNode.setNodeLabel(minion.getId());
            requisitionNode.setForeignId(minion.getLabel() != null ? minion.getLabel() : minion.getId());
            requisitionNode.setLocation(minion.getLocation());
            requisitionNode.putInterface(requisitionInterface);

            requisition.putNode(requisitionNode);

            requisitionUpdated = true;
        }

        if (requisitionCreated || requisitionUpdated) {
            requisition.setDate(new Date());
            m_deployedForeignSourceRepository.save(requisition);
            m_deployedForeignSourceRepository.flush();

            if (requisitionCreated) {
                final ForeignSource foreignSource = m_deployedForeignSourceRepository.getForeignSource(foreignSourceName);
                foreignSource.setDetectors(Collections.emptyList());
                foreignSource.setPolicies(Collections.emptyList());
                m_deployedForeignSourceRepository.save(foreignSource);
            }

            final EventBuilder eventBuilder = new EventBuilder(EventConstants.RELOAD_IMPORT_UEI, "Web");
            eventBuilder.addParam(EventConstants.PARM_URL, String.valueOf(m_deployedForeignSourceRepository.getRequisitionURL(foreignSourceName)));

            try {
                m_eventProxy.send(eventBuilder.getEvent());
            } catch (final EventProxyException e) {
                throw new DataAccessResourceFailureException("Unable to send event to import group " + foreignSourceName, e);
            }
        }

        Date lastUpdated = new Date();
        minion.setLastUpdated(lastUpdated);
        minionDao.saveOrUpdate(minion);
    }

