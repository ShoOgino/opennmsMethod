    private AggregateMinionStatus transformStatus(final AggregateMinionStatus currentStatus, final String serviceName, final Date ifRegainedService, final Date ifLostService) {
        final AggregateMinionStatus newStatus;
        if (ifRegainedService != null) {
            if (MINION_HEARTBEAT.equals(serviceName)) {
                newStatus = currentStatus.heartbeatUp();
            } else if (MINION_RPC.equals(serviceName)) {
                newStatus = currentStatus.rpcUp();
            } else {
                LOG.warn("Unhandled 'up' outage record: service={}, lost={}, regained={}", serviceName, ifLostService, ifRegainedService);
                newStatus = currentStatus;
            }
        } else {
            if (MINION_HEARTBEAT.equals(serviceName)) {
                newStatus = currentStatus.heartbeatDown();
            } else if (MINION_RPC.equals(serviceName)) {
                newStatus = currentStatus.rpcDown();
            } else {
                LOG.warn("Unhandled 'down' outage record: service={}, lost={}, regained={}", serviceName, ifLostService, ifRegainedService);
                newStatus = currentStatus;
            }
        }
        return newStatus;
    }

