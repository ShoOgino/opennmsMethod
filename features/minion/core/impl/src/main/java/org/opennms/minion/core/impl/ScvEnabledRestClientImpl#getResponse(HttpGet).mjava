	// Setup a client with pre-emptive authentication
    private CloseableHttpResponse getResponse(HttpGet httpget)
            throws Exception {
        CloseableHttpResponse response = null;
        HttpHost target = new HttpHost(url.getHost(), url.getPort(),
                                       url.getProtocol());
        CredentialsProvider credsProvider = new BasicCredentialsProvider();
        credsProvider.setCredentials(new AuthScope(target.getHostName(),
                                                   target.getPort()),
                                     new UsernamePasswordCredentials(
                                                                     username,
                                                                     password));
        CloseableHttpClient httpclient = HttpClients.custom().setDefaultCredentialsProvider(credsProvider).build();
        AuthCache authCache = new BasicAuthCache();
        BasicScheme basicAuth = new BasicScheme();
        authCache.put(target, basicAuth);

        HttpClientContext localContext = HttpClientContext.create();
        localContext.setAuthCache(authCache);

        response = httpclient.execute(target, httpget, localContext);
        return response;
    }

