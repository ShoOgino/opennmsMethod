    /**
     * One or more polling packages may be assigned to monitoring locations via the UI
     * From there we retrieve the matching packages stored in etc/poller-configuration.xml
     * Using the package definition, we retrieve all matching ifservices
     */
    public void scheduleAllServices() {
        final Map<String, List<RemotePolledService>> servicesByPackage = new HashMap<>();

        LOG.info("Scheduling all services...");
        sessionUtils.withReadOnlyTransaction(() -> {
            for (OnmsMonitoringLocation location : monitoringLocationDao.findAll()) {
                final List<String> pollingPackageNames = location.getPollingPackageNames();
                LOG.debug("Location '{}' has polling packages: {}", location.getLocationName(), pollingPackageNames);
                for (String pollingPackageName : pollingPackageNames) {
                    final List<RemotePolledService> servicesForPackage = servicesByPackage.computeIfAbsent(pollingPackageName, (pkgName) -> getServicesForPackage(location, pkgName));

                    for (RemotePolledService polledService : servicesForPackage) {
                        try {
                            scheduleService(location.getLocationName(), polledService);
                        } catch (SchedulerException e) {
                            LOG.warn("Failed to schedule {}.", polledService, e);
                        }
                    }
                }
            }
            return null;
        });
    }

