        private static <E> Stream<ServiceEntry<E>> flatten(final Map<InetAddress, Map<String, E>> services, final Node node) {
            return services.entrySet().stream()
                           .flatMap(e -> flatten(e.getValue(), node.iface(e.getKey())));
        }

