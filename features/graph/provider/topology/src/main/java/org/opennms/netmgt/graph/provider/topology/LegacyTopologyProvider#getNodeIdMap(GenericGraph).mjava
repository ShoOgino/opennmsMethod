    private Map<String, Map<String, Integer>> getNodeIdMap(GenericGraph graph) {
        final Set<String> foreignSources = graph.getVertices().stream()
                .filter(v -> v.getNodeRef() != null && v.getNodeRef().getNodeId() == null)
                .map(v -> v.getNodeRef().getForeignSource())
                .collect(Collectors.toSet());
        final Map<String, Map<String, Integer>> foreignSourceMap = Maps.newHashMap();
        for (String eachForeignSource : foreignSources) {
            final Map<String, Integer> foreignIdToNodeIdMap = nodeDao.getForeignIdToNodeIdMap(eachForeignSource);
            foreignSourceMap.put(eachForeignSource, foreignIdToNodeIdMap);
        }
        return foreignSourceMap;
    }

