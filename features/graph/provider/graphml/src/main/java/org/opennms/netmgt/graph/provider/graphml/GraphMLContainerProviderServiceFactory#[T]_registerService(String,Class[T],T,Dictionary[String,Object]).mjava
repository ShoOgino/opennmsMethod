    private <T> void registerService(String pid, Class<T> serviceType, T serviceImpl, Dictionary<String, Object> serviceProperties) {
        final ServiceRegistration<T> serviceRegistration = bundleContext.registerService(serviceType, serviceImpl, serviceProperties);
        containerRegistrations.putIfAbsent(pid, Lists.newArrayList());
        containerRegistrations.get(pid).add(serviceRegistration);
    }

