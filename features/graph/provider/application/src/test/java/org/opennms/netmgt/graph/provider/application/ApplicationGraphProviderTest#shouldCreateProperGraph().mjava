    @Test
    public void shouldCreateProperGraph() {
        final List<OnmsApplication> applications = generateApplications();
        final ApplicationDao dao = Mockito.mock(ApplicationDao.class);
        when(dao.findAll()).thenReturn(applications);

        final ApplicationGraphProvider provider = new ApplicationGraphProvider(new MockSessionUtils(), dao);
        final ImmutableGraph<ApplicationVertex, SimpleDomainEdge> graph = provider.loadGraph();
        assertEquals(30, graph.getVertices().size());
        assertEquals(25, graph.getEdges().size());

        for(OnmsApplication app: applications) {
            for(OnmsMonitoredService service : app.getMonitoredServices()) {
                verifyLinkingBetweenNodes(graph, graph.getVertex(createVertexId(app)), graph.getVertex(createVertexId(service)));
            }
        }
    }

