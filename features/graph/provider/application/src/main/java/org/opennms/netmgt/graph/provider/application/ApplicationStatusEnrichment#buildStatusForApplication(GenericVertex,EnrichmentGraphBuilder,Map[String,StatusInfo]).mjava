    StatusInfo buildStatusForApplication(final GenericVertex application, final EnrichmentGraphBuilder graphBuilder, final Map<String, StatusInfo> childStatusMap) {
        Collection<GenericEdge> services = graphBuilder.getView().getConnectingEdges(application);

        boolean allChildrenHaveActiveAlarms = services.size() > 0;

        final StatusInfo.StatusInfoBuilder rootStatusBuilder = StatusInfo.from(DEFAULT_STATUS);
        // Calculate max severity
        for (GenericEdge eachEdge : services) {
            final GenericVertex serviceVertex = graphBuilder.getView().resolveVertex(eachEdge.getTarget());
            final StatusInfo childStatus = Optional.ofNullable(childStatusMap.get(toId(serviceVertex))).orElse(StatusInfo.defaultStatus().build());
            final Severity childSeverity = childStatus.getSeverity();

            // check if all children have alarms
            if(Severity.Normal.isEqual(childSeverity) || Severity.Unknown.isEqual(childSeverity)){
                allChildrenHaveActiveAlarms = false;  // at least one child has no active alarm
            }

            // check for the highest severity
            if (rootStatusBuilder.getSeverity().isLessThan(childSeverity)) {
                rootStatusBuilder.severity(childSeverity);
            }

            // sum up all alarm counts from children
            rootStatusBuilder.count(rootStatusBuilder.getCount() + childStatus.getCount());
        }

        // if all children have active alarms, the application status must be at least major
        if (allChildrenHaveActiveAlarms && rootStatusBuilder.getSeverity().isLessThan(Severity.Major)) {
            rootStatusBuilder.severity(Severity.Major);
        }
        return rootStatusBuilder.build();
    }

