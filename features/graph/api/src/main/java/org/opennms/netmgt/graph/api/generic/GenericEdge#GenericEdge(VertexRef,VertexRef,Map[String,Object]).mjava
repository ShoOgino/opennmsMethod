    private GenericEdge(VertexRef source, VertexRef target, Map<String, Object> properties) {
        super(new MapBuilder<String, Object>()
                .withProperties(properties)
                .withProperty(GenericProperties.ID, properties.getOrDefault(GenericProperties.ID, source.getNamespace() + ":" + source.getId() + "->" + target.getNamespace() + ":" + target.getId()))
                .build());
        this.source = Objects.requireNonNull(source);
        this.target = Objects.requireNonNull(target);
        if (!source.getNamespace().equals(getNamespace()) && !target.getNamespace().equals(getNamespace())) {
            throw new IllegalArgumentException (
                    String.format("Neither the namespace of the source VertexRef(namespace=%s) nor the target VertexRef(%s) matches our namespace=%s",
                            source.getNamespace(), target.getNamespace(), getNamespace()));
        }
    }

