        // Verifies that either the source or target vertex are known by the graph
        private void assertEdgeContainsAtLeastOneKnownVertex(Edge edge) {
            Objects.requireNonNull(edge.getSource(), "Source vertex must be provided");
            Objects.requireNonNull(edge.getTarget(), "Target vertex must be provided");
            final VertexRef sourceRef = edge.getSource();
            final VertexRef targetRef = edge.getTarget();

            // neither source nor target share the same namespace => both unknown => not valid
            if (!sourceRef.getNamespace().equals(getNamespace()) && !targetRef.getNamespace().equals(getNamespace())) {
                throw new IllegalArgumentException(
                        String.format("Adding an Edge with two vertices of unknown namespace. Either the source or target vertex must match the graph's namespace (%s). But got: (%s, %s)",
                                getNamespace(), sourceRef.getNamespace(), targetRef.getNamespace()));
            }
            // source vertex is shared -> check if known
            if (sourceRef.getNamespace().equals(getNamespace())) {
                assertVertexFromSameNamespaceIsKnown(sourceRef);
            }
            // target vertex is shared -> check if known
            if (targetRef.getNamespace().equals(getNamespace())) {
                assertVertexFromSameNamespaceIsKnown(targetRef);
            }
        }

