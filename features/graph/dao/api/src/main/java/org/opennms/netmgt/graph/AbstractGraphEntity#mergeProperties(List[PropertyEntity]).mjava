    public void mergeProperties(List<PropertyEntity> propertyEntities) {
        for (PropertyEntity propertyEntity : propertyEntities) {
            final PropertyEntity alreadyExisting = getProperty(propertyEntity.getName());
            if (alreadyExisting != null) {
                alreadyExisting.setType(propertyEntity.getType());
                alreadyExisting.setValue(propertyEntity.getValue());
            } else {
                getProperties().add(propertyEntity);
            }
        }
        // This may be caused if a property name has changed. So we remove all non existing names
        if (getProperties().size() != propertyEntities.size()) {
            final List<String> newPropertyNames = propertyEntities.stream().map(pe -> pe.getName()).collect(Collectors.toList());
            final List<String> allPropertyNames = getProperties().stream().map(pe -> pe.getName()).collect(Collectors.toList());
            allPropertyNames.removeAll(newPropertyNames);
            // Now remove all
            allPropertyNames.forEach(propertyName -> getProperties().remove(getProperty(propertyName)));
        }
    }

