    public static ZoneId extractUserTimeZoneIdOrNull(final UI ui) {
        // Verify if a ui is provided, still attached and has a session
        if (ui != null && ui.isAttached() && ui.getSession() != null && ui.getSession().getSession() != null) {
            // Only the wrapped session has the attribute set, the VaadinSession does not!
            return (ZoneId) ui.getSession().getSession().getAttribute(CentralizedDateTimeFormat.SESSION_PROPERTY_TIMEZONE_ID);
        }
        return null;
    }

