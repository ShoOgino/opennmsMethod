	@Override
	protected void doGet(HttpServletRequest req,
			HttpServletResponse resp) throws ServletException,
			IOException {
		String path = req.getPathInfo();
		String resourcePath = VAADIN + path;

		String contentType = getServletContext().getMimeType(resourcePath);
		if (contentType != null) {
		    resp.setContentType(contentType);
		}

		URL resourceUrl = vaadin.getResource(resourcePath);

		if (null == resourceUrl) {
			resourceUrl = loadFromResources(resourcePath);
		}

		if (null == resourceUrl) {
			resp.sendError(HttpServletResponse.SC_NOT_FOUND);
			return;
		}

		InputStream in = resourceUrl.openStream();
		OutputStream out = resp.getOutputStream();

		byte[] buffer = new byte[1024];
		int read = 0;
		while (-1 != (read = in.read(buffer))) {
			out.write(buffer, 0, read);
		}
	}

