    @Test
    public void testMibExtraction() {
        final OnmsProblemEventHandler onmsProblemEventHandler = new OnmsProblemEventHandler(new SmiDefaultParser());

        final String validUnix = "/dev/opennms/develop/features/mib-compiler/src/test/resources/IF-MIB.txt:1116:11:snmpTraps";
        final String invalidUnix = "/dev/opennms/develop/features/mib-compiler/src/test/resources/G6-NOTIFICATION-MIB_0.20.mib : unexpected char: '='";
        final String validWindows = "C:\\dev\\opennms\\develop\\features\\mib-compiler\\src\\test\\resources\\IF-MIB.txt:1116:11:snmpTraps";
        final String invalidWindows = "C:\\dev\\opennms\\develop\\features\\mib-compiler\\src\\test\\resources\\G6-NOTIFICATION-MIB_0.20.mib : unexpected char: '='";

        Assert.assertEquals("snmpTraps", onmsProblemEventHandler.getMibFromSource(validUnix, '/'));
        Assert.assertNull(onmsProblemEventHandler.getMibFromSource(invalidUnix, '/'));
        Assert.assertEquals("snmpTraps", onmsProblemEventHandler.getMibFromSource(validWindows, '\\'));
        Assert.assertNull(onmsProblemEventHandler.getMibFromSource(invalidWindows, '\\'));

        final String kickIt = "C:\\something\\very:wrong\\this:should:be:null";
        final String beforeYou = "/this/should/also/be/null";
        final String lickIt = "/this:is:also:null:yeah";

        Assert.assertNull(onmsProblemEventHandler.getMibFromSource(kickIt,'\\'));
        Assert.assertNull(onmsProblemEventHandler.getMibFromSource(beforeYou,'/'));
        Assert.assertNull(onmsProblemEventHandler.getMibFromSource(lickIt,'/'));
    }

