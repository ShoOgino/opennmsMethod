    @Test
    public void canCollectNodeLevelResource() throws Exception {
        // Build the query
        JdbcQuery query = new JdbcQuery();
        query.setIfType("ignore");
        query.setQueryName("someJdbcQuery"); // This is the group name

        JdbcColumn column = new JdbcColumn();
        column.setColumnName("someColumnName");
        column.setAlias("someAlias");
        column.setDataType(AttributeType.GAUGE);
        query.addJdbcColumn(column);

        JdbcDataCollection collection = new JdbcDataCollection();
        collection.addQuery(query);

        // Mock the result set
        ResultSet resultSet = mock(ResultSet.class);
        when(resultSet.getRow()).thenReturn(1);
        when(resultSet.getString("someColumnName")).thenReturn("99");
        when(resultSet.next()).thenReturn(true).thenReturn(false);

        // Collect and verify
        CollectionSet collectionSet = collect(collection, resultSet);
        assertEquals(CollectionStatus.SUCCEEDED, collectionSet.getStatus());
        List<String> collectionSetKeys = CollectionSetUtils.flatten(collectionSet);
        assertEquals(Arrays.asList("snmp/1/someJdbcQuery/someAlias[null,99.0]"),
                collectionSetKeys);
    }

