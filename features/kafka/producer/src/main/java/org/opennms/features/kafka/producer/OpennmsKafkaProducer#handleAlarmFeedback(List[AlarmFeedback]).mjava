    @Override
    public void handleAlarmFeedback(List<AlarmFeedback> alarmFeedback) {
        if (!forwardAlarmFeedback) {
            return;
        }

        // NOTE: This will currently block while waiting for Kafka metadata if Kafka is not available.
        alarmFeedback.forEach(feedback -> sendRecord(() -> {
            LOG.debug("Sending alarm feedback with key: {}", feedback.getAlarmKey());

            return new ProducerRecord<>(alarmFeedbackTopic, feedback.getAlarmKey().getBytes(encoding),
                    protobufMapper.toAlarmFeedback(feedback).build().toByteArray());
        }, recordMetadata -> {
            // We've got an ACK from the server that the alarm feedback was forwarded
            // Let other threads know when we've successfully forwarded an alarm feedback
            forwardedAlarmFeedback.countDown();
        }));
    }

