    public OpennmsModelProtos.TopologyVertex.Builder toVertexTopologyMessage(String protocol,
            org.opennms.netmgt.topologies.service.api.OnmsTopologyVertex vertex) {
        final OpennmsModelProtos.TopologyVertex.Builder builder = OpennmsModelProtos.TopologyVertex.newBuilder()
                .setRef(getTopologyRef(protocol, vertex.getId()))
                .setLabel(vertex.getLabel());
        if (vertex.getNodeid() != null) {
            builder.setNode(getTopologyVertexNode(protocol, vertex));
        } else {
            builder.setSegment(getTopologyVertexSegment(protocol, vertex));
        }
        return builder;
    }

