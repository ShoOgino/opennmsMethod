    private void forwardTopologyUpdateMessage(OnmsTopologyMessage message) {
        if (message.getMessagebody() instanceof OnmsTopologyVertex) {
            OnmsTopologyVertex vertex = (OnmsTopologyVertex) message.getMessagebody();
            final OpennmsModelProtos.TopologyVertex mappedTopoMsg = 
                    protobufMapper.toVertexTopologyMessage(message.getProtocol().getId(),vertex).build();
            forwardTopologyVertexMessage(mappedTopoMsg.getRef().toByteArray(),
                                         mappedTopoMsg.toByteArray());
        } else if (message.getMessagebody() instanceof OnmsTopologyEdge) {
            OnmsTopologyEdge edge = (OnmsTopologyEdge) message.getMessagebody();
            final OpennmsModelProtos.TopologyEdge mappedTopoMsg = 
                    protobufMapper.toEdgeTopologyMessage(message.getProtocol().getId(),edge).build();
            forwardTopologyEdgeMessage(mappedTopoMsg.getRef().toByteArray(),
                                       mappedTopoMsg.toByteArray());
        } else {
            LOG.error("forwardTopologyUpdateMessage: no supported update class {}", message.getMessagebody().getClass().getName());
        }
    }

