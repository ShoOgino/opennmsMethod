  /**
   * Extracts the time part from a timestamp.
   *
   * @param timestamp The timestamp from which to extract the time.
   * @param tz The time zone of the time.
   * @return The extracted time.
   */
  public Time convertToTime(Timestamp timestamp, TimeZone tz) {
    long millis = timestamp.getTime();
    if (tz == null) {
      tz = defaultTz;
    }
    long low = -tz.getOffset(millis);
    long high = low + ONEDAY;
    if (millis < low) {
      do {
        millis += ONEDAY;
      } while (millis < low);
    }
    else if (millis >= high) {
      do {
        millis -= ONEDAY;
      } while (millis > high);
    }

    return new Time(millis);
  }

