    @SuppressWarnings({ "rawtypes" })
    public synchronized void onBind(S extension, Map properties) {
        LOG.debug("bind called with {}: {}", extension, properties);
        if (extension != null) {
            extServiceRegistrationMap.computeIfAbsent(extension, (ext) -> {
                final T mappedExt = map(ext);
                final Hashtable<String,Object> props = new Hashtable<>();
                // Make the service available to any Spring-based listeners
                props.put("registration.export", Boolean.TRUE.toString());
                return bundleContext.registerService(clazz, mappedExt, props);
            });
        }
    }

