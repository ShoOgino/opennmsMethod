    private void removeListener(EventListener listener, Consumer<EventListenerAdapter> removal) {
        final EventListenerAdapter adapter = eventListenerToAdapterMap.get(listener);
        if (adapter != null) {
            removal.accept(adapter);
            if (adapter.decrementReferenceCount() <= 0L) {
                eventListenerToAdapterMap.remove(listener);
                // Stop the listener thread
                delegate.removeEventListener(adapter);
            }
        }
    }

