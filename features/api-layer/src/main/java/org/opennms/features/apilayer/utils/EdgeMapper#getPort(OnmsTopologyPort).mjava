    private TopologyPort getPort(OnmsTopologyPort port) {
        ImmutableTopologyPort.Builder portBuilder = ImmutableTopologyPort.newBuilder()
                .setId(port.getId())
                .setTooltipText(port.getToolTipText())
                .setIfIndex(port.getIfindex())
                .setIfName(port.getIfname())
                .setIfAddress(port.getAddr());

        Integer nodeId = port.getVertex().getNodeid();
        ImmutableNodeCriteria.Builder nodeCriteriaBuilder = ImmutableNodeCriteria.newBuilder().setId(nodeId);

        nodeCriteriaCache.getNodeCriteria(nodeId.longValue()).ifPresent(nc -> {
            nodeCriteriaBuilder.setForeignSource(nc.getForeignSource());
            nodeCriteriaBuilder.setForeignId(nc.getForeignId());
        });

        portBuilder.setNodeCriteria(nodeCriteriaBuilder.build());

        return portBuilder.build();
    }

