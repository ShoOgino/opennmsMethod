    @Override
    public org.opennms.netmgt.poller.PollStatus poll(MonitoredService svc, Map<String, Object> parameters) {
        Map<String, String> attributes = getAttributes(parameters);
        PollerRequest monitoredService = new PollerRequestImpl(svc, attributes);
        ServicePoller servicePoller = servicePollerFactory.createPoller();
        CompletableFuture<PollerResult> future = servicePoller.poll(monitoredService);
        PollerResult pollStatus;
        try {
            pollStatus = future.get();
            switch (pollStatus.getStatus()) {
                case Up:
                    return PollStatus.up();
                case Down:
                    return PollStatus.down(pollStatus.getReason());
                case UnResponsive:
                    return PollStatus.unresponsive(pollStatus.getReason());
                case Unknown:
                    return PollStatus.unknown(pollStatus.getReason());
            }
        } catch (InterruptedException | ExecutionException e) {
            return PollStatus.down(e.getMessage());
        }
        return PollStatus.unknown(pollStatus.getReason());
    }

