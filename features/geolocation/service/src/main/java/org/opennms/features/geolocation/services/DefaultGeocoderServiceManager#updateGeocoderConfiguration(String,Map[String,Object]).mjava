    @Override
    public void updateGeocoderConfiguration(String geocoderId, Map<String, Object> properties) throws IOException {
        // Activate geocoder
        setActiveGeocodingService(geocoderId);

        // Now update the configuration
        // This will result in a bundle reload of the according bundle
        // Please keep in mind, that the config pid of the geocoder must be PID + geocoderId
        final String configPID = PID + "." + geocoderId;
        final Configuration configuration = configurationAdmin.getConfiguration(configPID, null);
        final Dictionary<String, Object> currentProperties = configuration.getProperties() != null ? configuration.getProperties() : new Hashtable<>();
        properties.entrySet().forEach(e -> {
            if (e.getValue() instanceof Boolean) {
                currentProperties.put(e.getKey(), Boolean.toString((Boolean)e.getValue()));
            } else {
                currentProperties.put(e.getKey(), e.getValue());
            }
        });
        // Ensure file will be created if it does not yet exist
        if (currentProperties.get("felix.fileinstall.filename") == null) {
            final Path configFile = Paths.get(System.getProperty("karaf.etc"), configPID + ".cfg");
            final Properties persistentProperties = new Properties();
            properties.entrySet().forEach(e -> persistentProperties.put(e.getKey(), e.getValue().toString()));
            persistentProperties.store(new FileOutputStream(configFile.toFile()), null);
        }
        configuration.update(currentProperties);
    }

