    private Status calculateStatus(GeolocationQuery query, Set<Integer> nodeIds) {
        final NodeStatusCalculatorConfig nodeStatusCalculatorConfig = new NodeStatusCalculatorConfig();
        nodeStatusCalculatorConfig.setIncludeAcknowledgedAlarms(query.isIncludeAcknowledgedAlarms());
        nodeStatusCalculatorConfig.setLocation(query.getLocation());
        if (query.getSeverity() != null) {
            final OnmsSeverity severity = OnmsSeverity.get(query.getSeverity().getId());
            final List<OnmsSeverity> severityFilter = Arrays.stream(OnmsSeverity.values()).filter(s -> s.isGreaterThanOrEqual(severity)).collect(Collectors.toList());
            nodeStatusCalculatorConfig.setSeverities(severityFilter);
        }
        if (query.getStatusCalculationStrategy() != null) {
            nodeStatusCalculatorConfig.setCalculationStrategy(NodeStatusCalculationStrategy.valueOf(query.getStatusCalculationStrategy().name()));
        }

        nodeStatusCalculatorConfig.setNodeIds(nodeIds);


        final Status status = nodeStatusCalculator.calculateStatus(nodeStatusCalculatorConfig);
        return status;
    }

