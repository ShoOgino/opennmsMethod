    /**
     * Allocates a new stream
     */
    private void newStream() throws IOException {
        LOG.debug("Opening new PipedOutputStream and adding it to the queue");

        // create a new piped writer
        final PipedOutputStream pipeOut = new PipedOutputStream();
        try {
            synchronized (pipeOut) {
                synchronized (m_xchange) {
                    m_xchange.add(pipeOut);
                    m_xchange.notify();
                }
                LOG.debug("Added pipe to the xchange list");

                pipeOut.wait();

                LOG.debug("Pipe Signaled");
            }
        } catch (final InterruptedException e) {
		LOG.debug("An I/O error occured.", e);
            throw new IOException("The thread was interrupted");
        }

        LOG.debug("PipedOutputStream connected");

        m_out = pipeOut;
    }

