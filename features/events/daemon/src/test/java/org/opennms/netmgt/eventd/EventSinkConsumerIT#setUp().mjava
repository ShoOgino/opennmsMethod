    @Before
    public void setUp() throws Exception {
        System.setProperty(String.format("%sbootstrap.servers", KafkaSinkConstants.KAFKA_CONFIG_SYS_PROP_PREFIX),
                kafkaServer.getKafkaConnectString());
        System.setProperty(String.format("%sauto.offset.reset", KafkaSinkConstants.KAFKA_CONFIG_SYS_PROP_PREFIX),
                "earliest");
        // Since Kafka consumer depends on above system properties to start, can't autowire below beans.
        KafkaMessageConsumerManager consumerManager = new KafkaMessageConsumerManager();
        consumerManager.afterPropertiesSet();
        EventSinkConsumer m_eventSinkConsumer = new EventSinkConsumer();
        m_eventSinkConsumer.setconfig(m_config);
        m_eventSinkConsumer.setEventForwarder(m_eventMgr);
        m_eventSinkConsumer.setMessageConsumerManager(consumerManager);
        consumerManager.registerConsumer(m_eventSinkConsumer);
        final Properties producerConfig = new Properties();
        producerConfig.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, kafkaServer.getKafkaConnectString());
        producerConfig.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getCanonicalName());
        producerConfig.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, ByteArraySerializer.class.getCanonicalName());
        producer = new KafkaProducer<>(producerConfig);
    }

