    @Test
    public void canExpandWithMatchValues() {
        // build the event definition
        org.opennms.netmgt.xml.eventconf.Event eventConfig = new org.opennms.netmgt.xml.eventconf.Event();
        eventConfig.setUei("test");
        Mask mask = new Mask();
        eventConfig.setMask(mask);
        Maskelement me = new Maskelement();
        me.setMename("generic");
        me.setMevalues(Collections.singletonList("6"));
        mask.addMaskelement(me);
        Varbind vb = new Varbind();
        vb.setVbnumber(1);
        vb.setVbvalues(Arrays.asList("~Node /(?<poolName>.*?)/(?<poolMember>\\S+) address (?<poolAddr>\\S+) monitor status down. .*\\(slot(?<slotNum>[0-9]+)\\)"));
        mask.addVarbind(vb);

        // build an event that will match the definition above
        EventBuilder builder = new EventBuilder("test", "test");
        builder.addParam("vb1", "Node /Common/10.129.1.30 address 10.129.1.31 monitor status down. [ /Common/icmp_default: down ] [ was up for 0hr:1min:10sec ] (slot1)");
        builder.setGeneric(6);
        Event event = builder.getEvent();

        // initialize the matchers
        eventConfig.initialize(new EventOrdering().next());

        // expand
        expand(event, eventConfig);

        // verify
        assertThat(event, hasParameter("poolName", "Common"));
        assertThat(event, hasParameter("poolMember", "10.129.1.30"));
        assertThat(event, hasParameter("poolAddr", "10.129.1.31"));
        assertThat(event, hasParameter("slotNum", "1"));
    }

