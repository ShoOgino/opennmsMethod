    @Test
    public void testNamedParameterExpansion() {
        // Create an expandable string that references N
        // distinct named parameters
        final int N = 6;
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < N; i++) {
            sb.append("%parm[" + i + "]%");
        }
        String expandable = sb.toString();

        // Now create an event with N parameters matching
        // the names that are referenced above
        EventBuilder eb = new EventBuilder("uei", "test");
        for (int i = 0; i < N; i++) {
            // The named parameters in the expandable should
            // match the parameters name here even when we pad
            // them with whitespace
            eb.addParam(" \n\t" + i + "\n\t ", i);
        }
        Event e = eb.getEvent();

        // Manually generate the expected string
        sb = new StringBuilder();
        for (int i = 0; i < N; i++) {
            sb.append(i);
        }
        String expected = sb.toString();

        // Expand!
        assertEquals(expected, eventUtil.expandParms(expandable, e));

        final int M = 1000;
        long start = System.currentTimeMillis();
        for (int i = 0; i < 1000; i++) {
            eventUtil.expandParms(expandable, e);
        }
        System.err.printf("Succesfully expanded %d events with %d parameters in %d ms\n",
                M, N, System.currentTimeMillis() - start);
    }

