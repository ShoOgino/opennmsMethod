	@Override
	public CompletableFuture<SyslogMessage> parse(ByteBuffer incoming) {
		ParserState state = new ParserState(incoming);

		// TODO: Use better collection than ArrayList?
		// We have to make sure that this list maintains the insertion order
		// so that the first future that completes is definitely returned by
		// {@link RadixTreeParser#firstNonNullResult()}
		final List<CompletableFuture<ParserState>> finishedFutures = new ArrayList<>();

		// Top of future tree is parser state
		final CompletableFuture<ParserState> parent = CompletableFuture.completedFuture(state);

		// Recursively construct the parser tree
		addStageFutures(finishedFutures, parent, tree);

		return firstNonNullResult(finishedFutures).thenApply(s -> {
			if (s == null) {
				return null;
			} else {
				return s.message;
			}
		});
	}

