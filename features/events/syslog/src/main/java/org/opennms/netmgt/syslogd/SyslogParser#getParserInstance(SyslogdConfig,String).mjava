    public static SyslogParser getParserInstance(SyslogdConfig config, String text) throws MessageDiscardedException {
        Class<? extends SyslogParser> m_parserClass = null;
        try {
            m_parserClass = Class.forName(config.getParser()).asSubclass(SyslogParser.class);
        } catch (final Exception ex) {
            LOG.debug("Unable to instantiate Syslog parser class specified in config: {}", config.getParser(), ex);
            m_parserClass = CustomSyslogParser.class;
        }

        final SyslogParser retval;
        try {
            Constructor<? extends SyslogParser> m = m_parserClass.getConstructor(SyslogdConfig.class, String.class);
            retval = (SyslogParser)m.newInstance(config, text);
        } catch (final Exception ex) {
            LOG.debug("Unable to get parser for class '{}'", m_parserClass.getName(), ex);
            throw new MessageDiscardedException(ex);
        }

        return retval;
    }

