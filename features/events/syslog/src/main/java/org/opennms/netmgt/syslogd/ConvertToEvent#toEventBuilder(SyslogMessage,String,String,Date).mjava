    public static final EventBuilder toEventBuilder(SyslogMessage message, String systemId, String location,
                                                    Date receivedTimestamp) {
        if (message == null) {
            return null;
        }

        // Build a basic event out of the syslog message
        final String priorityTxt = message.getSeverity().toString();
        final String facilityTxt = message.getFacility().toString();

        EventBuilder bldr = new EventBuilder();
        bldr.setUei("uei.opennms.org/syslogd/" + facilityTxt + "/" + priorityTxt);
        bldr.setSource("syslogd");

        // Set constant values in EventBuilder

        // Set monitoring system
        bldr.setDistPoller(systemId);
        // Set event host
        bldr.setHost(InetAddressUtils.getLocalHostName());
        // Set default event destination to logndisplay
        bldr.setLogDest("logndisplay");


        // Set values from SyslogMessage in the EventBuilder

        bldr.addParam("hostname", message.getHostName());

        final InetAddress hostAddress = message.getHostAddress();
        if (hostAddress != null) {
            // Set nodeId
            InterfaceToNodeCache cache = AbstractInterfaceToNodeCache.getInstance();
            if (cache != null) {
                cache.getFirstNodeId(location, hostAddress)
                        .ifPresent(bldr::setNodeid);
            }

            bldr.setInterface(hostAddress);
        }

        if (message.getDate() != null) {
            // The message has a date, transfer it to the event
            bldr.setTime(message.getDate());
        } else {
            boolean didSetPartialDate = false;

            if (message.getYear() != null) {
                bldr.setYear(message.getYear());
                didSetPartialDate = true;
            }
            if (message.getMonth() != null) {
                bldr.setMonth(message.getMonth());
                didSetPartialDate = true;
            }
            if (message.getDayOfMonth() != null) {
                bldr.setDayOfMonth(message.getDayOfMonth());
                didSetPartialDate = true;
            }
            if (message.getHourOfDay() != null) {
                bldr.setHourOfDay(message.getHourOfDay());
                didSetPartialDate = true;
            }
            if (message.getMinute() != null) {
                bldr.setMinute(message.getMinute());
                didSetPartialDate = true;
            }
            if (message.getSecond() != null) {
                bldr.setSecond(message.getSecond());
                didSetPartialDate = true;
            }
            if (message.getMillisecond() != null) {
                bldr.setMillisecond(message.getMillisecond());
                didSetPartialDate = true;
            }
            if (message.getZoneId() != null) {
                bldr.setZoneId(message.getZoneId());
                didSetPartialDate = true;
            }

            if (!didSetPartialDate && receivedTimestamp != null) {
                // We did not set *any* date information on the event - use the received timestamp
                bldr.setTime(receivedTimestamp);
            }
        }

        bldr.setLogMessage(message.getMessage());
        // Using parms provides configurability.
        bldr.addParam("syslogmessage", message.getMessage());

        bldr.addParam("severity", priorityTxt);

        bldr.addParam("timestamp", SyslogMessage.getRfc3164FormattedDate(bldr.currentEventTime()));

        if (message.getMessageID() != null) {
            bldr.addParam("messageid", message.getMessageID());
        }

        if (message.getProcessName() != null) {
            bldr.addParam("process", message.getProcessName());
        }

        bldr.addParam("service", facilityTxt);

        if (message.getProcessId() != null) {
            bldr.addParam("processid", message.getProcessId().toString());
        }

        return bldr;
    }

