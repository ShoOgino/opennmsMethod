    /**
     * Make sure the terminal case works where a hostname is the last grok pattern.
     */
    @Test
    public void testHostnameLastPattern() {
        RadixTreeParser oldRadixParser = RadixTreeSyslogParser.getRadixParser();

        // Create a custom radix tree parser that can handle our simple test message
        RadixTreeParser radixParser = new RadixTreeParser();
        radixParser.teach(GrokParserStageSequenceBuilder.parseGrok("%{STRING:message}: %{HOSTNAME:hostname}")
                .toArray(new ParserStage[0]));
        RadixTreeSyslogParser.setRadixParser(radixParser);
        String testPrefix = "%TEST-123: ";

        String testHostName = "my-test-host";
        String syslogMessage = testPrefix + testHostName;
        Event event = parseSyslog("testHostnameLastPattern", radixConfig, syslogMessage);
        assertEquals(testHostName, event.getParm("hostname").getValue().getContent());

        String testIp = "10.0.0.1";
        syslogMessage = testPrefix + testIp;
        event = parseSyslog("testHostnameLastPattern", radixConfig, syslogMessage);
        assertEquals(testIp, event.getParm("hostname").getValue().getContent());

        RadixTreeSyslogParser.setRadixParser(oldRadixParser);
    }

