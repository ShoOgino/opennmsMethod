    /**
     * Make sure that a syslog message with no host provided uses the source
     * address of the message log and that the node is is correctly populated as a result.
     */
    @Test
    public void testNoHostNameProvided() {
        String syslogMessage = "<14> Mar 29 2004 09:57:04: %PIX-5-304001: 192.168.0.2 Accessed URL " +
                "212.227.109.224:/scriptlib/ClientStdScripts.js";

        InetAddress localHostIP = InetAddressUtils.ONE_TWENTY_SEVEN;
        Integer nodeId = 1;

        // Mock the cache hit for the IP Address to Node ID lookup
        InterfaceToNodeCache originalCache = AbstractInterfaceToNodeCache.getInstance();
        InterfaceToNodeCache mockCache = Mockito.mock(InterfaceToNodeCache.class);
        AbstractInterfaceToNodeCache.setInstance(mockCache);
        when(mockCache.getFirstNodeId(MonitoringLocationDao.DEFAULT_MONITORING_LOCATION_ID,
                localHostIP)).thenReturn(Optional.of(nodeId));

        Event event = parseSyslog("testNoHostNameProvided", radixConfig, syslogMessage);
        String eventHostname = event.getParm("hostname").getValue().getContent();

        // Stop using the mock cache so we don't interfere with other tests
        AbstractInterfaceToNodeCache.setInstance(originalCache);

        assertNotNull(eventHostname);
        assertEquals(localHostIP, InetAddressUtils.addr(eventHostname));
        assertEquals(nodeId.intValue(), event.getNodeid().intValue());
    }

