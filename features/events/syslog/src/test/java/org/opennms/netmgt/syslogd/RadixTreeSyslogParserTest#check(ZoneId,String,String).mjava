    private void check(ZoneId expectedTimeZoneId, String timezoneProperty, String log) throws Exception {

        String configuration = "<syslogd-configuration>" +
                "<configuration " +
                "syslog-port=\"10514\" " +
                timezoneProperty+
                "/></syslogd-configuration>";

        final InputStream stream = new ByteArrayInputStream((configuration).getBytes());
        final SyslogdConfigFactory config = new SyslogdConfigFactory(stream);
        final RadixTreeSyslogParser parser = new RadixTreeSyslogParser(config, SyslogdTestUtils.toByteBuffer(log));
        SyslogMessage message = parser.parse();
        assertEquals(expectedTimeZoneId, message.getZoneId());
    }

