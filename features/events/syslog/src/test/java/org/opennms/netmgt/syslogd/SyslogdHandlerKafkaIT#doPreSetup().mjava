	@Override
	public void doPreSetup() throws Exception {
		super.doPreSetup();

		// Delete any existing Kafka log directory
		FileUtils.deleteDirectory(new File("target/kafka-log"));

		zkTestServer = new TestingServer(zookeeperPort);
		Properties properties = new Properties();
		properties.put("broker.id", "5001");
		properties.put("enable.zookeeper", "false");
		properties.put("host.name", "localhost");
		properties.put("log.dir", "target/kafka-log");
		properties.put("port", String.valueOf(kafkaPort));
		properties.put("zookeeper.connect",zkTestServer.getConnectString());
		try {
			kafkaConfig = new KafkaConfig(properties);
			kafkaServer = new KafkaServer(kafkaConfig, null);
			kafkaServer.startup();
		}
		catch(Exception e){
			e.printStackTrace();
		}
	}

