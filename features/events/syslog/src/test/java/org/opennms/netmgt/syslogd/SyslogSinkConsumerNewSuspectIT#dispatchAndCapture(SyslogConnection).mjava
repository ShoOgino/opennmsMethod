    /**
     * Converts given connection to a DTO and dispatches it to the consumer.
     *
     * We then wait until an Event is sent to the forwarder, and return the
     * captured event.
     */
    private Event dispatchAndCapture(SyslogConnection connection) {
        // Wrap
        SyslogMessageLogDTO messageLog = m_syslogSinkModule.toMessageLog(connection);
        // Dispatch
        m_syslogSinkConsumer.handleMessage(messageLog);
        // Capture
        await().until(() -> m_anticipator.getUnanticipatedEvents().size(), equalTo(1));
        // Capture
        final List<Event> events = m_anticipator.getUnanticipatedEvents();
        assertEquals(1, events.size());
        final Event event = events.get(0);
        m_anticipator.reset();
        return event;
    }

