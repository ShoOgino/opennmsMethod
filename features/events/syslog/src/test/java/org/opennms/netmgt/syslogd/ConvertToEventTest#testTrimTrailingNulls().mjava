    @Test
    public void testTrimTrailingNulls() {
        ByteBuffer allNulls = ByteBuffer.wrap(new byte[] { 0, 0, 0, 0, 0 });
        ByteBuffer allNullsTrimmed = ConvertToEvent.trimTrailingNulls(allNulls);

        allNulls.position(3);

        // Make sure that the original buffer's position and limit is unchanged
        assertEquals(3, allNulls.position());
        assertEquals(5, allNulls.limit());
        assertEquals(2, allNulls.remaining());

        assertEquals(0, allNullsTrimmed.position());
        assertEquals(0, allNullsTrimmed.limit());
        assertEquals(0, allNullsTrimmed.remaining());

        ByteBuffer middleByte = ByteBuffer.wrap(new byte[] { 0, 0, 4, 0, 0 });
        ByteBuffer middleByteTrimmed = ConvertToEvent.trimTrailingNulls(middleByte);

        middleByte.position(3);

        // Make sure that the original buffer's position and limit is unchanged
        assertEquals(3, middleByte.position());
        assertEquals(5, middleByte.limit());
        assertEquals(2, middleByte.remaining());

        assertEquals(0, middleByteTrimmed.position());
        assertEquals(3, middleByteTrimmed.limit());
        assertEquals(3, middleByteTrimmed.remaining());
    }

