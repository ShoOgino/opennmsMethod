    private void checkDateParserWith(TimeZone expectedTimeZone, String timezoneProperty) throws IOException {
        String configuration = "<syslogd-configuration>" +
                "<configuration " +
                "syslog-port=\"10514\" " +
                timezoneProperty+
                "/></syslogd-configuration>";

        final InputStream stream = new ByteArrayInputStream((configuration).getBytes());
        final SyslogdConfigFactory config = new SyslogdConfigFactory(stream);
        final SyslogParser parser = new Rfc5424SyslogParser(config, SyslogdTestUtils.toByteBuffer("something"));
        checkDateParserWith(expectedTimeZone, "yyyy-MM-dd'T'HH:mm:ss'Z'", parser);
        checkDateParserWith(expectedTimeZone, "yyyy-MM-dd'T'HH:mm:ss.SSSSSS'Z'", parser);
    }

