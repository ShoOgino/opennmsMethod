	/**
	 * Use Aries Blueprint synchronous mode to avoid a blueprint deadlock bug.
	 * 
	 * @see https://issues.apache.org/jira/browse/ARIES-1051
	 * @see https://access.redhat.com/site/solutions/640943
	 */
	@Override
	public void doPreSetup() throws Exception {
		System.setProperty("org.apache.aries.blueprint.synchronous", Boolean.TRUE.toString());
		System.setProperty("de.kalpatec.pojosr.framework.events.sync", Boolean.TRUE.toString());
		
		zkTestServer = new TestingServer(2181);
    	Properties properties = new Properties();
    	properties.put("port", "9092");
    	properties.put("host.name", "localhost");
    	properties.put("broker.id", "5001");
    	properties.put("enable.zookeeper", "false");
    	properties.put("zookeeper.connect",zkTestServer.getConnectString());
    	try{
    		kafkaConfig = new KafkaConfig(properties);
    		kafkaServer = new KafkaServer(kafkaConfig, null);
    		kafkaServer.startup();
    	}
    	catch(Exception e){
    		e.printStackTrace();
    	}
	}

