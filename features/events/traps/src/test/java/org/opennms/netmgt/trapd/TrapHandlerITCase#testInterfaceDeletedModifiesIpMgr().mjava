    @Test
    @DirtiesContext
    public void testInterfaceDeletedModifiesIpMgr() throws Exception {
        // Put the default list of nodes in the database
        m_dbPopulator.populateDatabase();

        // Sync the managed interface cache
        m_cache.dataSourceSync();

        long nodeId = 0;

        // Send an interfaceDeleted to clear the entry out of the cache
        Event event = anticipateEvent(EventConstants.INTERFACE_DELETED_EVENT_UEI, m_ip, m_dbPopulator.getNode1().getId());
        m_eventMgr.sendNow(event);

        // Anticipate the trap and the newSuspect event
        anticipateEvent("uei.opennms.org/default/trap", m_ip, nodeId);
        anticipateEvent(EventConstants.NEW_SUSPECT_INTERFACE_EVENT_UEI, m_ip, nodeId);

        try {
            Thread.sleep(100);
        } catch (InterruptedException e) {
            // do nothing
        }

        sendTrap("v1", null, 6, 1);

        finishUp();

        m_dbPopulator.resetDatabase();
        m_cache.clear();
    }

