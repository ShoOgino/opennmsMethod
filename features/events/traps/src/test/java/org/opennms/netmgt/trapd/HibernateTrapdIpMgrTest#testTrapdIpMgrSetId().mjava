    @Test
    @Transactional
    public void testTrapdIpMgrSetId() throws Exception {
        String ipAddr = m_databasePopulator.getNode2().getPrimaryInterface().getIpAddress().getHostAddress();
        long expectedNodeId = Long.parseLong(m_databasePopulator.getNode2().getNodeId());

        long nodeId = m_trapdIpMgr.getNodeId(ipAddr);
        Assert.assertEquals(expectedNodeId, nodeId);

        // Address already exists on database and it is not primary.
        Assert.assertEquals(-1, m_trapdIpMgr.setNodeId("192.168.1.3", 1));

        // Address already exists on database but the new node also contain the address and is their primary address.
        Assert.assertEquals(1, m_trapdIpMgr.setNodeId("192.168.1.3", m_testNodeId)); // return old nodeId
        Assert.assertEquals(m_testNodeId, m_trapdIpMgr.getNodeId("192.168.1.3")); // return the new nodeId
    }

