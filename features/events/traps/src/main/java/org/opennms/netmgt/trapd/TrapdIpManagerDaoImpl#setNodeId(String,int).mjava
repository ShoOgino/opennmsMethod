    /**
     * Sets the IP Address and Node ID in the Map.
     *
     * @param addr   The IP Address to add.
     * @param nodeid The Node ID to add.
     * @return The nodeid if it existed in the map.
     */
    @Override
    public synchronized int setNodeId(String addr, int nodeid) {
        if (addr == null || nodeid == -1) {
            return -1;
        }
        // Only add the address if it doesn't exist on the map. If it exists, only replace the current one if the new address is primary.
        if (m_knownips.containsKey(InetAddressUtils.getInetAddress(addr))) {
            OnmsIpInterface intf = m_ipInterfaceDao.findByNodeIdAndIpAddress(nodeid, addr);
            if (intf != null && intf.isPrimary()) {
                LOG.info("setNodeId: adding SNMP primary IP address {} to known IP list", intf);
                return intValue(m_knownips.put(InetAddressUtils.getInetAddress(addr), nodeid));
            } else {
                return -1;
            }
        } else {
            return intValue(m_knownips.put(InetAddressUtils.getInetAddress(addr), nodeid));
        }
    }

