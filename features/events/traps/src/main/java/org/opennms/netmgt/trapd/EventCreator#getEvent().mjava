    public Event getEvent() {
        long nodeId = -1;

        if (m_location == null) {
            // If there was no location in the trap message, assume that
            // it was generated in the default location
            nodeId = m_cache.getNodeId(MonitoringLocationDao.DEFAULT_MONITORING_LOCATION_ID, m_trapAddress);
        } else {
            nodeId = m_cache.getNodeId(m_location, m_trapAddress);
        }

        if (m_systemId == null) {
            // If there was no systemId in the trap message, assume that
            // it was generated by this system. Eventd will fill in the
            // systemId of the local system if it remains null here.
        } else {
            m_eventBuilder.setDistPoller(m_systemId);
        }

        if (nodeId != -1) {
            m_eventBuilder.setNodeid(nodeId);
        }
        return m_eventBuilder.getEvent();
    }

