    /**
     *  This method performs detection for all the IP Addressed that succeeded ping in parallel and returns a
     *  completable future with discovery results that succeeded detection.
     */
    private CompletableFuture<List<DiscoveryResult>> performDetection(String location, PingSweepSummary summary, DiscoveryConfiguration config) {

        List<CompletableFuture<DiscoveryResult>> futures = summary.getResponses().entrySet().stream()
                .map(entry -> launchDetectors(entry.getKey(), entry.getValue(), location, config)).collect(Collectors.toList());
        // Combine all futures.
        CompletableFuture<Void> allFutures = CompletableFuture.allOf(futures.toArray(new CompletableFuture[futures.size()]));
        CompletableFuture<List<DiscoveryResult>> futureList = allFutures.thenApply(result -> {
            return futures.stream().map(CompletableFuture::join).collect(Collectors.toList());
        });
        return futureList.thenApply((results) -> {
             return results.stream().filter(DiscoveryResult::getDetectResult).collect(Collectors.toList());
        });
    }

