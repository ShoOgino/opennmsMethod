    public DataSource createDataSource(ConnectionPool connectionPool, JdbcDataSource jdbcDataSource) throws Exception {
        Objects.requireNonNull(connectionPool);
        Objects.requireNonNull(jdbcDataSource);

        final String connectionPoolFactoryClassName = connectionPool.getFactory();
        final Class<?> clazz = Class.forName(connectionPoolFactoryClassName);
        final Constructor<?> constructor = clazz.getConstructor(new Class<?>[] { JdbcDataSource.class });
        final ClosableDataSource dataSource = (ClosableDataSource)constructor.newInstance(new Object[] { jdbcDataSource });
        dataSource.setIdleTimeout(connectionPool.getIdleTimeout());
        dataSource.setLoginTimeout(connectionPool.getLoginTimeout());
        dataSource.setMinPool(connectionPool.getMinPool());
        dataSource.setMaxPool(connectionPool.getMaxPool());
        dataSource.setMaxSize(connectionPool.getMaxSize());
        return dataSource;
    }

