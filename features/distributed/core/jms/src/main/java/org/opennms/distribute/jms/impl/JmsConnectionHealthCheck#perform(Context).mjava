    @Override
    public Response perform(Context context) {
        final ServiceReference<ConnectionFactory> connectionFactoryRef = bundleContext.getServiceReference(ConnectionFactory.class);
        if (connectionFactoryRef != null) {
            try {
                final ConnectionFactory connectionFactory = bundleContext.getService(connectionFactoryRef);
                if (connectionFactory != null) {
                    Connection jmsConnection = null;
                    try {
                        jmsConnection = connectionFactory.createConnection();
                        // NMS-9445: Attempt to use the connection by creating a session
                        // and immediately closing it.
                        jmsConnection.createSession(false, Session.AUTO_ACKNOWLEDGE).close();
                    } finally{
                        if (jmsConnection != null) {
                            try {
                                jmsConnection.close();
                            } catch(JMSException ex) {
                                return new Response(Status.Failure, "Failed to close the JMS connection: " + ex.getMessage());
                            }
                        }
                    }
                    return new Response(Status.Success);
                }
            } catch (Exception ex) {
                return new Response(Status.Failure, "Failed to create a JMS session." + ex.getMessage(), ex);
            } finally {
                bundleContext.ungetService(connectionFactoryRef);
            }
        }
        return null;
    }

