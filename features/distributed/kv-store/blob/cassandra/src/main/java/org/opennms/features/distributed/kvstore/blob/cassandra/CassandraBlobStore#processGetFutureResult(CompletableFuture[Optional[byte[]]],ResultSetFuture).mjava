    private static void processGetFutureResult(CompletableFuture<Optional<byte[]>> future,
                                               ResultSetFuture resultSetFuture) {
        ResultSet resultSet;

        try {
            resultSet = resultSetFuture.getUninterruptibly();
        } catch (Exception e) {
            future.completeExceptionally(e);
            return;
        }

        Row row = resultSet.one();

        // Could not find the key
        if (row == null) {
            future.complete(Optional.empty());
            return;
        }

        future.complete(Optional.of(row.getBytes(VALUE_COLUMN).array()));
    }

