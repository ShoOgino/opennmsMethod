    @Test
    public void canGetOnlyIfNotStale() {
        String key = "key2";
        String context = "value2";
        String value = "{\"hello\": \"world\"}";

        // Shouldn't exist yet
        assertThat(postgresJSONStore.getIfStale(key, context, 0), equalTo(Optional.empty()));

        // Write the value
        long insertedAt = postgresJSONStore.put(key, value, context);

        // Attempt to get the value with a non-stale timestamp
        Optional<Optional<String>> retrievedValue = postgresJSONStore.getIfStale(key, context, insertedAt + 1);
        assertThat(retrievedValue, equalTo(Optional.of(Optional.empty())));

        // Attempt to get the value with a stale timestamp
        retrievedValue = postgresJSONStore.getIfStale(key, context, insertedAt - 1);
        assertThat(retrievedValue, equalTo(Optional.of(Optional.of(value))));
    }

