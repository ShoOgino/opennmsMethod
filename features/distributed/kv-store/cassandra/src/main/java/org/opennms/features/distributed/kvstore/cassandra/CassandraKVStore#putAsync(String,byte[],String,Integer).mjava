    @Override
    public CompletableFuture<Long> putAsync(String key, byte[] value, String context, Integer ttlInSeconds) {
        CompletableFuture<Long> putFuture = new CompletableFuture<>();
        long timestamp = System.currentTimeMillis();

        try {
            Statement statement = getStatementForInsert(key, context, ByteBuffer.wrap(value), timestamp, ttlInSeconds);
            // Cassandra will throw a runtime exception here if the execution fails
            session.executeAsync(statement)
                    .addListener(() -> putFuture.complete(timestamp), MoreExecutors.directExecutor());
        } catch (Exception e) {
            putFuture.completeExceptionally(e);
        }

        return putFuture;
    }

