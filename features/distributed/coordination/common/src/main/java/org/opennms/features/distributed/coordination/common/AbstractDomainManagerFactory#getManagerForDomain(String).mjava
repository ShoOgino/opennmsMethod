    @Override
    public synchronized final DomainManager getManagerForDomain(String domain) {
        if (!Objects.requireNonNull(domain).matches("^[a-zA-Z0-9.-_]*$")) {
            throw new IllegalArgumentException("Invalid domain");
        }

        if (domainManagers.containsKey(domain)) {
            LOG.debug("Returning existing manager for domain {}", domain);

            return domainManagers.get(domain);
        } else {
            LOG.debug("Creating new manager for domain {}", domain);
            DomainManager domainManager = createManagerForDomain(domain);
            domainManagers.put(domain, domainManager);

            return domainManager;
        }
    }

