    /**
     * Test registering after deregistering to make sure we still get notified.
     *
     * @throws Exception
     */
    @Test
    public void testReregister() throws Exception {
        testServer.start();

        manager.register(id, (role, domain) -> {});
        manager.deregister(id);

        register();
        assertEquals(domain, activeFuture.get(10, TimeUnit.SECONDS));
    }

