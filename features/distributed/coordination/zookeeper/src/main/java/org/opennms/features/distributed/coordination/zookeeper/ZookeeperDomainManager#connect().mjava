    @Override
    protected void connect() {
        if (isConnected()) {
            return;
        }

        if (client == null) {
            client = clientBuilder.build();
        }

        client.start();

        boolean blocked = true;
        while (blocked) {
            try {
                LOG.info("Connecting to ZooKeeper with client {}", client);
                client.blockUntilConnected();
                blocked = false;
                LOG.info("Connected to ZooKeeper");
            } catch (InterruptedException e) {
                LOG.warn("Interrupted while connecting to ZooKeeper", e);
            }
        }

        if (leaderSelector == null) {
            leaderSelector = new LeaderSelector(client, "/" + getDomain(),
                    leaderSelectorListener);
        }

        leaderSelector.autoRequeue();
        leaderSelector.start();
    }

