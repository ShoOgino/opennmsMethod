    @Override
    public List<BusinessService> apply(BusinessServiceManager businessServiceManager, List<BusinessService> businessServiceDTOs) {
        Stream<BusinessService> s = businessServiceDTOs.stream();

        for (String nameRegexp : m_nameFilters) {
            s = s.filter(p -> p.getName().matches(nameRegexp));
        }


        for (Pair<String, String> pair : m_attributeFilters) {
            s = s.filter(p -> p.getAttributes().containsKey(pair.getA()) && p.getAttributes().get(pair.getA()).matches(pair.getB()));
        }

        for (Pair<CompareOperator, OnmsSeverity> pair : m_severityFilters) {
            s = s.filter(p -> pair.getA().check(businessServiceManager.getOperationalStatusForBusinessService(p).compareTo(pair.getB())));
        }

        Comparator<BusinessService> comparator = new Comparator<BusinessService>() {
            @Override
            public int compare(BusinessService p1, BusinessService p2) {
                switch (m_order) {
                    case Name: {
                        return p1.getName().compareTo(p2.getName());
                    }
                    case Severity: {
                        return businessServiceManager.getOperationalStatusForBusinessService(p1).compareTo(businessServiceManager.getOperationalStatusForBusinessService(p2));
                    }
                    default:
                        throw new IllegalArgumentException("Order not set");
                }
            }
        };

        if (!m_ascending) {
            comparator = comparator.reversed();
        }

        s = s.sorted(comparator);

        if (m_limit > 0) {
            s = s.limit(m_limit);
        }

        return s.collect(Collectors.toList());
    }

