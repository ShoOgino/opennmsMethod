    @Test
    public void testReduce() {
        Map<Edge, Status> edgeStatusMap = new HashMap<>();
        edgeStatusMap.put(new TestEdge(1, new Identity()), Status.MINOR);
        edgeStatusMap.put(new TestEdge(1, new Identity()), Status.MAJOR);
        edgeStatusMap.put(new TestEdge(1, new Identity()), Status.WARNING);

        HighestSeverityAbove reduceFunction = new HighestSeverityAbove();
        reduceFunction.setThreshold(Status.CRITICAL);

        Assert.assertEquals(Optional.empty(), reduceFunction.reduce(Maps.newHashMap()));
        Assert.assertEquals(Optional.empty(), reduceFunction.reduce(edgeStatusMap));

        edgeStatusMap.put(new TestEdge(1, new Identity()), Status.CRITICAL);
        Assert.assertEquals(Optional.of(Status.CRITICAL), reduceFunction.reduce(edgeStatusMap));
    }

