    @Test
    public void ensureNoDanglingMapFunctions() {
        // Create a business service with an edge
        final BusinessService bs = this.createBusinessService("bs1");
        bs.addReductionKeyEdge("my-reduction-key", new Increase(), Edge.DEFAULT_WEIGHT, "My Reduction Key");
        bs.save();

        // Ensure there is an associated mapping function
        assertEquals(1, mapFunctionDao.countAll());

        Iterables.getOnlyElement(bs.getReductionKeyEdges())
                 .setMapFunction(new Decrease());
        bs.save();

        // Ensure there is still only one associated mapping function
        assertEquals(1, mapFunctionDao.countAll());

        // Delete an edge
        bs.delete();

        // Ensure there are no mapping functions left
        assertEquals(0, mapFunctionDao.countAll());
    }

