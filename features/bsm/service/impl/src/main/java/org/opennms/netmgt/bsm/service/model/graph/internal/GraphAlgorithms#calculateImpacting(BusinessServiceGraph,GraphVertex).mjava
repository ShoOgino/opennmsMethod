    public static Set<GraphEdge> calculateImpacting(BusinessServiceGraph graph, GraphVertex parent) {
        // Grab all of the child edges
        List<GraphEdge> childEdges = graph.getOutEdges(parent).stream()
                .collect(Collectors.toList());

        // Weigh and reduce the statuses
        List<StatusWithIndex> statuses = DefaultBusinessServiceStateMachine.weighEdges(childEdges);
        Optional<StatusWithIndices> reducedStatus = parent.getReductionFunction().reduce(statuses);

        if (!reducedStatus.isPresent()) {
            return Collections.emptySet();
        } else {
            return reducedStatus.get().getIndices().stream()
                .map(idx -> childEdges.get(idx))
                .collect(Collectors.toSet());
        }
    }

