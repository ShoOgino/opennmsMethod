    @Override
    public <T extends Edge> T createEdge(Class<T> type, BusinessService source, MapFunction mapFunction) {
        T edge = null;
        // TODO MVR do differently maybe enum
        if (type == IpServiceEdge.class) {
            edge = (T) new IpServiceEdgeImpl(this, new org.opennms.netmgt.bsm.persistence.api.IPServiceEdge());
        }
        if (type == ChildEdge.class) {
            edge = (T) new ChildEdgeImpl(this, new BusinessServiceChildEdge());
        }
        if (type == ReductionKeyEdge.class) {
            edge = (T) new ReductionKeyEdgeImpl(this, new SingleReductionKeyEdge());
        }
        if (edge != null) {
            edge.setSource(source);
            edge.setMapFunction(mapFunction);
            return edge;
        }
        throw new IllegalArgumentException("Could not create edge for type " + type);
    }

