    public static List<StatusWithIndex> weighEdges(Collection<GraphEdge> edges) {
        return weighStatuses(edges.stream()
                .collect(Collectors.toMap(Function.identity(), GraphEdge::getStatus,
                        (u,v) -> { throw new IllegalStateException(String.format("Duplicate key %s", u)); },
                        LinkedHashMap::new)));
    }

