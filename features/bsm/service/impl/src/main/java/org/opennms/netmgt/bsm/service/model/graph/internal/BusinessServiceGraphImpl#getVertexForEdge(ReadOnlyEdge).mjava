    private GraphVertex getVertexForEdge(ReadOnlyEdge edge) {
        if (edge.getType() == Edge.Type.REDUCTION_KEY) {
            return m_verticesByReductionKey.get(((ReadOnlyReductionKeyEdge) edge).getReductionKey());
        }
        if (edge.getType() == Edge.Type.CHILD_SERVICE) {
            return m_verticesByBusinessServiceId.get(((ReadOnlyChildEdge) edge).getChild().getId());
        }
        if (edge.getType() == Edge.Type.IP_SERVICE) {
            return m_verticesByIpServiceId.get(((ReadOnlyIpServiceEdge) edge).getIpService().getId());
        }
        throw new IllegalArgumentException("Unsupported edge of type: " + edge.getType().name());
    }

