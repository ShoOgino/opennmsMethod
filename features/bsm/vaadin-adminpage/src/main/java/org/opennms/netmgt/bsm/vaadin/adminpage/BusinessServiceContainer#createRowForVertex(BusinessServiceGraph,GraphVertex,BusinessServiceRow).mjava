    private void createRowForVertex(BusinessServiceGraph graph, GraphVertex graphVertex, BusinessServiceRow parentRow) {
        final BusinessService businessService = graphVertex.getBusinessService();
        if (businessService == null) {
            return;
        }

        final long rowId = rowIdCounter.incrementAndGet();
        final Long parentBusinessServiceId = parentRow != null ? parentRow.getBusinessService().getId() : null;
        final BusinessServiceRow row = new BusinessServiceRow(rowId, businessService, parentBusinessServiceId);
        if (parentRow != null) {
            rowIdToParentRowIdMapping.put(rowId, parentRow.getRowId());
        }
        addBean(row);

        // Recurse with all of the children
        graph.getOutEdges(graphVertex).stream()
                .map(e -> graph.getOpposite(graphVertex, e))
                .filter(v -> v.getBusinessService() != null)
                .sorted((v1, v2) -> v1.getBusinessService().getName().compareTo(v2.getBusinessService().getName()))
                .forEach(v -> createRowForVertex(graph, v, row));
    }

