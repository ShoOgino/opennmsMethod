    public BusinessServiceEntity toEntity() {
        BusinessServiceEntity entity = new BusinessServiceEntity();
        entity.setName(name);
        entity.setId(id);
        entity.setAttributes(attributes);
        if (reduceFunction != null) {
            entity.setReductionFunction(reduceFunction);
        }

        // TODO MVR we have to deal with the map function stuff
        ipServices.forEach(e -> entity.addIpService(e, new Identity()));
        children.forEach(e -> entity.addChildren(e, new Identity()));
        reductionKeys.forEach(e -> entity.addReductionKey(e, new Identity()));

        // TODO MVR deal with this
        if (!parents.isEmpty()) {
            throw new RuntimeException("This is not supported anymore");
        }
        return entity;
    }

