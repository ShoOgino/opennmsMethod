    @Test
    public void canCreateReadUpdateAndDeleteReductionFunctions() {
        // Initially there should be no reduction functions
        assertEquals(0, m_reductionFunctionDao.countAll());

        // Create a reduction function
        ThresholdEntity threshold = new ThresholdEntity();
        threshold.setThreshold(0.75f);

        m_reductionFunctionDao.save(threshold);
        m_reductionFunctionDao.flush();

        // Read a reduction function
        assertEquals(threshold, m_reductionFunctionDao.get(threshold.getId()));

        // Update a reduction function
        threshold.setThreshold(0.5f);
        m_reductionFunctionDao.save(threshold);
        m_reductionFunctionDao.flush();

        ThresholdEntity otherThreshold = (ThresholdEntity)m_reductionFunctionDao.get(threshold.getId());
        assertEquals(threshold, otherThreshold);
        assertEquals(1, m_reductionFunctionDao.countAll());

        // Delete a reduction function
        m_reductionFunctionDao.delete(threshold);
        assertEquals(0, m_reductionFunctionDao.countAll()); 
    }

