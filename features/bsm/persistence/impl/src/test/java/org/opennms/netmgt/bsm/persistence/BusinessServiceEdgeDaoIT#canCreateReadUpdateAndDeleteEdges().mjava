    @Test
    public void canCreateReadUpdateAndDeleteEdges() {
        // Create a business service
        BusinessService bs = new BusinessService();
        bs.setName("Web Servers");
        bs.setAttribute("dc", "RDU");
        bs.setReductionFunction(m_mostCritical);
        m_businessServiceDao.save(bs);
        m_businessServiceDao.flush();

        // Initially there should be no edge
        assertEquals(0, m_businessServiceEdgeDao.countAll());

        // Create an edge
        IPServiceEdge edge = new IPServiceEdge();
        edge.setMapFunction(m_identity);
        edge.setBusinessService(bs);

        // Grab the first monitored service from node 1
        OnmsMonitoredService ipService = m_databasePopulator.getNode1()
                .getIpInterfaces().iterator().next()
                .getMonitoredServices().iterator().next();
        edge.setIpService(ipService);
        m_businessServiceEdgeDao.save(edge);
        m_businessServiceEdgeDao.flush();

        // Read an edge
        assertEquals(edge, m_businessServiceEdgeDao.get(edge.getId()));

        // Update an edge
        edge.setWeight(2);
        m_businessServiceEdgeDao.save(edge);
        m_businessServiceEdgeDao.flush();

        AbstractBusinessServiceEdge otherEdge = m_businessServiceEdgeDao.get(edge.getId());
        assertEquals(edge, otherEdge);
        assertEquals(1, m_businessServiceEdgeDao.countAll());

        // Delete an edge
        m_businessServiceEdgeDao.delete(edge);
        assertEquals(0, m_businessServiceEdgeDao.countAll()); 
    }

