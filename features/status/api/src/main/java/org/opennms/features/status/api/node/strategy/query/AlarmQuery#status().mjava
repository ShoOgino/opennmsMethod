    @Override
    public Status status() {
        sql = new StringBuilder();
        sql.append("SELECT ").append(getViewName()).append(".nodeid").append(", ").append(getSeverityColumn()).append(" AS severity, alarm_count, alarm_count_unack ");
        sql.append("FROM ").append(getViewName()).append(" ");
        sql.append("JOIN node on ").append(getViewName()).append(".nodeid = node.nodeid ") ;

        applyRestrictions();
        applyOrder();
        applyLimitAndOffset();

        final Status status = new Status();
        executeQuery((RowHandler<Object[]>) columns -> status.add(
                (int) columns[0], // nodeId
                OnmsSeverity.get((int) columns[1]), // node status
                columns[2] != null ? ((BigInteger) columns[2]).longValue() : 0, // alarm count
                columns[3] != null ? ((BigInteger) columns[3]).longValue() : 0 // unacknowledged count
        ));

        return status;
    }

