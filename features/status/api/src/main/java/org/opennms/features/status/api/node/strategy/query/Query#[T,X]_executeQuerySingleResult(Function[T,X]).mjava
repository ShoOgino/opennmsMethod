    protected <T, X> X executeQuerySingleResult(Function<T, X> function) {
        final List<T> rows = genericPersistenceAccessor.executeNativeQuery(sql.toString(), parameterMap);
        if (rows == null || rows.size() != 1) {
            throw new IllegalStateException("Query returned multiple rows, but only 1 expected");
        }
        T column = rows.get(0);
        return function.apply(column);
    }

