    /**
     * Since Java 1.7.0u45, only "secure" system properties are allowed
     * via Java Web Start so remap properties with "secure" prefixes to
     * normal system properties. This circumvents the Java Web Start
     * checks without altering any of our code or vendor code that relies
     * on system properties (like log4j2).
     *
     * @see https://docs.oracle.com/javase/7/docs/technotes/guides/javaws/developersguide/syntax.html#application_desc
     */
    private static void copyJnlpSystemProperties() {
        Properties systemPropertiesClone = (Properties)System.getProperties().clone();
        for (String prefix : new String[] { "jnlp.", "javaws." }) {
            systemPropertiesClone.forEach((propKey,value) -> {
                String key = (String)propKey;
                if (key.startsWith(prefix)) {
                    String newKey = key.substring(prefix.length());
                    System.out.printf("Copying system property %s to %s\n", key, newKey);
                    System.setProperty(newKey, (String)value);
                }
            });
        }
    }

