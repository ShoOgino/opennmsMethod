	private PollerFrontEnd getPollerFrontEnd(final AbstractApplicationContext context) {
		PollerFrontEnd frontEnd = (PollerFrontEnd) context.getBean("pollerFrontEnd");

		frontEnd.addPropertyChangeListener(new PropertyChangeListener() {

			private boolean shouldExit(PropertyChangeEvent e) {
				LOG.info("shouldExit: received property change event for property: {}; oldvalue: {}; newvalue: {}", e.getPropertyName(), e.getOldValue(), e.getNewValue());
				String propName = e.getPropertyName();
				Object newValue = e.getNewValue();

				// if exitNecessary becomes true.. then return true
				if (PollerFrontEndStates.exitNecessary.toString().equals(propName) && Boolean.TRUE.equals(newValue)) {
					LOG.info("shouldExit: Exiting because exitNecessary is TRUE");
					return true;
				}

				// if started becomes false the we should exit
				if (PollerFrontEndStates.started.toString().equals(propName) && Boolean.FALSE.equals(newValue)) {
					LOG.info("shouldExit: Exiting because started is now false");
					return true;
				}

				LOG.info("shouldExit: not exiting");
				return false;
			}

			@Override
			public void propertyChange(PropertyChangeEvent e) {
				if (shouldExit(e)) {
					// MVR: gracefully shutdown scheduler, otherwise context.close() will raise 
					// an exception. See #NMS-6966 for more details.
					if (context.isActive()) {
						try {
							LOG.info("Shutting down PollerFrontEnd scheduler");
							((Scheduler)context.getBean("scheduler")).shutdown();
						} catch (SchedulerException ex) {
							LOG.warn("Shutting down PollerFrontEnd scheduler failed", ex);
						}
						LOG.info("PollerFrontEnd scheduler shutdown complete");

						// now close the application context
						context.close();
					}

					new Thread() {
						public void run() {
							// Sleep for a couple of seconds so that the other
							// PropertyChangeListeners get a chance to fire
							try { Thread.sleep(5000); } catch (InterruptedException e) {}
							System.exit(10);
						}
					}.start();
				}
			}
		});

		return frontEnd;
	}

