    @Test
    public void testValidFields() throws Exception {
        final Set<MetadataField> fields = getReader("target/test-classes/metadata.properties").getMetadataFields();
        assertEquals(3, fields.size());
        final Iterator<MetadataField> i = fields.iterator();

        assertTrue(i.hasNext());
        MetadataField field = i.next();
        assertEquals("Foo", field.getDescription());
        assertNotNull(field.getValidator());
        assertTrue(field.getValidator().getClass().equals(IntegerValidator.class));
        assertTrue(field.isRequired());
        
        assertTrue(i.hasNext());
        field = i.next();
        assertEquals("Bar", field.getDescription());
        assertNotNull(field.getValidator());
        assertTrue(field.getValidator().getClass().equals(InetAddressValidator.class));
        assertFalse(field.isRequired());

        assertTrue(i.hasNext());
        field = i.next();
        assertEquals("Baz", field.getDescription());
        assertNull(field.getValidator());
        assertTrue(field.isRequired());

        assertFalse(i.hasNext());
    }

