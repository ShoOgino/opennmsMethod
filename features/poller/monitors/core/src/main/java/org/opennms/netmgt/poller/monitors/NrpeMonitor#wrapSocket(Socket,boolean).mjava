    /**
     * <p>wrapSocket</p>
     *
     * @param socket a {@link java.net.Socket} object.
     * @param useSsl a boolean.
     * @return a {@link java.net.Socket} object.
     * @throws java.io.IOException if any.
     */
    protected Socket wrapSocket(Socket socket, boolean useSsl) throws IOException {
    	if (!useSsl) {
    		return socket;
    	} else {
    	    // Set this socket to use anonymous Diffie-Hellman ciphers. This removes the authentication
    	    // benefits of SSL, but it's how NRPE rolls so we have to play along.
	    return SocketUtils.wrapSocketInSslContext(socket, null, ADH_CIPHER_SUITES);
    	}
    	
    }

