        private Properties getServiceProperties(MonitoredService svc) {
            final InetAddress addr = InetAddressUtils.addr(svc.getIpAddr());
            boolean requireBrackets = addr != null && addr instanceof Inet6Address && !svc.getIpAddr().startsWith("[");
            Properties properties = new Properties();
            properties.put("ipaddr", requireBrackets ? "[" + svc.getIpAddr() + "]" : svc.getIpAddr());
            properties.put("nodeid", svc.getNodeId());
            properties.put("nodelabel", svc.getNodeLabel());
            properties.put("svcname", svc.getSvcName());
            return properties;
        }

