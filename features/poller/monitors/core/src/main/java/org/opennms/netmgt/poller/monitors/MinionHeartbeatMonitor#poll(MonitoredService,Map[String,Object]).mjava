    @Override
    public PollStatus poll(final MonitoredService svc, final Map<String, Object> parameters) {
        // Minions send heartbeat every 30 seconds - we check that we can skip not more than one beat
        final int period = 2 * ParameterMap.getKeyedInteger(parameters, "period", 30 * 1000);

        // Get the minion to test whereas the minion ID is the nodes foreign ID by convention
        final OnmsNode node = nodeDao.get().get(svc.getNodeId());
        final OnmsMinion minion = minionDao.get().findById(node.getForeignId());

        // Calculate the time since the last heartbeat was received
        final long lastSeen = System.currentTimeMillis() - minion.getLastUpdated().getTime();

        final PollStatus status;
        if (lastSeen <= period) {
            status = PollStatus.available();
        } else {
            status = PollStatus.unavailable(String.format("Last heartbeat was %.2f seconds ago", lastSeen / 1000.0));
        }

        return status;
    }

