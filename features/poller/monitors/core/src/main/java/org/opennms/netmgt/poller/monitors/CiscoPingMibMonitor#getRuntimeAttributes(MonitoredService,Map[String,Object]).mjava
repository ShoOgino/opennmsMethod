    @Override
    public Map<String, Object> getRuntimeAttributes(MonitoredService svc, Map<String, Object> parameters) {
        final Map<String, Object> attributes = new HashMap<>(super.getRuntimeAttributes(svc, parameters));

        // Determine the target address
        final InetAddress targetIpAddr = (InetAddress) determineTargetAddress(svc, parameters);

        // Determine the node to use as our IOS ping proxy
        final InetAddress proxyIpAddr = determineProxyAddress(parameters, svc);
        if (proxyIpAddr == null) {
            LOG.debug("Unable to determine proxy address for this service");
            throw new IllegalStateException("Unable to determine proxy address for this service");
        }

        attributes.put("targetIpAddr", InetAddrUtils.str(targetIpAddr));
        attributes.put("proxyIpAddr", InetAddrUtils.str(proxyIpAddr));
        return attributes;
    }

