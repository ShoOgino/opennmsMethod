    /**
     * Restore a key pair from the encoded representation of the keys
     */
    static KeyPair keyPair(String encodedPub, String encodedPriv) throws Exception {
        KeyFactory kf = KeyFactory.getInstance(ALGORITHM, BOUNCY_CASTLE_PROVIDER);
        PublicKey pub = kf.generatePublic(new X509EncodedKeySpec(Base64.getDecoder().decode(encodedPub)));
        PrivateKey priv = kf.generatePrivate(new PKCS8EncodedKeySpec(Base64.getDecoder().decode(encodedPriv)));
        return new KeyPair(pub, priv);
    }

