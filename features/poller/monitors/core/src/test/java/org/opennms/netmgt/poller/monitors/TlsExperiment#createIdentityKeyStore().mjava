    /**
     * Create a KeyStore containing a single key with a self-signed certificate.
     *
     * @return a KeyStore containing a single key with a self-signed certificate.
     */
    static KeyStore createIdentityKeyStore() throws Exception {
        PrivateCredential cred = createSelfSignedCredentials();

        KeyStore store = KeyStore.getInstance("JKS");

        store.load(null, null);

        store.setKeyEntry("identity", cred.getPrivateKey(), ID_STORE_PASSWORD, new Certificate[]{cred.getCertificate()});

        return store;
    }

