    private List<Sample> getBucket(Map<Instant, List<Sample>> buckets, Instant instant) {
        long offset = instant.toEpochMilli() - startTime.toEpochMilli();
        long startOfBucket = startTime.toEpochMilli() + (offset / this.bucketSize.toMillis()) * this.bucketSize.toMillis();
        return buckets.computeIfAbsent(Instant.ofEpochMilli(startOfBucket), inst -> new ArrayList<>());
    }

