    private Set<Metric> searchFor(ResourcePath path, int depth) {
        final Set<Metric> results;
        try {
            results = searcher.search(path, depth);
            LOG.trace("Found {} results.", results.size());
        } catch (StorageException e) {
            LOG.error("An error occurred while querying for {}", path, e);
            throw new RuntimeException(e);
        }
        return results;
    }

