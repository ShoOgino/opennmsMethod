    // this only works if we have exactly one column in a row. */
    public static Sample toTimeseriesSample(final Results.Row<Measurement> row, final Metric metric) {

        // check preconditions
        final int sizeOfRow = row.getElements().size();
        if(row.getElements().size() != 1) {
            throw new IllegalArgumentException(String.format("expected exactly one column in row but was %s", sizeOfRow));
        }

        // and convert
        Measurement measurement = row.getElements().iterator().next();
        return ImmutableSample.builder()
                .metric(metric)
                .time(toInstant(measurement.getTimestamp()))
                .value(measurement.getValue())
                .build();
    }

