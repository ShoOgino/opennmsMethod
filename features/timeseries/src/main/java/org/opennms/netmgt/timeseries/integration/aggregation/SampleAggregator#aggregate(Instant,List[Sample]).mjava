    private Sample aggregate(final Instant startOfBucket, final List<Sample> samples) {
        if (samples == null || samples.isEmpty()) {
            return null;
        }
        List<Double> values = samples.stream().map(Sample::getValue).collect(Collectors.toList());
        Double value = getAggregation().apply(values);
        return ImmutableSample.builder()
                .metric(this.expectedMetric)
                .time(startOfBucket)
                .value(value).build();
    }

