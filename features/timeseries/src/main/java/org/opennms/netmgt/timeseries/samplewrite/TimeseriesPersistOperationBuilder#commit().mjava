    @Override
    public void commit() {
        try(final Timer.Context context = commitTimer.time()) {
            writer.insert(getSamplesToInsert());
            writer.index(getSamplesToIndex());
        }
    }

