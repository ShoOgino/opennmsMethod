    private void storeMetadata(SampleBatchEvent event) throws SQLException, ExecutionException {
        // dedouble attributes
        Set<MetaData> metaData = new HashSet<>();
        for(Sample sample : event.getSamples()) {
            Metric metric = sample.getMetric();
            String resourceId = metric.getFirstTagByKey(IntrinsicTagNames.resourceId).getValue();
            metric.getMetaTags().forEach(tag -> metaData.add(new MetaData(resourceId, tag.getKey(), tag.getValue())));
        }
        this.timeSeriesMetaDataDao.store(metaData);
    }

