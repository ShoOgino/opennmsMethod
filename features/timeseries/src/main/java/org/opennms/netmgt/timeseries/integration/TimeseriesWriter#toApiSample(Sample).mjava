    private org.opennms.integration.api.v1.timeseries.Sample toApiSample(final Sample sample) {

        ImmutableMetric.MetricBuilder builder = ImmutableMetric.builder()
                .intrinsicTag(IntrinsicTagNames.resourceId, sample.getResource().getId())
                .intrinsicTag(IntrinsicTagNames.name, sample.getName())
                .metaTag(typeToTag(sample.getType()));

        if(sample.getResource().getAttributes().isPresent()) {
            sample.getResource().getAttributes().get().forEach(builder::metaTag);
        }

        final ImmutableMetric metric = builder.build();
        final Instant time = Instant.ofEpochMilli(sample.getTimestamp().asMillis());
        final Double value = sample.getValue().doubleValue();

        return ImmutableSample.builder().metric(metric).time(time).value(value).build();
    }

