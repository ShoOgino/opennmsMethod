    @Override
    public void onEvent(SampleBatchEvent event) throws Exception {
        // We'd expect the logs from this thread to be in collectd.log
        Logging.putPrefix("collectd");

        // Decrement our entry counter
        numEntriesOnRingBuffer.decrementAndGet();

        if (event.isIndexOnly()) {
            storeMetadata(event);
        } else {
            storeTimeseriesData(event);
            storeMetadata(event);
        }
    }

