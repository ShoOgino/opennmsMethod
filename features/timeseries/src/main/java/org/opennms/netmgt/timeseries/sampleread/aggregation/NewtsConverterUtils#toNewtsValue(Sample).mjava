    private static ValueType<?> toNewtsValue(final Sample sample) {
        final Metric.Mtype mtype = Metric.Mtype.valueOf(sample.getMetric().getFirstTagByKey(IntrinsicTagNames.mtype).getValue());
        if(Metric.Mtype.count == mtype) {
            return new Counter(sample.getValue().longValue());
        } else if(Metric.Mtype.gauge == mtype) {
            return new Gauge(sample.getValue());
        } else  {
            throw new IllegalArgumentException(String.format("I don't know how to map %s to ValueType", mtype));
        }
    }

