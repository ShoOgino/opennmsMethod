    @Test
    public void shouldRejectWrongMetric() {
        ImmutableMetric wrongMetric = ImmutableMetric.builder()
                .intrinsicTag(IntrinsicTagNames.resourceId, "otherResource").build();

        sample(10, 10);
        samples.add(ImmutableSample.builder().metric(wrongMetric).time(Instant.ofEpochMilli(11)).value(11d).build());
        assertThrowsException(IllegalArgumentException.class, () -> compute(Aggregation.AVERAGE, 10, 24, 5));
    }

