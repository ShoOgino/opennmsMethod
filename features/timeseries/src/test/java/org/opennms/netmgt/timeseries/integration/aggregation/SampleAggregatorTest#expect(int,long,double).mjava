    private void expect(int index, long timeInMillis, double value) {
        if (results.size() <= index) {
            fail(String.format("Bucket with index %s not found", index));
        }
        Sample bucket = this.results.get(index);
        assertEquals(this.metric, bucket.getMetric());
        assertEquals(timeInMillis, bucket.getTime().toEpochMilli());
        assertEquals(Double.valueOf(value), bucket.getValue());
    }

