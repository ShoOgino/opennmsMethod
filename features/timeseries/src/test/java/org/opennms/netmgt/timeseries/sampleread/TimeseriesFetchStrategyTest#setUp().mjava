    @Before
    public void setUp() {
        resourceDao = EasyMock.createNiceMock(ResourceDao.class);
        this.timeSeriesStorage = Mockito.mock(TimeSeriesStorage.class);
        when(timeSeriesStorage.supportsAggregation(Aggregation.AVERAGE)).thenReturn(true);
        storageManager = Mockito.mock(TimeseriesStorageManager.class);
        when(storageManager.get()).thenReturn(this.timeSeriesStorage);
        storageManager.onBind(this.timeSeriesStorage, new HashMap<String, String>());

        fetchStrategy = new TimeseriesFetchStrategy();
        fetchStrategy.setResourceDao(resourceDao);
        fetchStrategy.setTimeseriesStorageManager(storageManager);
        fetchStrategy.setMetricRegistry(new MetricRegistry());
    }

