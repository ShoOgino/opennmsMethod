    private List<Sample> retrieveSamples(final String resourceId, final String name) throws StorageException {
        List<Metric> metrics = timeseriesStorageManager.get().getMetrics(Arrays.asList(
                new ImmutableTag(IntrinsicTagNames.resourceId, resourceId),
                new ImmutableTag(IntrinsicTagNames.name, name)));
        assertEquals(1, metrics.size());

        TimeSeriesFetchRequest request = ImmutableTimeSeriesFetchRequest.builder()
                .aggregation(Aggregation.NONE)
                .start(Instant.ofEpochMilli(0))
                .end(Instant.now())
                .step(Duration.ofSeconds(1))
                .metric(metrics.get(0)).build();

        return timeseriesStorageManager.get().getTimeseries(request);
    }

