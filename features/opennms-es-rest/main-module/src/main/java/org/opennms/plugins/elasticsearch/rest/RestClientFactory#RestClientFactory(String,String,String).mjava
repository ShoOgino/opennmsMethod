	/**
	 * Create a RestClientFactory.
	 * 
	 * @param elasticSearchURL Elasticsearch URL, either a single URL or
	 *   multiple URLs that are comma-separated without spaces
	 * @param esusername Optional HTTP username
	 * @param espassword Optional HTTP password
	 */
	public RestClientFactory(String elasticSearchURL, String esusername, String espassword ) throws MalformedURLException {

		// If multiple URLs are specified in a comma-separated string, split them up
		final List<String> targetHosts = Arrays.asList(elasticSearchURL.split(","));
		final HttpClientConfig.Builder configBuilder = new HttpClientConfig.Builder(targetHosts).multiThreaded(true);
		if (!Strings.isNullOrEmpty(esusername) && !Strings.isNullOrEmpty(espassword)) {
			final URL targetUrl = new URL(targetHosts.get(0));

			if (targetHosts.size() > 1) {
				LOG.warn("Credentials have been defined, but multiple target hosts were found. " +
						"Each host will use the same credentials. Preemptive auth is only enabled for host {}", targetHosts.get(0));
			}

			configBuilder.defaultCredentials(esusername, espassword);
			configBuilder.setPreemptiveAuth(new HttpHost(targetUrl.getHost(), targetUrl.getPort(), targetUrl.getProtocol()));
		}
		config = configBuilder.build();

		factory = new JestClientFactory();

		factory.setHttpClientConfig(config);

	}

