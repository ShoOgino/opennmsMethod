	/**
	 * This executes single Elasticsearch actions, creating indices as needed.
	 * 
	 * @param client
	 * @param action
	 * @throws IOException
	 */
	private static void executeSingleAction(JestClient client, BulkableAction<DocumentResult> action) throws IOException {

		DocumentResult result = client.execute(action);

		if(result.getResponseCode() == 404){
			// index doesn't exist for upsert command so create new index and try again

			if(LOG.isDebugEnabled()) {
				logEsDebug(action.getRestMethodName(), action.getIndex(), action.getType(), result.getJsonString(), result.getResponseCode(), result.getErrorMessage());
				LOG.debug("index name "+action.getIndex() + " doesn't exist, creating new index");
			}

			createIndex(client, action.getIndex(), action.getType());

			result = client.execute(action);
		}

		if(result.getResponseCode() != 200){
			logEsError(action.getRestMethodName(), action.getIndex(), action.getType(), result.getJsonString(), result.getResponseCode(), result.getErrorMessage());
		} else if(LOG.isDebugEnabled()) {
			logEsDebug(action.getRestMethodName(), action.getIndex(), action.getType(), result.getJsonString(), result.getResponseCode(), result.getErrorMessage());
		}
	}

