    @Test
    public void shouldGiveCollapsedIndexesForLayeredTimeRanges() throws ParseException {

        Check.strategy(IndexStrategy.HOURLY)
                .from("2015-11-29 23:05").to("2018-02-02 02:10")
                .expected("prefix-2015-11-29-23"
                        , "prefix-2015-11-30-*"
                        , "prefix-2015-12-*"
                        , "prefix-2016-*"
                        , "prefix-2017-*"
                        , "prefix-2018-01-*"
                        , "prefix-2018-02-01-*"
                        , "prefix-2018-02-02-00"
                        , "prefix-2018-02-02-01"
                        , "prefix-2018-02-02-02")
                .check();

        Check.strategy(IndexStrategy.DAILY)
                .from("2015-11-28 23:05").to("2018-02-01 22:59")
                .expected("prefix-2015-11-28"
                        , "prefix-2015-11-29"
                        , "prefix-2015-11-30"
                        , "prefix-2015-12-*"
                        , "prefix-2016-*"
                        , "prefix-2017-*"
                        , "prefix-2018-01-*"
                        , "prefix-2018-02-01")
                .check();

        Check.strategy(IndexStrategy.MONTHLY)
                .from("2015-12-29 22:05").to("2018-01-02 03:10")
                .expected("prefix-2015-12"
                        , "prefix-2016-*"
                        , "prefix-2017-*"
                        , "prefix-2018-01")
                .check();

        Check.strategy(IndexStrategy.YEARLY)
                .from("2016-11-29 22:05").to("2018-02-02 03:10")
                .expected("prefix-2016"
                        , "prefix-2017"
                        , "prefix-2018")
                .check();
    }

