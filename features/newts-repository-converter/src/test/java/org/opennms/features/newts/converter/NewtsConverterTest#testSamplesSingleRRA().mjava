    /**
     * Test samples for a single RRA
     *
     * @throws Exception the exception
     */
    @Test
    public void testSamplesSingleRRA() throws Exception {
        final File source = new File("src/test/resources/sample-counter.xml");
        final RRDv3 rrd = JaxbUtils.unmarshal(RRDv3.class, source);
        Assert.assertNotNull(rrd);

        final NavigableMap<Long, List<Double>> samples = NewtsConverter.generateSamples(rrd, rrd.getRras().get(0));
        Assert.assertFalse(samples.isEmpty());
        Assert.assertEquals(12, samples.size());

        long ts = 1441748400L;
        Double v1 = 600.0;
        Double v2 = 2.0;
        for (final Map.Entry<Long, List<Double>> s : samples.entrySet()) {
            Assert.assertEquals(2, s.getValue().size());
            Assert.assertEquals(ts, (long) s.getKey());
            Assert.assertEquals(v1, s.getValue().get(0));
            Assert.assertEquals(v2, s.getValue().get(1));
            ts += 300L;
            v1 += 300.0 * v2;
            v2 += 1.0;
        }
    }

