    private MBeanServerConnection getConnection() {
        try {
            final Set<Integer> processes = getOpenNMSProcesses();
            JMXServiceURL url = new JMXServiceURL("service:jmx:rmi:///jndi/rmi://:1099/jmxrmi");
            if (processes.size() > 0) {
                url = getURLForPid(processes.iterator().next());
            }
            JMXConnector jmxc = JMXConnectorFactory.connect(url, null);
            return jmxc.getMBeanServerConnection();
        } catch (final Exception e) {
            LogUtils.infof(this, e, "Unable to get JMX connection to OpenNMS.");
        }
        return null;
    }

