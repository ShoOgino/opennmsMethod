    public void persistOperations(TransactionTemplate template, OnmsDao dao) {
    	m_stats.beginProcessingOps();
    	m_stats.setDeleteCount(getDeleteCount());
    	m_stats.setInsertCount(getInsertCount());
    	m_stats.setUpdateCount(getUpdateCount());
		PooledExecutor dbPool = new PooledExecutor(new LinkedQueue());
		dbPool.setMinimumPoolSize(m_writeThreads);

		preprocessOperations(template, dao, new OperationIterator(), dbPool);
    	
		dbPool.shutdownAfterProcessingCurrentlyQueuedTasks();
		try { dbPool.awaitTerminationAfterShutdown(); } catch (InterruptedException e) { log().error("persister interrupted!", e); }
		
		m_stats.finishProcessingOps();
    	
    }

