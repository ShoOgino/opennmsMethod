    /**
     * <p>mergeNodeAttributes</p>
     *
     * @param scannedNode a {@link org.opennms.netmgt.model.OnmsNode} object.
     */
    public void mergeNodeAttributes(OnmsNode scannedNode, EventForwarder eventForwarder) {
        if (hasNewValue(scannedNode.getLabel(), getLabel())) {
            // Create a NODE_LABEL_CHANGED_EVENT_UEI event
            EventBuilder bldr = new EventBuilder(EventConstants.NODE_LABEL_CHANGED_EVENT_UEI, "OnmsNode.mergeNodeAttributes");

            bldr.setNodeid(scannedNode.getId());
            bldr.setHost("host");

            if (getLabel() != null) {
                bldr.addParam(EventConstants.PARM_OLD_NODE_LABEL, getLabel());
                bldr.addParam(EventConstants.PARM_OLD_NODE_LABEL_SOURCE, getLabelSource());
            }

            if (scannedNode.getLabel() != null) {
                bldr.addParam(EventConstants.PARM_NEW_NODE_LABEL, scannedNode.getLabel());
                bldr.addParam(EventConstants.PARM_NEW_NODE_LABEL_SOURCE, scannedNode.getLabelSource());
            }

            eventForwarder.sendNow(bldr.getEvent());

            // Update the node label value
            setLabel(scannedNode.getLabel());
        }
    
        if (hasNewValue(scannedNode.getForeignSource(), getForeignSource())) {
            setForeignSource(scannedNode.getForeignSource());
        }
    
        if (hasNewValue(scannedNode.getForeignId(), getForeignId())) {
            setForeignId(scannedNode.getForeignId());
        }
        
        if (hasNewValue(scannedNode.getLabelSource(), getLabelSource())) {
            setLabelSource(scannedNode.getLabelSource());
        }
        
        if (hasNewValue(scannedNode.getNetBiosName(), getNetBiosDomain())) {
            setNetBiosName(scannedNode.getNetBiosDomain());
        }
        
        if (hasNewValue(scannedNode.getNetBiosDomain(), getNetBiosDomain())) {
            setNetBiosDomain(scannedNode.getNetBiosDomain());
        }
        
        if (hasNewValue(scannedNode.getOperatingSystem(), getOperatingSystem())) {
            setOperatingSystem(scannedNode.getOperatingSystem());
        }
        
        mergeAgentAttributes(scannedNode);
        
        mergeAdditionalCategories(scannedNode);
    }

