    /**
     * This method is passed a list of strings and a maximum string size that
     * must not be exceeded by the composite string.
     *
     * @param strings
     *            The list of String objects.
     * @param maxlen
     *            The maximum length of the composite string
     * @return The composite string.
     * @exception java.lang.ClassCastException
     *                Thrown if any processed item in the list is not a string
     *                object.
     */
    public static String format(List<String> strings, int maxlen) {
        if (strings == null) {
            return null;
        }

        StringBuffer buf = new StringBuffer();
        boolean first = true;
        Iterator<String> i = strings.iterator();

        while (i.hasNext() && buf.length() < maxlen) {
            String s = i.next();
            s = escape(s, MULTIPLE_VAL_DELIM);
            if (!first) {
                buf.append(MULTIPLE_VAL_DELIM);
            }
            buf.append(s);
            first = false;
        }

        if (buf.length() >= maxlen) {
            buf.setLength(maxlen - 4);
            buf.append(VALUE_TRUNCATE_INDICATOR);
        }
        return buf.toString();
    }

