        public BridgeTopologyHelper(Bridge xBridge, List<BridgeMacLink> xBFT, Integer yBridgeId, List<BridgeMacLink> yBFT) {
            super();

            for (BridgeMacLink xlink: xBFT) {
                if (xBridge.getId() == xlink.getNode().getId() && xlink.getBridgeDot1qTpFdbStatus() == BridgeDot1qTpFdbStatus.DOT1D_TP_FDB_STATUS_LEARNED) 
                    xmactoport.put(xlink.getMacAddress(), xlink);
                if (xBridge.getId() == xlink.getNode().getId() && xlink.getBridgeDot1qTpFdbStatus() == BridgeDot1qTpFdbStatus.DOT1D_TP_FDB_STATUS_SELF) 
                    xmacs.add(xlink.getMacAddress());
            }                
            for (BridgeMacLink ylink: yBFT) {
                if (yBridgeId == ylink.getNode().getId()) {
                    ymactoport.put(ylink.getMacAddress(), ylink);
                    if (!m_throughSet.containsKey(ylink.getBridgePort()))
                        m_throughSet.put(ylink.getBridgePort(), new ArrayList<BridgeMacLink>());
                    m_throughSet.get(ylink.getBridgePort()).add(ylink);
                }
                if (yBridgeId == ylink.getNode().getId() && ylink.getBridgeDot1qTpFdbStatus() == BridgeDot1qTpFdbStatus.DOT1D_TP_FDB_STATUS_SELF) 
                    ymacs.add(ylink.getMacAddress());
            }
            Set<String> commonlearnedmacs = new HashSet<String>(); 
            commonlearnedmacs.addAll(xmactoport.keySet());
            commonlearnedmacs.retainAll(ymactoport.entrySet());

            boolean cond1X = condition1BridgeX();
            boolean cond1Y = condition1BridgeY();
            if (cond1X && !cond1Y)
                condition2BridgeX(commonlearnedmacs);
            if (!cond1X && cond1Y)
                condition2BridgeY(commonlearnedmacs);
            if (!cond1X && !cond1Y)
                condition3(commonlearnedmacs);
            
            if (m_xy == null || m_xy == null)
                return;
            
            BridgeMacLink xylink = null;
            BridgeMacLink yxlink = null;
            for (String mac: commonlearnedmacs) {
                if (xmactoport.get(mac).getBridgePort() == m_xy) {
                    simpleconnection.add(xmactoport.get(mac));
                    if (xylink == null)
                        xylink = xmactoport.get(mac);
                }
                if (ymactoport.get(mac).getBridgePort() == m_yx) {
                    simpleconnection.add(ymactoport.get(mac));
                    if (yxlink == null)
                        yxlink = ymactoport.get(mac);
                }
            }
            if (xylink != null && yxlink != null ) {
                blink.setNode(xylink.getNode());
                blink.setBridgePort(xylink.getBridgePort());
                blink.setBridgePortIfIndex(xylink.getBridgePortIfIndex());
                blink.setBridgePortIfName(xylink.getBridgePortIfName());
                
                blink.setDesignatedNode(yxlink.getNode());
                blink.setDesignatedPort(yxlink.getBridgePort());
                blink.setDesignatedPortIfIndex(yxlink.getBridgePortIfIndex());
                blink.setDesignatedPortIfName(yxlink.getBridgePortIfName());
            }
            m_throughSet.remove(m_yx);            
        }

