    public void addAuthority(GrantedAuthority authority) {
        final Set<GrantedAuthority> authorities = new HashSet<GrantedAuthority>();
        authorities.add(authority);
        if (m_authorities != null) {
            for (final GrantedAuthority existing : m_authorities) {
                authorities.add(existing);
            }
        }
        m_authorities = authorities.toArray(EMPTY_AUTHORITY_ARRAY);
    }

