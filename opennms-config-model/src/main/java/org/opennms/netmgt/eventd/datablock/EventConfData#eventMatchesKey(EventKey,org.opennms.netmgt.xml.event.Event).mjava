    /**
     * Check whether the event matches the passed key
     * 
     * @return true if the event matches the passed key
     */
    private boolean eventMatchesKey(EventKey eventKey, org.opennms.netmgt.xml.event.Event event) {
        // go through the key elements and see if this event will match
        boolean maskMatch = true;

        for (final Entry<String, Object> entry : eventKey.entrySet()) {
            final String key = entry.getKey();

            @SuppressWarnings("unchecked")
            final List<String> maskValues = (List<String>) entry.getValue();

            // get the event value for this key
            final String eventvalue = EventKey.getMaskElementValue(event, key);
            maskMatch = eventValuePassesMaskValue(eventvalue, maskValues);
            if (!maskMatch) {
                return maskMatch;
            }
        }

        return maskMatch;
    }

