    public void initialize(final Partition partition, final EventOrdering eventOrdering) {
        m_ordering = eventOrdering;

        for (final Event event : m_events) {
            event.initialize(m_ordering.next());
        }

        partitionEvents(partition);

        for (final Events events : m_loadedEventFiles.values()) {
            events.initialize(partition, m_ordering.subsequence());
        }

        // roll up all prioritized events and sort all events by priority
        // must be done after event.initialize() has been called to set the event.index
        List<Event> prioritizedEvents = getPrioritizedEvents();
        m_events.addAll(prioritizedEvents);
        m_events.sort(Comparator.naturalOrder());
        // Also add to unpartitioned events for first crack when not using a UEI match
        m_nullPartitionedEvents.addAll(prioritizedEvents);
        m_nullPartitionedEvents.sort(Comparator.naturalOrder());

        indexEventsByUei();
    }

