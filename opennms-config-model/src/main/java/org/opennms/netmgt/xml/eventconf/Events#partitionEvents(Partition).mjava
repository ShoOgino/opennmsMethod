    private void partitionEvents(final Partition partition) {
        m_partition = partition;

        m_partitionedEvents = new LinkedHashMap<String, List<Event>>();
        m_nullPartitionedEvents = new ArrayList<Event>();

        for(final Event event : m_events) {
            final List<String> keys = partition.group(event);
            if (keys == null) {
                m_nullPartitionedEvents.add(event);
            } else {
                for(final String key : keys) {
                    List<Event> events = m_partitionedEvents.computeIfAbsent(key, k -> new ArrayList<Event>());
                    events.add(event);
                }
            }
        }
        // Place all the partitioned and nullPartitioned event definitions in priority order.
        m_partitionedEvents.values().stream().forEach(l -> Collections.sort(l));
        Collections.sort(m_nullPartitionedEvents);
    }

