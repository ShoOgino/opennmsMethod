    public Event findFirstMatchingEvent(final org.opennms.netmgt.xml.event.Event matchingEvent) {
        // Atempt to match the event definition by UEI
        final String ueiToMatch = matchingEvent.getUei();
        if (ueiToMatch != null) {
            final Event matchedEvent = m_eventsByUei.get(ueiToMatch);
            if (matchedEvent != null) {
                return matchedEvent;
            }
        }

        // If the UEI match failed, fallback to searching with the matchers through the partitions
        final String key = m_partition.group(matchingEvent);
        Collection<Event> potentialMatches = m_nullPartitionedEvents;
        if (key != null) {
            final List<Event> events = m_partitionedEvents.get(key);
            if (events != null) {
                potentialMatches = new TreeSet<Event>(m_nullPartitionedEvents);
                potentialMatches.addAll(events);
            }
        }

        for (final Event event : potentialMatches) {
            if (event.matches(matchingEvent)) {
                return event;
            }
        }

        for (Events subEvents : m_loadedEventFiles.values()) {
            final Event event = subEvents.findFirstMatchingEvent(matchingEvent);
            if (event != null) {
                return event;
            }
        }

        return null;
    }

