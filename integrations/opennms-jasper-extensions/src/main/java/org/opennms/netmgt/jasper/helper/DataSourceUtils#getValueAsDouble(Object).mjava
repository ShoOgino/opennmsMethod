    private static Double getValueAsDouble(Object o) {
        if (o instanceof Date) {
            return (double) ((Date)o).getTime();
        }
        if (o instanceof Number) {
            return Double.valueOf(String.valueOf(o));
        }
        try {
            return (Double) o;
        } catch (ClassCastException e) {
            throw new RuntimeException("Invalid value type. "
                    + "Does the datasource originate from an RRD or JRB file?", e);
        }
    }

