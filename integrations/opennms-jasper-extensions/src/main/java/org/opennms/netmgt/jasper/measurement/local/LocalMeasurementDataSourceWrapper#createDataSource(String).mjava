    @Override
    public JRRewindableDataSource createDataSource(String query) throws JRException {
        Objects.requireNonNull(query);
        QueryRequest queryRequest = unmarshal(query);
        Objects.requireNonNull(queryRequest);

        try {
            QueryResponse response = fetchService.query(queryRequest);
            return new MeasurementDataSource(response);
        } catch (ResourceNotFoundException rnfe) {
            LOG.warn("A attribute or resource was not found", rnfe);
            return new EmptyJRDataSource();
        } catch (Exception e) {
           LOG.error("An error occurred while fetching the measurement results", e);
           throw new JRException(e);
        }
    }

