    /**
     * Filters the given data source by successively applying
     * all of the analytics commands.
     */
    public JRRewindableDataSource filter(JRRewindableDataSource ds) throws JRException {
        // Don't bother converting the ds to and from a table if there are no
        // commands to apply
        if (m_analyticsCommands.isEmpty()) {
            return ds;
        }
 
        // Convert the data source to a table, making it easier for modules to manipulate
        RowSortedTable<Integer, String, Double> dsAsTable = DataSourceUtils.fromDs(ds, m_fieldNames);

        // Apply the filter modules
        try {
            filter(dsAsTable);
        } catch (Exception e) {
            throw new JRException("Failed to enrich the data source.", e);
        }

        // Convert the resulting table back to a data source
        return DataSourceUtils.toDs(dsAsTable);
    }

