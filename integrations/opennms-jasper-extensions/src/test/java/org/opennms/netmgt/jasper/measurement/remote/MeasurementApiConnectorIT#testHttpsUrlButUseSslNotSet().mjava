    // Verifies that even if useSSL = false, when connecting to a valid https url the connection is secure
    @Test
    public void testHttpsUrlButUseSslNotSet() throws IOException {
        Result result = new MeasurementApiClient().execute(false, "https://localhost:" + wireMockRule.httpsPort() + "/opennms/rest/measurements", null, null, "<dummy request>");
        Assert.assertTrue(result.wasSuccessful());
        Assert.assertTrue(result.wasSecureConnection());
        Assert.assertNotNull(result.getInputStream());
        Assert.assertNull(result.getErrorStream());

        LoggingEvent[] warnEvents = MockLogAppender.getEventsAtLevel(Level.WARN);
        boolean found = false;
        for (LoggingEvent eachEvent : warnEvents) {
            if (MeasurementApiClient.class.getName().equals(eachEvent.getLoggerName())) {
                Assert.assertTrue(eachEvent.getMessage().contains("A secure connection was established even if it was not intended."));
                Assert.assertTrue(eachEvent.getMessage().contains("Use SSL = false"));
                Assert.assertTrue(eachEvent.getMessage().contains("URL = https://localhost:" + wireMockRule.httpsPort() + "/opennms/rest/measurements"));
                found = true;
            }
        }
        Assert.assertTrue("Expected to have a warn message about using ssl even if it was not enabled manually", found);
    }

