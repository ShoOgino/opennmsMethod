    private static RrdXport fromTable(RowSortedTable<Integer, String, Double> input, long start, long end) {
        RrdXport xport = new RrdXport();

        XMeta xmeta = new XMeta();
        xmeta.setStart(start);
        xmeta.setEnd(end);
        xmeta.setRows((long) input.rowKeySet().size());
        xmeta.setLegends(new ArrayList<String>(input.columnKeySet()));
        xmeta.setStep(input.get(0, "step").longValue());
        xmeta.getLegends().remove("timestamp");
        xmeta.getLegends().remove("step");
        xmeta.setColumns((long) xmeta.getLegends().size());

        xport.setMeta(xmeta);

        for (int rowIndex : input.rowKeySet()) {
            XRow row = new XRow();
            row.setTimestamp(input.get(rowIndex, "timestamp").longValue());
            row.setValues(new ArrayList<Double>());
            for (String eachColumnName : xport.getMeta().getLegends()) {
                Double value = input.get(rowIndex, eachColumnName);
                row.getValues().add(value == null ? Double.NaN : value);
            }
            xport.getRows().add(row);
        }

        return xport;
    }

