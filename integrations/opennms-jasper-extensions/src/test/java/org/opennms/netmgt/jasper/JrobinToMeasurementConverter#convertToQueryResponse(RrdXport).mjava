    private static QueryResponse convertToQueryResponse(RrdXport rrdXport) {
        QueryResponse queryResponse = new QueryResponse();
        queryResponse.setStart(rrdXport.getMeta().getStart() * 1000);
        queryResponse.setEnd(rrdXport.getMeta().getEnd() * 1000);
        queryResponse.setStep(rrdXport.getMeta().getStep());

        Map<String, double[]> columns = new HashMap<String, double[]>();
        for (int i=0; i<rrdXport.getMeta().getColumns(); i++) {
            final String label = rrdXport.getMeta().getLegends().get(i);
            final double[] values = new double[Long.valueOf(rrdXport.getMeta().getRows()).intValue()];
            for (int a=0; a<rrdXport.getMeta().getRows(); a++) {
                values[a] = rrdXport.getRows().get(a).getValues().get(i);
            }
            columns.put(label, values);
        }
        queryResponse.setColumns(columns);

        final long[] timestamps = new long[Long.valueOf(rrdXport.getMeta().getRows()).intValue()];
        for (int i=0; i<rrdXport.getMeta().getRows(); i++) {
            timestamps[i] = rrdXport.getRows().get(i).getTimestamp() * 1000;
        }
        queryResponse.setTimestamps(timestamps);
        return queryResponse;
    }

