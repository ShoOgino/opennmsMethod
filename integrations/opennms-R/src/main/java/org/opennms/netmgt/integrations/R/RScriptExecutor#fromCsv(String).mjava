    /**
     * Convert the CSV string to an immutable table.
     */
    protected static ImmutableTable<Integer, String, Double> fromCsv(final String csv) throws IOException {
        ImmutableTable.Builder<Integer, String, Double> builder = ImmutableTable.builder();
        try (StringReader reader = new StringReader(csv);
                CSVParser parser = new CSVParser(reader,
                        CSVFormat.RFC4180.withHeader());) {
            int rowIndex = 0;
            Map<String, Integer> headerMap = parser.getHeaderMap();
            for (CSVRecord record : parser) {
                for (String key : headerMap.keySet()) {
                    Double value;
                    try {
                        value = Double.valueOf(record.get(key));
                    } catch (NumberFormatException e) {
                        value = Double.NaN;
                    }

                    builder.put(rowIndex, key, value);
                }
                rowIndex++;
            }
        }
        return builder.build();
    }

