    /** {@inheritDoc} */
    public String getType(final String sysoid, final String sysdescr) {
        LogUtils.debugf(this, "getType: sysoid: %s", sysoid);
        LogUtils.debugf(this, "getType: sysdescription: %s", sysdescr);
        getReadLock().lock();
        try {
            String type = getConfiguration().getDefaultType();
            boolean notMatched = true;
            if (sysoid != null && sysdescr != null) {
                for (Mapping map : mappings()) {
                    LogUtils.debugf(this,
                                    "getType: parsing map with SysoidMaSk: %s, SysdescrMatch: %s",
                                    map.getSysoidMask(),
                                    map.getSysdescrMatch());
                    if (sysoid.startsWith(map.getSysoidMask())) {
                        if (map.getSysdescrMatch() != null
                                && sysdescr.matches(map.getSysdescrMatch())) {
                            LogUtils.debugf(this, "getType: matched type: %s",
                                            map.getType());
                            return map.getType();
                        }
                        if (map.getSysdescrMatch() == null && notMatched) {
                            LogUtils.debugf(this,"getType: null sysdescrmatch: first match: type: %s "
                                                    , map.getType());
                            type = map.getType();
                            notMatched = false;
                        }
                    }
                }
            } else if (sysoid != null) {
                for (Mapping map : mappings()) {
                    LogUtils.debugf(this,"getType: sysdescr is null: parsing map with SysoidMaSk: %s "
                                            , map.getSysoidMask());
                    if (sysoid.startsWith(map.getSysoidMask())) {
                        LogUtils.debugf(this,"getType: matched type: %s "
                                                , map.getType());
                        return map.getType();
                    }
                }

            }
            LogUtils.debugf(this,"getType: matched type: {}", type);
            return type;
        } finally {
            getReadLock().unlock();
        }
    }

