    @Test
    public void testNodeDownEvent() {
        Event e = MockEventUtil.createNodeDownEvent("Test", m_node1);
        
        expect(m_correlator.isLinkUp(e)).andStubReturn(false);
        m_anticipator.anticipateEvent(m_failedEvent);
        
        replay();

        m_linkEventHandler.receiveEvent(e);
        m_eventForwarder.finishProcessingEvents();
        assertEquals(0, m_anticipator.waitForAnticipated(0).size());

        verify();
    }

