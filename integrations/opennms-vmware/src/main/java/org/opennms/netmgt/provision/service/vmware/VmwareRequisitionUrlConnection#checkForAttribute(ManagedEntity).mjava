    /**
     * Checks whether an attribute/value is defined by a managed entity.
     *
     * @param managedEntity the managed entity to check
     * @return true if present and value is equal, false otherwise
     * @throws RemoteException
     */
    private boolean checkForAttribute(ManagedEntity managedEntity) throws RemoteException {
        String key = m_args.get("key");
        String value = m_args.get("value");

        // if key/value is not set, return true
        if (key == null && value == null) {
            return true;
        }

        // if only key or value is set, return false
        if (key == null || value == null) {
            return false;
        }

        // get available values
        CustomFieldValue[] values = managedEntity.getCustomValue();
        // get available definitions
        CustomFieldDef[] defs = managedEntity.getAvailableField();

        // now search for the correct key/value pair
        for (int i = 0; defs != null && i < defs.length; i++) {
            if (key.equals(defs[i].getName())) {

                int targetIndex = defs[i].getKey();

                for (int j = 0; j < values.length; j++) {
                    if (targetIndex == values[j].getKey()) {
                        return value.equals(((CustomFieldStringValue) values[j]).value);
                    }
                }
            }
        }

        return false;
    }

