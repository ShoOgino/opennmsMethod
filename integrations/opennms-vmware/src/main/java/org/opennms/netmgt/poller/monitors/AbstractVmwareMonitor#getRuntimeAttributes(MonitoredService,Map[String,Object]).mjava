    @Override
    public Map<String, Object> getRuntimeAttributes(MonitoredService svc, Map<String, Object> parameters) {
        if (m_nodeDao == null) {
            m_nodeDao = BeanUtils.getBean("daoContext", "nodeDao", NodeDao.class);
        }

        if (m_vmwareConfigDao == null) {
            m_vmwareConfigDao = BeanUtils.getBean("daoContext", "vmwareConfigDao", VmwareConfigDao.class);
        }

        if (m_transactionTemplate == null) {
            m_transactionTemplate = BeanUtils.getBean("daoContext", "transactionTemplate", TransactionTemplate.class);
        }

        final Map<String, Object> runtimeAttributes = new HashMap<>();

        m_transactionTemplate.execute(new TransactionCallback<Object>() {
            @Override
            public Object doInTransaction(TransactionStatus transactionStatus) {
                final OnmsNode onmsNode = m_nodeDao.get(svc.getNodeId());
                if (onmsNode == null) {
                    throw new IllegalArgumentException("No node found with ID: " + svc.getNodeId());
                }

                // retrieve the assets

                final String vmwareManagementServer = VmwareImporter.getManagementServer(onmsNode);
                final String vmwareManagedEntityType = VmwareImporter.getManagedEntityType(onmsNode);

                final String vmwareManagedObjectId = onmsNode.getForeignId();

                String vmwareMangementServerUsername = null;
                String vmwareMangementServerPassword = null;
                final Map<String, VmwareServer> serverMap = m_vmwareConfigDao.getServerMap();
                if (serverMap == null) {
                    logger.error("Error getting vmware-config.xml's server map.");
                } else {
                    final VmwareServer vmwareServer = serverMap.get(vmwareManagementServer);
                    if (vmwareServer == null) {
                        logger.error("Error getting credentials for VMware management server '{}'.", vmwareManagementServer);
                    } else {
                        vmwareMangementServerUsername = vmwareServer.getUsername();
                        vmwareMangementServerPassword = vmwareServer.getPassword();
                    }
                }

                runtimeAttributes.put(VmwareImporter.METADATA_MANAGEMENT_SERVER, vmwareManagementServer);
                runtimeAttributes.put(VmwareImporter.METADATA_MANAGED_ENTITY_TYPE, vmwareManagedEntityType);
                runtimeAttributes.put(VmwareImporter.METADATA_MANAGED_OBJECT_ID, vmwareManagedObjectId);
                runtimeAttributes.put(VmwareImporter.VMWARE_MANAGEMENT_SERVER_USERNAME_KEY, vmwareMangementServerUsername);
                runtimeAttributes.put(VmwareImporter.VMWARE_MANAGEMENT_SERVER_PASSWORD_KEY, vmwareMangementServerPassword);

                return null;
            }
        });

        return runtimeAttributes;
    }

