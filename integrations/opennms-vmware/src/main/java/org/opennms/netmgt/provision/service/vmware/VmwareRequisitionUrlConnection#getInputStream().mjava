    /**
     * {@inheritDoc}
     * <p/>
     * Creates a ByteArrayInputStream implementation of InputStream of the XML
     * marshaled version of the Requisition class. Calling close on this stream
     * is safe.
     */
    @Override
    public InputStream getInputStream() throws IOException {

        InputStream stream = null;
        try {
            final Requisition existingRequisition = getExistingRequisition(importRequest.getForeignSource());
            importRequest.setExistingRequisition(existingRequisition);
            final VmwareImporter importer = new VmwareImporter(importRequest);
            stream = new ByteArrayInputStream(jaxBMarshal(importer.getRequisition()).getBytes());
        } catch (Throwable e) {
            logger.warn("Problem getting input stream: '{}'", e);
            throw new IOExceptionWithCause("Problem getting input stream: " + e, e);
        }

        return stream;
    }

