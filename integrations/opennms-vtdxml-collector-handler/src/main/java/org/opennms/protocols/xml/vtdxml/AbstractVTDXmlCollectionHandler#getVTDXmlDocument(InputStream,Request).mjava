    /**
     * Gets the XML document.
     *
     * @param is the input stream
     * @param request the request
     * @return the XML document
     */
    protected VTDNav getVTDXmlDocument(InputStream is, Request request) {
        try {
            is = preProcessHtml(request, is);
            is = applyXsltTransformation(request, is);
            VTDGen vg = new VTDGen();
            vg.setDoc(IOUtils.toByteArray(is));
            vg.parse(true);
            return vg.getNav();
        } catch (Exception e) {
            throw new XmlCollectorException(e.getMessage(), e);
        }
    }

