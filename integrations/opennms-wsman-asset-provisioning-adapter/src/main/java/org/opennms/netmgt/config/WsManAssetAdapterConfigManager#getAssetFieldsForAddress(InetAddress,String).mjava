    /**
     * Returns all {@link AssetField} objects that are in packages that match the specified
     * Vendor precisely. This relies on the WsManDetector issuing an Identify and populating
     * the Vendor and Product fields.
     */
    @Override
    public AssetField[] getAssetFieldsForAddress(final InetAddress address, final String vendor) {
        getReadLock().lock();
        
        try {
            if (vendor == null) {
                LOG.debug("getAssetFieldsForAddress: WSMAN vendor field was null for address {}, returning empty list", InetAddressUtils.str(address));
                return new AssetField[0];
            }
    
            final List<AssetField> retval = new ArrayList<>();
            for (final org.opennms.netmgt.config.wsmanAsset.adapter.Package pkg : m_config.getPackages()) {
                final String pkgVendor = pkg.getVendor();
                if (pkgVendor != null) {
                    if (pkgVendor.equals(vendor)) {
                        retval.addAll(pkg.getAssetFields());
                    }
                }
            }
            if (retval.isEmpty()) {
                LOG.debug("getAssetFieldsForAddress: Zero AssetField matches returned for {} with vendor: {}", InetAddressUtils.str(address), vendor);
            }
            return retval.toArray(new AssetField[0]);
        } finally {
            getReadLock().unlock();
        }
    }

