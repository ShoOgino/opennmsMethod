        private InetAddress getIpForNode(final OnmsNode node) {
                LOG.debug("getIpForNode: node: {} Foreign Source: {}", node.getNodeId(), node.getForeignSource());
                final OnmsIpInterface primaryInterface = node.getPrimaryInterface();
                InetAddress ipaddr = InetAddressUtils.getLocalHostAddress();
                if (primaryInterface == null) {
                        LOG.debug("getIpForNode: found null SNMP Primary Interface, getting interfaces");
                        final Set<OnmsIpInterface> ipInterfaces = node.getIpInterfaces();
                        for (final OnmsIpInterface onmsIpInterface : ipInterfaces) {
                                LOG.debug("getIpForNode: trying Interface with id: {}", onmsIpInterface.getId());
                                if (InetAddressUtils.str(onmsIpInterface.getIpAddress()) != null)
                                        ipaddr = onmsIpInterface.getIpAddress();
                                else
                                        LOG.debug("getIpForNode: found null ip address on Interface with id: {}", onmsIpInterface.getId());


                        }
                } else {
                        LOG.debug("getIpForNode: found SNMP Primary Interface");
                        if (InetAddressUtils.str(primaryInterface.getIpAddress()) != null )
                                ipaddr = primaryInterface.getIpAddress();
                        else
                                LOG.debug("getIpForNode: found null ip address on Primary Interface");
                }
                return ipaddr;
        }

