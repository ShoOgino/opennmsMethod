    private void addOrUpdate() throws Exception {
        OnmsNode node = m_onmsNodeDao.get(m_nodeId);
        Map<String, Celement> celements = m_mapsAdapterConfig.getElementByAddress((getSuitableIpForMap(node)));
        if (celements.isEmpty()) {
            log().info("Element is not managed in the adapter: nodeid="+m_nodeId);
        } else {
        Iterator<String> ite = celements.keySet().iterator();
        while (ite.hasNext()) {
            String mapName = ite.next();
            Celement celement = celements.get(mapName);
            OnmsMap onmsMap = getSuitableMap(mapName);
            if (onmsMap.isNew()) {
                throw new Exception("Error adding element. Map does not exist: " + mapName);
            } else {
                if (onmsMap.getMapElements().size() == 0) {
                    addAsSubMap(mapName);
                }
                XY xy=getXY(onmsMap);
                log().debug("doAddOrUpdate: adding node: " + node.getLabel() + " to map: " + mapName);
                OnmsMapElement mapElement = new OnmsMapElement(onmsMap,m_nodeId,OnmsMapElement.NODE_TYPE,node.getLabel(),celement.getIcon(),xy.getX(),xy.getY());
                m_onmsMapElementDao.saveOrUpdate(mapElement);
                m_onmsMapElementDao.flush();
                onmsMap.setLastModifiedTime(new Date());
                m_onmsMapDao.update(onmsMap);
                m_onmsMapDao.flush();
            }
        }
        m_onmsMapElementDao.clear();
        m_onmsMapDao.clear();
        }

    }

