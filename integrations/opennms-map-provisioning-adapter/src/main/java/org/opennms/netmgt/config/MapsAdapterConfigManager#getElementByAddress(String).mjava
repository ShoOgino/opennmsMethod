    /** {@inheritDoc} */
    public Map<String, Celement> getElementByAddress(final String ipaddr) {
        getReadLock().lock();
        try {
            final Map<String,Celement> mapAndElements = new HashMap<String, Celement>();
            if (hasCmaps()) {
                final List<String> pkgs = getAllPackageMatches(ipaddr);
                for (final Cmap cmap : getConfiguration().getCmaps().getCmapCollection()) {
                    final Iterator<Celement> cels = cmap.getCelementCollection().iterator();
                    boolean found = false;
                    while (cels.hasNext()) {
                        final Celement celement = cels.next();
                        final Iterator<String> pkgname = pkgs.iterator();
                        while (pkgname.hasNext()) {
                            if (pkgname.next().equals(celement.getPackage())) {
                                mapAndElements.put(cmap.getMapName(), celement);
                                found = true;
                                break;
                            }
                        }
                        if (found) break;
                    }
                }
            }
            return mapAndElements;
        } finally {
            getReadLock().unlock();
        }
    }

