        @Override
        public void run() {
            syncMaps();
            while (true) {
                try {
                    LOG.debug("Sleeping: {}", RESYNC_TIMEOUT);
                    Thread.sleep(RESYNC_TIMEOUT);
                } catch (InterruptedException e) {
                    LOG.error("Cannot sleep: {}", e.getLocalizedMessage());
                }
                
                if (doSync) {
                    LOG.debug("Synchronization started");
                    Set<Integer> deletes = new TreeSet<Integer>();
                    Set<Integer> adds = new TreeSet<Integer>();
                    Set<Integer> updates = new TreeSet<Integer>();
                    LOG.info("acquiring lock...");
                    synchronized (m_lock) {                            
                        for (Integer i: m_deletes) {
                            deletes.add(i);
                        }                        
                        for (Integer i: m_adds) {
                            adds.add(i);
                        }
                        for (Integer i: m_updates) {
                            updates.add(i);
                        }
                        m_deletes = new TreeSet<Integer>();
                        m_updates = new TreeSet<Integer>();
                        m_adds = new TreeSet<Integer>();                            
                        doSync = false;
                    }
                    LOG.info("lock released.");
                    reSyncMap(deletes,adds,updates);
                } else {
                    LOG.debug("No Synchronization required");
                    
                }
            }
        }        

