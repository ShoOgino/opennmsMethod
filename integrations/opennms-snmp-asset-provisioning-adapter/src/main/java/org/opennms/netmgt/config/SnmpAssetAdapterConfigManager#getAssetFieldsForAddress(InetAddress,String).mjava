	/**
	 * Returns all {@link AssetField} objects that are in packages that match the specified
	 * sysoid precisely based on the <sysoid> tag or by starting with the content of the 
	 * <sysoidMask> tag.
	 * 
	 * TODO: Support matching based on IP address
	 */
	public AssetField[] getAssetFieldsForAddress(InetAddress address, String sysoid) {
		if (sysoid == null) {
			// If the sysoid is null, we won't be able to fetch any SNMP attributes;
			// return an empty list.
			log().debug("getAssetFieldsForAddress: SNMP sysoid was null for address " + address.getHostAddress() + ", returning empty list");
			return new AssetField[0];
		}

		List<AssetField> retval = new ArrayList<AssetField>();
		for (org.opennms.netmgt.config.snmpAsset.adapter.Package pkg : m_config.getPackageCollection()) {
			String pkgSysoid = pkg.getPackageChoice().getSysoid();
			String pkgSysoidMask = pkg.getPackageChoice().getSysoidMask();
			if (pkgSysoid != null) {
				if (pkgSysoid.equals(sysoid)) {
					retval.addAll(pkg.getAssetFieldCollection());
				}
			} else if (pkgSysoidMask != null) {
				if (sysoid.startsWith(pkgSysoidMask)) {
					retval.addAll(pkg.getAssetFieldCollection());
				}
			} else {
				log().warn("getAssetFieldsForAddress: Unexpected condition: both sysoid and sysoidMask are null on package " + pkg.getName());
			}
		}
		if (log().isDebugEnabled()) {
			if (retval.size() == 0) {
				log().debug("getAssetFieldsForAddress: Zero AssetField matches returned for " + address.getHostAddress() + " with sysoid: " + sysoid);
			}
		}
		return retval.toArray(new AssetField[0]);
	}

