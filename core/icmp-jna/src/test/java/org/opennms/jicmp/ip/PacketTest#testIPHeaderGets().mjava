    @Test
    public void testIPHeaderGets() throws Exception {
        
        IPPacket pkt = new IPPacket(ip, 0, ip.length);
        
        // test header data
        assertThat(pkt.getVersion(), is(equalTo(4)));
        assertThat(pkt.getHeaderLength(), is(equalTo(20)));
        assertThat(pkt.getTimeToLive(), is(equalTo(128)));
        assertThat(pkt.getProtocol(), is(equalTo(Protocol.ICMP)));
        assertThat(pkt.getSourceAddress(), is(equalTo(InetAddress.getByName("127.0.0.1"))));
        assertThat(pkt.getDestinationAddress(), is(equalTo(InetAddress.getByName("127.0.0.1"))));
        
        // payload 64 bytes: ICMP header (8 bytes) followed by byte values 1, 2, 3, ... 55, 56 
        ByteBuffer payload = pkt.getPayload();
        assertThat(payload.remaining(), is(equalTo(64)));
        assertThat(payload.capacity(), is(equalTo(64)));
        assertThat(payload.position(), is(equalTo(0)));
        assertThat(payload.get(8), is(equalTo((byte)0)));
        assertThat(payload.get(16), is(equalTo((byte)8)));
        assertThat(payload.get(24), is(equalTo((byte)16)));
    }

