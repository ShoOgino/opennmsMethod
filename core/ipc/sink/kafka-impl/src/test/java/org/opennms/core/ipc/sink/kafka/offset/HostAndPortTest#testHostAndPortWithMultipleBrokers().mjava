    @Test
    public void testHostAndPortWithMultipleBrokers() {
        String kafkaHostString = "kafka:9092 , 127.0.0.1:9093 , 128.0.0.1:9094";
        HostAndPort hostAndPort = HostAndPort.fromString(kafkaHostString);
        assertEquals(9092, hostAndPort.getPort());
        assertEquals("kafka", hostAndPort.getHost());
        hostAndPort = HostAndPort.getNextHostAndPort(hostAndPort);
        assertEquals(9093, hostAndPort.getPort());
        assertEquals("127.0.0.1", hostAndPort.getHost());
        hostAndPort = HostAndPort.getNextHostAndPort(hostAndPort);
        assertEquals(9094, hostAndPort.getPort());
        assertEquals("128.0.0.1", hostAndPort.getHost());
        hostAndPort = HostAndPort.getNextHostAndPort(hostAndPort);
        assertEquals(9092, hostAndPort.getPort());
        assertEquals("kafka", hostAndPort.getHost());
        kafkaHostString = "kafka:9092";
        hostAndPort = HostAndPort.fromString(kafkaHostString);
        assertEquals(9092, hostAndPort.getPort());
        assertEquals("kafka", hostAndPort.getHost());
        hostAndPort = HostAndPort.getNextHostAndPort(hostAndPort);
        assertEquals(9092, hostAndPort.getPort());
        assertEquals("kafka", hostAndPort.getHost());
    }

