    public SimpleConsumer getConsumer() {
        Object kafkaServer = kafkaConfig.get("bootstrap.servers");
        if (kafkaServer == null || !(kafkaServer instanceof String)) {
            throw new IllegalArgumentException("Kafka server is invalid");
        }
        final String kafkaString = (String) kafkaServer;
        HostAndPort kafkaHost = HostAndPort.fromString(kafkaString);
        if (kafkaHost == null) {
            throw new IllegalArgumentException("Kafka server is invalid");
        }
        return getConsumer(kafkaHost.getHost(), kafkaHost.getPort());
    }

