    //Configurable buffer size as config property but it should always be less than DEFAULT_MAX_BUFFER_SIZE
    public static Integer getMaxBufferSize(String  bufferSize) {
        int maxBufferSize = DEFAULT_MAX_BUFFER_SIZE;
        if (bufferSize != null) {
            try {
                maxBufferSize = Integer.parseInt(bufferSize);
            } catch (NumberFormatException ex){
                LOG.warn("Configured max buffer size is not a number");
            }
        }
        return Math.min(DEFAULT_MAX_BUFFER_SIZE, maxBufferSize);
    }

