    @Test
    public void recoversFromCorruptFile() throws IOException, WriteFailedException, InterruptedException {
        String moduleName = "recoversFromCorruptFile";
        File tmpFolder = folder.newFolder();
        File corruptfile = Paths.get(tmpFolder.getAbsolutePath(), moduleName + ".fifo").toFile();
        Files.write(corruptfile.toPath(), "corrupt!".getBytes());
        QueueFileOffHeapDispatchQueue<String> queue = new QueueFileOffHeapDispatchQueue<>(String::getBytes, String::new,
                moduleName, Paths.get(tmpFolder.toURI()), 1, 1, 300);

        String payload1 = "msg1";
        queue.enqueue(payload1, "key1");

        String received = queue.dequeue().getValue();
        assertThat(received, equalTo(payload1));
    }

