    @Override
    public boolean writeMessage(byte[] message, String moduleName, String key) throws WriteFailedException {
        long storeSize = store.getFileStore().size();
        if (message == null || Strings.isNullOrEmpty(moduleName)) {
            throw new WriteFailedException("Invalid message");
        }
        if (storeSize + message.length > maxSizeInBytes) {
            throw new WriteFailedException("Offheap storage exhausted, size = " + maxSizeInBytes);
        }
        MVMap<String, byte[]> mvMap = mvMapRegistry.get(moduleName);
        if (mvMap == null) {
            mvMap = store.openMap(moduleName);
            mvMapRegistry.put(moduleName, mvMap);
            queueMap.put(moduleName, new LinkedBlockingQueue<>());
            LOG.info("initialized mvMap for module : {} ", moduleName);
        }
        mvMap.put(key, message);
        BlockingQueue<String> keys = queueMap.get(moduleName);
        keys.add(key);
        return true;
    }

