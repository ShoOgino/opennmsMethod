    private long convertByteSizes(String size) {
        String suffix = size.substring(size.length()-2, size.length());
        double value = 0;
        long bytes = 0;
        try {
            value = Double.parseDouble(size.substring(0, size.length() - 2));
        } catch (NumberFormatException e) {
            //pass
        }
        switch(suffix) {
            case "KB":
                bytes = (long) (value * 1024);
                break;
            case "MB":
                bytes = (long) (value * 1024 * 1024);
                break;
            case "GB":
                bytes = (long) (value * 1024 * 1024 * 1024);
                break;
        }
        if (bytes == 0) {
            LOG.error("Provided offheap size '{}' is invalid, using default as {}", size, DEFAULT_OFFHEAP_SIZE);
            return convertByteSizes(DEFAULT_OFFHEAP_SIZE);
        }
        return bytes;
    }

