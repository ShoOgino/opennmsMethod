    @Override
    public boolean isFull() {
        if (offHeapQueue == null) {
            int remaining = inMemoryQueue.remainingCapacity();
            LOG.trace("Checked if full and remaining capacity is {}", remaining);

            return remaining <= 0;
        }

        return fileCapacityLatch.isFull();
    }

