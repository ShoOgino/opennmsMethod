    private static long convertToBytes(String sizeWithSuffix) {
        if (sizeWithSuffix == null || sizeWithSuffix.length() == 0) {
            return 0;
        }

        String suffix;
        String sizeValue;
        try {
            suffix = sizeWithSuffix.substring(sizeWithSuffix.length() - 2).toLowerCase();
            sizeValue = sizeWithSuffix.substring(0, sizeWithSuffix.length() - 2).trim();
        } catch (IndexOutOfBoundsException e) {
            LOG.warn("Invalid file size '" + sizeWithSuffix + "'. The file size must include a size and the units. eg 128MB");
            throw e;
        }

        double value = Long.parseLong(sizeValue);
        long bytes;

        switch (suffix) {
            case "kb":
                bytes = (long) value * 1024;
                break;
            case "mb":
                bytes = (long) value * 1024 * 1024;
                break;
            case "gb":
                bytes = (long) value * 1024 * 1024 * 1024;
                break;
            default:
                LOG.warn("Could not parse unit suffix of '" + suffix + "' from max file size '" + sizeWithSuffix + "'");
                throw new IllegalArgumentException("Invalid unit suffix " + suffix);
        }

        return bytes;
    }

