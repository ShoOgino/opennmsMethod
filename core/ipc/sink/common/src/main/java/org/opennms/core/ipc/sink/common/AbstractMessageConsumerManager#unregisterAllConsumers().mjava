    public synchronized void unregisterAllConsumers() throws Exception {
        // Copy the list of consumers before we iterate to avoid concurrent modification exceptions
        final List<MessageConsumer<?, Message>> consumers = Lists.newArrayList(consumersByModule.values());
        for (MessageConsumer<?, Message> consumer : consumers) {
            unregisterConsumer(consumer);
        }
    }

