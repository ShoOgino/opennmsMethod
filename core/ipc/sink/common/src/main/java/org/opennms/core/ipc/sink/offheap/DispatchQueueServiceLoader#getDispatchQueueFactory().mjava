    public static Optional<DispatchQueueFactory> getDispatchQueueFactory() {
        if (dispatchQueueFactory != null) {
            return Optional.of(dispatchQueueFactory);
        }

        if (context != null) {
            try {
                ServiceReference<DispatchQueueFactory> serviceReference = context.getServiceReference(DispatchQueueFactory.class);
                return serviceReference == null ? Optional.empty() : Optional.of(context.getService(serviceReference));
            } catch (Exception e) {
                LOG.error("Exception while retrieving DispatchQueueFactory Service from registry", e);
                throw e;
            }
        }

        return Optional.empty();
    }

