        @Override
        public EnqueueResult enqueue(T message, String key) throws WriteFailedException {
            enqueueFairMutex.lock();
            try {
                queue.put(new AbstractMap.SimpleImmutableEntry<>(key, message));

                return EnqueueResult.IMMEDIATE;
            } catch (InterruptedException e) {
                throw new WriteFailedException(e);
            } finally {
                enqueueFairMutex.unlock();
            }
        }

