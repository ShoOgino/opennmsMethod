    public void shutdown() {
        closed.set(true);
        rpcTimeoutQueue.clear();
        rpcHandlerByLocation.clear();
        rpcHandlerByMinionId.clear();
        rpcHandlerIteratorMap.clear();
        rpcResponseMap.clear();
        sinkModulesById.clear();
        if (rpcMetricsReporter != null) {
            rpcMetricsReporter.close();
        }
        if (sinkMetricsReporter != null) {
            sinkMetricsReporter.close();
        }
        if (server != null) {
            server.shutdown();
        }
        rpcTimeoutExecutor.shutdownNow();
        responseHandlerExecutor.shutdownNow();
        LOG.info("OpenNMS gRPC server stopped");
    }

