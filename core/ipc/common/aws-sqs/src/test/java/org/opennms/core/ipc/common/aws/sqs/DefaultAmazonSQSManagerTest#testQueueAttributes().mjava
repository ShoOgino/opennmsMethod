    /**
     * Test queue attributes.
     */
    @Test
    public void testQueueAttributes() {
        Map<String, String> sqsConfig = new HashMap<>();
        sqsConfig.put(AmazonSQSConstants.AWS_REGION, "us-east-2");

        // FifoQueue=false should not be passed.
        AmazonSQSQueueConfig queueConfig = getSinkQueueConfig(sqsConfig);
        Map<String,String> queueAttributes = queueConfig.getAttributes();
        assertThat(queueAttributes, not(hasKey(AmazonSQSQueueAttributes.FifoQueue.toString())));
        assertThat(queueAttributes, not(hasKey(AmazonSQSQueueAttributes.ContentBasedDeduplication.toString())));

        sqsConfig.put(AmazonSQSConstants.SINK_QUEUE_PROP_PREFIX + AmazonSQSQueueAttributes.FifoQueue.toString(), "true");
        queueConfig = getSinkQueueConfig(sqsConfig);
        queueAttributes = queueConfig.getAttributes();
        assertThat(queueConfig.isFifoEnabled(), equalTo(true));
        assertThat(queueConfig.isFifoContentDedupEnabled(), equalTo(false));
        // FifoQueue was added as well as ContentBasedDeduplication
        assertThat(queueAttributes, hasEntry(AmazonSQSQueueAttributes.FifoQueue.toString(), "true"));
        assertThat(queueAttributes, hasEntry(AmazonSQSQueueAttributes.ContentBasedDeduplication.toString(), "false"));

        sqsConfig.put(AmazonSQSConstants.SINK_QUEUE_PROP_PREFIX + AmazonSQSQueueAttributes.ContentBasedDeduplication.toString(), "true");
        queueConfig = getSinkQueueConfig(sqsConfig);
        queueAttributes = queueConfig.getAttributes();
        assertThat(queueConfig.isFifoEnabled(), equalTo(true));
        assertThat(queueConfig.isFifoContentDedupEnabled(), equalTo(true));
        // FifoQueue was added as well as ContentBasedDeduplication
        assertThat(queueAttributes, hasEntry(AmazonSQSQueueAttributes.FifoQueue.toString(), "true"));
        assertThat(queueAttributes, hasEntry(AmazonSQSQueueAttributes.ContentBasedDeduplication.toString(), "true"));

        // Another entry
        sqsConfig.put(AmazonSQSConstants.SINK_QUEUE_PROP_PREFIX + AmazonSQSQueueAttributes.Policy.toString(), "a-policy-here");
        queueConfig = getSinkQueueConfig(sqsConfig);
        queueAttributes = queueConfig.getAttributes();
        assertThat(queueAttributes, hasEntry(AmazonSQSQueueAttributes.Policy.toString(), "a-policy-here"));
    }

