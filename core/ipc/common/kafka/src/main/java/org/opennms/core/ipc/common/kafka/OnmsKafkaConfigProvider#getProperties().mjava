    @Override
    public Properties getProperties() {
        final Properties kafkaConfig = new Properties();
        kafkaConfig.put("group.id", SystemInfoUtils.getInstanceId());

        // Find all of the system properties that start with provided prefix (kafkaSysPropPrefix)
        // and add them to the config.
        // See https://kafka.apache.org/0100/documentation.html#newconsumerconfigs for the list of supported properties
        for (Map.Entry<Object, Object> entry : System.getProperties().entrySet()) {
            final Object keyAsObject = entry.getKey();
            if (keyAsObject == null || !(keyAsObject instanceof String)) {
                continue;
            }
            final String key = (String) keyAsObject;
            if (key.length() > kafkaSysPropPrefix.length()
                    && key.startsWith(kafkaSysPropPrefix)) {
                final String kafkaConfigKey = key.substring(kafkaSysPropPrefix.length());
                kafkaConfig.put(kafkaConfigKey, entry.getValue());
            }
        }
        return kafkaConfig;
    }

