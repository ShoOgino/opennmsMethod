    @Before
    public void setup() throws Exception {
        System.setProperty(String.format("%sbootstrap.servers", KAFKA_CONFIG_PID), kafkaServer.getKafkaConnectString());
        System.setProperty(String.format("%sauto.offset.reset", KAFKA_CONFIG_PID), "earliest");
        rpcClient = new KafkaRpcClientFactory();
        echoClient = new MockEchoClient(rpcClient);
        rpcClient.start();
        kafkaConfig.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, kafkaServer.getKafkaConnectString());
        kafkaConfig.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "earliest");
        kafkaConfig.put("rpcid.cache.config", "maximumSize=1000,expireAfterWrite=15s");
        ConfigurationAdmin configAdmin = mock(ConfigurationAdmin.class, RETURNS_DEEP_STUBS);
        when(configAdmin.getConfiguration(KafkaRpcConstants.KAFKA_CONFIG_PID).getProperties())
                .thenReturn(kafkaConfig);
        minionIdentity = new MockMinionIdentity(REMOTE_LOCATION_NAME);
        kafkaRpcServer = new KafkaRpcServerManager(configAdmin, minionIdentity);
        kafkaRpcServer.init();
        kafkaRpcServer.bind(echoRpcModule);
    }

