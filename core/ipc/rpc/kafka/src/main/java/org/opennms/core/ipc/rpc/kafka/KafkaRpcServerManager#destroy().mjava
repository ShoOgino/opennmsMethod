    public void destroy() {
        if (producer != null) {
            producer.close();
        }
        messageCache.clear();
        kafkaConsumersByTopic.forEach((topic, kafkaConsumerRunner) ->
                kafkaConsumerRunner.shutdown());
        executor.shutdown();
        requestExecutor.shutdown();
        delayQueueExecutor.shutdown();
    }

