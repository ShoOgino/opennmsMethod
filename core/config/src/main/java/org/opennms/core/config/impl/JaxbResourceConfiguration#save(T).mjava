    public void save(final T config) throws ConfigurationResourceException {
        final Resource r = getResource();
        if (!(r instanceof WritableResource)) {
            throw new ConfigurationResourceException("Resource " + r + " is not writable!");
        }
        final WritableResource resource = (WritableResource)r;
        OutputStream os = null;
        OutputStreamWriter osw = null;
        try {
            os = resource.getOutputStream();
            osw = new OutputStreamWriter(os);
            JaxbUtils.marshal(config, osw);
        } catch (final IOException e) {
            throw new ConfigurationResourceException("Failed to write to " + r, e);
        } catch (final Exception e) {
            throw new ConfigurationResourceException("Failed to marshal configuration " + getClassType() + " to resource " + r, e);
        } finally {
            IOUtils.closeQuietly(osw);
            IOUtils.closeQuietly(os);
        }
    }

