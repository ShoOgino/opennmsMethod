    /**
     * <p>migrate</p>
     *
     * @param changelog
     * @throws org.opennms.core.schema.MigrationException if any.
     */
    public void migrate(Resource changelog) throws MigrationException {
        Connection connection = null;

        try {
            connection = m_dataSource.getConnection();

            final SpringLiquibase lb = new SpringLiquibase();
            lb.setResourceLoader(m_context);
            lb.setChangeLog(changelog.getURI().toString());
            lb.setDataSource(m_dataSource);
            lb.setChangeLogParameters(getChangeLogParameters());
            lb.setDefaultSchema(getSchemaName());
            lb.setContexts(getLiquibaseContexts());
            lb.afterPropertiesSet();
        } catch (final Throwable e) {
            throw new MigrationException("unable to migrate the database: " + e.getMessage(), e);
        } finally {
            cleanUpDatabase(connection, null, null, null);
        }
    }

