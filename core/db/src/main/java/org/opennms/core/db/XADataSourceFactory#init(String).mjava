	/**
	 * <p>init</p>
	 *
	 * @param dsName a {@link java.lang.String} object.
	 * @throws java.io.IOException if any.
	 * @throws org.exolab.castor.xml.MarshalException if any.
	 * @throws org.exolab.castor.xml.ValidationException if any.
	 * @throws java.lang.ClassNotFoundException if any.
	 * @throws java.beans.PropertyVetoException if any.
	 * @throws java.sql.SQLException if any.
	 */
	public static synchronized void init(final String dsName) throws IOException, MarshalException, ValidationException, ClassNotFoundException, PropertyVetoException, SQLException {
		if (isLoaded(dsName)) {
			// init already called - return
			// to reload, reload() will need to be called
			return;
		}

		final File cfgFile = ConfigFileConstants.getFile(ConfigFileConstants.OPENNMS_DATASOURCE_CONFIG_FILE_NAME);
		FileInputStream fileInputStream = null;
		try {
			fileInputStream = new FileInputStream(cfgFile);
			final JdbcDataSource ds = ConnectionFactoryUtil.marshalDataSourceFromConfig(fileInputStream, dsName);
			PGXADataSource xaDataSource = new PGXADataSource();
			URL url = new URL(ds.getUrl());
			xaDataSource.setServerName(url.getHost());
			xaDataSource.setPortNumber(url.getPort());
			xaDataSource.setDatabaseName(ds.getDatabaseName());
			xaDataSource.setUser(ds.getUserName());
			xaDataSource.setPassword(ds.getPassword());
			setInstance(xaDataSource);
		} finally {
			IOUtils.closeQuietly(fileInputStream);
		}
	}

