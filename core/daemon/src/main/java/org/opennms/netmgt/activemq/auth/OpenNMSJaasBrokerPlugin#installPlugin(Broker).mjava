    @Override
    public Broker installPlugin(Broker broker) throws Exception {
        final Set<InetAddress> trustedHostAddresses = new HashSet<>();
        for (String trustedHost : trustedHosts) {
            trustedHostAddresses.add(InetAddress.getByName(trustedHost));
        }
        final Set<Principal> principalsForTrustedHosts = groupsForTrustedHosts.stream()
                .map(g -> new GroupPrincipal(g))
                .collect(Collectors.toSet());
        return new OpenNMSJaasAuthenticationBroker(broker, trustedHostAddresses, usernameForTrustedHosts, principalsForTrustedHosts);
    }

