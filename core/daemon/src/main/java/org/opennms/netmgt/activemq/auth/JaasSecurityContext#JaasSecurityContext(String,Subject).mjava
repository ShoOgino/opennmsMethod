    public JaasSecurityContext(String userName, Subject subject) {
        super(userName);
        // Map all of the subject's principals to GroupPrincipals with the same name
        principals = subject.getPrincipals().stream()
                .map(p -> p.getName())
                .map(n -> new GroupPrincipal(n))
                .collect(Collectors.toSet());
    }

