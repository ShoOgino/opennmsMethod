    /**
     * Creates an SNMP4J PDU based on the SNMP4J version constants.
     * A v3 request requires a ScopedPDU.
     * 
     * @param type
     * @return
     */
    public PDU createPdu(int type) {
        PDU pdu = null;
        if (isSnmpV3()) {
            pdu = new ScopedPDU();
            ScopedPDU scopedPDU = (ScopedPDU) pdu;
            OctetString contextName = getContextName();
            if (contextName != null)
                scopedPDU.setContextName(contextName);
            OctetString contextEngineID = getContextEngineID();
            if (contextEngineID != null)
                scopedPDU.setContextEngineID(contextEngineID);
        } else {
            pdu = new PDU();
        }
        pdu.setType(type);
        return pdu;
    }

