    protected static TrapProcessor processTrap(TrapInformation trap, TrapProcessor trapProcessor) {
        
        trap.validate();
        
        trapProcessor.setSystemId(trap.getSystemId());
        trapProcessor.setLocation(trap.getLocation());
        trapProcessor.setCreationTime(trap.getCreationTime());
        trapProcessor.setVersion(trap.getVersion());
        trapProcessor.setCommunity(trap.getCommunity());
        trapProcessor.setAgentAddress(trap.getAgentAddress());
        trapProcessor.setTrapAddress(trap.getTrapAddress());
    
        LOG.debug("{} trap - trapInterface: ()", trap.getVersion(), trap.getTrapAddress());
        
        // time-stamp
        trapProcessor.setTimeStamp(trap.getTimeStamp());
    
        trapProcessor.setTrapIdentity(trap.getTrapIdentity());
        
        int i = 0;
        try {
            for (i = 0; i < trap.getPduLength(); i++) {
                trap.processVarBindAt(i);
            } // end for loop
        } catch (Throwable t) {
            LOG.error("Caught {} while processing varbind {} of trap; rethrowing. Trap info: {}. Stack trace: {}", t.getClass(), i+1, trap.toString(), t.getStackTrace());
            throw t;
        }
    
        return trapProcessor;
    }

