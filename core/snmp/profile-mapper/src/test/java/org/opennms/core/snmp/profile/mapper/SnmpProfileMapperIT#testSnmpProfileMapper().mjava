    @Test(timeout = 30000)
    public void testSnmpProfileMapper() throws UnknownHostException {

        // timeout and ttl from first profile.
        int timeout = 5000;
        long ttl = 10000;
        try (InputStream configStream = getClass().getResource("/snmp-config1.xml").openStream()) {
            setUpProfileMapper(configStream);
            CompletableFuture<Optional<SnmpAgentConfig>> future = profileMapper.getAgentConfigFromProfiles(InetAddress.getByName("192.0.1.206"),
                    null);
            Optional<SnmpAgentConfig> agentConfig = future.get();
            assertTrue(agentConfig.isPresent());
            assertEquals(ttl, agentConfig.get().getTTL().longValue());
            assertEquals(timeout, agentConfig.get().getTimeout());
            snmpPeerFactory.saveAgentConfigAsDefinition(agentConfig.get(), "Default", "test");
            List<Definition> definitions = snmpPeerFactory.getSnmpConfig().getDefinitions();
            Optional<Definition> definition = definitions.stream().filter(def -> def.getTimeout() == timeout).findFirst();
            assertTrue(definition.isPresent());
        } catch (InterruptedException | ExecutionException | IOException e) {
            fail();
        }
    }

