    /**
     * Check that all fields that are marked with @Autowired are not null.
     */
    public static <T> void assertAutowiring(T instance) {
        for (Field field : instance.getClass().getDeclaredFields()) {
            Autowired annotation = field.getAnnotation(Autowired.class);
            if (annotation != null && annotation.required()) {
                try {
                    field.setAccessible(true);
                    notNull(field.get(instance), "@Autowired field " + field.getName() + " cannot be null");
                    LogUtils.debugf(instance, "%s is not null", field.getName());
                } catch (IllegalAccessException e) {
                    throw new IllegalArgumentException("Illegal access to @Autowired field " + field.getName());
                }
            }
        }
    }

