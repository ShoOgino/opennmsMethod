    private static AddressType classifyAddress(final String address) {
        if (address.indexOf(':') != -1) {
            return AddressType.IPv6;
        }

        if (address.indexOf('.') != -1) {
            return AddressType.IPv4;
        }
        throw new IllegalArgumentException("Cannot determine whether address is a IPv4 or IPv6 address");
    }

