    public static ManagedChannel getChannel(String host, int port, Map<String, String> properties) throws IOException {

        NettyChannelBuilder channelBuilder = NettyChannelBuilder.forAddress(host, port)
                .keepAliveWithoutCalls(true);
        boolean tlsEnabled = Boolean.parseBoolean(properties.get(TLS_ENABLED));
        if (tlsEnabled) {
            return channelBuilder
                    .negotiationType(NegotiationType.TLS)
                    .sslContext(buildSslContext(properties).build())
                    .build();
        } else {
            return channelBuilder.usePlaintext().build();
        }
    }

