    @Test
    public void testBadlyBehavedTask() throws Exception {

        BadlyBehavedTask bad1 = new BadlyBehavedTask(m_coordinator, "Task 1", Failure.COMPLETESUBMIT, Failure.DOSUBMIT, Failure.POSTSCHEDULE, Failure.PRESCHEDULE);
        BadlyBehavedTask bad2 = new BadlyBehavedTask(m_coordinator, "Task 2", Failure.COMPLETESUBMIT, Failure.DOSUBMIT, Failure.POSTSCHEDULE, Failure.PRESCHEDULE);

        TaskLatch latch1 = new TaskLatch(1, 1, 1);
        bad1.setTaskLatch(latch1);
        TaskLatch latch2 = new TaskLatch(1, 1, 1);
        bad2.setTaskLatch(latch2);

        // Add the second task as a dependent of the first
        bad1.addDependent(bad2);

        // Schedule the first task
        bad2.schedule();

        assertFalse("Task 1 completed unexpectedly", bad1.waitFor(200, TimeUnit.MILLISECONDS));
        assertFalse("Task 2 completed unexpectedly", bad2.waitFor(200, TimeUnit.MILLISECONDS));

        bad1.schedule();

        assertTrue("Task 1 did not finish", bad1.waitFor(5, TimeUnit.SECONDS));
        LOG.info("Task 1 finished!");
        assertTrue("Task 2 did not finish", bad2.waitFor(5, TimeUnit.SECONDS));
        LOG.info("Task 2 finished!");

        latch1.waitFor(1, TimeUnit.SECONDS);
        latch2.waitFor(1, TimeUnit.SECONDS);
    }

