    /**
     * Send this PingRequest through the given icmpSocket
     *
     * @param icmpSocket a {@link org.opennms.protocols.icmp.IcmpSocket} object.
     */
    public void send(NativeDatagramSocket icmpSocket, InetAddress addr) {
        try {
            m_log.debug(System.currentTimeMillis()+": Sending Ping Request: " + this);

            if (addr instanceof Inet4Address) {
                m_expiration = System.currentTimeMillis() + m_timeout;
                v4.ping((Inet4Address)addr, (int)m_id.getTid(), m_id.getSequenceId(), 1, 0);
            } else if (addr instanceof Inet6Address) {
                m_expiration = System.currentTimeMillis() + m_timeout;
                v6.ping((Inet6Address)addr, (int)m_id.getTid(), m_id.getSequenceId(), 1, 0);
            }
        } catch (Throwable t) {
            m_callback.handleError(m_id.getAddress(), m_request, t);
        }
    }

