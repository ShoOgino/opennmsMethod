    @Test
    public void testICMPPacketGets() throws Exception {
        
        IPPacket pkt = new IPPacket(ip, 0, ip.length);
        assertThat(pkt.getProtocol(), is(equalTo(Protocol.ICMP)));
        
        // payload 64 bytes: ICMP header (8 bytes) followed by byte values 1, 2, 3, ... 55, 56 
        ByteBuffer payload = pkt.getPayload();
        ICMPPacket icmpPacket = new ICMPPacket(payload);
        assertThat(icmpPacket.getType(), is(equalTo(Type.EchoReply)));
        assertThat(icmpPacket.getCode(), is(equalTo(0)));
        assertThat(icmpPacket.getChecksum(), is(equalTo(24310)));
        assertThat(icmpPacket.getChecksum(), is(equalTo(icmpPacket.computeChecksum())));
        
        ICMPEchoPacket echoReply = new ICMPEchoPacket(icmpPacket);
        assertThat(echoReply.getIdentifier(), is(equalTo(43260)));
        assertThat(echoReply.getSequenceNumber(), is(equalTo(250)));
        
        ByteBuffer content = echoReply.getContentBuffer();
        for(int i = 0; i < 56; i++) {
            assertThat(content.get(i), is(equalTo((byte)i)));
        }
        
    }

