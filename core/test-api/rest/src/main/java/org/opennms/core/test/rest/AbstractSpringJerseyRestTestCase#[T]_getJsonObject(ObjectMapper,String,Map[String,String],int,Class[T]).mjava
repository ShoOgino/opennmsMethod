    protected <T> T getJsonObject(ObjectMapper mapper, String url, Map<String, String> parameterMap, int expectedStatus, Class<T> expectedClass) throws Exception {
        MockHttpServletRequest request = createRequest(servletContext, GET, url, parameterMap, getUser(), getUserRoles());
        MockHttpServletResponse response = createResponse();
        request.addHeader(ACCEPT, MediaType.APPLICATION_JSON);
        dispatch(request, response);
        assertEquals(expectedStatus, response.getStatus());

        System.err.printf("json: %s%n", response.getContentAsString());

        InputStream in = new ByteArrayInputStream(response.getContentAsByteArray());

        return mapper.readValue(in, expectedClass);
    }

