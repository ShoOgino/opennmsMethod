    @Override
    protected String sendRequest(MockHttpServletRequest request, int expectedStatus, final String expectedUrlSuffix) throws Exception, UnsupportedEncodingException {
        request.addHeader(ACCEPT, MediaType.APPLICATION_JSON);
        MockHttpServletResponse response = createResponse();
        dispatch(request, response);
        final String json = response.getContentAsString();
        assertEquals(expectedStatus, response.getStatus());
        if (expectedUrlSuffix != null) {
            final String location = response.getHeader("Location").toString();
            assertTrue("location '" + location + "' should end with '" + expectedUrlSuffix + "'", location.endsWith(expectedUrlSuffix));
        }
        Thread.sleep(50);
        return json;
    }

