    private OnmsAlarm getFirstAlarmWithType(long time, int type, String typeDescr) {
        return getAlarms(time).stream()
                .filter(a -> a.getAlarmType() == type)
                .findFirst()
                .orElseThrow(() -> new RuntimeException("No " + typeDescr + " alarms at time: " + time));
    }

