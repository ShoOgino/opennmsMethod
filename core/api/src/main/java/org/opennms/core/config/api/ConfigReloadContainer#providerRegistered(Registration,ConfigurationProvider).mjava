    @Override
    public void providerRegistered(Registration registration, ConfigurationProvider provider) {
        boolean added;
        // must be synchronized for two reasons:
        // 1. the providers collection must not be modified concurrently
        // 2. forceReload changes must made visible to other threads
        synchronized (this) {
            if (clazz.equals(registration.getProvider(ConfigurationProvider.class).getType())
                && providers.add(new ConfigurationProviderState<>(provider))) {
                LOG.debug("Registered configuration provider {} for {}.", provider, clazz.getCanonicalName());
                // Force a check on the next get
                forceReload = true;
                added = true;
            } else {
                added = false;
            }
        }
        if (added) {
            provider.registeredToConfigReloadContainer();
        }
    }

