    /* (non-Javadoc)
     * @see org.opennms.upgrade.api.OnmsUpgrade#preExecute()
     */
    public void preExecute() throws OnmsUpgradeException {
        printMainSettings();
        if (getRrdExtension() == null) {
            throw new OnmsUpgradeException("Can't find the configured extension for JRB/RRD.");
        }
        try {
            DataCollectionConfigFactory.init();
        } catch (Exception e) {
            throw new OnmsUpgradeException("Can't initialize datacollection-config.xml because " + e.getMessage());
        }
        try {
            KSC_PerformanceReportFactory.init();
        } catch (Exception e) {
            throw new OnmsUpgradeException("Can't initialize ksc-performance-reports.xml because " + e.getMessage());
        }
        interfacesToMerge = getInterfacesToMerge();
        for (SnmpInterfaceUpgrade intf : interfacesToMerge) {
            File[] targets = { intf.getOldInterfaceDir(), intf.getNewInterfaceDir() };
            for (File target : targets) {
                if (target.exists()) {
                    log("Backing up: %s\n", target);
                    zipDir(new File(target.getAbsolutePath() + ZIP_EXT), target);
                }
            }
        }
    }

