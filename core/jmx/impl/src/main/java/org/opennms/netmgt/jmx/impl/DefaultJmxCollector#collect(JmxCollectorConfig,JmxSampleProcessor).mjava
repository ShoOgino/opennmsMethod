    @Override
    public void collect(JmxCollectorConfig config, JmxSampleProcessor sampleProcessor) throws JmxServerConnectionException {
        if (m_jmxConfigDao == null) {
            m_jmxConfigDao = BeanUtils.getBean("daoContext", "jmxConfigDao", JmxConfigDao.class);
        }

        Map<String, String> mergedStringMap = new HashMap<>(config.getServiceProperties());

        if (mergedStringMap.containsKey("port")) {
            MBeanServer mBeanServer = m_jmxConfigDao.getConfig().lookupMBeanServer(config.getAgentAddress(), mergedStringMap.get("port"));
            if (mBeanServer != null) {
                mergedStringMap.putAll(mBeanServer.getParameterMap());
            }
        }

        JmxConnectionManager connectionManager = new DefaultConnectionManager(config.getRetries());
        try (JmxServerConnectionWrapper connectionWrapper = connectionManager.connect(config.getConnectionName(), config.getAgentAddress(), mergedStringMap, null)) {
            Objects.requireNonNull(connectionWrapper, "connectionWrapper should never be null");
            Objects.requireNonNull(connectionWrapper.getMBeanServerConnection(), "connectionWrapper.getMBeanServerConnection() should never be null");

            final MBeanServerConnection concreteConnection = connectionWrapper.getMBeanServerConnection();
            collect(concreteConnection, config.getJmxCollection(), sampleProcessor);
        }
    }

