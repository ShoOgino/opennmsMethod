    /*
     * At some point while working on the new Graph Service API reloading the Bsmd did not correctly
     * reload the BusinessServiceGraphProvider, instead a ClassNotFoundException was raised.
     * When looking into the issue, it could not be reproduced anymore.
     * However this test is going to fail if the issue re-surfaces at some later point.
     */
    @Test
    public void canReloadBsmGraphProvider() {
        final String containerId = "bsm";
        final String namespace = containerId;

        // By default no business services should be available
        given().log().ifValidationFails()
                .accept(ContentType.JSON)
                .get("/{containerId}/{namespace}", containerId, namespace)
                .then().log().ifValidationFails()
                .statusCode(200)
                .body("vertices", Matchers.hasSize(0))
                .body("edges", Matchers.hasSize(0));

        // Generate hierarchie
        karafShell.runCommand("opennms-bsm:generate-hierarchies 5 2");
        Unreliables.retryUntilSuccess(30, TimeUnit.SECONDS, () -> {
            given().log().ifValidationFails()
                    .accept(ContentType.JSON)
                    .get("/{containerId}/{namespace}", containerId, namespace)
                    .then().log().ifValidationFails()
                    .statusCode(200)
                    .body("vertices", Matchers.hasSize(5))
                    .body("edges", Matchers.hasSize(0));
            return null;
        });

        // Delete hierarchy and verify daemon reloaded successful
        karafShell.runCommand("opennms-bsm:delete-generated-hierarchies");
        Unreliables.retryUntilSuccess(30, TimeUnit.SECONDS, () -> {
            given().log().ifValidationFails()
                    .accept(ContentType.JSON)
                    .get("/{containerId}/{namespace}", containerId, namespace)
                    .then().log().ifValidationFails()
                    .statusCode(200)
                    .body("vertices", Matchers.hasSize(0))
                    .body("edges", Matchers.hasSize(0));
            return null;
        });
    }

