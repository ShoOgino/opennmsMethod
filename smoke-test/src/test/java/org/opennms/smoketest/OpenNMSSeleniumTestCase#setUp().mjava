    @Before
    public void setUp() throws Exception {
        final String logLevel = System.getProperty("org.opennms.smoketest.logLevel", "DEBUG");
        final Logger logger = org.slf4j.LoggerFactory.getLogger(ch.qos.logback.classic.Logger.ROOT_LOGGER_NAME);
        if (logger instanceof ch.qos.logback.classic.Logger) {
            final ch.qos.logback.classic.Logger logbackLogger = (ch.qos.logback.classic.Logger) logger;
            logbackLogger.setLevel(ch.qos.logback.classic.Level.valueOf(logLevel));
        }

        final String driverClass = System.getProperty("org.opennms.smoketest.webdriver.class", System.getProperty("webdriver.class"));
        if (driverClass != null) {
            m_driver = (WebDriver)Class.forName(driverClass).newInstance();
        }

        // otherwise, PhantomJS if found, or fall back to Firefox
        if (m_driver == null) {
            if (usePhantomJS) {
                final File phantomJS = findPhantomJS();
                if (phantomJS != null) {
                    final DesiredCapabilities caps = new DesiredCapabilities();
                    caps.setCapability(PhantomJSDriverService.PHANTOMJS_EXECUTABLE_PATH_PROPERTY, phantomJS.toString());
                    m_driver = new PhantomJSDriver(caps);
                }
            }
            if (m_driver == null) {
                m_driver = new FirefoxDriver();
            }
        }

        LOG.debug("Using driver: {}", m_driver);
        m_driver.manage().timeouts().implicitlyWait(LOAD_TIMEOUT, TimeUnit.MILLISECONDS);
        wait = new WebDriverWait(m_driver, TimeUnit.SECONDS.convert(LOAD_TIMEOUT, TimeUnit.MILLISECONDS));

        selenium = new WebDriverBackedSelenium(m_driver, BASE_URL);
        // Change the timeout from the default of 30 seconds to 60 seconds
        // since we have to launch the browser and visit the front page of
        // the OpenNMS web UI in this amount of time and on the Bamboo
        // machines, 30 seconds is cutting it close. :)

        m_driver.get(BASE_URL + "opennms/login.jsp");
        enterText(By.name("j_username"), "admin");
        enterText(By.name("j_password"), "admin");
        findElementByName("Login").click();
        new WebDriverWait(m_driver, 60).until(ExpectedConditions.visibilityOfElementLocated(By.xpath("//div[@id='content']")));
    }

