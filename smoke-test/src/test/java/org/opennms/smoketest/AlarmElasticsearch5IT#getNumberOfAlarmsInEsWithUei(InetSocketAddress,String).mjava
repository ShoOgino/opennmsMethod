    private static int getNumberOfAlarmsInEsWithUei(InetSocketAddress esHttpAddr, String uei) throws IOException {
        JestClient client = null;
        try {
            JestClientFactory factory = new JestClientFactory();
            factory.setHttpClientConfig(new HttpClientConfig.Builder(String.format("http://%s:%d", esHttpAddr.getHostString(), esHttpAddr.getPort()))
                    .multiThreaded(true)
                    .build());
            client = factory.getObject();

            SearchResult response = client.execute(
                    new Search.Builder(new SearchSourceBuilder()
                            .query(QueryBuilders.matchQuery("eventuei", EventConstants.IMPORT_FAILED_UEI))
                            .toString()
                    )
                            .addIndex("opennms-alarms*")
                            .build()
            );

            LOG.debug("SEARCH RESPONSE: {}", response.toString());
            return response.getTotal();
        } finally {
            if (client != null) {
                client.shutdownClient();
            }
        }
    }

