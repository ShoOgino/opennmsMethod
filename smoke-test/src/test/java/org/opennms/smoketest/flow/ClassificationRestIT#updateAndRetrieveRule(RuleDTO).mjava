    private RuleDTO updateAndRetrieveRule(RuleDTO ruleDTO) {
        given().contentType(ContentType.JSON)
                .body(ruleDTO)
                .log().all()
                .put(Integer.toString(ruleDTO.getId()))
                .then().assertThat()
                .log().all()
                .statusCode(200);

        // Verify update worked
        final RuleDTO updatedRule = given().get(Integer.toString(ruleDTO.getId()))
                .then()
                .log().body(true)
                .assertThat()
                .contentType(ContentType.JSON)
                .statusCode(200)
                .extract().response().as(RuleDTO.class);
        assertThat(updatedRule.getId(), is(ruleDTO.getId()));
        assertThat(updatedRule.getName(), is(ruleDTO.getName()));
        assertThat(updatedRule.getDstAddress(), is(ruleDTO.getDstAddress()));
        assertThat(updatedRule.getProtocols(), is(ruleDTO.getProtocols()));
        assertThat(updatedRule.getGroup().getName(), is(ruleDTO.getGroup().getName()));
        return updatedRule;
    }

