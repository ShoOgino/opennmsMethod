    private RuleDTO saveAndRetrieveRule(RuleDTO ruleDTO) {
        String header = given().contentType(ContentType.JSON)
                .accept(ContentType.JSON)
                .body(ruleDTO)
                .post().then().assertThat().statusCode(201) // created
                .extract().header("Location");
        final String[] split = header.split("/");
        int classificationId = Integer.parseInt(split[split.length - 1]);

        // Verify Creation of rule
        final RuleDTO receivedHttpRule = given().get("" + classificationId)
                .then().log().body(true)
                .assertThat()
                .statusCode(200)
                .contentType(ContentType.JSON)
                .extract().response().as(RuleDTO.class);
        assertThat(receivedHttpRule.getId(), is(classificationId));
        assertThat(receivedHttpRule.getName(), is(ruleDTO.getName()));
        assertThat(receivedHttpRule.getDstAddress(), is(ruleDTO.getDstAddress()));
        assertThat(receivedHttpRule.getProtocols(), is(ruleDTO.getProtocols()));
        assertThat(receivedHttpRule.getGroup().getName(), is(ruleDTO.getGroup().getName()));
        return receivedHttpRule;
    }

