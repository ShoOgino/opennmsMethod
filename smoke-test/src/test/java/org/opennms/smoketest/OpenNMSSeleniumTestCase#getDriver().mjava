    protected WebDriver getDriver() throws InstantiationException, IllegalAccessException, ClassNotFoundException {
        WebDriver driver = null;
        final String driverClass = System.getProperty("org.opennms.smoketest.webdriver.class", System.getProperty("webdriver.class"));
        if (driverClass != null) {
            driver = (WebDriver)Class.forName(driverClass).newInstance();
        }

        // otherwise, PhantomJS if found, or fall back to Firefox
        if (driver == null) {
            if (usePhantomJS) {
                final File phantomJS = findPhantomJS();
                if (phantomJS != null) {
                    final DesiredCapabilities caps = new DesiredCapabilities();
                    caps.setCapability(PhantomJSDriverService.PHANTOMJS_EXECUTABLE_PATH_PROPERTY, phantomJS.toString());
                    driver = new PhantomJSDriver(caps);
                }
            }
            if (driver == null) {
                driver = new FirefoxDriver();
            }
        }
        return driver;
    }

