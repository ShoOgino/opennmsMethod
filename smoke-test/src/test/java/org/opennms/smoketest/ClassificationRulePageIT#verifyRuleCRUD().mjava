    @Test
    public void verifyRuleCRUD() {
        final GroupTab groupTab = new GroupTab(this.uiPage, Tabs.USER_DEFINED).click();
        assertThat(groupTab.isEmpty(), is(true));

        // Create dummy group
        groupTab.addNewRule(new RuleDTOBuilder()
                .withName("http")
                .withDstPort("80,8080")
                .withProtocol("udp,tcp").build());
        assertThat(groupTab.isEmpty(), is(false));

        // Verify that one group has been created
        final List<RuleData> rules = groupTab.getRules();
        assertThat(rules, hasSize(1));
        final RuleData rule = rules.get(0);
        assertThat(rule.getName(), is("http"));
        assertThat(rule.getProtocol(), is("TCP,UDP"));
        assertThat(rule.getDstAddress(), is(""));
        assertThat(rule.getDstPort(), is("80\n8080"));
        assertThat(rule.getSrcAddress(), is(""));
        assertThat(rule.getSrcPort(), is(""));
        assertThat(rule.getExporterFilter(), is(""));

        // Edit rule
        groupTab.editRule(rule.getPosition(),
                createFrom(rule)
                        .withName("OpenNMS")
                        .withProtocol("tcp")
                        .withDstAddress("5.5.5.5")
                        .withDstPort("8980")
                        .withSrcAddress("127.0.0.1")
                        .withSrcPort("55557")
                        .withExporterFilter("categoryName == 'Routers'")
                .build()
        );

        // Edit, but cancel
        groupTab.editModal(0).setInput(createFrom(rule).build()).cancel();

        // Verify edit made it through, but cancel did not
        final RuleData modifiedRule = groupTab.getRuleData(0);
        assertThat(modifiedRule.getName(), is("OpenNMS"));
        assertThat(modifiedRule.getProtocol(), is("TCP"));
        assertThat(modifiedRule.getDstAddress(), is("5.5.5.5"));
        assertThat(modifiedRule.getDstPort(), is("8980"));
        assertThat(modifiedRule.getSrcAddress(), is("127.0.0.1"));
        assertThat(modifiedRule.getSrcPort(), is("55557"));
        assertThat(modifiedRule.getExporterFilter(), is("categoryName == 'Routers'"));

        // Delete rule
        groupTab.deleteGroup(rule.getPosition());
        assertThat(groupTab.getRules(), hasSize(0));
    }

