    /**
     * Override this method to customize the test environment.
     */
    @Override
    protected TestEnvironmentBuilder getEnvironmentBuilder() {
        final TestEnvironmentBuilder builder = TestEnvironment.builder().all()

            // Enable Elasticsearch 5
            .es5()

            // Enable Kafka
            .kafka();
        builder.withOpenNMSEnvironment()

            // Add opennms-es-rest to the featuresBoot list
            .addFile(AbstractSyslogTestCase.class.getResource("/org.apache.karaf.features.cfg"), "etc/org.apache.karaf.features.cfg")

            // Set logging to INFO level
            .addFile(AbstractSyslogTestCase.class.getResource("/log4j2-info.xml"), "etc/log4j2.xml")
            .addFile(AbstractSyslogTestCase.class.getResource("/eventconf.xml"), "etc/eventconf.xml")
            .addFile(AbstractSyslogTestCase.class.getResource("/events/Cisco.syslog.events.xml"), "etc/events/Cisco.syslog.events.xml")
            // Disable Alarmd, enable Syslogd
            .addFile(AbstractSyslogTestCase.class.getResource("/service-configuration-disable-alarmd.xml"), "etc/service-configuration.xml")
            .addFile(AbstractSyslogTestCase.class.getResource("/syslogd-configuration.xml"), "etc/syslogd-configuration.xml")
            .addFile(AbstractSyslogTestCase.class.getResource("/syslog/Cisco.syslog.xml"), "etc/syslog/Cisco.syslog.xml")

            // Add a 60-second delay to the sink consumer startup to give 
            // opennms-es-rest time to start up before consuming from Kafka
            .addFile(AbstractSyslogTestCase.class.getResource("/opennms.properties.d/sink-initial-sleep-time.properties"), "etc/opennms.properties.d/sink-initial-sleep-time.properties")

            // Switch sink impl to Kafka using opennms-properties.d file
            .addFile(AbstractSyslogTestCase.class.getResource("/opennms.properties.d/kafka-sink.properties"), "etc/opennms.properties.d/kafka-sink.properties");
        builder.withMinionEnvironment()
            // Switch sink impl to Kafka using features.boot file
            .addFile(AbstractSyslogTestCase.class.getResource("/featuresBoot.d/kafka.boot"), "etc/featuresBoot.d/kafka.boot");
        OpenNMSSeleniumTestCase.configureTestEnvironment(builder);
        return builder;
    }

