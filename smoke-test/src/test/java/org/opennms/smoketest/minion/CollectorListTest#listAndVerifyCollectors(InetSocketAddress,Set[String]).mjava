    public List<String> listAndVerifyCollectors(InetSocketAddress sshAddr, Set<String> expectedCollectors) throws Exception {
        List<String> unmatchedCollectors = new ArrayList<>();
        try (final SshClient sshClient = new SshClient(sshAddr, "admin", "admin")) {
            // List the collectors
            PrintStream pipe = sshClient.openShell();
            pipe.println("collection:list-collectors");
            pipe.println("logout");
            await().atMost(1, MINUTES).until(sshClient.isShellClosedCallable());

            // Parse the output
            String shellOutput = sshClient.getStdout();
            shellOutput = StringUtils.substringAfter(shellOutput, "collection:list-collectors");
            LOG.info("Collectors output: {}", shellOutput);
            Set<String> collectors = new HashSet<String>();
            for (String collector : shellOutput.split("\\r?\\n")) {
                if (StringUtils.isNotBlank(collector)) {
                    collectors.add(collector);
                }
            }
            LOG.info("Found collectors: {}", collectors);

            // Verify
            for (String expectedCollector : expectedCollectors) {
                if (!collectors.contains(expectedCollector)) {
                    unmatchedCollectors.add(expectedCollector);
                }
            }
        }
        return unmatchedCollectors;
    }

