    private static void createElasticsearchIndex(InetSocketAddress esTransportAddr, Date date) {
        Settings settings = ImmutableSettings.settingsBuilder()
            .put("cluster.name", "opennms").build();
        TransportClient esClient = new TransportClient(settings).addTransportAddress(new InetSocketTransportAddress(esTransportAddr));

        try {
            esClient.admin().indices().prepareCreate(new IndexNameFunction().apply("opennms", date)).execute().actionGet();
        } finally {
            esClient.close();
        }

        LOG.info("Finished creating index {}", new IndexNameFunction().apply("opennms", date));

        // Sleep to ensure that the index is fully operational
        try { Thread.sleep(1000); } catch (InterruptedException e) {}
    }

