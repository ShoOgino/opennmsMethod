    /**
     * CAUTION: There are a variety of Firefox-specific bugs related to using
     * {@link WebElement#sendKeys(CharSequence...)}. We're doing this bizarre
     * sequence of operations to try and work around them.
     *
     * @see https://code.google.com/p/selenium/issues/detail?id=2487
     * @see https://code.google.com/p/selenium/issues/detail?id=8180
     */
    protected static WebElement enterText(WebDriver driver, final By selector, final String text) {
        LOG.debug("Enter text: '{}' into selector: {}", text, selector);
        final WebElement element = driver.findElement(selector);

        // Clear the element content
        element.clear();
        // Because clear() seems to be async, verify that it worked before
        // continuing so that we don't erase the value
        int i = 0;
        while (!"".equals(element.getAttribute("value").trim()) && (i++ < 100)) {
            try { Thread.sleep(200); } catch (InterruptedException e) {}
        }

        // Focus on the element before typing
        new Actions(driver).moveToElement(element).click().perform();
        // Again, focus on the element before typing
        element.sendKeys("");
        // Send the keys
        element.sendKeys(text);
        i = 0;
        while (!text.equals(element.getAttribute("value")) && (i++ < 100)) {
            try { Thread.sleep(200); } catch (InterruptedException e) {}
        }
        return element;
    }

