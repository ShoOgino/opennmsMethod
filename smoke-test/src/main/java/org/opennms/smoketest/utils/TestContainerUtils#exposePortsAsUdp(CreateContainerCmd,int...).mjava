    /**
     * Workaround for UDP ports -- see https://github.com/testcontainers/testcontainers-java/issues/554
     *
     * @param cmd
     * @param ports
     */
    public static void exposePortsAsUdp(CreateContainerCmd cmd, int... ports) {
        final ExposedPort[] exposedPorts = cmd.getExposedPorts();
        if (exposedPorts == null && ports.length > 0) {
            throw new RuntimeException("There are 1+ ports to convert to UDP, but no exposed ports were found.");
        }

        // Index the ports for easy lookup
        final Map<Integer, Integer> portToIdx = new HashMap<>();
        for (int i = 0; i < exposedPorts.length; i++) {
            portToIdx.put(exposedPorts[i].getPort(), i);
        }

        for (int port : ports) {
            final Integer idx = portToIdx.get(port);
            if (idx == null) {
                throw new RuntimeException("No exposed port entry found for: " + port);
            }
            exposedPorts[idx] = new ExposedPort(port, InternetProtocol.UDP);
        }
    }

