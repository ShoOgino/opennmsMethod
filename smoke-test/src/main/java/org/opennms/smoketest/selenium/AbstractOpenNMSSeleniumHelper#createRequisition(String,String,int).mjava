    protected void createRequisition(final String foreignSource, final String xml, final int expectedNodes) {
        LOG.debug("Creating requisition from XML: " + foreignSource);
        try {
            final String foreignSourceUrlFragment = URLEncoder.encode(foreignSource, "UTF-8");

            sendPost("/rest/requisitions", xml);
            requisitionWait.until(new WaitForNodesInRequisition(expectedNodes));

            final HttpPut request = new HttpPut(getBaseUrlExternal() + "opennms/rest/requisitions/" + foreignSourceUrlFragment + "/import");
            final Integer status = doRequest(request);
            if (status == null || status < 200 || status >= 400) {
                throw new OpenNMSTestException("Unknown status: " + status);
            }
            requisitionWait.until(new WaitForNodesInDatabase(expectedNodes));
        } catch (final Exception e) {
            throw new OpenNMSTestException(e);
        }
    }

