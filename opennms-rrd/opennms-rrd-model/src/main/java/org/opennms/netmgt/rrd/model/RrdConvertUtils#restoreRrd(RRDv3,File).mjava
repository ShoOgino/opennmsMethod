    /**
     * Restores a RRD.
     *
     * @param rrd the RRD object
     * @param targetFile the target file
     * @throws IOException Signals that an I/O exception has occurred.
     * @throws RrdException the RRD exception
     */
    public static void restoreRrd(RRDv3 rrd, File targetFile) throws IOException, RrdException {
        String rrdBinary = System.getProperty("rrd.binary");
        if (rrdBinary == null) {
            throw new IllegalArgumentException("rrd.binary property must be set");
        }
        File xmlDest = new File(targetFile + ".xml");
        JaxbUtils.marshal(rrd, new FileWriter(xmlDest));
        String command = rrdBinary + " restore " + xmlDest.getAbsolutePath() + " " + targetFile.getAbsolutePath();
        String[] commandArray = StringUtils.createCommandArray(command, '@');
        Process process = Runtime.getRuntime().exec(commandArray);
        String errors = FileCopyUtils.copyToString(new InputStreamReader(process.getErrorStream()));
        if (errors.length() > 0) {
            throw new RrdException("RRDtool command fail: " + errors);
        }
        xmlDest.delete();
    }

