    /**
     * Add an operation to the queue.
     *
     * @param op a {@link org.opennms.netmgt.rrd.QueuingRrdStrategy.Operation} object.
     */
    private void addOperation(final Operation op) {
        synchronized (this) {
            if (queueIsFull()) {
                m_log.error("RRD Data Queue is Full!! Discarding operation for file {}", op.getFileName());
                return;
            }

            if (op.isSignificant() && sigQueueIsFull()) {
                m_log.error("RRD Data Significant Queue is Full!! Discarding operation for file {}", op.getFileName());
                return;
            }

            if (!op.isSignificant() && inSigQueueIsFull()) {
                m_log.error("RRD Insignificant Data Queue is Full!! Discarding operation for file {}", op.getFileName());
                return;
            }

            storeAssignment(op);

            setTotalOperationsPending(getTotalOperationsPending() + 1);
            setEnqueuedOperations(getEnqueuedOperations() + 1);
            if (op.isSignificant())
                setSignificantOpsEnqueued(getSignificantOpsEnqueued() + 1);
            notifyAll();
            ensureThreadsStarted();
        }
    }

