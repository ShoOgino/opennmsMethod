    /**
     * Creates the JRobin RrdDb from the def by opening the file and then
     * closing.
     *
     * @param rrdDef a {@link org.jrobin.core.RrdDef} object.
     * @throws java.lang.Exception if any.
     */
    @Override
    public void createFile(final RrdDef rrdDef,  Map<String, String> attributeMappings) throws Exception {
        if (rrdDef == null) {
            LOG.debug("createRRD: skipping RRD file");
            return;
        }
        LOG.info("createRRD: creating RRD file {}", rrdDef.getPath());

        RrdDb rrd = new RrdDb(rrdDef);
        rrd.close();

        String filenameWithoutExtension = rrdDef.getPath().replace(getDefaultFileExtension(), "");
        int lastIndexOfSeparator = filenameWithoutExtension.lastIndexOf(File.separator);

        RrdMetaDataUtils.createMetaDataFile(
            new File(filenameWithoutExtension.substring(0, lastIndexOfSeparator)),
            filenameWithoutExtension.substring(lastIndexOfSeparator),
            attributeMappings
        );
    }

