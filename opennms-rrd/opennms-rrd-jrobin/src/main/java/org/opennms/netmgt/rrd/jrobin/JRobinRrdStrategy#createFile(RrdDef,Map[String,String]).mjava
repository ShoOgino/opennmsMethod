    /**
     * Creates the JRobin RrdDb from the def by opening the file and then
     * closing.
     *
     * @param rrdDef a {@link org.jrobin.core.RrdDef} object.
     * @throws java.lang.Exception if any.
     */
    public void createFile(final RrdDef rrdDef,  Map<String, String> attributeMappings) throws Exception {
        if (rrdDef == null) {
        	log().debug("createRRD: skipping RRD file");
            return;
        }
        log().info("createRRD: creating RRD file " + rrdDef.getPath());
        
        RrdDb rrd = new RrdDb(rrdDef);
        rrd.close();
        
        String filenameWithoutExtension = rrdDef.getPath().replace(RrdUtils.getExtension(), "");
        int lastIndexOfSeparator = filenameWithoutExtension.lastIndexOf(File.separator);
        
		RrdUtils.createMetaDataFile(
				filenameWithoutExtension.substring(0, lastIndexOfSeparator),
				filenameWithoutExtension.substring(lastIndexOfSeparator),
				attributeMappings);
    }

