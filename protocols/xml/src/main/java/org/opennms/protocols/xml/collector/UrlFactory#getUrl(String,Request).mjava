    /**
     * Gets the URL Object.
     * <p>This method has been created because it is not possible to call URL.setURLStreamHandlerFactory more than once.</p>
     *
     * @param urlStr the URL String
     * @param request the request
     * @return the URL Object
     * @throws MalformedURLException the malformed URL exception
     */
    public static URL getUrl(String urlStr, Request request) throws MalformedURLException {
        URL url = null;
        String protocol = null;
        try {
            protocol = urlStr.substring(0, urlStr.indexOf("://")).toLowerCase();
        } catch (Exception e) {
            return null;
        }
        if (SftpUrlHandler.PROTOCOL.equals(protocol)) {
            url = new URL(null, urlStr, new SftpUrlHandler());
        } else if (Sftp3gppUrlHandler.PROTOCOL.equals(protocol)) {
            url = new URL(null, urlStr, new Sftp3gppUrlHandler());
        } else if (HttpUrlHandler.HTTP.equals(protocol)) {
            url = new URL(null, urlStr, new HttpUrlHandler(request));
        } else if (HttpsUrlHandler.HTTPS.equals(protocol)) {
            url = new URL(null, urlStr, new HttpsUrlHandler(request));
        } else {
            url = new URL(urlStr);
        }
        return url;
    }

