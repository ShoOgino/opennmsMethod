    /**
     * Gets the collection resource.
     *
     * @param agent the collection agent
     * @param instance the resource instance
     * @param resourceType the resource type
     * @return the collection resource
     */
    private XmlCollectionResource getCollectionResource(CollectionAgent agent, String instance, String resourceType) {
        XmlCollectionResource resource = null;
        if (resourceType.toLowerCase().equals("node")) {
            resource = new XmlSingleInstanceCollectionResource(agent);
        } else {
            resource = new XmlMultiInstanceCollectionResource(agent, instance, resourceType);
        }
        return resource;
    }

