    public static CollectionSet doCollect(NodeDao nodeDao, XmlCollectionHandler handler, CollectionAgent agent, XmlDataCollection collection, Map<String, Object> parameters) throws CollectionException {
        ResourceTypeMapper.getInstance().setResourceTypeMapper(type -> getResourceType(type));
        XmlCollector collector = new XmlCollector();
        collector.setNodeDao(nodeDao);
        XmlDataCollection parsedCollection = collector.parseCollection(collection, handler, agent, parameters);
        return handler.collect(agent, parsedCollection, parameters);
    }

