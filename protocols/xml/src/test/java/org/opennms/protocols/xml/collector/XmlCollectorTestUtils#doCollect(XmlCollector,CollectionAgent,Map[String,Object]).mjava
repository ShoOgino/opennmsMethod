    public static CollectionSet doCollect(XmlCollector collector, CollectionAgent agent, Map<String, Object> parameters) throws CollectionException {
        ResourceTypeMapper.getInstance().setResourceTypeMapper(type -> getResourceType(type));
        final Map<String, Object> runtimeAttributes = collector.getRuntimeAttributes(agent, parameters);
        Map<String, Object> allParams = new HashMap<>();
        allParams.putAll(parameters);
        allParams.putAll(runtimeAttributes);
        allParams = Collections.unmodifiableMap(allParams);
        return collector.collect(agent, allParams);
    }

