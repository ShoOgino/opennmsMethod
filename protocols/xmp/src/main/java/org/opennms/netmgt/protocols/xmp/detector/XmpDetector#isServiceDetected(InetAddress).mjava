    public boolean isServiceDetected(InetAddress address)
    {
        XmpSession aSession;
        XmpMessage aReply;
        XmpVar[] vars,replyVars;

        if (LOG != null)
           LOG.debug("XmpDetector: isServiceDetected checking out "+address);
        else 
	   System.out.println("XmpDetector: isServiceDetected starting with null LOG to query "+address);

        // try to establish session
        aSession = new XmpSession(sockopts,address,xmpPort,xmpAuthenUser);
        if (aSession == null) {
	   System.out.println("XmpDetector: null session to "+address);
	   LOG.debug("XmpDetector: null session to "+address);
	   return false;
        }

        if (LOG != null)
           LOG.debug("XmpDetector: isServiceDetected session established with "+address);
        else 
           System.out.println("XmpDetector: isServiceDetected session established with "+address);

        // query for core.sysName, core.sysDescr, 
        // core.sysUpTime, core.xmpdVersion
        vars = new XmpVar[] {
	    new XmpVar("core","sysName","","",Xmp.SYNTAX_NULLSYNTAX),
	    new XmpVar("core","sysDescr","","",Xmp.SYNTAX_NULLSYNTAX),
	    new XmpVar("core","sysUpTime","","",Xmp.SYNTAX_NULLSYNTAX),
	    new XmpVar("core","xmpdVersion","","",Xmp.SYNTAX_NULLSYNTAX),
        };
      
        if ((aReply = aSession.queryVars(vars)) == null) {
            if (LOG != null) {
               LOG.debug("XmpDetector: isServiceDetected no vars from "+address);
               LOG.debug("XmpDetector: isServiceDetected false for "+address);
            }
            else {
               System.out.println("XmpDetector: isServiceDetected no vars from "+address);
               System.out.println("XmpDetector: isServiceDetected false for "+address);
            }
	    aSession.closeSession();
            return false;
        }

        aSession.closeSession();

	// log what we retrieved
        if ((replyVars = aReply.getMIBVars()) == null) {
           if (LOG != null) {
	      LOG.debug("XmpDetector: isServiceDetected no replyVars for "+address);
   	   }
           else {
	      System.out.println("XmpDetector: isServiceDetected no replyVars for"+address);
           }

           return false;

        } /* if replyVars == null */

        if (LOG != null) {
           LOG.debug("XmpDetector: isServiceDetected "+address+" reports "+
                     replyVars[0].getValue()+","+
                     replyVars[1].getValue());
           LOG.debug("XmpDetector: isServiceDetected true for "+address);
	}
        else {
           System.out.println("XmpDetector: isServiceDetected "+address+" reports "+
                              replyVars[0].getValue()+","+
                              replyVars[1].getValue());
           System.out.println("XmpDetector: isServiceDetected true for "+address);
        }

	return true;

    } /* isServiceDetected */

