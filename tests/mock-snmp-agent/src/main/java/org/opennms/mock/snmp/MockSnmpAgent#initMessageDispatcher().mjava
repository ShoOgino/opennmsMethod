    /** {@inheritDoc} */
    @Override
    protected void initMessageDispatcher() {
        s_log.info("MockSnmpAgent: starting initMessageDispatcher()");
        try {
            dispatcher = new MessageDispatcherImpl();
    
            usm = new USM(SecurityProtocols.getInstance(),
                          agent.getContextEngineID(),
                          updateEngineBoots());
    
            mpv3 = new MPv3(usm);
    
            SecurityProtocols.getInstance().addDefaultProtocols();
            dispatcher.addMessageProcessingModel(new MPv1());
            dispatcher.addMessageProcessingModel(new MPv2c());
            dispatcher.addMessageProcessingModel(mpv3);
            initSnmpSession();
        } finally {
            s_log.info("MockSnmpAgent: finished initMessageDispatcher()");
        }
    }

