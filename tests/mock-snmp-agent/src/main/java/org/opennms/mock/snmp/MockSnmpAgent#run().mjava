    /**
     * Starts the <code>MockSnmpAgent</code> running.  Meant to be called from the
     * <code>start</code> method of class <code>Thread</code>, but could also be
     * used to bring up a standalone mock agent.
     * @see org.snmp4j.agent.BaseAgent#run()
     * 
     * @author Jeff Gehlbach
     */
    @Override
    public void run() {
        try {
            init();
            loadConfig(ImportModes.UPDATE_CREATE);
            addShutdownHook();
            finishInit();
            super.run();
            m_running = true;
        } catch (final BindException e) {
        	s_log.error(String.format("Unable to bind to %s.  You probably specified an invalid address or a port < 1024 and are not running as root. Exception: %s", m_address, e), e);
        } catch (final Throwable t) {
        	s_log.error("An error occurred while initializing: " + t, t);
        }

        boolean interrupted = false;
        while (m_running) {
            try {
                Thread.sleep(10); // fast, Fast, FAST, *FAST*!!!
            } catch (final InterruptedException e) {
                interrupted = true;
                break;
            }
        }

        for (final TransportMapping transportMapping : transportMappings) {
            try {
                if (transportMapping != null) {
                	transportMapping.close();
                }
            } catch (final IOException t) {
            	s_log.error("an error occurred while closing the transport mapping " + transportMapping + ": " + t, t);
            }
        }

        m_stopped = true;

        s_log.debug("Agent is no longer running.");
        if (interrupted) {
        	Thread.currentThread().interrupt();
        }
    }

