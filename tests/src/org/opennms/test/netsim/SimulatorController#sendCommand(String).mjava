    protected void sendCommand(String command)
    {
        command = "ssh " + this._controlChannel.getHostAddress() + " /usr/local/netsim/init.d/" + command;
        try {
            Process p = Runtime.getRuntime().exec(command);
            for (int ms = 0; ms < 5000; ms += 100)
            {
                try {
                    int exit = p.exitValue();
                    break;
                } catch (IllegalThreadStateException e) {
                    //System.err.println("Still not done at " + ms + " milliseconds.");
                }
                Thread.sleep(100);
            }
            
            try {
                int exit = p.exitValue();
                if (!(exit == 0)) {
                    System.out.println("Nonzero exit code: " + exit);
                }
            } catch (IllegalThreadStateException e) {
                System.err.println("Process timed out executing command '" + command + "'");
            } finally {
                p.destroy();
            }
        } catch (InterruptedException e) {
            System.err.println("Thread interrupted!");
        } catch (java.io.IOException e) {
            System.err.println("IOException executing command '" + command + "'");
        }
    }

